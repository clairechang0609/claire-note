{"pages":[{"title":"404","text":"æ‰¾ä¸åˆ°æ­¤é é¢ è¿”å›é¦–é  .navbar, .article-meta.columns.is-variable.is-1.is-multiline.is-mobile.is-size-7-mobile, .footer { display: none; } .container { position: fixed; left: 50%; top: 50%; transform: translate(-50%, -50%); text-align: center; } h1.is-size-3 { font-size: 3rem !important; color: rgb(27, 102, 85); } .headerlink { display: none; } h3:hover::before { display: none; } .content p:not(:last-child) { margin-bottom: 2rem; } p a { padding: 0.35rem 1rem; background-color: rgb(30, 160, 142); color: white; border-radius: 20px; } p a:hover { color: white; }","link":"/404.html"},{"title":"I'm Claire Chang","text":"ç•¶äº† 6 å¹´çš„å¹³é¢è¨­è¨ˆå¸«ï¼Œåœ¨æœ‹å‹çš„æ¨è–¦ä¸‹è¸å…¥å‰ç«¯é ˜åŸŸï¼Œç™¼ç¾å¯ä»¥åšå‹•æ…‹çš„ç¶²ç«™ç›¸ç•¶æœ‰è¶£ï¼Œ æ–¼æ˜¯åœ¨ 2020 å¹´ 10 æœˆæˆåŠŸè½‰è·ç‚ºå‰ç«¯å·¥ç¨‹å¸«ï¼Œç›®å‰æŒçºŒå­¸ç¿’è€•è€˜ä¸­ã€‚ ä¸€ç›´ä»¥ä¾†å¾ç¶²è·¯å¤§ç¥å¯«çš„æ–‡ç« ç²ç›Šè‰¯å¤šï¼Œæ±ºå®šæŠŠè‡ªå·±å­¸ç¿’ç¢°åˆ°çš„å‘èˆ‡éç¨‹è¨˜éŒ„ä¸‹ä¾†ï¼Œ é™¤äº†è®“è‡ªå·±è¤‡ç¿’ä¸€éï¼Œä¹Ÿå¸Œæœ›èƒ½çµ¦äºˆç¢°åˆ°ç›¸åŒå•é¡Œçš„äººä¸€äº›å¹«åŠ©ã€‚ æœ‰ä»»ä½•æƒ³è·Ÿæˆ‘äº¤æµäº’å‹•çš„å…§å®¹ï¼Œæ­¡è¿ç•™è¨€çµ¦æˆ‘å–²ï¼ https://www.behance.net/claire0609e29c https://github.com/clairechang0609","link":"/about/index.html"}],"posts":[{"title":"é€é NVM ç®¡ç†å¤šç‰ˆæœ¬ Node.jsï¼ˆMacOSï¼‰","text":"NVMï¼ˆNode Version Managerï¼‰ç‚º Node.js ç‰ˆæœ¬ç®¡ç†å·¥å…·ã€‚ æ¯å€‹å°ˆæ¡ˆé–‹ç™¼å¯èƒ½æœƒæ­é…ä¸åŒçš„ Node.js ç‰ˆæœ¬ï¼Œç‰ˆæœ¬å·®ç•°æœƒå°è‡´ç·¨è­¯æˆ–é–‹ç™¼ç™¼ç”Ÿå•é¡Œï¼Œå› æ­¤å¸¸å¸¸éœ€è¦ä¾†å›é€²è¡Œç‰ˆæœ¬åˆ‡æ›ï¼Œè€Œ NVM æœ€å¤§çš„ç”¨é€”æ˜¯å¯ä»¥è¼•é¬†åˆ‡æ› Node.js ç‰ˆæœ¬ã€‚ å®‰è£ NVMæ‰“é–‹ã€ŒTerminal çµ‚ç«¯æ©Ÿã€è¼¸å…¥æŒ‡ä»¤å®‰è£ NVMï¼ˆv0.39.3 ç‚ºç‰ˆæœ¬è™Ÿï¼‰ curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.3/install.sh | bash å¦‚æœæˆ‘å€‘æ˜¯ä½¿ç”¨å…¶ä»–çš„ shell æŒ‡ä»¤å·¥å…·ï¼Œè¼¸å…¥ nvm å¯èƒ½æœƒå ±éŒ¯ï¼Œåƒæ˜¯ï¼š zsh: command not found: nvm shellï¼šå‘½ä»¤è§£æå™¨ï¼Œè®“ä½¿ç”¨è€…é€éçµ‚ç«¯æ©Ÿè·Ÿä½œæ¥­ç³»çµ±æ ¸å¿ƒåšæºé€šï¼Œè€Œ bash è·Ÿ zsh æ˜¯ shell æŒ‡ä»¤å·¥å…· ç™¼ç”ŸéŒ¯èª¤éœ€è¦æ‰‹å‹•è¨­å®šï¼Œbash è·Ÿ zsh å…©ç¨®æŒ‡ä»¤å·¥å…·å‰‡ä¸€ï¼š bashåœ¨æ ¹ç›®éŒ„æª¢æŸ¥æ˜¯å¦æœ‰ .bash_profile æª”æ¡ˆï¼ˆç‚ºéš±è—æª”æ¡ˆï¼Œè¼¸å…¥ shift + command + . å¯ä»¥é¡¯ç¤ºéš±è—æª”ï¼‰ï¼Œå¦‚æœæ²’æœ‰ä½¿ç”¨æŒ‡ä»¤æ‰‹å‹•å»ºç«‹ touch ~/.bash_profile æ¥ä¸‹ä¾†æ‰“é–‹æª”æ¡ˆåŠ å…¥ç¨‹å¼ç¢¼ export NVM_DIR=\"$HOME/.nvm\"[ -s \"$NVM_DIR/nvm.sh\" ] &amp;&amp; \\. \"$NVM_DIR/nvm.sh\" # This loads nvm[ -s \"$NVM_DIR/bash_completion\" ] &amp;&amp; \\. \"$NVM_DIR/bash_completion\" # This loads nvm bash_completion æ¥è‘—è¼¸å…¥ nvm å–å¾—ä»¥ä¸‹å…§å®¹ä»£è¡¨å®‰è£æˆåŠŸ Node Version Manager (v0.39.3)Note: &lt;version&gt; refers to any version-like string nvm understands. This includes: - full or partial version numbers, starting with an optional \"v\" (0.10, v0.1.2, v1) - default (built-in) aliases: node, stable, unstable, iojs, system - custom aliases you define with `nvm alias foo` Any options that produce colorized output should respect the `--no-colors` option.Usage: nvm --help Show this message --no-colors Suppress colored output nvm --version Print out the installed version of nvm nvm install [&lt;version&gt;] Download and install a &lt;version&gt;. Uses .nvmrc if available and version is omitted. The following optional arguments, if provided, must appear directly after `nvm install`:... zshåœ¨æ ¹ç›®éŒ„æª¢æŸ¥æ˜¯å¦æœ‰ .zshrc æª”æ¡ˆï¼ˆç‚ºéš±è—æª”æ¡ˆï¼‰ï¼Œå¦‚æœæ²’æœ‰ä½¿ç”¨æŒ‡ä»¤æ‰‹å‹•å»ºç«‹ touch ~/.zshrc æ¥ä¸‹ä¾†æ‰“é–‹æª”æ¡ˆåŠ å…¥ç¨‹å¼ç¢¼ export NVM_DIR=\"$HOME/.nvm\"[ -s \"$NVM_DIR/nvm.sh\" ] &amp;&amp; \\. \"$NVM_DIR/nvm.sh\" # This loads nvm[ -s \"$NVM_DIR/bash_completion\" ] &amp;&amp; \\. \"$NVM_DIR/bash_completion\" # This loads nvm bash_completion NVM ç›¸é—œæŒ‡ä»¤ nvm ls-remoteï¼šç•¶å‰å¯ç”¨çš„é ç«¯ Node.js ç‰ˆæœ¬ nvm listï¼šæœ¬æ©Ÿå®‰è£çš„ Node.js ç‰ˆæœ¬ nvm install ï¼šå®‰è£ç‰¹å®šç‰ˆæœ¬ Node.js nvm alias default ï¼šå‘½ä»¤åˆ—é è¨­ä½¿ç”¨ Node.js ç‰ˆæœ¬ nvm use ï¼šç•¶å‰å‘½ä»¤åˆ—ä½¿ç”¨ Node.js ç‰ˆæœ¬ é€é NVM å®‰è£å¤šç‰ˆæœ¬ Node.jsåŸ·è¡Œ nvm ls-remote å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ï¼ˆæˆªå–ç‰‡æ®µï¼‰ ...v14.11.0v14.12.0v14.13.0v14.13.1v14.14.0v14.15.0 (LTS: Fermium)v14.15.1 (LTS: Fermium)v14.15.2 (LTS: Fermium)v14.15.3 (LTS: Fermium)...v14.20.1 (LTS: Fermium)v14.21.0 (LTS: Fermium)v14.21.1 (LTS: Fermium)v14.21.2 (LTS: Fermium)v14.21.3 (Latest LTS: Fermium)v15.0.0v15.0.1v15.1.0... æŒ‘é¸ç‰ˆæœ¬æ™‚å»ºè­°å®‰è£ LTSï¼ˆé•·æœŸæ”¯æ´ï¼‰ç‰ˆæœ¬ å‡è¨­æƒ³åŒæ™‚å®‰è£ v14 è·Ÿ v16ï¼Œä¾›ä¸åŒå°ˆæ¡ˆä½¿ç”¨ï¼Œè©²å¦‚ä½•åšï¼š 1. å®‰è£ Node.js nvm install 14nvm install 16 2. æŒ‡å®šé è¨­ç‰ˆæœ¬ nvm alias default 14 é€é nvm list æŸ¥çœ‹æœ¬æ©Ÿå®‰è£ç‰ˆæœ¬ 3. å°ˆæ¡ˆåˆ‡æ›ç‰ˆæœ¬ ç‰¹å®šå°ˆæ¡ˆç‰ˆæœ¬åˆ‡æ› nvm use 16 åƒè€ƒæ–‡ç« ï¼š https://ithelp.ithome.com.tw/articles/10261849 https://www.casper.tw/development/2022/01/10/install-nvm/","link":"/2023/02/18/node/node-nvm/"},{"title":"Nuxt.js æ­é… Axios èˆ‡è‡ªè¨‚ Error Page","text":"ç‰ˆæœ¬ï¼šnuxt 2.15.8 Axios æ˜¯ä¸€å¥—ç›¸ç•¶ä¾¿åˆ©çš„ Promise Base Ajax å¥—ä»¶ï¼Œè€Œ Nuxt åˆæœ‰ Axios æ•´åˆå¥—ä»¶ @nuxtjs/axiosï¼Œæ­¤ç¯‡ç¯„ä¾‹æœƒä½¿ç”¨åˆ° Asyncã€Awaitï¼Œå¦‚æœå°æ–¼ Promise å°šä¸ç†Ÿæ‚‰ï¼Œå¯ä»¥åƒè€ƒ Promise ä»‹ç´¹æ–‡ç«  é‚£å€‘æˆ‘å€‘å°±ä¾†æ›¿å°ˆæ¡ˆåŠ ä¸Š axios å§ï¼é¦–å…ˆåŸ·è¡Œ npm install @nuxtjs/axios æ¥è‘—åœ¨ nuxt.config.js é€²è¡Œé…ç½®ï¼ˆåƒæ•¸é¸é …ï¼‰ï¼š // nuxt.config.jsexportdefault { modules: [ '@nuxtjs/axios' ], axios: { baseUrl: process.env.SERVER_URL, browserBaseURL: process.env.BASE_URL, credentials: true }} å¦‚æœéœ€è¦å€åˆ† client è·Ÿ server ç«¯ base urlï¼Œå¯ä»¥å¦å¤–è¨­å®š browserBaseURLï¼ˆæ–¼client ç«¯æœƒè¦†å¯« baseUrlï¼‰ï¼Œå¥—ä»¶å°‡ axios æ–¹æ³•ç›´æ¥ æ³¨å…¥(inject) è‡³ Vue å¯¦ä¾‹ï¼Œæ“·å–å¥—ä»¶åŸå§‹ç¢¼ç‰‡æ®µ // node_modules/@nuxtjs/axios/lib/plugin.js// Inject axios to the context as $axiosctx.$axios = axiosinject('axios', axios) å› æ­¤åœ¨ Vue ç”Ÿå‘½é€±æœŸæˆ–å±¬æ€§ä½¿ç”¨ this.$axios å³å¯å‘¼å« axios æ–¹æ³•ï¼Œé‚£éº½åœ¨ Nuxt ç”Ÿå‘½é€±æœŸå‘¢ï¼Ÿ Nuxt ç”Ÿå‘½é€±æœŸï¼ˆasyncData, fetch, plugins, middlewareï¼‰æœƒè‡ªå‹•å¸¶å…¥ context åƒæ•¸ï¼Œcontext åŒ…å«ä»¥ä¸‹åƒæ•¸ / ç‰©ä»¶ï¼š const { $axios app, store, route, params, query, env, isDev, isHMR, redirect, error, $config} = context ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼ˆç¯„ä¾‹ä½¿ç”¨ asyncDataï¼‰ // pages/about.vueexport default { async asyncData(context) { const { seo } = await context.$axios.$get('/api/seo'); return { seo }; }} æˆ‘å€‘ä¹Ÿå¯ä»¥ç‰©ä»¶è§£æ§‹æ–¹å¼ä½¿ç”¨ $axios // pages/about.vueexport default { async asyncData({ $axios }) { const { seo } = await $axios.$get('/api/seo'); return { seo }; }} axios æä¾›ä»¥ä¸‹æ–¹æ³•é€²è¡Œäº‹ä»¶æ•æ‰ï¼š onRequest(config) onResponse(response) onError(err) onRequestError(err) onResponseError(err) å¦‚æœæˆ‘å€‘æƒ³è¦å…¨åŸŸè¨»å†Šæ””æˆªå™¨(Interceptors) é€²è¡Œ api è«‹æ±‚æˆ–æ˜¯éŒ¯èª¤æ•æ‰ï¼Œä¹Ÿå¾ˆç°¡å–®ï¼Œ é¦–å…ˆåœ¨ plugins æ–°å¢æª”æ¡ˆï¼Œé€™è£¡å‘½åç‚º axios.jsï¼Œæ¥è‘—åœ¨è£¡é¢ç›£è½æƒ³æ•æ‰çš„äº‹ä»¶æ–¹æ³• // plugins/axios.jsexport default ({ $axios, redirect, store }) =&gt; { $axios.onRequest(config =&gt; { console.log('on request', config.url); }); $axios.onError(error =&gt; { const code = parseInt(error.response &amp;&amp; error.response.status); if (code === 401) { redirect('/login'); } });}; æ¥è‘—åœ¨ nuxt.config.js plugins é€²è¡Œæ“´å…… // nuxt.config.jsexport default { plugins: [ { src: '@/plugins/axios' } ]} axios åœ¨ç™¼ç”ŸéŒ¯èª¤æ™‚ï¼Œé è¨­æœƒå°åˆ° error pageï¼Œå¦‚æœæˆ‘å€‘æƒ³é¿å…ç•«é¢è·³è½‰ï¼Œå¯ä»¥åŠ å…¥ resolve promiseï¼Œé€™æ¨£åœ¨ç™¼ç”ŸéŒ¯èª¤æ™‚ï¼Œéƒ½ä¸æœƒè·³è½‰åˆ° error page // plugins/axios.jsexport default ({ $axios, redirect, store }) =&gt; { $axios.onError(error =&gt; { const code = parseInt(error.response &amp;&amp; error.response.status); if (code === 401) { redirect('/login'); } return Promise.resolve(false); // é¿å…ç•«é¢è½‰å°éŒ¯èª¤é  });}; å¦‚æœå…¨åŸŸè¨­å®š resolve promiseï¼Œåœ¨ axios ç™¼ç”ŸéŒ¯èª¤æ™‚ï¼Œéƒ½ä¸æœƒé€²åˆ° catch error æ­ï¼ è‡ªè¨‚ Error Page Nuxt å°ˆæ¡ˆæœ‰é è¨­çš„ error pageï¼Œå¯ä»¥åœ¨ .nuxt è³‡æ–™å¤¾çœ‹åˆ° components/nuxt-error.vueï¼ŒéŒ¯èª¤é é¢ä¹Ÿå¯ä»¥è‡ªè¨‚ï¼Œæª”æ¡ˆæ”¾ç½®ä½ç½®æ¯”è¼ƒç‰¹åˆ¥ï¼Œåœ¨ layouts è³‡æ–™å¤¾å…§æ–°å¢ä¸€æ”¯æª”æ¡ˆ error.vue // layouts/error.vue&lt;template&gt; &lt;div class=\"nuxt-error-wrap\"&gt; &lt;div class=\"text-center py-4\"&gt; &lt;h2&gt;{{ error.statusCode }}&lt;/h2&gt; &lt;h3&gt;{{ error.message }}&lt;/h3&gt; &lt;/div&gt; &lt;nuxt-link to=\"/\" class=\"btn btn-primary p-4\"&gt;å›é¦–é &lt;/nuxt-link&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default { name: 'ErrorPage', layout: 'error-layout', props: { error: { type: Object, default: () =&gt; {} } }};&lt;/script&gt; é›–ç„¶ error.vue æª”ç½®æ–¼ layouts è³‡æ–™å¤¾ï¼Œä½†è¦–ç‚º pages é é¢ï¼Œå› æ­¤å¦‚æœæ²’æœ‰é…ç½® layoutï¼Œé è¨­æœƒè®€å– layouts/default.vue æ¨£æ¿ é€™æ¨£å°±å®Œæˆäº†ï¼Œåœ¨ Nuxt ç™¼ç”ŸéŒ¯èª¤æ™‚ï¼Œéƒ½æœƒé€²åˆ°æˆ‘å€‘è‡ªè¨‚éŒ¯èª¤é é¢ï¼Œå¦‚æœè¦æ‰‹å‹•é€²åˆ°éŒ¯èª¤é ï¼Œå‘¼å« context å…§çš„ error æ–¹æ³•å³å¯ï¼Œåœ¨ Nuxt ç”Ÿå‘½é€±æœŸï¼š // pages/about.vueexport default { async asyncData({ $axios, error }) { try { const { seo } = await $axios.$get('/api/seo'); return { seo }; } catch(err) { const { statusCode, message } = err; error({ statusCode, message }); } }} åœ¨ Vue ç”Ÿå‘½é€±æœŸæˆ–å±¬æ€§ï¼Œä½¿ç”¨ this.$nuxt.error() å°±å¯ä»¥å›‰ï¼ // pages/about.vueexport default { methods: { async getSeo() { try { const { seo } = await this.$axios.$get('/api/seo'); this.seo = seo; } catch(err) { const { statusCode, message } = err; this.$nuxt.error({ statusCode, message }); } } }} åƒè€ƒæ–‡ç« ï¼š https://ithelp.ithome.com.tw/articles/10208852 https://mavrickmaster.medium.com/custom-error-pages-with-nuxt-js-3c70e6c51aff","link":"/2022/11/21/nuxt/nuxt-axios/"},{"title":"Nuxt.js å¥—ä»¶æ‡‰ç”¨ï¼šBootstrap 5 æ­é… SCSS æ‰“é€ ç¶²é  UI","text":"ç‰ˆæœ¬ï¼šnuxt 2.15.8 Bootstrap æ˜¯ä¸€æ¬¾ç›¸ç•¶ç†±é–€çš„å‰ç«¯é–‹ç™¼å·¥å…·ï¼Œå¯ä»¥å¹«åŠ©æˆ‘å€‘å¿«é€Ÿçš„è¨­è¨ˆè·Ÿè‡ªè¨‚ RWD ç¶²ç«™ï¼Œéå» Bootstrap ç›¸ä¾æ–¼ jQuery é–‹ç™¼ï¼ŒBootstrap 5 ä¸éœ€ä½¿ç”¨ jQueryï¼Œæ–°å¢ Utilities APIï¼Œå¯ä»¥æ›´ç°¡æ˜“çš„ç®¡ç†æˆ–æ“´å……æ¨£å¼ï¼Œè®“ç¨‹å¼ç¢¼æ›´è¼•é‡ï¼Œå¦å¤–ä¹Ÿæ–°å¢äº† Bootstrap Icons ä¾›å…è²»ä½¿ç”¨ã€‚ é€é create-nuxt-app å»ºç½® Nuxt.js å°ˆæ¡ˆæ™‚ï¼Œé›–ç„¶å¯ä»¥é¸æ“‡ CSS æ¨¡æ¿ï¼ˆUI frameworkï¼‰ï¼Œä½†é¸é …å…§ä¸¦æ²’æœ‰ Bootstrap ï¼ˆBootstrap Vue æ­é…çš„æ˜¯ Bootstrap 4.5ï¼‰ï¼Œå› æ­¤éœ€æ‰‹å‹•å®‰è£ã€‚ æ­é… SCSS é–‹ç™¼éœ€è¦å®‰è£ sass loaderï¼ŒåŸ·è¡Œï¼š npm i --save-dev sass sass-loader@10 æ¥è‘—å®‰è£ Bootstrapï¼š npm i --save bootstrap @popperjs/core æ–°å¢å…©å€‹æª”æ¡ˆï¼ˆæª”åè‡ªè¨‚ï¼‰ï¼š plugins/bootstrap.jsï¼šç”¨ä¾†è¨­å®šå‹•æ…‹åŠŸèƒ½ assets/scss/app.scssï¼šç”¨ä¾†é…ç½®æ¨£å¼ ç„¶å¾Œè‡³ nuxt.config.js åŠ å…¥æª”æ¡ˆï¼š // nuxt.config.jsexport default { css: [ { src: '@/assets/scss/app.scss', lang: 'scss' } ], plugins: [ { src: '@/plugins/bootstrap', mode: 'client' } ]} CSS è¨­å®šä¸å»ºè­°ç›´æ¥å¼•å…¥ ~bootstrap/scss/bootstrap ï¼Œé¸æ“‡éœ€è¦çš„æ¨£å¼å¼•å…¥å³å¯ï¼Œé¿å… css æª”æ¡ˆéå¤§ï¼Œé€ æˆç³»çµ±è² æ“” éœ€æ³¨æ„å¼•å…¥çš„é †åºï¼š // assets/scss/app.scss// 1. å¼•å…¥ functionsï¼Œæ‰èƒ½æ“æ§é¡è‰², svg, calc...@import \"~bootstrap/scss/functions\";// 2. è‡ªè¨‚è®Šæ•¸ï¼Œæœƒè¦†è“‹ bootstrap çš„è®Šæ•¸@import \"./variables\";// 3. å¼•å…¥ variables, mixins, root@import \"~bootstrap/scss/variables\";@import \"~bootstrap/scss/mixins\";@import \"~bootstrap/scss/root\";// 4. å¼•å…¥ utilities@import \"~bootstrap/scss/utilities\";// 5. è‡ªè¨‚ utilities@import \"./utilities\";// 6. å¼•å…¥éœ€è¦çš„ bootstrap components@import \"~bootstrap/scss/reboot\";@import \"~bootstrap/scss/type\";@import \"~bootstrap/scss/images\";@import \"~bootstrap/scss/containers\";@import \"~bootstrap/scss/grid\";@import \"~bootstrap/scss/tables\";@import \"~bootstrap/scss/forms\";@import \"~bootstrap/scss/buttons\";@import \"~bootstrap/scss/helpers\";// ...// 7. ä½¿ç”¨ utilities éœ€å¼•å…¥ utilities apiï¼ˆå°‡ sass map è½‰æ›ç‚º utility classesï¼‰@import \"~bootstrap/scss/utilities/api\";// 8. å®¢è£½æ¨£å¼ç½®æ–¼æœ€å¾Œï¼Œè¦†è“‹å‰é¢çš„æ¨£å¼@import \"./style\"; æƒ³è¦äº†è§£å¦‚ä½•ä½¿ç”¨ utilities å®¢è£½æ¨£å¼ï¼Œå¯ä»¥åƒè€ƒ é€™ç¯‡æ–‡ç«  Javascript è¨­å®š// plugins/bootstrap.jsimport Vue from 'vue';import * as bootstrap from 'bootstrap';const { Modal, Collapse } = bootstrap;// é¿å…é‡è¤‡è¨»å†Šï¼Œåœ¨ Vue å¯¦é«”å…§åŠ å…¥åƒæ•¸åˆ¤æ–·if (!Vue.__bootstrap_mixin__) { Vue.__bootstrap_mixin__ = true; Vue.mixin({ methods: { bootstrapModal(element) { return new Modal(element); }, bootstrapCollapse(element) { return new Collapse(element); } } });} å°‡éœ€ä½¿ç”¨åˆ°çš„åŠŸèƒ½ï¼ˆEXï¼šModal, Collapseï¼‰é€é mixin è¨»å†Šåˆ° Vue å¯¦é«”ï¼Œé€™æ¨£åœ¨ .vue æª”å…§å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚ ç¯„ä¾‹èªªæ˜å¦‚ä½•åœ¨é é¢ä¸Šï¼ˆpages/about.vueï¼‰æ“æ§å…ƒä»¶ï¼ˆcomponents/modal.vueï¼‰ï¼Œè®“ Modal é–‹å•Ÿï¼š // components/modal.vue&lt;template&gt; &lt;div class=\"modal fade\" tabindex=\"-1\"&gt; &lt;div class=\"modal-dialog\"&gt; &lt;div class=\"modal-content\"&gt; &lt;div class=\"modal-header\"&gt; &lt;h5&gt;Modal Title&lt;/h5&gt; &lt;button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"&gt;&lt;/button&gt; &lt;/div&gt; &lt;div class=\"modal-body\"&gt; ... &lt;/div&gt; &lt;div class=\"modal-footer\"&gt; &lt;button type=\"button\" class=\"btn btn-outline-secondary\" data-bs-dismiss=\"modal\"&gt;&lt;/button&gt; &lt;button type=\"button\" class=\"btn btn-secondary\"&gt;ç¢ºå®š&lt;/button&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default { name: 'Modal'}&lt;/script&gt; // pages/about.vue&lt;template&gt; &lt;h2&gt;é—œæ–¼æˆ‘å€‘&lt;/h2&gt; &lt;Modal ref=\"modal\" /&gt; &lt;button type=\"button\" class=\"btn btn-primary\" @click=\"openModal()\"&gt;é–‹å•Ÿ Modal&lt;/button&gt;&lt;/template&gt;&lt;script&gt;import Modal from '@/components/Modal';export default { name: 'About', components: { Modal }, data() { return { modal: '' } }, mounted() { // æ“æ§å…§å±¤å…ƒä»¶ï¼Œéœ€æŒ‡å®š this.$refs.modal å…§çš„ $el this.modal = this.bootstrapModal(this.$refs.modal.$el); }, methods: { openModal() { this.modal.show(); } }};&lt;/script&gt; åƒè€ƒæ–‡ç« ï¼š https://getbootstrap.com/ https://easonchang0115.github.io/blogs/other/2021/20210530_1.html https://stackoverflow.com/questions/71432924/vuejs-3-and-bootstrap-5-modal-reusable-component-show-programmatically","link":"/2022/12/22/nuxt/nuxt-bootstrap5/"},{"title":"Nuxt.js ç›®éŒ„çµæ§‹","text":"ç‰ˆæœ¬ï¼šnuxt 2.15.8 ä½¿ç”¨ create-nuxt-app å®‰è£å®Œæˆå¾Œï¼Œå¯ä»¥çœ‹åˆ°ä»¥ä¸‹çš„è³‡æ–™å¤¾çµæ§‹ï¼š assets, layouts, middleware, mixins, plugins ä»¥ä¸Šè³‡æ–™å¤¾åœ¨ç•¶å‰ç‰ˆæœ¬æ˜¯éœ€è¦æ‰‹å‹•å»ºç½®çš„ï¼Œ ä¾ç…§é †åºä»‹ç´¹å„è³‡æ–™å¤¾åŠŸèƒ½ï¼š assetsè·Ÿ Vue å°ˆæ¡ˆç›¸åŒï¼Œç”¨ä¾†å­˜æ”¾åƒæ˜¯ css, scss, images éœ€è¦è¢« webpack ç·¨è­¯çš„éœæ…‹è³‡æºï¼Œå¦‚ä¸éœ€è¢«ç·¨è­¯ï¼Œå‰‡å­˜æ”¾æ–¼ staticã€‚ componentsè‡ªè¨‚çš„å…ƒä»¶æª”ï¼Œä¾‹å¦‚æˆ‘å€‘å¸¸æœƒå»ºç«‹å…±ç”¨çš„ Navbar.vue, Sidebar.vue â€¦ï¼Œé€šå¸¸ç‚ºå¤§å¯«å‘½åï¼Œç„¶å¾Œåœ¨éœ€è¦çš„é é¢å¼•å…¥è©²æª”æ¡ˆå³å¯ä½¿ç”¨ï¼Œä½¿ç”¨æ–¹å¼åŸºæœ¬ä¸Šè·Ÿ Vue å°ˆæ¡ˆç›¸åŒã€‚ å¦‚æœä¸æƒ³è¦å€‹åˆ¥å¼•å…¥å…ƒä»¶ï¼ŒNuxt ä¹Ÿæœ‰æä¾›å¾ˆä¾¿åˆ©çš„ä½œæ³•ï¼Œåªè¦åœ¨ nuxt.config.js æª”å…§è¨­å®šï¼š // nuxt.config.jsexport default { components: true} å°±æœƒå…¨å±€å¼•å…¥å…ƒä»¶ï¼Œä½¿ç”¨æ–¹å¼åªè¦éµå¾ªè³‡æ–™å¤¾çµæ§‹è¼¸å…¥å…ƒä»¶åç¨±å°±å¯ä»¥äº† ç¯„ä¾‹ï¼š å…ƒä»¶è·¯å¾‘ï¼šcomponents/home/Banner.vue ä½¿ç”¨å…ƒä»¶ï¼š&lt;HomeBanner&gt;&lt;/HomeBanner&gt; layoutså…±ç”¨æ¨¡æ¿ã€‚ å¤§å®¶é‚„è¨˜å¾—åœ¨ Vue å°ˆæ¡ˆä¸‹ï¼Œåªè¦åœ¨ App.vueï¼Œæˆ–æ˜¯åœ¨ router å»ºç«‹ä¸€å€‹å·¢ç‹€è·¯ç”±ï¼Œå¤–å±¤è¨­å®šå…±ç”¨å®¹å™¨ï¼Œå†å°‡åµŒå¥—è·¯ç”±æ”¾å…¥ childrenï¼Œå­è·¯ç”±å°±å¯ä»¥å…±äº«å¤–å±¤æ¨¡æ¿ export default [ { path: '/products', component: Product, children: [ { path: 'food', component: Food }, { path: 'drink', component: Drink } ] }] ä½†æ˜¯åœ¨ Nuxt æ¶æ§‹ä¸‹ï¼Œä¸¦ä¸å­˜åœ¨ App.vue é€™éš»æª”æ¡ˆï¼Œrouter ä¹Ÿæœƒè‡ªå‹•é…ç½®ï¼Œé‚£è©²æ€éº¼åšåˆ°æ¨¡æ¿å…±ç”¨å‘¢ï¼Ÿå…¶å¯¦å¾ˆç°¡å–®ï¼Œåªè¦åœ¨ layouts è³‡æ–™å¤¾å…§ï¼Œæ–°å¢ default.vue æª”ï¼Œé è¨­æ‰€æœ‰ pages å…§çš„æª”æ¡ˆéƒ½æœƒå…±äº«è©²ç‰ˆé¢ // default.vue&lt;template&gt; &lt;div class=\"default-wrap\"&gt; &lt;Navbar /&gt; &lt;Nuxt /&gt; &lt;Footer /&gt; &lt;/div&gt;&lt;/template&gt; &lt;Nuxt /&gt; é¡ä¼¼ Vue çš„ &lt;router-view /&gt; ï¼ˆåµŒå¥—è·¯ç”±ï¼‰ å¦‚æœæƒ³è¦æ–°å¢æ›´å¤šæ¨¡æ¿ï¼Œåªè¦åœ¨ layouts å…§æ–°å¢æª”æ¡ˆï¼Œä¾‹å¦‚ layouts/products.vueï¼Œåœ¨æ¬²ä½¿ç”¨çš„é é¢å¼•å…¥ï¼Œè©²é å°±å¯ä»¥è®€åˆ° layouts/products.vue æ¨¡æ¿ // pages/food.vueexport default { layout: 'products'} middlewareå‰é¢æœ‰èªªåˆ° Nuxt å°ˆæ¡ˆæœƒè‡ªå‹•ä¾ pages å…§çš„è³‡æ–™å¤¾çµæ§‹ç”¢ç”Ÿå°æ‡‰çš„éœæ…‹/å‹•æ…‹è·¯ç”±ï¼Œ ä½†å¦‚æœèªªæˆ‘å€‘æƒ³è¦ä½¿ç”¨ è·¯ç”±å®ˆè¡›(Navigation Guards) ä¾†é€²è¡Œè·¯ç”±ç›£è½ï¼Œåƒæ˜¯ Vue router å…§çš„ beforeEach callbackï¼Œè©²æ€éº¼åšå‘¢ï¼Ÿ Vue å°ˆæ¡ˆï¼š// pages/food.vueconst router = new VueRouter({ mode: 'history', routes});router.beforeEach(async (to, from, next) =&gt; { if (!store.permissions.includes(route.path)) { next({ statusCode: 403 }); } next();});export default router; Nuxt å°ˆæ¡ˆï¼šæˆ‘å€‘å¯ä»¥æ‰‹å‹•å»ºç«‹ä¸€å€‹ middleware è³‡æ–™å¤¾ï¼Œåœ¨è£¡é¢æ–°å¢è¦é€²è¡Œè·¯ç”±ç›£è½çš„æª”æ¡ˆ routeAuth.js // middleware/routeAuth.jsexport default ({ from, route, redirect, store, error }) =&gt; { if (!store.isLogin) { redirect('/login'); } if (!store.permissions.includes(route.path)) { error({ statusCode: 403 }); }}; ç„¶å¾Œåœ¨éœ€è¦é€²è¡Œç›£è½çš„æª”æ¡ˆåŠ å…¥ middleware // layouts/default.vueexport default { middleware: 'routeAuth', data() { return {}; }} æˆ–æ˜¯åœ¨ nuxt.config.js è¨­å®šå…¨åŸŸç›£è½ // nuxt.config.jsexport default { router: { middleware: [ 'routeAuth' ] }} mixinsmixins æä¾›å½ˆæ€§æ–¹å¼è®“é é¢å¯ä»¥é‡è¤‡ä½¿ç”¨æ–¹æ³•ï¼Œå¯ä»¥åŒ…å«ä»»ä½• Vue çµ„ä»¶é …ç›®(data, computed, watch, ç”Ÿå‘½é€±æœŸ)ï¼Œå°‡å…±ç”¨æ–¹æ³•åŒ…è£é€²å»ï¼Œé¦–å…ˆåœ¨ mixins æ–°å¢æª”æ¡ˆ mixins/utils.js // mixins/utils.jsexport default { data() { return { number: 0 }; } methods: { count() { this.number++; } }}; å…¨åŸŸè¨»å†Šï¼šå…¨åŸŸå®£å‘Š mixin å‹™å¿…å°å¿ƒä½¿ç”¨ï¼Œå› ç‚ºæœƒå½±éŸ¿åˆ°æ‰€æœ‰ Vue æª”(pages, components) åœ¨ mixins æ–°å¢ä¸€æ”¯æª”æ¡ˆ global-mixins.jsï¼Œå°‡æ¬²å…¨åŸŸè¨»å†Šçš„æª”æ¡ˆåŠ å…¥ Vue å¯¦ä¾‹ // mixins/global-mixins.jsimport Vue from 'vue';import utils from '@/mixins/utils';// é¿å…é‡è¤‡è¨»å†Šif (!Vue.__utils_mixin__) { Vue.__utils_mixin__ = true; Vue.mixin(utils);} æ¥è‘—åŠ å…¥ nuxt.config.js å…§ // nuxt.config.jsexport default { plugins:[ { src: '@/mixins/global-mixins' } ]} å±€éƒ¨è¨»å†Šï¼šå±€éƒ¨è¨»å†Šå¾ˆç°¡å–®ï¼Œåªè¦åœ¨æ¬²ä½¿ç”¨æª”æ¡ˆå¼•å…¥å³å¯ï¼Œé€™è£¡å‡è¨­åœ¨ pages/about.vue // pages/about.vueimport utils from '@/mixins/utils';export default { name: 'About', mixins:[ utils ]} é€™æ¨£åœ¨ About é é¢å°±å¯ä»¥å–å¾—åƒæ•¸ number çš„å€¼è·Ÿå‘¼å« count() æ–¹æ³•å›‰ï¼ pagesä¸»è¦çš„é é¢æª”æ¡ˆï¼ŒNuxt å°ˆæ¡ˆæœƒè‡ªå‹•ä¾ç…§ pages å…§çš„è³‡æ–™å¤¾çµæ§‹é…ç½®è·¯ç”±ï¼Œ æ›å¥è©±èªªï¼Œå°±ä¸éœ€è¦åƒ Vue å°ˆæ¡ˆä¸€æ¨£éœ€è¦è‡ªè¡Œè¨­å®š vue-routerï¼Œç‚ºå°å¯«å‘½åï¼ˆå‘½åæœƒç›´æ¥æ˜¯è·¯å¾‘åç¨±ï¼‰ï¼Œæ¯å€‹ .vue æª”éƒ½æ˜¯å·²ç¶“è¢«è¨»å†Šçš„é é¢ ä»¥é¦–é ç‚ºä¾‹ï¼špages/index.vue â†’ http://localhost:3000 å·¢ç‹€è·¯ç”±ï¼š ç›´æ¥èˆ‰ä¾‹ï¼Œå…ˆå»ºç«‹ä¸€æ”¯æª”æ¡ˆ pages/about.vue // pages/about/index.vue&lt;template&gt; &lt;div&gt; aboutï¼š &lt;nuxt-child /&gt; &lt;/div&gt;&lt;/template&gt; æ¥åœ¨ about è³‡æ–™å¤¾æ–°å¢å…©éš»æª”æ¡ˆï¼Œå¯å–å¾—é…ç½®çš„å·¢ç‹€è·¯å¾‘å¦‚ä¸‹ pages/about/index.vue â†’ http://localhost:3000/about pages/about/claire.vue â†’ http://localhost:3000/about/claire å‹•æ…‹è·¯ç”±ï¼š å¦‚æœæƒ³è¦é¡¯ç¤ºå‹•æ…‹è·¯ç”±ï¼Œåªè¦åœ¨æª”åå‰åŠ ä¸Šä¸‹åº•ç·šå°±å¯ä»¥äº†ï¼š pages/about/ _name.vue â†’ http://localhost:3000/about/claire é€™æ¨£å°±å¯ä»¥åœ¨æª”æ¡ˆå…§å–å¾—å‹•æ…‹è·¯ç”±åƒæ•¸ // pages/about/_name.vueexport default { created () { console.log(this.$route.params.name); }} pluginsNuxt æ’ä»¶ï¼Œæ–¼ Vue.js åŸ·è¡Œå‰å¼•å…¥ç¬¬ä¸‰æ–¹å¥—ä»¶ï¼Œä»¥ vue-notification ç‚ºä¾‹ é¦–å…ˆä½¿ç”¨ npm å®‰è£ npm i vue-notification ç„¶å¾Œåœ¨ plugins è³‡æ–™å¤¾æ–°å¢ notification.js æª” // plugins/notification.jsimport Vue from 'vue';import Notifications from 'vue-notification';Vue.use(Notifications); åœ¨ nuxt.config.js é…ç½® plugins // nuxt.config.jsexport default { plugins: [ { src: '@/plugins/notification.js' } ]} å°±å¯ä»¥åœ¨æ‰€æœ‰é é¢ä¸­ä½¿ç”¨è©²å¥—ä»¶ &lt;Notifications&gt;&lt;/Notifications&gt; staticéœæ…‹è³‡æºè³‡æ–™å¤¾ï¼Œç”¨ä¾†å­˜æ”¾ä¸éœ€è¦è¢«ç·¨è­¯çš„æª”æ¡ˆï¼Œåƒæ˜¯åœ–ç‰‡æª”ï¼Œæˆ–æ˜¯å¯ä»¥ä¾›ä½¿ç”¨è€…ä¸‹è¼‰çš„ç¯„ä¾‹æª”ç­‰ï¼Œå¦‚éœ€è¢«ç·¨è­¯ï¼Œå‰‡å­˜æ”¾æ–¼ assetsã€‚ storeæ”¾ç½® Vuex ç‹€æ…‹ç®¡ç†å·¥å…·ï¼Œç”¨ä¾†å­˜æ”¾å…¨åŸŸå…±ç”¨çš„æ–¹æ³•ã€è³‡æ–™ï¼Œä½¿ç”¨æ–¹å¼èˆ‡ Vue å¤§è‡´ç›¸åŒï¼ŒVuex åœ¨ä½¿ç”¨æ™‚æœƒç¢°åˆ°ä¸€å€‹å•é¡Œï¼Œç•¶é é¢é‡æ–°æ•´ç†ï¼Œå…¶æœƒè¢«é‚„åŸç‚ºåˆå§‹ç‹€æ…‹ï¼Œè‡³æ–¼è¦æ€éº¼è§£æ±ºé€™å€‹å•é¡Œï¼Œå¾ŒçºŒæœƒå–®ç¨ä»‹ç´¹ã€‚ åƒè€ƒæ–‡ç« ï¼š https://israynotarray.com/vue/20211011/3406447097/ https://dev.to/husteadrobert/how-to-use-global-navigation-guards-with-nuxt-middleware-and-why-you-absolutely-should-not-7bl https://ithelp.ithome.com.tw/articles/10207822 https://medium.com/@seyijosh44/how-to-use-mixins-in-nuxt-js-826724fa251","link":"/2022/11/17/nuxt/nuxt-catalog/"},{"title":"Nuxt.js å¥—ä»¶æ‡‰ç”¨ï¼šCKEditor 5 æ–‡å­—ç·¨è¼¯å™¨","text":"ç‰ˆæœ¬ï¼šnuxt 2.15.8ckeditor: 38.0.1 CKEditor æ˜¯ä¸€å¥—æ­·å²æ‚ ä¹…ä¸”åŠŸèƒ½å®Œæ•´ã€è¼•é‡çš„å¯Œæ–‡æœ¬ç·¨è¼¯å™¨ï¼ˆrich text editorï¼‰ï¼Œç‚ºä½¿ç”¨è€…æä¾›æ‰€è¦‹å³æ‰€å¾—ï¼ˆWYSIWYGï¼‰çš„ç·¨è¼¯å€åŸŸï¼ŒCKEditor 5 èˆ‡èˆŠç‰ˆä¸åŒï¼Œä½¿ç”¨ MVC æ¶æ§‹ã€ES6 ç·¨å¯«ã€UI ç°¡æ½”ï¼Œä¸”å› æ‡‰ç¾åœ¨çš„å‰å¾Œç«¯åˆ†é›¢è¶¨å‹¢ï¼Œèˆ‡å‰ç«¯æ¡†æ¶ Reactã€Angularã€and Vue.js åšæ•´åˆï¼Œè®“æˆ‘å€‘å¯ä»¥æ›´ä¾¿åˆ©çš„é–‹ç™¼æ‡‰ç”¨ã€‚ é‚£éº¼æˆ‘å€‘å°±é–‹å§‹åœ¨ Nuxt å°ˆæ¡ˆä½¿ç”¨ CKEditor 5 å§ï¼Œé¦–å…ˆé¸æ“‡ç·¨è¼¯å™¨é¡å‹ï¼ˆé€™è£¡ä½¿ç”¨ Classic editorï¼‰ï¼Œå¯ä»¥é€éå…©ç¨®æ–¹å¼å®‰è£ï¼š Adding a plugin to a buildå¦‚æœæˆ‘å€‘æƒ³è¦ç›´æ¥ä½¿ç”¨ Classic editor é…ç½®å¥½çš„åŠŸèƒ½ï¼Œä¸éœ€é¡å¤–æ“´å……ï¼Œæ­¤æ–¹æ³•å¯ä»¥å¿«é€Ÿç°¡æ˜“çš„å»ºç½®ï¼Œé¦–å…ˆå®‰è£å¥—ä»¶ï¼š npm install --save \\ @ckeditor/ckeditor5-vue2 \\ @ckeditor/ckeditor5-build-classic æ¥è‘—åœ¨å…ƒä»¶å…§åŠ å…¥ç·¨è¼¯å™¨ &lt;template&gt; &lt;div&gt; &lt;ckeditor :editor=\"editor\" v-model=\"editorData\"&gt;&lt;/ckeditor&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;import CKEditor from '@ckeditor/ckeditor5-vue2';import ClassicEditor from '@ckeditor/ckeditor5-build-classic';export default { name: 'Editor', components: { ckeditor: CKEditor.component }, data() { return { editor: ClassicEditor, editorData: '&lt;div&gt;Hello World!&lt;/div&gt;' }; }};&lt;/script&gt; é€™æ¨£å°±å®Œæˆäº†ï¼Œæ˜¯ä¸æ˜¯å¾ˆç°¡å–®å‘¢ï¼ ä½†å¦‚æœæˆ‘å€‘æƒ³æ“´å……åŠŸèƒ½ï¼Œåƒæ˜¯æ–°å¢ä¸‹åº•ç·š @ckeditor/ckeditor5-basic-styles/src/underlineï¼Œå°ˆæ¡ˆæœƒç›´æ¥å ±éŒ¯ï¼š Uncaught CKEditorError: ckeditor-duplicated-modules åŸå› æ˜¯ @ckeditor/ckeditor5-build-classic ç‚ºåŒ…è£å¥½çš„å…§å®¹ï¼Œè©¦è‘—é€²åˆ° node_modules/@ckeditor/ckeditor5-build-classic/package.json å¯ä»¥çœ‹åˆ°ç›¸ä¾å¥—ä»¶å·²ç¶“å®‰è£é€²å»ï¼š å› æ­¤ CKeditor åœ¨åˆå§‹åŒ–æ™‚æœƒå› ç‚ºæ¨¡çµ„é‡è¤‡åŸ·è¡Œå°è‡´éŒ¯èª¤ï¼Œå¯ä»¥æ”¹ç”¨ä»¥ä¸‹æ–¹æ³• Adding a plugin to an editorå®¢è£½åŒ–é…ç½®æ‰€æœ‰åŠŸèƒ½ï¼Œæ­¥é©Ÿç›¸å°è¤‡é›œï¼Œé¦–å…ˆå®‰è£åŸºæœ¬å¥—ä»¶ï¼š npm install --save \\ @ckeditor/ckeditor5-vue2 \\ @ckeditor/ckeditor5-editor-classic \\ @ckeditor/ckeditor5-dev-webpack-plugin \\ @ckeditor/ckeditor5-dev-utils \\ @ckeditor/ckeditor5-theme-lark \\ postcss@8 \\ postcss-loader@4 \\ raw-loader@4 é‡é»æ­¥é©Ÿï¼šéœ€æ‰‹å‹•è¨­å®š webpackï¼Œé€™ä¸€æ­¥æ¼æ‰æœƒç›´æ¥å ±éŒ¯ // nuxt.config.jsconst path = require('path');const CKEditorWebpackPlugin = require('@ckeditor/ckeditor5-dev-webpack-plugin');const { styles } = require('@ckeditor/ckeditor5-dev-utils');export default { build: { transpile: [ /ckeditor5-[^/\\\\]+[/\\\\]src[/\\\\].+\\.js$/ ], plugins: [ // Only with ssr: false new CKEditorWebpackPlugin({ // See https://ckeditor.com/docs/ckeditor5/latest/features/ui-language.html language: 'zh', additionalLanguages: 'all', addMainLanguageTranslationsToAllAssets: true }) ], // If you don't add postcss, the CKEditor css will not work. postcss: { postcssOptions: styles.getPostCssConfig({ themeImporter: { themePath: require.resolve('@ckeditor/ckeditor5-theme-lark') }, minify: true }) }, extend(config) { // If you do not exclude and use raw-loader to load svg, the following errors will be caused. // Cannot read property 'getAttribute' of null const svgRule = config.module.rules.find(item =&gt; { return /svg/.test(item.test); }); svgRule.exclude = [ path.join(__dirname, 'node_modules', '@ckeditor') ]; // add svg to load raw-loader config.module.rules.push({ test: /ckeditor5-[^/\\\\]+[/\\\\]theme[/\\\\]icons[/\\\\][^/\\\\]+\\.svg$/, use: [ 'raw-loader' ] }); } }} webpack è¨­å®šèªªæ˜ï¼š èªè¨€è¨­å®šï¼šé€™è£¡è¨­ç‚ºç¹é«”ä¸­æ–‡ï¼ˆâ€™zhâ€™ï¼‰ å¿…é ˆåœ¨ ssr: false æ¢ä»¶ä¸‹æ‰èƒ½é‹ä½œï¼Œå¦å‰‡æœƒå ±éŒ¯èª¤ window is not definedï¼Œè·Ÿ [CKEditorWebpackPlugin] Error: No translation has been found for the XX language æ’é™¤ @ckeditor svgï¼Œä¸¦ä½¿ç”¨ raw-loader è®€å– svg å…§å®¹ï¼Œå¦å‰‡æœƒæ‹‹ cannot read property â€˜getAttributeâ€™ of null éŒ¯èª¤ ä½¿ç”¨ PostCSS è½‰æ› css ä»£ç¢¼ï¼Œå¦å‰‡æœƒ css æ¨£å¼æœƒè®€å–ä¸åˆ° æ¥è‘—ä¾†è©¦è‘—å®‰è£ç·¨è¼¯å™¨åŠŸèƒ½ï¼Œç¯„ä¾‹å®‰è£ åŸºæœ¬æ¨£å¼ / å­—ç´š / å­—é«”ï¼š npm install --save \\ @ckeditor/ckeditor5-essentials \\ @ckeditor/ckeditor5-font \\ @ckeditor/ckeditor5-paragraph \\ æ‰€æœ‰ ckeditor å¥—ä»¶ç‰ˆæœ¬å¿…é ˆç›¸åŒï¼Œå¦å‰‡æœƒç™¼ç”ŸéŒ¯èª¤ï¼ˆ@ckeditor/ckeditor5-dev-* è·Ÿ @ckeditor/ckeditor5-vue2 é™¤å¤–ï¼‰ åŸºç¤è¨­å®šä»‹ç´¹ï¼š placeholderï¼šç·¨è¼¯å™¨ä½”ä½ç¬¦ pluginsï¼šç·¨è¼¯å™¨æ‡‰ç”¨åŠŸèƒ½ toolbarï¼šå·¥å…·åˆ—é…ç½®ï¼Œä¹Ÿå¯ä»¥åŠ å…¥åˆ†éš”ç¬¦è™Ÿ | å…¶ä»–ï¼šå„åŠŸèƒ½çš„ç›¸é—œè¨­å®šè«‹è¦‹å®˜æ–¹æ–‡ä»¶ &lt;template&gt; &lt;div&gt; &lt;ckeditor :editor=\"editor\" :config=\"editorConfig\" v-model=\"editorData\"&gt;&lt;/ckeditor&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;import CKEditor from '@ckeditor/ckeditor5-vue2';import ClassicEditor from '@ckeditor/ckeditor5-editor-classic/src/classiceditor';import Essentials from '@ckeditor/ckeditor5-essentials/src/essentials';import FontFamily from '@ckeditor/ckeditor5-font/src/fontfamily';import FontSize from '@ckeditor/ckeditor5-font/src/fontsize';import Paragraph from '@ckeditor/ckeditor5-paragraph/src/paragraph';export default { name: 'Editor', components: { ckeditor: CKEditor.component }, data() { return { editor: ClassicEditor, editorData: '', editorConfig: { placeholder: 'è«‹è¼¸å…¥å…§å®¹', plugins: [ Essentials, FontFamily, FontSize, Paragraph ], toolbar: { items: [ 'fontSize', 'fontFamily', '|' ], shouldNotGroupWhenFull: true }, fontSize: { options: [ 12, 16, 18, 20, 24, 32, 40, 48 ], supportAllValues: true } } }; }};&lt;/script&gt; é€™æ¨£å°±å¯ä»¥æˆåŠŸçœ‹åˆ°ç•«é¢å›‰ ğŸ™Œ æ˜¯å¦è¦ºå¾—åŠŸèƒ½å®‰è£è·Ÿé…ç½®æœ‰é»éº»ç…©å‘¢ï¼Ÿå®˜æ–¹è²¼å¿ƒçš„æä¾› online-builder ï¼Œå¯ä»¥å…ˆæŒ‘é¸åŠŸèƒ½ä¸¦é…ç½®å¥½ toolbarï¼Œç¢ºèªç•«é¢å¾Œå†å®‰è£ å…¨åŸŸè¨»å†Šç•¶å°ˆæ¡ˆæœ‰å¾ˆå¤šåœ°æ–¹æœƒä½¿ç”¨åˆ°ç·¨è¼¯å™¨ï¼Œæˆ‘å€‘ä¹Ÿå¯ä»¥å…¨åŸŸå¼•å…¥ æ–°å¢æª”æ¡ˆç½®æ–¼ pluginsï¼Œé€™è£¡å‘½å ckeditor.js // plugins/ckeditor.jsimport Vue from 'vue';import CKEditor from '@ckeditor/ckeditor5-vue2';Vue.use(CKEditor); nuxt.config.js é…ç½® // nuxt.config.jsexport default { plugins: [ { src: '@/plugins/ckeditor' } ] } CSS styleå¯¦å‹™æ‡‰ç”¨ä¸Šæœƒåœ¨å¾Œå°ä½¿ç”¨ç·¨è¼¯å™¨ä¾†è¨­è¨ˆå…§å®¹ï¼Œç„¶å¾Œå°‡ HTML å…§å®¹å„²å­˜åˆ°è³‡æ–™åº«ï¼Œæ–¼å‰å°å–å›è³‡æ–™ä¸¦æ¸²æŸ“åœ¨ç•«é¢ä¸Šï¼Œæ‰€ä»¥æœƒéœ€è¦é…ç½®ç›¸é—œçš„ CSSï¼Œç¢ºä¿å‰å¾Œå°æ¨£å¼ä¸€è‡´ã€‚ åªè¦è¤‡è£½ Content styles åœ¨å°ˆæ¡ˆå…§ï¼Œç„¶å¾Œåœ¨ç·¨è¼¯å™¨å…§å®¹çš„å¤–å±¤å®¹å™¨åŠ ä¸Š ck-content CSS class å°±å¯ä»¥å›‰ï¼Œç¯„ä¾‹å¦‚ä¸‹ï¼š &lt;template&gt; &lt;div class=\"ck-content\"&gt; // ç·¨è¼¯å™¨å…§å®¹ &lt;div v-html=\"content\"&gt;&lt;/div&gt; &lt;/div&gt;&lt;/template&gt; åƒè€ƒæ–‡ç« ï¼š https://github.com/changemyminds/nuxtjs-integrate-ckeditor5?ref=vuejsexamples.comhttps://ithelp.ithome.com.tw/articles/10198816https://medium.com/@charming_rust_oyster_221/ckeditor-5-æ–‡å­—ç·¨è¼¯å™¨-ç ”ç©¶å¿ƒå¾—-519c97f20a4https://ckeditor.com/docs/ckeditor5/latest/installation/frameworks/vuejs-v2.html","link":"/2022/12/01/nuxt/nuxt-ckeditor5/"},{"title":"Nuxt.js nuxt.config.js è¨­å®šæª”","text":"ç‰ˆæœ¬ï¼šnuxt 2.15.8 å…¨åç‚º Nuxt configuration fileï¼ŒåŠŸèƒ½åŒ Vue å°ˆæ¡ˆå…§ vue.config.js æª”ï¼Œå¦‚æœæˆ‘å€‘ä½¿ç”¨ create-nuxt-app ä¾†å»ºç½®å°ˆæ¡ˆï¼Œæœƒè‡ªå‹•ç”¢ç”Ÿé€™æ”¯æª”æ¡ˆï¼Œåœ¨æ­¤é…ç½®çš„å…§å®¹ï¼Œæœƒå…¨åŸŸè®€å–è¨­å®šã€‚ æ¥ä¸‹ä¾†ä»‹ç´¹ä¸€ä¸‹ä¸€äº›å¸¸ç”¨çš„è¨­å®šï¼š aliasè·¯å¾‘åˆ¥åï¼Œå¤§å®¶é‚„è¨˜å¾—åœ¨ Vue å°ˆæ¡ˆå…§ï¼Œå¦‚æœæ²’æœ‰è¨­å®šè·¯å¾‘åˆ¥åï¼Œå‰‡éœ€è¦å¯«ç›¸å°è·¯å¾‘ï¼ˆä¾‹å¦‚ï¼š../components/Navbar.vueï¼‰ï¼Œå°æ–¼ç¶­è­·å’Œé–‹ç™¼éƒ½å¾ˆä¸æ–¹ä¾¿ï¼Œä¸€äº›ç¨‹å¼ç¢¼æª¢æ ¸å·¥å…·ï¼Œç”šè‡³æœƒè¦–ç‚º bad smellï¼Œå› æ­¤æˆ‘å€‘æœƒåœ¨ vue.config.js æª”å…§çµ±ä¸€è¨­å®šè·¯å¾‘åˆ¥åã€‚ Nuxt å°ˆæ¡ˆå¾ˆè²¼å¿ƒçš„è‡ªå‹•é…ç½®äº†è·¯å¾‘åˆ¥åï¼Œé è¨­å€¼å¦‚ä¸‹ { '~~': `&lt;rootDir&gt;`, '@@': `&lt;rootDir&gt;`, '~': `&lt;srcDir&gt;`, '@': `&lt;srcDir&gt;`, 'assets': `&lt;srcDir&gt;/assets`, // (unless you have set a custom `dir.assets`) 'static': `&lt;srcDir&gt;/static`, // (unless you have set a custom `dir.static`)} å› æ­¤åœ¨å¼•å…¥å…ƒä»¶ Navbar æ™‚å¯ä»¥å¯«æˆ @/components/Navbar.vue å¦‚æœéœ€è¦æ›´æ”¹é…ç½®ä¹Ÿå¯ä»¥ import { resolve } from 'path';export default { alias: { 'images': resolve(__dirname, './assets/images'), '@static': resolve(__dirname, './static') }} ssrserver side renderï¼Œé è¨­ç‚º trueï¼Œå¦‚æœä¸éœ€ SEOï¼Œåªè¦ spa æ“ä½œï¼Œè¨­å®š ssr: false å³å¯ èˆŠç‰ˆæœƒä½¿ç”¨ mode: 'spa' ä¾†é€²è¡Œè¨­å®šï¼Œä½†å®˜æ–¹æ–‡ä»¶æœ‰èªªæ˜ v2.14.5 ç‰ˆæœ¬é–‹å§‹å·²æ£„ç”¨ï¼Œæ”¹ç”¨ ssr: false export default { ssr: false // spa} serverç”¨ä¾†è¨­å®š portï¼ˆé è¨­ 3000ï¼‰ è·Ÿ hostï¼ˆé è¨­ localhostï¼‰ export default { server: { port: 8000, host: 'my-website' }} routeré…ç½® Nuxt è·¯ç”±ï¼ˆvue-routerï¼‰ï¼Œé€™è£¡ä»¥è¨­å®š base url èˆ‰ä¾‹ï¼Œå…¶ä»–è«‹åƒè€ƒå®˜æ–¹æ–‡ä»¶ export default { router: { base: '/backoffice/' }} headåœ¨ Vue å°ˆæ¡ˆï¼Œæˆ‘å€‘è¦è¨­å®š head å…§å®¹ï¼Œåªè¦åœ¨ public/index.html æª”è¨­å®šå°±å¥½äº†ï¼Œä½† Nuxt å°ˆæ¡ˆåˆè©²æ€éº¼è¨­å®šå‘¢ï¼Ÿ å…¨åŸŸè¨­å®šåœ¨ nuxt.config.js æª” head å…§å³å¯å…¨åŸŸè¨­å®šï¼Œé€šå¸¸åœ¨å»ºç«‹å°ˆæ¡ˆæœƒé å…ˆå¸¶å…¥ export default { head: { title: 'test', htmlAttrs: { lang: 'en' }, meta: [ { charset: 'utf-8' }, { name: 'viewport', content: 'width=device-width, initial-scale=1' }, { hid: 'description', name: 'description', content: '' }, { name: 'format-detection', content: 'telephone=no' } ], link: [ { rel: 'icon', type: 'image/x-icon', href: '/favicon.ico' } ] }} é€™æ¨£æ‰€æœ‰é é¢éƒ½å¯ä»¥è®€åˆ° head è¨­å®š å–®é è¨­å®šNuxt å°ˆæ¡ˆå¾ˆé‡è¦çš„ä¸€é»æ˜¯ SEO æ•ˆèƒ½å„ªåŒ–ï¼ŒåŸºæ–¼é€™é»ï¼Œé€šå¸¸æœƒéœ€è¦ä¾ç…§å„é è¨­å®šè‡ªå·±çš„ SEOï¼Œä¾‹å¦‚pages/about.vue é é¢çš„ title å’Œ description è¦å–®ç¨è¨­å®šï¼Œæ–¹æ³•ä¹Ÿå¾ˆç°¡å–® export default { head: { title: 'é—œæ–¼æˆ‘å€‘', meta: [ { hid: 'description', name: 'description', content: 'é€™æ˜¯é—œæ–¼æˆ‘å€‘é é¢' } ] }} åœ¨å„é é¢è¨­å®šçš„å…§å®¹å„ªå…ˆåº¦è¼ƒé«˜ï¼Œæœƒè¦†å¯«å…¨åŸŸè¨­å®šçš„ head å…§å®¹ï¼Œå› æ­¤ç•¶æˆ‘å€‘é–‹å•Ÿ about é é¢ï¼Œæœƒçœ‹åˆ° title è®Šæˆ é—œæ–¼æˆ‘å€‘ã€description è®Šæˆ é€™æ˜¯é—œæ–¼æˆ‘å€‘é é¢ï¼Œå…¶ä»–é…ç½®å‰‡ä¾ç…§ nuxt.config.js æª” csså¼•å…¥å…¨åŸŸä½¿ç”¨çš„ css æª”ï¼Œåƒæ˜¯å¤–éƒ¨å¥—ä»¶ï¼Œæˆ–æ˜¯è‡ªè¨‚æª”ï¼Œå¦‚æœè¦ä½¿ç”¨ sassï¼Œå¿…é ˆå®‰è£ sass-loader npm install --save-dev sass sass-loader export default { css: [ // å¤–éƒ¨å¥—ä»¶ { src: 'bootstrap-icons/font/bootstrap-icons.css' }, // scss æª” { src: '@/assets/scss/app.scss', lang: 'scss' } ]} pluginså…¨å±€å¼•å…¥å¤–éƒ¨å¥—ä»¶ï¼Œä»¥ vue-notification èˆ‰ä¾‹ï¼Œåœ¨ plugins æ–°å¢ notification.js æª” // plugins/notification.jsimport Vue from 'vue';import Notifications from 'vue-notification';Vue.use(Notifications); åœ¨ nuxt.config.js é…ç½® plugins export default { plugins: [ { src: '@/plugins/notification.js' } ]} å°±å¯ä»¥åœ¨æ‰€æœ‰é é¢ä¸­ä½¿ç”¨è©²å¥—ä»¶ &lt;Notifications&gt;&lt;/Notifications&gt; componentså¦‚è¨­å®šç‚º trueï¼Œæœƒå…¨å±€å¼•å…¥å…ƒä»¶ï¼Œä½¿ç”¨æ–¹å¼åªè¦éµå¾ªè³‡æ–™å¤¾çµæ§‹è¼¸å…¥å…ƒä»¶åç¨±å°±å¯ä»¥äº† export default { components: true} ç¯„ä¾‹ï¼š å…ƒä»¶è·¯å¾‘ï¼šcomponents/home/Banner.vue ä½¿ç”¨å…ƒä»¶ï¼š&lt;HomeBanner&gt;&lt;/HomeBanner&gt; buildModulesç”¨ä¾†é…ç½®åªåœ¨é–‹ç™¼ç’°å¢ƒä½¿ç”¨çš„æ¨¡çµ„ï¼Œè¨»å†Šåœ¨æ­¤å¯ä»¥è®“å°ˆæ¡ˆåœ¨ç”Ÿç”¢ç’°å¢ƒéƒ¨ç½²é€Ÿåº¦æå‡ï¼Œä¸¦æ¸›å°‘ node_modules å®¹é‡ï¼Œè©³æƒ…å¯ä»¥åƒè€ƒå„å¥—ä»¶çš„é…ç½®å»ºè­° @nuxtjs/eslint-module å¥—ä»¶å®˜æ–¹å»ºè­°é…ç½®æ–¼ buildModules export default { buildModules: [ '@nuxtjs/eslint-module' ]} ä½¿ç”¨æ¢ä»¶ï¼šNuxt ç‰ˆæœ¬å¿…é ˆå¤§æ–¼ v2.9 modulesç”¨ä¾†é…ç½®é–‹ç™¼ç’°å¢ƒèˆ‡ç”Ÿç”¢ç’°å¢ƒå…±ç”¨æ¨¡çµ„ï¼ŒbuildModules åŠ modules é…ç½®ä½ç½®è©³è«‹åƒè€ƒå„å¥—ä»¶å»ºè­° export default { modules: [ '@nuxtjs/style-resources' ]} styleResourcesç”¨ä¾†æ³¨å…¥å…¨åŸŸå…±ç”¨ sass, scssï¼Œå¦‚æœä¸å¼•å…¥ï¼Œåœ¨å„é é¢ï¼ˆ.vueï¼‰å…§çš„ style æœƒç„¡æ³•ä½¿ç”¨åƒæ˜¯ mixin ç­‰çš„å¸¸ç”¨è®Šæ•¸ï¼Œæˆ–æ˜¯è¦åœ¨å„é é¢å–®ç¨ @import scss æª” é¦–å…ˆå¿…é ˆå¦å¤–å®‰è£ @nuxtjs/style-resources å¥—ä»¶ åŸ·è¡Œï¼šnpm i @nuxtjs/style-resources åœ¨ nuxt.config.js æª”è¨­å®š export default { modules: [ '@nuxtjs/style-resources' ], styleResources: { scss: [ '@/assets/scss/components/_color.scss', '@/assets/scss/components/_mixin.scss' ] }} é€™æ¨£å°±å¯ä»¥é”åˆ°è®Šæ•¸å…±ç”¨äº† å®˜æ–¹æ–‡ä»¶ æåˆ°ï¼Œè«‹å‹¿å¼•å…¥å¯¦éš›çš„ css æ¨£å¼ï¼Œå› ç‚ºæ¯å€‹é é¢è·Ÿå…ƒä»¶éƒ½æœƒé‡è¤‡ç·¨è­¯ï¼Œé€ æˆç³»çµ±æ¥µå¤§è² æ“”ï¼ˆç­†è€…è¸©å‘éOQï¼‰ï¼Œå»ºè­°åªæ³¨å…¥è®Šæ•¸, mixinsï¼Œå› ç‚ºé€™äº›å€¼åœ¨ç·¨è­¯å¾Œå°±æœƒæ¶ˆå¤±äº†ã€‚ buildå®¢è£½åŒ– webpack è¨­å®šï¼Œé€™è£¡èˆ‰ä¾‹ï¼Œåœ¨é–‹ç™¼æ™‚ï¼Œç™¼ç¾åœ¨ Vue æ¨£æ¿ç„¡æ³•ä½¿ç”¨å¯é¸ä¸²é€£ Optional Chainingï¼ˆes2020èªæ³•ï¼‰ï¼Œç ”ç©¶å¾Œç™¼ç¾å¿…é ˆéœ€å®‰è£æ“´å……å¥—ä»¶ npm install vue-template-babel-compiler --save-dev æ¥è‘—åœ¨ nuxt.config.js æª”è¨­å®šï¼Œå°±å¯ä»¥æˆåŠŸä½¿ç”¨å›‰ export default { build: { loaders: { vue: { compiler: require('vue-template-babel-compiler') } } }} LoadingLoading æ•ˆæœï¼ŒåŸºç¤è¨­å®šå¦‚ä¸‹ï¼ˆåƒæ•¸é¸é …ï¼‰ export default { loading: { color: 'black', height: '5px', continuous: true }} å¦‚æœæƒ³è‡ªè¨‚æ›´å¤šæ¨£å¼ï¼Œä¹Ÿå¯ä»¥åŒ…è£æˆå…ƒä»¶å¾Œå¼•å…¥ export default { loading: '@/components/TheLoading.vue'} envç”¨ä¾†å®šç¾©å…¨å±€å…±ç”¨çš„ç’°å¢ƒè®Šæ•¸ï¼ŒNuxt å°ˆæ¡ˆé è¨­åªæœ‰ nuxt.config.js æª”å…§å¯ä»¥è®€å–ç’°å¢ƒè®Šæ•¸ï¼Œ å› æ­¤å¦‚æœè¦è®“ .vue æª”æˆ–æ˜¯ .js æª”è®€åˆ°è®Šæ•¸ï¼Œé€™è£¡æä¾›ä»¥ä¸‹å…©å€‹åšæ³•ï¼š æ–¹æ³•ä¸€ï¼šç›´æ¥åœ¨ nuxt.config.js æª”å…§é…ç½®å±¬æ€§export default { env: { BASE_URL: process.env.BASE_URL }} ä½†æœ‰æ™‚è®Šæ•¸å¤šï¼Œä¸æƒ³å„åˆ¥é…ç½®ï¼Œå¯ä»¥æ¡ç”¨æ–¹æ³•äºŒ æ–¹æ³•äºŒï¼šå®‰è£å¥—ä»¶ @nuxtjs/dotenvåŸ·è¡Œï¼šnpm i @nuxtjs/dotenvï¼Œåœ¨ modules å…§è¨­å®šï¼š export default { modules: [ '@nuxtjs/dotenv' ]} é€™æ¨£å°±å¯ä»¥å…¨åŸŸä½¿ç”¨ .env è®Šæ•¸å›‰ã€‚ å°ˆæ¡ˆå¦‚æœæœ‰å€åˆ†é–‹ç™¼è·Ÿç”Ÿç”¢ç’°å¢ƒ .env æª”ï¼Œä¹Ÿå¯ä»¥è¨­å®šå¦‚ä¸‹ï¼š export default { modules: [ [ '@nuxtjs/dotenv', { filename: `.env.${process.env.ENV}` } ] ]} ä½¿ç”¨æ–¹æ³•äºŒéœ€æ³¨æ„ï¼Œè®Šæ•¸å¦‚æœå…§å«è®Šæ•¸ï¼Œæœƒè®€å–ä¸åˆ°ç¬¬äºŒå±¤çš„è®Šæ•¸ï¼ˆé¥’å£ï¼‰ï¼Œç›´æ¥æä¾›ç¯„ä¾‹ï¼Œå‡è¨­åœ¨ .env æª”å…§æœ‰å…©å€‹è®Šæ•¸BASE_DOMAIN=my-websitesBASE_URL=\"http://${BASE_DOMAIN}\"åœ¨ .vue æª”ç›´æ¥ä½¿ç”¨ process.env.BASE_URLï¼Œå–å¾—å€¼ç‚º http://${BASE_DOMAIN}ï¼Œç„¡æ³•è§£ææˆ http://my-websitesï¼Œæ­¤æƒ…æ³é‚„æ˜¯éœ€æ­é…æ–¹æ³•ä¸€ä½¿ç”¨ åƒè€ƒæ–‡ç« ï¼š https://ithelp.ithome.com.tw/articles/10207330 https://nuxtjs.org/docs/configuration-glossary https://hackmd.io/@xq/nuxt-config","link":"/2022/11/19/nuxt/nuxt-config-setting/"},{"title":"Nuxt.js è¨­å®š GA & GTM","text":"ç‰ˆæœ¬ï¼šnuxt 2.15.8 ç¶²ç«™ä¸Šç·šå¾Œï¼Œæˆ‘å€‘æœƒéœ€è¦ Google Analytics å’Œ Google Tag Manager å·¥å…·ä¾†è¿½è¹¤åˆ†æç¶²ç«™æµé‡ï¼Œæ¥ä¸‹ä¾†èªªæ˜å¦‚ä½•åœ¨ Nuxt.js å°ˆæ¡ˆå…§åŠ å…¥è¿½è¹¤ç¢¼ã€‚ Google Analyticsç”³è«‹ä»£ç¢¼ï¼š è‡³ Google Analytics åˆ†æï¼Œä½¿ç”¨ google å¸³æˆ¶ç™»å…¥ï¼Œé»é¸å·¦ä¸‹è§’çš„ç®¡ç† é¸æ“‡å»ºç«‹è³‡æº è¨­å®šè³‡æºåç¨±ï¼Œé¸é …å‹¾é¸å¾Œï¼Œé»é¸å»ºç«‹ é¸æ“‡è³‡æ–™ä¸²æµå¹³å°ï¼šç¶²ç«™ è¨­å®šç¶²ç«™ç¶²å€è·Ÿä¸²æµåç¨±ï¼Œæ¥è‘—å°±æ–°å¢æˆåŠŸä¸¦å–å¾— GA ä»£ç¢¼ã€‚ è¨­å®šä»£ç¢¼ï¼šæ­é…å¥—ä»¶ vue-gtag ï¼ŒåŸ·è¡Œï¼šnpm i vue-gtag@1.16.1 Vue v2.x éœ€æ­é… vue-gtag v1.x æ¥è‘—æˆ‘å€‘æ–°å¢æª”æ¡ˆè‡³ pluginsï¼Œé€™è£¡å‘½åç‚º gtag.js // plugins/gtag.jsimport Vue from 'vue';import VueGtag from 'vue-gtag';Vue.use(VueGtag, { config: { id: 'UA-XXXXXXXXX-X' }}); é…ç½®åˆ° nuxt.config.js // nuxt.config.jsexport default { plugins: [ { src: '@/plugins/gtag.js' } ]} Google Tag Managerç”³è«‹ä»£ç¢¼ï¼š è‡³ Google Tag Manager ä»£ç¢¼ç®¡ç†å·¥å…·ï¼Œä½¿ç”¨ google å¸³æˆ¶ç™»å…¥ä¸¦å»ºç«‹å¸³æˆ¶ è¨­å®šå¸³æˆ¶åç¨±ï¼ˆå‘½åä¸€å€‹å®¹æ˜“è¾¨è­˜ç¶²ç«™çš„åç¨±ï¼‰ï¼Œæ¥è‘—è¨­å®šå®¹å™¨ï¼ˆGTM è¦æ”¾å…¥çš„ç¶²åŸŸï¼‰ï¼ŒæŒ‰ä¸‹å»ºç«‹ï¼Œå°±å¯ä»¥çœ‹åˆ°æ–°å¢çš„å®¹å™¨è·Ÿ GTM ä»£ç¢¼å›‰ è¨­å®šä»£ç¢¼ï¼šæ­é…å¥—ä»¶ @nuxtjs/gtm ï¼ŒåŸ·è¡Œï¼šnpm i @nuxtjs/gtmï¼Œç„¶å¾Œé…ç½® nuxt.config.js // nuxt.config.jsexport default { modules: [ '@nuxtjs/gtm', ], gtm: { id: 'GTM-XXXXXXX' }} é è¨­å…§å®¹ åƒè€ƒï¼Œä¹Ÿå¯ä»¥èª¿æ•´è¨­å®š // nuxt.config.jsexport default { modules: [ '@nuxtjs/gtm', ], gtm: { id: 'GTM-XXXXXXX', enabled: true, // for dev mode pageTracking: true }} å¦‚æœä»£ç¢¼éƒ½æ˜¯å›ºå®šçš„å…§å®¹ï¼Œé€™æ¨£å°±å®Œæˆå›‰ï½ ä¸éäº‹æƒ…ç¸½æ²’é€™éº¼ç°¡å–®ï¼Œå¦‚æœä»Šå¤©å°ˆæ¡ˆæœ‰å¾Œå°ï¼ŒGA è·Ÿ GTM éƒ½å¯ä¾›ä½¿ç”¨è€…è¨­å®šï¼Œä»£ç¢¼éƒ½æ˜¯è®Šå‹•çš„åƒæ•¸ï¼Œåˆè©²æ€éº¼åšå‘¢ï¼Ÿ æ•´åˆå¾Œç«¯ API é€²è¡Œä»£ç¢¼è¨­å®šé€™è£¡åŒæ™‚èªªæ˜ GA è·Ÿ GTM çš„é…ç½®ï¼Œé¦–å…ˆå®‰è£å¥—ä»¶ npm i vue-gtag@1.16.1 npm i @nuxtjs/gtm ç”±æ–¼è¦ä¸²æ¥ APIï¼Œé€™è£¡æ­é… @nuxtjs/axios ä½¿ç”¨ï¼ŒåŸ·è¡Œï¼šnpm i @nuxtjs/axios æ–°å¢ plugins/gtag.js // plugins/gtag.jsimport Vue from 'vue';import VueGtag from 'vue-gtag';export default async ({ $gtm, $axios }) =&gt; { const { gaFour, gtm } = await $axios.$get('/api/ga'); // GA4 Vue.use(VueGtag, { config: { id: gaFour } }); // GTM if (gtm) { $gtm.init(gtm); }}; é…ç½® nuxt.config.js // nuxt.config.jsexport default { plugins: [ { src: '@/plugins/gtag.js' } ], modules: [ '@nuxtjs/gtm' ], gtm: { enabled: true, pageTracking: true }} åƒè€ƒæ–‡ç« ï¼š https://www.turingdigital.com.tw/blog/install-ga4-property https://www.cyberbiz.io/support/?p=228 https://stackoverflow.com/questions/64612031/setup-google-analytics-4-in-nuxt-js","link":"/2022/12/14/nuxt/nuxt-ga-and-gtm/"},{"title":"Nuxt.js å°ˆæ¡ˆæ¶è¨­","text":"ç‰ˆæœ¬ï¼šnuxt 2.15.8 èªªåˆ° Nuxtï¼Œå¿…é ˆå…ˆå¾ Vue.js èªªèµ·ï¼ŒVue.js ç‚ºå°ˆæ³¨åœ¨è¦–åœ–å±¤(View) çš„ JS æ¡†æ¶ï¼Œç‚º SPAï¼ˆSingle Page Applicationï¼‰æ‡‰ç”¨ç¨‹å¼ï¼Œç°¡è€Œè¨€ä¹‹æ•´å€‹ç¶²ç«™æ‡‰ç”¨åªæœ‰å–®ä¸€é é¢ï¼Œä¸€ä½†é é¢è¢«åŠ è¼‰é€²ä¾†å¾Œï¼Œå°±ä¸æœƒå†é€²è¡Œè©²é é¢è«‹æ±‚ï¼Œç”±æ–¼ Vue æ˜¯åˆ©ç”¨ JS è¼‰å…¥è³‡æ–™ï¼Œä¸¦å‹•æ…‹ç”¢ç”Ÿå…ƒä»¶ï¼ŒSEO åªèƒ½æŠ“å–åˆ° HTML å…§å®¹ï¼Œå› æ­¤ SEO è¡¨ç¾è¶¨è¿‘æ–¼é›¶ã€‚ è€Œ Nuxt æ˜¯åŸºæ–¼ Vue.jsã€Node.jsã€Webpack ä»¥åŠ Badel.js çš„è¼•é‡æ¡†æ¶ï¼Œå¯ä»¥åŒæ™‚å‰µå»º SSRï¼ˆServer Side Renderï¼‰åŠ SPAï¼Œåœ¨é é¢è¼‰å…¥å‰å³æ¸²æŸ“ï¼ˆä¼ºæœå™¨å›å‚³å®Œæ•´ HTML æª”ï¼Œæ¯æ¬¡è·³è½‰é é¢ï¼Œç€è¦½å™¨éƒ½éœ€è¦åˆ·æ–°ï¼‰ï¼Œæœå°‹å¼•æ“çˆ¬èŸ²å¯ä»¥å–å¾—è³‡æ–™ï¼Œå¤§å¹…è§£æ±º SEO çš„å•é¡Œã€‚ ä»¥ä¸‹åœ–ç‰‡èªªæ˜ï¼š æ¥ä¸‹ä¾†ä¸€èµ·ä¾†å˜—è©¦å‰µå»ºä¸€å€‹ Nuxt å°ˆæ¡ˆå§ï¼ å¦‚åŒ Vue CLIï¼ŒNuxt ä¹Ÿæœ‰é¡ä¼¼çš„æŒ‡ä»¤åˆ—(command-line)å·¥å…· create-nuxt-appï¼Œ ä¾æ“šå®˜æ–¹æ–‡ä»¶æä¾›çš„å°ˆæ¡ˆåŒ…å»ºç½®æ–¹å¼ï¼š npx create-nuxt-app &lt;project-name&gt; ä½¿ç”¨ npx å®‰è£ï¼Œå®‰è£çš„å¥—ä»¶åœ¨åŸ·è¡Œå®Œå¾Œå°±æœƒè¢«ç§»é™¤ npxä»‹ç´¹ æ¥è‘—æœƒè·‘å‡ºä¸€äº›é¸é …ï¼š Project nameï¼šè¨­å®šå°ˆæ¡ˆåç¨± Programming languageï¼šé¸æ“‡ç¨‹å¼èªè¨€ Package managerï¼šè»Ÿé«”å¥—ä»¶ç®¡ç†ç³»çµ± npm / yarn UI frameworkï¼šcss æ¨¡æ¿ Template engineï¼šæ¨£ç‰ˆå¼•æ“ Nuxt.js modulesï¼šç›¸ä¾å¥—ä»¶ Linting toolsï¼šç¨‹å¼ç¢¼æª¢æŸ¥å·¥å…· Testing frameworkï¼šæ¸¬è©¦å·¥å…· Rendering modeï¼šæ¸²æŸ“æ¨¡å¼ Deployment targetï¼šé‹è¡Œæ¨¡å¼ ï¼ˆåœ¨æ­¤ç¤ºç¯„ Server Side Render) Development toolsï¼šé–‹ç™¼å·¥å…· Version control systemï¼šç‰ˆæ§å·¥å…· ä»¥ä¸Šé¸æ“‡å®Œç•¢å°±é–‹å§‹å®‰è£å°ˆæ¡ˆåŒ…ï¼Œé‹è¡Œå®Œæˆå°±å¯ä»¥é–‹å§‹ç·¨è­¯å°ˆæ¡ˆï¼Œè·Ÿè‘—æç¤ºè¨Šæ¯åŸ·è¡Œï¼šcd testnpm run dev åœ¨ package.json å…§å¯ä»¥çœ‹åˆ°ç›¸é—œæŒ‡ä»¤ \"scripts\": { \"dev\": \"nuxt\", \"build\": \"nuxt build\", \"start\": \"nuxt start\", \"generate\": \"nuxt generate\"} æ¥ä¸‹ä¾†å°±å¯ä»¥çœ‹åˆ°ç•«é¢å›‰ ğŸ‘ åƒè€ƒæ–‡ç« ï¼š https://medium.com/web-design-zone/å»ºç«‹nuxt-jså°ˆæ¡ˆåˆé«”é©—-21920735e38b https://levelup.gitconnected.com/spa-ssg-ssr-and-jamstack-a-front-end-acronyms-guide-6add9543f24d","link":"/2022/11/16/nuxt/nuxt-installation/"},{"title":"Nuxt.js Lazy Loading åœ–ç‰‡å»¶é²è¼‰å…¥","text":"ç‰ˆæœ¬ï¼šnuxt 2.15.8 Lazy Loading æ˜¯å¸¸è¦‹çš„åœ–ç‰‡å„ªåŒ–æŠ€å·§ï¼Œåœ¨ä½¿ç”¨å¤§é‡åœ–ç‰‡çš„ç¶²ç«™å°¤å…¶é©ç”¨ï¼Œå¯ä»¥æå‡ç¶²é è¼‰å…¥é€Ÿåº¦ï¼Œç¯€çœæµé‡çš„æµªè²»ï¼ŒGoogle Lighthouse ä¹Ÿé¡¯ç¤ºæ­¤ç‚ºæœ‰æ•ˆæå‡è©•åˆ†çš„æ–¹å¼ï¼Œè¨€ä¸‹ä¹‹æ„æœƒå½±éŸ¿åˆ° Google æœç´¢æ’åï¼Œæœ¬æ–‡ä»‹ç´¹å¦‚ä½•æ­é…å¥—ä»¶ lazysizes ä½¿ç”¨ã€‚ å¼•å…¥ lazysizes å¥—ä»¶ åŸ·è¡Œ npm i lazysizes æ¥è‘—åœ¨ plugins è³‡æ–™å¤¾æ–°å¢æª”æ¡ˆ lazysizes.js // plugins/lazysizes.jsimport lazySizes from 'lazysizes';export default lazySizes; nuxt.config.js é…ç½® plugin // nuxt.config.jsexport default { plugins: [ { src: '@/plugins/lazysizes', mode: 'client' } ], build: { extend(config, { _isDev, isClient, loaders: { vue } }) { if (isClient) { vue.transformAssetUrls.img = [ 'data-src', 'src' ]; } } }} Lazy Loading é‹ç”¨ å°‡ src å±¬æ€§æ›¿æ›ç‚º data-src åŠ ä¸Š lazyload class name src å»ºè­°åŠ ä¸Šé è¨­åœ–ç‰‡ï¼Œé¿å…åœ¨é é¢è¼‰å…¥æ™‚ç”¢ç”Ÿç ´åœ– &lt;template&gt; &lt;div&gt; &lt;img data-src=\"https://.../image.png\" class=\"lazyload\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=\" /&gt; &lt;/div&gt;&lt;/template&gt; lazy loading é‹ä½œåŸç†å¦‚ä¸‹ï¼š &lt;img&gt; ä½¿ç”¨ data-src å±¬æ€§ä»£å…¥è¦åŠ è¼‰çš„åœ–ç‰‡è·¯å¾‘ï¼Œç€è¦½å™¨ç„¡æ³•è¾¨è­˜è©²å±¬æ€§å› æ­¤ç„¡æ³•è¼‰å…¥ ç›£è½åœ–ç‰‡ dom å…ƒç´ æ˜¯å¦é€²å…¥ç€è¦½å™¨å¯è¦–å€ ç•¶ dom å…ƒç´ é€²å…¥å¯è¦–ç¯„åœï¼Œå°‡ data-src çš„å€¼è¤‡è£½åˆ° src å…§ï¼Œé€²è¡Œåœ–ç‰‡è¼‰å…¥ ä¹Ÿå¯ä»¥è©¦è‘—åŒ…è£æˆå…±ç”¨å…ƒä»¶ // components/TheLazyLoadImage.vue&lt;template&gt; &lt;img :data-src=\"src\" :src=\"defaultImage\" class=\"lazyload\" :alt=\"alt\" /&gt;&lt;/template&gt;&lt;script&gt;export default { name: 'LazyLoadImage', props: { src: { type: String, required: true, default: '' }, alt: { type: String, required: true, default: '' }, defaultImage: { type: String, default: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=' } }};&lt;/script&gt; æ¥è‘—åœ¨é é¢ä½¿ç”¨ &lt;template&gt; &lt;TheLazyLoadImage src=\"https://.../image.png\" alt=\"example image\" /&gt;&lt;/template&gt;&lt;script&gt;import TheLazyLoadImage from '@/components/TheLazyLoadImage';export default { name: 'LazyLoadImage', components: { TheLazyLoadImage }};&lt;/script&gt; çœ‹ä¸€ä¸‹ç·¨è­¯å¾Œçš„çµæœ &lt;img class=\"lazyloaded\" data-src=\"https://.../image.png\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=\" alt=\"example image\" /&gt; ç•¶ &lt;img&gt; é€²å…¥å¯è¦–ç¯„åœå¾Œï¼Œé¡¯ç¤ºå¦‚ä¸‹ &lt;img class=\"lazyloaded\" data-src=\"https://.../image.png\" src=\"https://.../image.png\" alt=\"example image\" /&gt; ç¯„ä¾‹ç¨‹å¼ç¢¼ See the Pen Vue.js Lazy Loading Images by Claire Chang (@claire-chang-the-bashful) on CodePen. åƒè€ƒæ–‡ç« ï¼š https://medium.com/@dannjb/a-lazy-loading-image-component-for-nuxt-js-c34e0909e6e1 https://medium.com/@mingjunlu/lazy-loading-images-via-the-intersection-observer-api-72da50a884b7","link":"/2023/02/02/nuxt/nuxt-lazy-loading/"},{"title":"Nuxt.js Lifecycle ç”Ÿå‘½é€±æœŸ","text":"ç‰ˆæœ¬ï¼šnuxt 2.15.8 Nuxt æœ€å¤§çš„ç‰¹é»å°±æ˜¯ Server Side Renderï¼Œå› æ­¤ä»–æœ‰ç¨ç«‹çš„ç”Ÿå‘½é€±æœŸï¼Œä¾†çœ‹ä¸€ä¸‹å®˜æ–¹æä¾›çš„åœ–ç‰‡ï¼š nuxtServerInitåªåœ¨ Nuxt ç’°å¢ƒåˆå§‹åŒ–æ™‚è§¸ç™¼ï¼Œç•¶æˆ‘å€‘æƒ³å°‡ server ç«¯è³‡æ–™æå‰å‚³çµ¦ client ç«¯ï¼Œå¯ä»¥ä½¿ç”¨æ­¤æ–¹æ³•ï¼Œè¦æ³¨æ„åªèƒ½å¯«åœ¨ VueX store/index.js actions // store/index.jsexport const state = () =&gt; ({ userInfo: {}});export const mutations = { setUserInfo(state, value) { state.userInfo = value; }};export const actions = { nuxtServerInit({ commit }, { req }) { // req.session.user = { name: 'claire' } commit('setUserInfo', req.session.user); }}; é€™æ¨£å°±å¯ä»¥åœ¨ Nuxt åˆå§‹åŒ–æ™‚ï¼Œè§¸ç™¼ nuxtServerInit æ–¹æ³•ï¼Œå°‡å€¼å‚³å…¥ stateï¼Œæˆ‘å€‘å¯ä»¥å¾ç€è¦½å™¨ Vue é–‹ç™¼è€…å·¥å…·çœ‹åˆ°å…§å®¹ï¼š å¦‚æœæƒ³å°‡è³‡æ–™å‚³çµ¦å…¶ä»– VueX modulesï¼Œå¯ä»¥é€™æ¨£åšï¼š é¦–å…ˆæ–°å¢ä¸€æ”¯æª”æ¡ˆ store/greeting.js // store/greeting.jsexport const state = () =&gt; ({ message: ''});export const mutations = { setMessage(state, value) { state.message = value; }}; æ¥è‘—åœ¨ store/index.js å®šç¾© nuxtServerInit // store/index.jsexport const actions = { nuxtServerInit({ commit }, { req }) { commit('greeting/setMessage', 'Hello World!'); }}; é€™æ¨£å°±å¯ä»¥è§¸ç™¼ store/greeting.js setMessage æ–¹æ³•ï¼Œè¦‹ä¸‹åœ–é–‹ç™¼è€…å·¥å…· Route Middlewareä¸­é–“çµ„ä»¶ï¼Œåœ¨é é¢æ¸²æŸ“å‰åŸ·è¡Œï¼Œæœ‰ä¸‰ç¨®å®šç¾©æ–¹å¼ï¼ŒåŸ·è¡Œé †åºç‚ºï¼šGlobal â†’ Layout â†’ Page æ¥ä¸‹ä¾†åˆ†åˆ¥èªªæ˜è©²å¦‚ä½•å®šç¾© Global Middlewareåœ¨ middleware è³‡æ–™å¤¾å…§å»ºç«‹æª”æ¡ˆï¼Œé€™è£¡å‘½åç‚º global.js // middleware/global.jsexport default ({ from, route, redirect, store, error }) =&gt; { console.log('global middleware'); if (!store.isLogin) { redirect('/login'); }}; æ¥è‘—åœ¨ nuxt.config.js é…ç½® // nuxt.config.jsexport default { router: { middleware: [ 'global' ] }} Layout Middlewareå»ºç«‹ middleware æª”æ¡ˆï¼Œé€™è£¡å‘½åç‚º middleware/layout.jsï¼Œç„¶å¾Œé…ç½®åˆ°ä»»ä¸€ layouts æª”æ¡ˆï¼Œç¯„ä¾‹ä½¿ç”¨ layouts/default.vue // layouts/default.vueexport default { name: 'Default', middleware: 'layout'}; æˆ–æ˜¯åŒ¿åé…ç½®ä¹Ÿå¯ä»¥ï¼š // layouts/default.vueexport default { name: 'Default', middleware({ from, route, redirect, store, error }) { console.log('layout middleware'); }}; Page Middlewareæ¦‚å¿µåŒ layouts middlewareï¼Œé…ç½®æ–¼ä»»ä¸€ pages æª”æ¡ˆï¼Œç¯„ä¾‹ä½¿ç”¨ pages/about.vueï¼Œé€™è£¡ä½¿ç”¨åŒ¿åé…ç½®ä¾†èªªæ˜ // pages/about.vueexport default { name: 'About', middleware({ from, route, redirect, store, error }) { console.log('page middleware'); }}; æ¥è‘—æˆ‘å€‘å¾é–‹ç™¼è€…å·¥å…·æŸ¥çœ‹ console çµæœä¾åºç‚ºä¸‹åœ–ï¼Œå› æ­¤æˆ‘å€‘å¯ä»¥é€é layout è·Ÿ page middleware ä¾†è¦†å¯« global middleware validateæ–¼ pages æª”æ¡ˆé…ç½®æ­¤æ–¹æ³•ï¼Œç”¨ä¾†é©—è­‰å‹•æ…‹è·¯ç”±åƒæ•¸æœ‰æ•ˆæ€§ï¼Œç¯„ä¾‹ä½¿ç”¨ pages/about/_userId.vue // pages/about/_userId.vueexport default { name: 'User', validate({ params, query }) { return true; // é©—è­‰é€šé return false; // é©—è­‰ç„¡æ•ˆï¼Œæœƒè‡ªå‹•è½‰å° error page }} é©—è­‰é€šéå¿…é ˆ return trueï¼Œå¦å‰‡æœƒè‡ªå‹•è½‰è·³ 404 error page asyncDataæ–¼ server ç«¯è™•ç†éåŒæ­¥çš„ç”Ÿå‘½é€±æœŸï¼Œåœ¨æ­¤å‚³å…¥çš„å…§å®¹å¯ä»¥è¢«æœå°‹å¼•æ“çˆ¬èŸ²å–å¾—ï¼Œæ˜¯æå‡ SEO æ•ˆèƒ½çš„é‡é»ç”Ÿå‘½é€±æœŸã€‚ åªæœƒåœ¨é é¢è¼‰å…¥æ™‚èª¿ç”¨ï¼Œç”±æ–¼ç”Ÿå‘½é€±æœŸåœ¨ Vue ä¹‹å‰ï¼Œå› æ­¤ç„¡æ³•å–å¾— this ï¼Œä¸” asyncData åƒ…é™ pages åº•ä¸‹é é¢ä½¿ç”¨ï¼Œæ–¹æ³•å…§æœƒè‡ªå‹•å¸¶å…¥ context åƒæ•¸ï¼Œæˆ‘å€‘å¯ä»¥å®‰è£ @nuxtjs/axios å¥—ä»¶ï¼Œaxios æœƒè¢«æ³¨å…¥é€² context å…§ï¼Œæˆ‘å€‘å¯ä»¥ç‰©ä»¶è§£æ§‹æ–¹å¼ä½¿ç”¨ï¼ˆ { $axios, params } = context )ï¼ˆç¯„ä¾‹ä½¿ç”¨ pages/about.vueï¼‰ // pages/about.vueexport default { name: 'About', async asyncData({ $axios, params }) { const id = params.id; const { data } = await $axios.$get(`/api/user/${id}`); return { userName: data }; }} é€é return valueï¼Œè³‡æ–™è¢«è³¦äºˆé€² Vue å¯¦é«”ï¼Œæˆ‘å€‘é€é this.userName å³å¯æˆåŠŸå–å€¼ // pages/about.vue&lt;template&gt; &lt;div&gt; &lt;h1&gt;{{ userName }}&lt;/h1&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default { name: 'About', async asyncData({ $axios, params }) { const id = params.id; const { data } = await $axios.$get(`/api/user/${id}`); return { userName: data }; }}&lt;/script&gt; data å¦‚æœæœ‰ç›¸åŒè®Šæ•¸åç¨±ï¼Œæœƒåœ¨ asyncData ç”Ÿå‘½é€±æœŸè¢«è¤‡å¯«ï¼Œæ‰€ä»¥é™¤ééœ€è¦å†æ¬¡ä¿®æ”¹è®Šæ•¸ï¼Œå¦å‰‡è«‹é¿å…é‡è¤‡å‘½åè®Šæ•¸ asyncData æ˜¯åœ¨ server ç«¯ã€è·¯ç”±æ›´æ–°å‰å³èª¿ç”¨ï¼Œç”±æ–¼æ˜¯åœ¨ç€è¦½å™¨æ¸²æŸ“å‰çš„ç”Ÿå‘½é€±æœŸï¼Œå› æ­¤ç„¡æ³•ä½¿ç”¨ loading placeholderï¼Œä¹Ÿä¸èƒ½ä½¿ç”¨ç€è¦½å™¨ç›¸é—œ API fetchNuxt v2.12 æ–°å¢åŠŸèƒ½ï¼ŒåŠŸèƒ½é¡ä¼¼ asyncData ï¼Œåœ¨ç•«é¢æ¸²æŸ“å‰ï¼ŒåŒæ™‚æ–¼ server ç«¯è·Ÿ client ç«¯çš„ç”Ÿå‘½é€±æœŸï¼Œå¯ä»¥ä½¿ç”¨æ–¼ä»»ä¸€ .vue é é¢ï¼Œç”±æ–¼æ˜¯åœ¨ Vue created ä¹‹å¾Œï¼Œå› æ­¤å¯ä»¥å–å¾— thisï¼Œåˆæ¬¡è¼‰å…¥é é¢æ™‚ï¼Œfetch æœƒåœ¨ server ç«¯åŸ·è¡Œï¼Œå¦‚æœæ˜¯é€é &lt;nuxt-link&gt; é€²è¡Œè·¯ç”±åˆ‡æ›ï¼Œfetch åœ¨ client ç«¯åŸ·è¡Œï¼Œå› æ­¤å¯ä»¥åœ¨æ­¤ç”Ÿå‘½é€±æœŸåŠ å…¥ loading æ•ˆæœ &lt;nuxt-link&gt; ç‚º Nuxt çš„è·¯ç”±åˆ‡æ›å…ƒä»¶ï¼Œç›¸ç•¶æ–¼ Vue.js çš„ &lt;router-link&gt; ï¼Œå› æ­¤æˆ‘å€‘åªèƒ½ä½¿ç”¨å…§éƒ¨é€£çµï¼Œå¤–éƒ¨é€£çµå¿…é ˆä½¿ç”¨ &lt;a&gt; æ¨™ç±¤ï¼Œé€é &lt;nuxt-link&gt; åˆ‡æ›è·¯ç”±ï¼Œæœƒè¢«è¦–ç‚º SPA é é¢è·³è½‰ ä»¥ä¸‹èªªæ˜ä½¿ç”¨æ–¹å¼ &lt;template&gt; &lt;ul&gt; &lt;li v-for=\"(post, key) in posts\" :key=\"key\"&gt; {{ post }} &lt;/li&gt; &lt;/ul&gt;&lt;/template&gt;&lt;script&gt;export default { data() { return { posts: [] } }, async fetch() { const { data } = await this.$axios.$get('/api/posts'); this.posts = data; }}&lt;/script&gt; å¦‚æœè¦é‡è¤‡è§¸ç™¼ fetch ç”Ÿå‘½é€±æœŸï¼Œå¯ä»¥ä½¿ç”¨ this.$fetch ä¾†å‘¼å«ï¼š &lt;template&gt; &lt;div&gt; &lt;ul&gt; &lt;li v-for=\"(post, key) in posts\" :key=\"key\"&gt; {{ post }} &lt;/li&gt; &lt;/ul&gt; &lt;button @click=\"$fetch\"&gt;é‡æ–°å–å¾—è²¼æ–‡&lt;/button&gt; &lt;/div&gt;&lt;/template&gt; å¦‚æœæˆ‘å€‘å¸Œæœ› fetch åªåœ¨ client ç«¯é‹è¡Œï¼Œå¯ä»¥åŠ ä¸Š fetchOnServer: falseï¼ˆé è¨­ trueï¼‰ å–å¾— fetch ç‹€æ…‹æˆ‘å€‘å¯ä»¥é€é this.$fetchState å–å¾— fetch ç•¶å‰åŸ·è¡Œç‹€æ…‹ï¼Œæœ‰ä»¥ä¸‹åƒæ•¸ï¼š pendingï¼šBoolean / æ˜¯å¦åŸ·è¡Œå®Œæˆï¼Œå¯ä»¥åœ¨æ­¤åŠ å…¥ loading æ•ˆæœï¼ˆclient ç«¯ï¼‰ errorï¼šnull or Error ç‰©ä»¶ / åˆ¤æ–·æ˜¯å¦ç™¼ç”ŸéŒ¯èª¤ timestampï¼šæ•´æ•¸ / æœ€å¾Œä¸€æ¬¡åŸ·è¡Œæ™‚é–“ï¼ˆæ­é… activated ä½¿ç”¨ï¼‰ ç¯„ä¾‹ï¼š &lt;template&gt; &lt;div&gt; &lt;p v-if=\"$fetchState.pending\"&gt;Loading...&lt;/p&gt; &lt;p v-if=\"$fetchState.error\"&gt;æœ‰æ±è¥¿å‡ºéŒ¯äº†&lt;/p&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default { data() { return { posts: [] } }, activated() { // æ¯ 30 ç§’è‡ªå‹•å‘¼å« fetch if (this.$fetchState.timestamp &lt;= Date.now() - 30000) { this.$fetch() } }, async fetch() { const { data } = await this.$axios.$get('/api/posts'); this.posts = data; }}&lt;/script&gt; ç”Ÿå‘½é€±æœŸåŸ·è¡Œé †åºæ¥è‘—æˆ‘å€‘å¾ç€è¦½å™¨é–‹ç™¼è€…å·¥å…·è§€å¯Ÿç”Ÿå‘½é€±æœŸåŸ·è¡Œé †åº asyncData() { console.log('asyncData');},fetch() { console.log('fetch');},beforeCreate() { console.log('beforeCreate');},created() { console.log('created');},beforeMount() { console.log('beforeMount');} å¯ä»¥ç™¼ç¾ï¼Œcreated è·Ÿ beforeCreate é€™å…©å€‹ Vue.js ç”Ÿå‘½é€±æœŸæœƒåŒæ™‚å‡ºç¾åœ¨ server ç«¯è·Ÿ client ç«¯ï¼Œå¦‚æœè¦é¿å…æ–¹æ³•è¢«é‡è¤‡åŸ·è¡Œï¼Œå¯ä»¥é€™æ¨£åšï¼š åŠ ä¸Š process.client åˆ¤æ–· created(){ if (process.client){ // åŸ·è¡Œå…§å®¹ }} ä½¿ç”¨ Nuxt fetch ç”Ÿå‘½é€±æœŸ ä½¿ç”¨ Vue beforeMount ç”Ÿå‘½é€±æœŸ åƒè€ƒæ–‡ç« ï¼š https://stackoverflow.com/questions/60411436/nuxtjs-page-is-created-twice https://happy9990929.github.io/2021/09/10/vue-nuxt-lifecycle-hooks/","link":"/2022/11/24/nuxt/nuxt-lifecycle/"},{"title":"Nuxt.js è‡ªè¨‚é é¢ Loading æ•ˆæœ","text":"ç‰ˆæœ¬ï¼šnuxt 2.15.8 Nuxt.js æä¾›äº†é è¨­çš„é€²åº¦æ¢æ•ˆæœï¼Œç•¶åˆ‡æ›è·¯å¾‘æ™‚æœƒè‡ªå‹•é¡¯ç¤ºã€‚æˆ‘å€‘å¯ä»¥è‡ªç”±åœ°èª¿æ•´é€²åº¦æ¢çš„æ¨£å¼ã€é—œé–‰é€²åº¦æ¢ï¼Œæˆ–è€…é€²è¡Œå®¢è£½åŒ–ä»‹é¢è¨­è¨ˆã€‚ è¨­å®š Loading æ¨£å¼1. é—œé–‰ loading æ•ˆæœå…¨åŸŸé—œé–‰æ•ˆæœ // nuxt.config.jsexport default { loading: false}; æˆ–æ˜¯é‡å°å–®é é—œé–‰æ•ˆæœ // pages/about.vue&lt;template&gt; &lt;h1&gt;About&lt;/h1&gt;&lt;/template&gt;&lt;script&gt; export default { loading: false };&lt;/script&gt; 2. èª¿æ•´é è¨­å…ƒä»¶æ¨£å¼// nuxt.config.jsexport default { loading: { color: 'blue', height: '5px' }}; åƒæ•¸å¦‚ä¸‹ï¼š åƒæ•¸ Type é è¨­å€¼ èªªæ˜ color String â€˜blackâ€™ é€²åº¦æ¢è‰²å½© failedColor String â€˜redâ€™ éŒ¯èª¤æ™‚é€²åº¦æ¢è‰²å½© height String â€˜2pxâ€™ é€²åº¦æ¢é«˜åº¦ throttle Number 200 é¡¯ç¤ºé€²åº¦æ¢å‰çš„ç·©è¡æ™‚é–“ (ms) duration Number 5000 é€²åº¦æ¢é¡¯ç¤ºæœ€é•·æ™‚é–“ (ms) continuous Boolean false loading æ™‚é–“å¤§æ–¼ duration æ™‚ï¼Œæ˜¯å¦æŒçºŒé¡¯ç¤ºé€²åº¦æ¢ css Boolean true è¨­å®š false æœƒç§»é™¤é è¨­é€²åº¦æ¢æ¨£å¼ï¼ˆä¸¦å¯è‡ªè¡Œè¨­å®šæ¨£å¼ï¼‰ rtl Boolean false é€²åº¦æ¢æ–¹å‘æ˜¯å¦ç”±å³è‡³å·¦ï¼ˆé è¨­ç”±å·¦è‡³å³ï¼‰ 3. å®¢è£½åŒ– Loading æ¨£å¼å¦‚æœä¸æƒ³ä½¿ç”¨é è¨­ loading æ¨£å¼ï¼Œä¹Ÿå¯ä»¥è‡ªå·±å»ºç«‹ï¼Œæ–°å¢ components/TheLoading.vueï¼ˆå‘½åè‡ªè¨‚ï¼‰ // nuxt.config.js&lt;template&gt; &lt;div v-if=\"loading\" class=\"loading-page\"&gt; &lt;span&gt;Loading...&lt;/span&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default { data() { return { loading: false } }, methods: { start() { this.loading = true }, finish() { this.loading = false }}};&lt;/script&gt; æ¥è‘—è¨»å†Šåˆ° nuxt.config.js // nuxt.config.jsexport default { loading: '@/components/TheLoading.vue'}; è§¸ç™¼ Loading äº‹ä»¶æˆ‘å€‘å¯ä»¥é€é start()ã€finish() æ–¹æ³•ä¾†è§¸ç™¼è·ŸçµæŸ loading æ•ˆæœ // pages/about.vue&lt;template&gt; &lt;h1&gt;Aboutï¼š&lt;/h1&gt; &lt;h3&gt;nameï¼š{{ info.name }}&lt;/h3&gt; &lt;h3&gt;ageï¼š{{ info.age }}&lt;h3&gt;&lt;/template&gt;&lt;script&gt;export default { data() { return { info: { name: '', age: '' } }; }, mounted() { this.getInfo(); }, methods: { async getInfo() { // loading é–‹å§‹ this.$nuxt.$loading.start(); const response = await $axios.$get('/api/info'); this.info = response; // loading çµæŸ this.$nuxt.$loading.finish(); } }};&lt;/script&gt; åƒè€ƒæ–‡ç« ï¼š https://nuxtjs.org/docs/features/loading/ https://ithelp.ithome.com.tw/articles/10205496","link":"/2022/12/29/nuxt/nuxt-loading/"},{"title":"Nuxt.js å¥—ä»¶æ‡‰ç”¨ï¼šMasonry æ‰“é€ ç€‘å¸ƒæµç‰ˆé¢","text":"ç‰ˆæœ¬ï¼šnuxt 2.15.8 å‰ç«¯ç¶²é é–‹ç™¼æƒ³å¿…å°ç€‘å¸ƒæµç‰ˆé¢ä¸é™Œç”Ÿï¼Œèƒ½å¤ å¿«é€Ÿçš„å¹«æˆ‘å€‘é”æˆ RWD å€å¡Šæ’ç‰ˆï¼Œå…¶ä¸­æœ€æœ‰åçš„å°±æ˜¯ masonry-layout é€™å¥— javascript å¥—ä»¶ã€‚ æ­¥é©Ÿå¦‚ä¸‹ï¼š 1. å®‰è£å¥—ä»¶npm i masonry-layout 2. è£½ä½œå…¨åŸŸå…±ç”¨ mixinsåœ¨ plugins æ–°å¢æª”æ¡ˆ masonry.jsï¼Œé€™è£¡ä½¿ç”¨åŸç”Ÿ JS å¯«æ³•ï¼šnew Masonry(element, optoins) ï¼Œoptions é¸é …åƒè€ƒ å®˜æ–¹æ–‡ä»¶ // plugins/masonry.jsimport Vue from 'vue';import Masonry from 'masonry-layout';// é¿å…é‡è¤‡è¨»å†Šif (!Vue.__masonry_mixin__) { Vue.__masonry_mixin__ = true; Vue.mixin({ methods: { masonry(element, optoins) { return new Masonry(element, optoins); } } });} å…¨åŸŸ mixins ç›¸ç•¶æ–¹ä¾¿ï¼Œä½†ä¹Ÿå¾ˆè€—è¨˜æ†¶é«”ï¼Œå› æ­¤å¿…é ˆåŠ ä¸Šåˆ¤æ–·æ¢ä»¶ï¼ˆEXï¼šVue.__masonry_mixin__ï¼‰ï¼Œé¿å…é‡è¤‡è¨»å†Š mixins 3. nuxt.config.js é…ç½® pluginså¿…é ˆåŠ ä¸Š mode: 'client' ï¼Œå› å¥—ä»¶æœ‰ä½¿ç”¨åˆ° window ç‰©ä»¶ï¼Œåœ¨ server ç«¯è®€å–ä¸åˆ°è®Šæ•¸æœƒå ±éŒ¯ï¼š window is not defined // nuxt.config.jsexport default { plugins: [ { src: '@/plugins/masonry', mode: 'client' } ]} 4. é é¢æ‡‰ç”¨æ¥ä¸‹ä¾†å°±å¯ä»¥åœ¨é é¢ä¸Šä½¿ç”¨äº†ï¼Œç¯„ä¾‹é é¢ pages/index.vue // pages/index.vue&lt;template&gt; &lt;div class=\"masonry-wrap\" ref=\"masonry\"&gt; &lt;div class=\"masonry-item\" v-for=\"item in 12\" :key=\"item\" :class=\"`masonry-item-${item}`\"&gt; &lt;div class=\"card\"&gt; {{ item }} &lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default { name: 'Home', mounted() { this.masonry(this.$refs.masonry, { columnWidth: 160, gutter: 20, itemSelector: '.masonry-item', transitionDuration: '0.3s', horizontalOrder: true }); }}&lt;/script&gt;&lt;style lang=\"scss\" scoped&gt; * { box-sizing: border-box; } .masonry-wrap { max-width: 1000px; padding: 50px; } .masonry-item { width: 160px; height: 100px; margin-bottom: 20px; .card { padding: 1rem; height: 100%; background: rgb(225, 225, 225); border-radius: 5px; border: 1px solid rgb(200, 200, 200); } } .masonry-item-1, .masonry-item-7, .masonry-item-12 { height: 200px; } .masonry-item-3, .masonry-item-9 { height: 150px; }&lt;/style&gt; çµæœå¦‚ä¸‹ See the Pen Vue.js 2.x å¥—ä»¶æ‡‰ç”¨ï¼šMasonry æ‰“é€ ç€‘å¸ƒæµç‰ˆé¢ by Claire Chang (@claire-chang-the-bashful) on CodePen. åƒè€ƒæ–‡ç« ï¼š https://masonry.desandro.com/ https://medium.com/@jake101/using-masonry-js-in-nuxt-c4dbf8c17647","link":"/2022/12/23/nuxt/nuxt-masonry/"},{"title":"Nuxt.js Meta Tags and SEO","text":"ç‰ˆæœ¬ï¼šnuxt 2.15.8 åœ¨ Vue.js å°ˆæ¡ˆï¼Œæˆ‘å€‘å¯ä»¥ç›´æ¥åœ¨ index.html &lt;head&gt; è¨­å®šå…¨ç«™å…±ç”¨çš„ meta tagsï¼Œé‚£åœ¨ Nuxt åˆè©²æ€éº¼è¨­å®šå‘¢ï¼Ÿ Nuxt.js è—‰ç”± vue-meta ä¾†æ›´æ–°æ‡‰ç”¨å…§çš„ head è¨­å®šè·Ÿ meta å±¬æ€§ï¼Œä½¿ç”¨ create-nuxt-app å»ºæ§‹å°ˆæ¡ˆæœƒè‡ªå‹•å®‰è£ï¼Œæˆ‘å€‘å¯ä»¥åœ¨é é¢å®šç¾©ä¸åŒçš„å…§å®¹ï¼Œå¹«åŠ©æœå°‹å¼•æ“çˆ¬èŸ²æŒæ¡é é¢å…§å®¹ï¼Œæå‡ SEOã€‚ å…¨åŸŸé…ç½®// nuxt.config.jsexport default { head: { title: 'my website title', meta: [ { charset: 'utf-8' }, { name: 'viewport', content: 'width=device-width, initial-scale=1' }, { hid: 'description', name: 'description', content: 'my website description' }, { hid: 'og:title', property: 'og:title', content: 'my website title' } ], link: [ { rel: 'icon', type: 'image/x-icon', href: '/favicon.ico' } ] }} æˆ‘å€‘å¯ä»¥çœ‹åˆ° head è‡ªå‹•æ¸²æŸ“ï¼š &lt;head&gt; &lt;title&gt;my website title&lt;/title&gt; &lt;meta data-n-head=\"ssr\" charset=\"utf-8\"&gt;&lt;/head&gt; ç‚ºäº†é¿å…å…ƒä»¶å…§ å±€éƒ¨é…ç½® head é€ æˆ meta tags é‡è¤‡ï¼Œéœ€åŠ ä¸Š hid keyï¼Œä¸¦è³¦äºˆå”¯ä¸€å€¼ï¼Œé€™æ¨£ç•¶å…ƒä»¶å®šç¾©ç›¸åŒ hid çš„ meta æ¨™ç±¤ï¼Œvue-meta æœƒè‡ªå‹•è¦†è“‹æ‰ å…¨åŸŸé…ç½® å±€éƒ¨é…ç½®ä»¥ç‰©ä»¶å®šç¾©ï¼š // pages/about.vueexport default { head: { title: 'about-us', meta: [ { hid: 'description', name: 'description', content: 'about-us' } ] }} å¦‚æœéœ€è¦é€é this ä¾†å–å¾— meta è³‡æ–™ï¼Œéœ€è¦èª¿æ•´ç‚º function returnï¼š // pages/about.vueexport default { data() { return { seo: { title: 'about-us', description: 'about-us' } } }, head() { return { title: this.seo.title, meta: [ { hid: 'description', name: 'description', content: this.seo.description } ] } }} åƒè€ƒæ–‡ç« ï¼š https://nuxtjs.org/docs/features/meta-tags-seo/","link":"/2022/12/10/nuxt/nuxt-meta-tags/"},{"title":"Nuxt.js å¯¦ä½œ 301 è½‰å€ï¼ˆ301 Redirectï¼‰","text":"ç‰ˆæœ¬ï¼šnuxt 2.15.8 301 è½‰å€åˆç¨±ç‚ºé‡æ–°å°å‘ï¼Œå°‡æŒ‡å®šç¶²å€å°å‘å¦ä¸€ç¶²å€ï¼Œåœ¨ç¶²ç«™çµæ§‹æ›´æ–°ã€ç¶²ç«™æ¬é·æ™‚å¸¸æœƒä½¿ç”¨åˆ°ï¼Œç•¶ç”¨æˆ¶è¼¸å…¥èˆŠç¶²å€æ™‚ï¼Œæœƒè‡ªå‹•è·³è½‰åˆ°æ–°ç¶²å€ã€‚ è½‰å€è·Ÿ SEO çš„é—œä¿‚å¦‚æœéœ€è½‰å€çš„ç¶²é å·²ç¶“ç¶“ç‡Ÿè¨±ä¹…ï¼Œå¦‚æœæ²’æœ‰è¨­å®šè½‰å€ï¼Œéå»ç´¯ç©çš„é é¢æ¬Šé‡å’Œæµé‡ä¸æœƒè·Ÿè‘—è½‰ç§»ï¼Œæ–°çš„ç¶²ç«™å¿…é ˆé‡æ–°ç´¯ç©ï¼Œä¸”æœå°‹å¼•æ“å¯èƒ½æœƒå‡ºç¾é‡è¤‡å…§å®¹ï¼Œå°‡æœƒå½±éŸ¿ SEO æ’åã€‚ 301 è½‰å€è·Ÿ 302 è½‰å€å·®åˆ¥å¦‚æœåªæ˜¯æš«æ™‚æ€§ç¶²ç«™ç¶­è­·ï¼Œä¹‹å¾Œæœƒé‡æ–°å°å›èˆŠæœ‰ç¶²ç«™ï¼Œéœ€ä½¿ç”¨ 302 æš«æ™‚è½‰å€ï¼›å¦‚æœæ˜¯æ°¸ä¹…æ›´æ›ï¼Œå‰‡ä½¿ç”¨ 301 è½‰å€ã€‚ å¯¦ä½œ 301 è½‰å€ç•¶ç¶²ç«™æ”¹ç‰ˆï¼Œç¶²å€çš„çµæ§‹ç•°å‹•ï¼Œæˆ‘å€‘å¯ä»¥é€™æ¨£åšï¼š èˆŠç¶²é ï¼š https://example.com/events/summer-sale æ–°ç¶²é ï¼š https://new-example.com/special/summer-sale èˆŠç¶²é  æ–°ç¶²é  /events/event-title /special/event-title /events/treatment-title /treatment/treatment-title /events/product-title /product/product-title æ–°ç¶²é æ˜¯ç•¶å‰å·²é–‹ç™¼çš„é é¢ï¼Œå°±ä¸å¤šåšèªªæ˜ï¼Œè‡³æ–¼è¦æ€éº¼è½‰å°èˆŠç¶²é ï¼Œæˆ‘å€‘å¯ä»¥é€é middlewareï¼Œé¦–å…ˆæ–°å¢å°æ‡‰è·¯ç”±çš„é é¢ï¼špages/events/_id.vue (ç”±æ–¼èˆŠè·¯ç”±çš†ç‚º events åº•ä¸‹ï¼Œçµ±ä¸€å»ºç«‹å‹•æ…‹è·¯ç”±)ï¼Œæ¥è‘—é€²è¡Œè¨­å®šï¼š // pages/events/_id.vue&lt;template&gt; &lt;div&gt;&lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default { name: 'EventsUrlRedirection', middleware({ route, redirect, error }) { const redirectArr = { '/events/event-title': '/special/event-title', '/events/treatment-title': '/treatment/treatment-title', '/events/product-title': '/product/product-title' }; if (redirectArr[route.path]) { redirect(301, redirectArr[route.path]); } else { // ç•¶é é¢ä¸å­˜åœ¨ï¼Œå°å‘ 404 error page error({ statusCode: 404 }); } }};&lt;/script&gt; redirect é è¨­ status code 302 ï¼Œä½¿ç”¨é è¨­å€¼ç›´æ¥å¯« redirect(path) å°±å¯ä»¥äº† middleware ä¹Ÿå¯ç¨ç«‹æ‹†åˆ†ï¼Œå¤–å±¤æ–°å¢ middleware è³‡æ–™å¤¾ï¼Œæ–°å¢æª”æ¡ˆ urlRedirection.js // middleware/urlRedirection.jsexport default ({ route, redirect, error }) =&gt; { const redirectArr = { '/events/event-title': '/special/event-title', '/events/treatment-title': '/treatment/treatment-title', '/events/product-title': '/product/product-title' }; if (redirectArr[route.path]) { redirect(301, redirectArr[route.path]); } else { error({ statusCode: 404 }); }}; æ¥è‘—å›åˆ° pages/events/_id.vueï¼š // pages/events/_id.vue&lt;template&gt; &lt;div&gt;&lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default { name: 'EventsUrlRedirection', middleware: 'urlRedirection'};&lt;/script&gt; é€™æ¨£å°±å®Œæˆäº†ï½ åƒè€ƒæ–‡ç« ï¼š https://welly.tw/serp-rank-optimization/301-and-302-redirection-guide-for-seo https://nuxtjs.org/docs/internals-glossary/context/#redirect","link":"/2022/12/18/nuxt/nuxt-redirect/"},{"title":"Nuxt.js æ›¿ç¶²ç«™å¢åŠ  sitemap ç¶²ç«™åœ°åœ–","text":"ç‰ˆæœ¬ï¼šnuxt 2.15.8 ç•¶æˆ‘å€‘çš„æ–°ç¶²ç«™ä¸Šç·šï¼Œå¤–éƒ¨é€£çµå°‘ï¼Œæˆ–æ˜¯ç¶²ç«™è¦æ¨¡å¾ˆå¤§æ™‚ï¼Œé€é sitemap ç¶²ç«™åœ°åœ–ï¼Œå¯ä»¥è®“ google æœå°‹å¼•æ“çˆ¬èŸ²å¯ä»¥æ›´å¿«é€Ÿçš„äº†è§£æˆ‘å€‘çš„ç¶²ç«™ä¸Šæœ‰å“ªäº›ç¶²é ä¸¦åŠ ä»¥æ”¶éŒ„ï¼Œä¸¦å»ºç«‹ç´¢å¼•ï¼Œæå‡ç¶²é å‡ºç¾çš„æ©Ÿç‡ã€‚ æˆ‘å€‘å¯ä»¥é€é @nuxtjs/sitemap ä¾†å¿«é€Ÿå»ºç«‹ sitemapï¼ŒåŸ·è¡Œï¼šnpm i @nuxtjs/sitemap åœ¨ config è³‡æ–™å¤¾æ–°å¢ sitemap.js æª”æ¡ˆï¼Œæ¥è‘—åœ¨ nuxt.config.js é…ç½®ï¼š // nuxt.config.jsimport sitemap from './config/sitemap';export default { modules: [ '@nuxtjs/sitemap', ], sitemap: sitemap} æ¥è‘—ç§»å‹•åˆ°åˆ° config/sitemap.js é€²è¡Œè¨­å®šã€‚ sitemap é¸é …èªªæ˜ï¼š pathï¼šè¨­å®š sitemap åç¨±ï¼Œé è¨­ç‚º ****/sitemap.xml hostnameï¼šç¶²ç«™ domain cacheTimeï¼šsitemap æ›´æ–°çš„é »ç‡ï¼ˆé è¨­ç‚º 1000 * 60 * 15 15 åˆ†é˜ï¼‰ gzipï¼šæ˜¯å¦ç”Ÿæˆå£“ç¸®æª”ï¼Œé è¨­ false excludeï¼šæ’é™¤è¢«åŠ é€² sitemap çš„é é¢ï¼ˆé™£åˆ—ï¼‰ sitemap: { exclude: [ '/guideline', '/sample/**' ]} defaultsï¼šé è¨­è¨­å®šï¼ˆè‡ªå‹•å¸¶å…¥ routesï¼‰ sitemap: { defaults: { changefreq: 'daily', // æ›´æ–°é »ç‡ priority: 0.8, // å„ªå…ˆåº¦ lastmod: new Date() // æœ€å¾Œæ›´æ–°æ™‚é–“ }} filterï¼šç¯©é¸è·¯å¾‘ï¼ˆfunctionï¼‰ sitemap: { filter({ routes }) { return routes.map(route =&gt; { // è¨­å®šé¦–é å„ªå…ˆåº¦ç‚º 1 if (route.url === '/') { route.priority = 1; } return route; }); }} routesï¼šåŠ å…¥è·¯å¾‘ï¼ˆæœ¬ç¯‡é‡é»ï¼Œä»¥ä¸‹è©³ç´°èªªæ˜ï¼‰ Routes è¨­å®š@nuxtjs/sitemap æœƒè‡ªå‹•åŠ å…¥ éœæ…‹è·¯ç”± é é¢ï¼Œä½† å‹•æ…‹è·¯ç”± å¿…é ˆæ‰‹å‹•åŠ å…¥ -| pages/---| index.vue --&gt; static route---| about.vue --&gt; static route---| users/-----| _id.vue --&gt; dynamic route åŠ å…¥å‹•æ…‹è·¯ç”±æ–¹æ³•ï¼š æ‰‹å‹•åŠ å…¥ï¼ˆä½¿ç”¨é™£åˆ—ï¼‰ sitemap: { routes: [ { url: '/users/1', changefreq: 'daily', priority: 0.6, lastmod: new Date() }, { url: '/users/2', changefreq: 'daily', priority: 0.6, lastmod: new Date() } ]} é€é API ä¸²æ¥åŠ å…¥ï¼ˆä½¿ç”¨ function å›å‚³ promiseï¼‰ ç¯„ä¾‹æœƒä½¿ç”¨ @nuxtjs/axios é€²è¡Œ API ä¸²æ¥ï¼ŒåŸ·è¡Œï¼šnpm i @nuxtjs/axios sitemap: { routes: async () =&gt; { const { data } = await axios.get('https://test/api/sitemap'); return data.map(user =&gt; { return { url: `/users/${user.id}`, changefreq: 'daily', priority: 0.6, lastmod: new Date() } }); }} å°‡ä¸Šè¿°è¨­å®šåˆä½µèµ·ä¾†ï¼š // config/sitemap.jsconst axios = require('axios');const sitemap = { path: '/sitemap.xml', // sitemap åç¨± hostname: 'https://test.com', // domain cacheTime: 1000 * 60 * 60 * 24, // update frequency of the day defaults: { changefreq: 'daily', priority: 0.8, lastmod: new Date() }, filter({ routes }) { return routes.map(route =&gt; { if (route.url === '/') { route.priority = 1; } return route; }); } routes: async () =&gt; { const { data } = await axios.get('https://test.com/api/sitemap'); return data.map(user =&gt; { return { url: `/users/${user.id}`, changefreq: 'daily', priority: 0.6, lastmod: new Date() } }); }};export default sitemap; æ¥è‘—åœ¨é é¢ä¸Šè¼¸å…¥ hostname/sitemap.xmlï¼ˆEXï¼šhttps://test.com/sitemap.xmlï¼‰ï¼Œå°±å¯ä»¥çœ‹åˆ°æˆ‘å€‘çš„ sitemap æª”æ¡ˆå›‰ ğŸ™Œ åƒè€ƒæ–‡ç« ï¼š https://www.hellosanta.com.tw/knowledge/category-13/post-236 https://sitemap.nuxtjs.org/usage/sitemap-options","link":"/2022/12/15/nuxt/nuxt-sitemap/"},{"title":"Nuxt.js å¥—ä»¶æ‡‰ç”¨ï¼šSwiper è£½ä½œè¼ªæ’­å‹•ç•«","text":"ç‰ˆæœ¬ï¼šnuxt 2.15.8 ç¶²ç«™é–‹ç™¼å¸¸ä½¿ç”¨åˆ°è¼ªæ’­åŠŸèƒ½ï¼ŒSwiper æ˜¯ä¸€æ¬¾åŸºæ–¼ js é–‹ç™¼ã€åŠŸèƒ½å®Œæ•´å¯¦ç”¨æ€§é«˜çš„è¼ªæ’­å¥—ä»¶ï¼Œæœ¬ç¯‡å°‡ä»‹ç´¹å¦‚ä½•åœ¨ Nuxt.js å°ˆæ¡ˆå…§æ­é… Vue æ•´åˆå¥—ä»¶ vue-awesome-swiper å¯¦ä½œè¼ªæ’­å‹•ç•« å¥—ä»¶å®‰è£ï¼š npm i swiper@6.8.4 npm i vue-awesome-swiper@4.1.1 å®˜æ–¹æ–‡ä»¶ç‰ˆæœ¬èªªæ˜ï¼šVue2 æ­é… Swiper 5-6 ï¼†&nbsp;vue-awesome-swiper@4.1.1å¦‚æœæ˜¯ Vue3 æ­¤å¥—ä»¶å·²ä¸æ”¯æ´ï¼Œéœ€æ”¹ç”¨ Swiper Vue.js Components æ¥è‘—å…¨åŸŸè¨»å†Š Swiper å…ƒä»¶ï¼Œåœ¨ plugins è³‡æ–™å¤¾æ–°å¢æª”æ¡ˆ swiper.jsï¼ˆæª”åè‡ªè¨‚ï¼‰ // plugins/swiper.jsimport Vue from 'vue';import Swiper, { /* swiper modules... */ } from 'swiper';import VueAwesomeSwiper from 'vue-awesome-swiper';Swiper.use([ /* swiper modules... */ ]);export default () =&gt; { Vue.use(VueAwesomeSwiper);}; ä¸Šè¿° swiper modules å€å¡Šå¯ä»¥æ›¿æ›éœ€è¦çš„æ¨¡çµ„ï¼ˆæ¨¡çµ„é¸é …ï¼‰ï¼Œç¯„ä¾‹ä½¿ç”¨ Navigation, Pagination åœ¨ nuxt.config.js é€²è¡Œé…ç½® // nuxt.config.jsexport default { css: [ { src: 'swiper/swiper-bundle.min.css' } ], plugins: [ { src: '@/plugins/swiper', mode: 'client' } ]} æ¥ä¸‹ä¾†å¯ä»¥é€éå…©ç¨®æ–¹å¼ä½¿ç”¨ï¼š swiper components å…ƒä»¶&lt;template&gt; &lt;client-only&gt; &lt;div&gt; &lt;swiper class=\"swiper\" :options=\"swiperOption\" ref=\"bannerSwiper\"&gt; &lt;swiper-slide&gt;banner 1&lt;/swiper-slide&gt; &lt;swiper-slide&gt;banner 2&lt;/swiper-slide&gt; &lt;swiper-slide&gt;banner 3&lt;/swiper-slide&gt; &lt;swiper-slide&gt;banner 4&lt;/swiper-slide&gt; &lt;swiper-slide&gt;banner 5&lt;/swiper-slide&gt; &lt;/swiper&gt; &lt;div class=\"swiper-button-prev\" slot=\"button-prev\"&gt;&lt;/div&gt; &lt;div class=\"swiper-button-next\" slot=\"button-next\"&gt;&lt;/div&gt; &lt;/div&gt; &lt;/client-only&gt;&lt;/template&gt;&lt;script&gt;export default { data() { return { swiperOption: { slidesPerView: 3, spaceBetween: 5, grabCursor: true } } }};&lt;/script&gt; swiper è¨­å®šé …ç›®è«‹è¦‹æ–‡ä»¶ï¼Œå¦‚æœå°ˆæ¡ˆç‚º server-side renderï¼Œä½¿ç”¨æ­¤æ–¹å¼å¤–å±¤éœ€åŠ ä¸Š &lt;client-only /&gt; ï¼Œå¦å‰‡åœ¨ server ç«¯æœƒå› ç‚º dom å…ƒç´ ç„¡æ³•è¢«è§£æè€Œå ±éŒ¯ [Vue warn]: The client-side rendered virtual DOM tree is not matching server-rendered content. This is likely caused by incorrect HTML markup, for example nesting block-level elements inside &lt;p&gt;, or missing &lt;tbody&gt;. Bailing hydration and performing full client-side render. æˆ‘å€‘å¯ä»¥ä½¿ç”¨ this.$refs.bannerSwiper.$swiper ä¾†å–å¾— Swiper å¯¦é«”ä¸¦ä½¿ç”¨ç›¸é—œæ–¹æ³• æ ¹æ“šæ–‡ä»¶èªªæ˜ï¼Œ&lt;client-only /&gt; çš„å…ƒç´ åœ¨ mounted ç”Ÿå‘½é€±æœŸæ‰æ¸²æŸ“å®Œç•¢ï¼Œå› æ­¤åœ¨ mounted å‘¼å« $refs å¯èƒ½æœƒå–ä¸åˆ°å…§å®¹ï¼ˆå³ä¾¿ä½¿ç”¨ $nextTickï¼‰ï¼Œéœ€å°‡æ–¹æ³•åŒ…è£æˆè¿´åœˆï¼š export default { mounted(){ this.getSwiperInstance() }, methods: { getSwiperInstance() { this.$nextTick(() =&gt; { if (this.$refs.bannerSwiper) { this.$refs.bannerSwiper.$swiper.slideTo(2); } else { this.getSwiperInstance(); } }); } }} directive æŒ‡ä»¤è‹¥ Swiper å…§å®¹éœ€è¢«æœå°‹å¼•æ“çˆ¬èŸ²è®€å–ï¼Œå¯ä»¥åˆ©ç”¨ Vue directive æ–¹æ³•ï¼Œä½¿ç”¨èƒ½è¢«ç€è¦½å™¨è§£æçš„ Dom å…ƒç´ åŒ…è£ Swiperï¼Œè¦‹ä»¥ä¸‹ç¯„ä¾‹ï¼š &lt;template&gt; &lt;div class=\"banner-wrap mx-auto py-4 px-3\"&gt; &lt;div v-swiper:bannerSwiper=\"swiperOption\" class=\"swiper\"&gt; &lt;div class=\"swiper-wrapper\"&gt; &lt;div class=\"swiper-slide\"&gt;banner 1&lt;/div&gt; &lt;div class=\"swiper-slide\"&gt;banner 2&lt;/div&gt; &lt;div class=\"swiper-slide\"&gt;banner 3&lt;/div&gt; &lt;div class=\"swiper-slide\"&gt;banner 4&lt;/div&gt; &lt;div class=\"swiper-slide\"&gt;banner 5&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default { data() { return { swiperOption: { slidesPerView: 3, spaceBetween: 5, grabCursor: true } } }, mounted() { this.bannerSwiper.slideTo(2, 500, false); }};&lt;/script&gt; å¦‚æœåŒä¸€å€‹é é¢æœ‰å¤šå€‹ Swipersï¼Œå¿…é ˆè¦é€éå‘½åï¼ˆ ex: v-swiper:bannerSwiper ï¼‰ä¾†é€²è¡Œç¶å®šï¼Œæˆ‘å€‘ä¹Ÿå¯ä»¥é€éåç¨± this.bannerSwiper çš„å–å¾— Swiper å¯¦é«”ä¸¦ä½¿ç”¨ç›¸é—œæ–¹æ³•ï¼Œæ˜¯ä¸æ˜¯ç°¡å–®è¨±å¤šå‘¢ï¼ åƒè€ƒæ–‡ç« ï¼š https://github.com/surmon-china/surmon-china.github.io/blob/vue2/projects/vue-awesome-swiper/examples/00-typescript-composition-api.vue https://nuxtjs.org/docs/features/nuxt-components/#the-client-only-component https://ken551113.github.io/2019/11/26/Using-Vue-Awesome-Swiper-On-Nuxt/","link":"/2022/11/29/nuxt/nuxt-swiper/"},{"title":"Nuxt.js å¥—ä»¶æ‡‰ç”¨ï¼šVeeValidate è¡¨å–®é©—è­‰","text":"ç‰ˆæœ¬ï¼šnuxt 2.15.8 vee-validate æ˜¯ä½¿ç”¨æ–¼ Vue.js çš„è¼•é‡è¡¨å–®é©—è­‰å¥—ä»¶ï¼ˆåƒè€ƒ php æ¡†æ¶ laravel è¡¨å–®é©—è­‰æ‰€é–‹ç™¼ï¼‰ï¼Œåƒ…éœ€åœ¨è¡¨å–®ä¸ŠåŠ å…¥ç°¡æ˜“èªæ³•å°±èƒ½é€²è¡Œé©—è­‰ï¼ŒåŸ·è¡Œï¼šnpm i vee-validate@3.4.14 Vue.js v2.x éœ€æ­é… vee-validate v3.x æ–°å¢ plugins/vee-validate.jsï¼Œåœ¨ nuxt.config.js é…ç½® // nuxt.config.jsexport default { plugins: [ { src: '@/plugins/vee-validate.js', mode: 'client' } ]} ç§»å‹•åˆ° plugins/vee-validate.js è¨»å†Šå…¨åŸŸè¡¨å–®é©—è­‰å…ƒä»¶ï¼Œæ­¥é©Ÿå¦‚ä¸‹ï¼š 1. è¦å‰‡å¼•å…¥å¼•å…¥éƒ¨åˆ†è¦å‰‡ï¼š import { extend } from 'vee-validate';import { required, email } from \"vee-validate/dist/rules\";extend('email', email);extend('required', { ...required, message: 'æ¬„ä½å¿…å¡«'}); å¼•å…¥å…¨éƒ¨è¦å‰‡ï¼š import { extend } from 'vee-validate';import * as rules from 'vee-validate/dist/rules';Object.keys(rules).forEach(rule =&gt; { extend(rule, rules[rule]);}); 2. èªç³»è¨­å®šï¼ˆä»¥ç¹é«”ä¸­æ–‡èˆ‰ä¾‹ï¼‰import { localize } from 'vee-validate';import tw from 'vee-validate/dist/locale/zh_TW.json';localize('zh_TW', tw); å…¨åŸŸè‡ªè¨‚æç¤ºè¨Šæ¯ localize('zh_TW', { ...tw, messages: { required: '{_field_} å¿…å¡«' }, fields: { email: { required: 'éƒµä»¶ å¿…å¡«' } }}); 3. èª¿æ•´äº’å‹•æ¨¡å¼è·Ÿ CSS classesäº’å‹•æ¨¡å¼é¸é …ï¼š aggressiveï¼šé è¨­æ¨¡å¼ï¼Œinput è·Ÿ blur äº‹ä»¶é€²è¡Œé©—è­‰ lazyï¼šchange æˆ– blur äº‹ä»¶é€²è¡Œé©—è­‰ passiveï¼šä¸æœƒè‡ªå‹•é©—è­‰ï¼Œéœ€ä¸»å‹•å‘¼å« eagerï¼šå®˜æ–¹èªªæ˜ç‚ºä½¿ç”¨è€…é«”é©—æœ€ä½³çš„äº’å‹•æ¨¡å¼ï¼Œçµåˆ aggressive (é©—è­‰å¤±æ•—å¾Œ) è·Ÿ lazy (é©—è­‰å‰) import { configure } from 'vee-validate';configure({ mode: 'eager', // Interaction Modes classes: { valid: 'is-valid', invalid: 'is-invalid' }}); 4. å°‡å…ƒä»¶è¨»å†Šè‡³ Vue InstanceValidationObserverï¼šé©—è­‰å®Œæ•´è¡¨å–® ValidationProviderï¼šé©—è­‰å–®ä¸€è¡¨å–®å…§å®¹ import { ValidationObserver, ValidationProvider } from 'vee-validate';Vue.component('ValidationObserver', ValidationObserver);Vue.component('ValidationProvider', ValidationProvider); å°‡ä»¥ä¸Šå…§å®¹æ•´åˆèµ·ä¾†ï¼š // plugins/vee-validate.jsimport Vue from 'vue';import tw from 'vee-validate/dist/locale/zh_TW.json';import * as VeeValidate from 'vee-validate';import * as rules from 'vee-validate/dist/rules';Object.keys(rules).forEach(rule =&gt; { VeeValidate.extend(rule, rules[rule]);});VeeValidate.localize('zh_TW', tw);VeeValidate.configure({ mode: 'eager', classes: { valid: 'is-valid', invalid: 'is-invalid' }});Vue.component('ValidationObserver', VeeValidate.ValidationObserver);Vue.component('ValidationProvider', VeeValidate.ValidationProvider); æ¥ä¸‹ä¾†å°±å¯ä»¥åœ¨å„é é¢ã€å…ƒä»¶ä½¿ç”¨è¡¨å–®é©—è­‰åŠŸèƒ½å›‰ï¼š Validation Providerï¼šé©—è­‰å–®ä¸€è¡¨å–®å…§å®¹ï¼ˆinputï¼‰1. v-slotï¼šå–å¾—å…ƒä»¶å›å‚³çš„å…§å®¹2. rulesï¼šè¦å‰‡é¸æ“‡ï¼Œå¤šå€‹è¦å‰‡å¯ä»¥ä½¿ç”¨ â€˜|â€™ åˆ†éš”3. propsï¼šå›å‚³å…§å®¹çµ¦å…ƒä»¶ï¼ŒEX: name &lt;ValidationProvider rules=\"required|email\" name=\"E-mail\" v-slot=\"{ errors, classes }\"&gt; &lt;input type=\"email\" placeholder=\"è«‹è¼¸å…¥ä¿¡ç®±\" v-model=\"email\" :class=\"classes\" /&gt; &lt;small&gt;{{ errors[0] }}&lt;/small&gt;&lt;/ValidationProvider&gt; Validation Observerï¼šé©—è­‰å®Œæ•´è¡¨å–®æ–¹æ³•ä¸€ï¼šä½¿ç”¨ ****v-slot=\"{ invalid }\" ï¼Œé©—è­‰ä¸é€šé disabled æŒ‰éˆ•ï¼ˆtype=\"submit\"ï¼‰ï¼ŒsubmitForm() ç‚ºè‡ªè¨‚æ–¹æ³• &lt;validation-observer v-slot=\"{ invalid }\"&gt; &lt;form @submit.prevent=\"submitForm\"&gt; &lt;ValidationProvider&gt;...&lt;/ValidationProvider&gt; &lt;button type=\"submit\" :disabled=\"invalid\"&gt;é€å‡ºè¡¨å–®&lt;/button&gt; &lt;/form&gt;&lt;/validation-observer&gt; æ–¹æ³•äºŒï¼šä½¿ç”¨ v-slot=\"{ handleSubmit }\" ï¼Œé€é handleSubmit æ–¹æ³•ä¾†ç›£è½è¡¨å–®ï¼Œé©—è­‰é€šéé»æ“ŠæŒ‰éˆ•æ‰æœƒåŸ·è¡Œ submitForm() &lt;validation-observer v-slot=\"{ handleSubmit }\"&gt; &lt;form @submit.prevent=\"handleSubmit(submitForm)\"&gt; &lt;ValidationProvider&gt;...&lt;/ValidationProvider&gt; &lt;button type=\"submit\"&gt;é€å‡ºè¡¨å–®&lt;/button&gt; &lt;/form&gt;&lt;/validation-observer&gt; å°‡ &lt;ValidationProvider /&gt;ã€&lt;ValidationObserver /&gt; çµåˆèµ·ä¾†ï¼Œç¯„ä¾‹é é¢ pages/contact-us.vueï¼š // pages/contact-us.vue&lt;template&gt; &lt;client-only&gt; &lt;ValidationObserver v-slot=\"{ handleSubmit }\" ref=\"observer\"&gt; &lt;form @submit.prevent=\"handleSubmit(submitForm)\"&gt; // å§“å &lt;label for=\"name\"&gt;å§“å&lt;/label&gt; &lt;ValidationProvider rules=\"required\" name=\"å§“å\" v-slot=\"{ errors, classes }\"&gt; &lt;input type=\"text\" v-model=\"name\" :class=\"classes\" /&gt; &lt;small&gt;{{ errors[0] }}&lt;/small&gt; &lt;/ValidationProvider&gt; // email &lt;label for=\"email\"&gt;E-mail&lt;/label&gt; &lt;ValidationProvider rules=\"required|email\" name=\"E-mail\" v-slot=\"{ errors, classes }\"&gt; &lt;input type=\"email\" v-model=\"email\" :class=\"classes\" /&gt; &lt;small&gt;{{ errors[0] }}&lt;/small&gt; &lt;/ValidationProvider&gt; &lt;button type=\"submit\"&gt;é€å‡ºè¡¨å–®&lt;/button&gt; &lt;/form&gt; &lt;/ValidationObserver&gt; &lt;/client-only&gt;&lt;/template&gt;&lt;script&gt; export default { data() { return { name: '', email: '' } }, methods: { submitForm() { // ... } } }&lt;/script&gt; åœ¨ ssr: true æ¨¡å¼ä¸‹ï¼Œå¤–å±¤å¿…é ˆåŠ ä¸Š &lt;client-only /&gt; ï¼Œå¦å‰‡åœ¨ server ç«¯æœƒå› ç‚º dom å…ƒç´ ç„¡æ³•è§£æè€Œæ‹‹éŒ¯èª¤ çµæœå¦‚ä¸‹ See the Pen Vue.js 2.x å¥—ä»¶æ‡‰ç”¨ï¼šVeeValidate è¡¨å–®é©—è­‰ by Claire Chang (@claire-chang-the-bashful) on CodePen. åƒè€ƒæ–‡ç« ï¼š https://medium.com/@yusufznl/how-to-validate-forms-in-nuxt-with-vee-validate-eef45508c3d4https://vee-validate.logaretm.com/v3/","link":"/2022/12/17/nuxt/nuxt-veevalidate/"},{"title":"Nuxt.js VueX Store æ­é… vuex-persistedstate ç‹€æ…‹ä¿å­˜å·¥å…·","text":"ç‰ˆæœ¬ï¼šnuxt 2.15.8 å‰æƒ…æè¦ä¸€ä¸‹ï¼Œåœ¨ Vue çš„å°ˆæ¡ˆä¸‹ï¼Œå¸¸æœƒéœ€è¦åšçˆ¶å­å…ƒä»¶æˆ–æ˜¯é é¢ä¹‹é–“çš„æºé€šå‚³å€¼ï¼Œå¦‚æœèªªåªæ˜¯å–®å±¤ï¼ˆexï¼šçˆ¶å…ƒä»¶ â†’ å­å…ƒä»¶ã€å­å…ƒä»¶ â†’ çˆ¶å…ƒä»¶ã€é é¢ â†’ é é¢ï¼‰ï¼Œæˆ‘å€‘å¯ä»¥å¾ˆç°¡å–®çš„ä½¿ç”¨ props ã€ emit æˆ– event bus å³å¯ï¼Œä½†åœ¨å¤§å‹å°ˆæ¡ˆï¼Œå…±ç”¨è³‡æ–™å°±ä¸æ˜¯å¦‚æ­¤å–®ç´”ï¼Œå¯èƒ½æœƒæœ‰å…ƒä»¶å…§å«å…ƒä»¶ã€å¤šå±¤ç´šçš„æºé€šï¼Œå¦‚æœåªç”¨ä¸Šè¿°æ–¹æ³•ï¼Œå°æ–¼é–‹ç™¼åŠé™¤éŒ¯éƒ½ä¸ä¾¿åˆ©ï¼Œå¦‚ä¸‹åœ–ç¯„ä¾‹ï¼Œå…ƒä»¶ 1-1 è·Ÿå…ƒä»¶ 2-1 çš„æºé€šç›¸å°è¤‡é›œã€‚ ç‚ºäº†è™•ç†é«˜é›£åº¦æºé€šï¼ŒVueX ç‹€æ…‹ç®¡ç†å·¥å…·å°±èª•ç”Ÿäº†ï¼Œé‚£éº¼åœ¨ Nuxt å°ˆæ¡ˆä¸‹åˆè©²æ€éº¼ä½¿ç”¨å‘¢ï¼Ÿ é¦–å…ˆå…ˆå®‰è£ VueX å¥—ä»¶ npm i vuex@3.6.2 Nuxt v2.x å¿…é ˆæ­é… VueX v3.x æ¥è‘—åœ¨å°ˆæ¡ˆæœ€å¤–å±¤æ–°å¢ store è³‡æ–™å¤¾ï¼Œä¸¦åœ¨è£¡é¢å»ºç«‹ .js æª”ï¼Œç¯„ä¾‹ä½¿ç”¨ userInfo.js // store/userInfo.jsexport const state = () =&gt; {};export const getters = {};export const mutations = {};export const actions = {}; Nuxt å°ˆæ¡ˆæœƒè‡ªå‹•å‰µå»ºå¯¦ä¾‹ new Vuex.Store()ï¼Œå°‡ store æª”æ¡ˆåŒ…è£é€²æ¨¡çµ„å…§ï¼Œåƒé€™æ¨£ï¼š new Vuex.Store({ modules: { userInfo: { namespaced: true, state: () =&gt; {}, getters: {}, mutations: {}, actions: {} } }}); VueX åŸºæœ¬æ¶æ§‹ï¼š stateï¼šç”¨ä»¥å„²å­˜ç‹€æ…‹ï¼ŒåŠŸèƒ½åŒ .vue æª”å…§çš„ dataï¼Œå› æ­¤æœƒä½¿ç”¨æ–¹æ³•ä¾†åŒ…è£ï¼Œä¸¦ return å…§å®¹ gettersï¼šåŠŸèƒ½åŒ computedï¼Œç”¨ä»¥è¨ˆç®— state å…§çš„ç‹€æ…‹ï¼Œä¸èƒ½ç›´æ¥æ”¹è®Š state mutationsï¼šç”¨ä¾†æ›´æ”¹ stateï¼Œä¸èƒ½ä½¿ç”¨éåŒæ­¥èªæ³• actionsï¼šéåŒæ­¥èªæ³•åªèƒ½å¯«åœ¨ actionsï¼Œä¸èƒ½ç›´æ¥æ”¹è®Š stateï¼Œéœ€é€é mutations æ”¹è®Š state æ¥è‘—ä¾†æ›¿ store åŠ å…¥ä¸€äº›å…§å®¹å§ // store/userInfo.jsexport const state = () =&gt; ({ count: 0, products: [ { name: 'food', onSale: false }, { name: 'drink', onSale: true } ]});export const getters = { onSaleProducts(state) { return state.products.filter(item =&gt; item.onSale); }};export const mutations = { increment(state, number) { state.count += number; }};export const actions = { incrementAsync({ commit }, number) { setTimeout(() =&gt; { commit('increment', number); }, 1000); }}; å¦‚æœè¦åœ¨é é¢ä½¿ç”¨ store çš„å…§å®¹ï¼Œæœ‰ä»¥ä¸‹å…©ç¨®æ–¹å¼ï¼š é€é this.$store æ“ä½œVueX å°‡ store æ³¨å…¥åˆ° Vue å¯¦ä¾‹ï¼Œå› æ­¤æˆ‘å€‘é€é $store å°±å¯ä»¥å–å¾—ç›¸é—œè³‡æ–™åŠæ–¹æ³•ï¼Œä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼ˆç¯„ä¾‹é é¢ pages/about.vueï¼‰ï¼š // pages/about.vueexport default { name: 'About', computed: { count() { // state return this.$store.state.userInfo.count; } onSaleProducts() { // getters return this.$store.getters['userInfo/onSaleProducts']; } }, methods: { increment(number) { // mutations this.$store.commit('userInfo/increment', number); }, incrementAsync(number) { // actions this.$store.dispatch('userInfo/incrementAsync', number); } }} ä½†æ˜¯æ¯ä¸€ç­†è³‡æ–™æˆ–æ˜¯æ–¹æ³•ï¼Œéƒ½é€é this.$store å–å¾—ï¼Œç¨‹å¼ç¢¼å†—é•·ï¼Œå¦‚æœä»Šå¤©æˆ‘å€‘æœ‰ä¸‰å€‹ store å„²å­˜åº«ï¼Œæ˜“è®€æ€§åˆæ›´ä½äº†ï¼Œé›£é“æ²’æœ‰ç°¡å–®çš„ä½¿ç”¨æ–¹å¼å—ï¼Ÿ é€éè¼”åŠ©å‡½å¼VueX æä¾›ä¸€ç³»åˆ—è¼”åŠ©å‡½å¼ï¼ˆmapState, mapGetters, mapMutations, mapActionsï¼‰ï¼Œå¯ä»¥å¹«åŠ©æˆ‘å€‘æ›´ç°¡æ˜“çš„å–å¾— store å…§å®¹ï¼Œé¦–å…ˆå¿…é ˆå¾ VueX å¼•å…¥è¼”åŠ©å‡½å¼ï¼Œæ¥è‘—ä¾†æ”¹å¯« about.vue é é¢ // pages/about.vueimport { mapState, mapGetters, mapMutations, mapActions } from 'vuex';export default { name: 'About', computed: { ...mapState('userInfo', [ 'count' ]), ...mapGetters('userInfo', [ 'onSaleProducts' ]) }, methods: { ...mapMutations('userInfo', [ 'increment' ]), ...mapActions('userInfo', [ 'incrementAsync' ]) }} é€éè¼”åŠ©å‡½å¼ï¼Œæ¸›å°‘è¨±å¤šç¨‹å¼ç¢¼ï¼Œé–±è®€èµ·ä¾†ä¹Ÿè¼•é¬†è¨±å¤šã€‚ VueX ç›¸ç•¶æ–¹ä¾¿ï¼Œä½†é‚„æ˜¯å­˜åœ¨ä¸€å€‹å•é¡Œï¼Œå°±æ˜¯ç•¶é é¢é‡æ–°æ•´ç†çš„æ™‚å€™ï¼Œæœƒå›å¾©åˆ°åˆå§‹ç‹€æ…‹ã€‚ æŸäº›æƒ…å¢ƒä¸‹ï¼Œæˆ‘å€‘éœ€è¦ä¿ç•™æ›´æ–°å¾Œçš„è³‡æ–™ï¼Œä¾‹å¦‚ç™»å…¥å¾Œå„²å­˜ä½¿ç”¨è€…è³‡è¨Šåˆ° storeï¼Œé‡æ•´é é¢å¾Œè³‡æ–™è¢«æ¸…ç©ºï¼Œä½¿ç”¨è€…å¿…é ˆé‡æ–°ç™»å…¥ã€‚ç‚ºäº†è§£æ±ºé€™å€‹å•é¡Œï¼Œæˆ‘å€‘å¯ä»¥å°‡è³‡æ–™å„²å­˜æ–¼ localStorageï¼Œå¾…ç•«é¢é‡æ•´å¾Œå†å°‡è³‡æ–™å–å›æ”¾å…¥ storeï¼Œæˆ–è€…æ˜¯ä½¿ç”¨å¥—ä»¶ vuex-persistedstate 2022.02.04 vuex-persistedstate å¥—ä»¶å·²ä¸ç¹¼çºŒç¶­è­·æ›´æ–° æ¥ä¸‹ä¾†èªªæ˜å¦‚ä½• Nuxt å°ˆæ¡ˆå¦‚ä½•æ­é… vuex-persistedstateï¼Œå­˜æ”¾åœ¨ localStorage çš„å…§å®¹ï¼Œå¯ä»¥è¼•æ˜“åœ°è¢«è®€å–ï¼Œå› æ­¤æˆ‘å€‘éœ€è¦å°‡å…§å®¹åŠ å¯†ï¼ˆæ­é…å¥—ä»¶ secure-lsï¼‰ é¦–å…ˆå®‰è£å¥—ä»¶ï¼šnpm i vuex-persistedstate åŠåŠ å¯†å¥—ä»¶ï¼šnpm i secure-lsï¼Œæ¥è‘—æ–¼ plugins å¢åŠ æª”æ¡ˆï¼Œç¯„ä¾‹ä½¿ç”¨ persistedstate.js // plugins/persistedstate.jsimport createPersistedState from 'vuex-persistedstate';import SecureLS from 'secure-ls';const ls = new SecureLS({ encodingType: 'aes', // åŠ å¯†æ–¹å¼ï¼Œé è¨­ base64 isCompression: false, // æ˜¯å¦å£“ç¸®æ•¸æ“š encryptionSecret: process.env.APP_KEY // åŠ å¯† key});export default ({ store, isHMR }) =&gt; { if (isHMR) { // é¿å…åœ¨ç†±æ›´æ–°çš„æ™‚å€™é‡è¤‡è§¸ç™¼(npm run dev) return; } window.onNuxtReady(() =&gt; { createPersistedState({ key: 'test', // è‡ªè¨‚ localStorage key storage: { getItem: key =&gt; ls.get(key), setItem: (key, value) =&gt; ls.set(key, value), removeItem: key =&gt; ls.remove(key) } })(store); });}; æ¥è‘—é…ç½®åˆ° nuxt.config.js å…§ // nuxt.config.jsexport default { plugins: [ { src: '@/plugins/persistedstate', ssr: false } ]} é€™æ¨£ä¸€ä¾†å³ä½¿ç•«é¢é‡æ•´ï¼Œstore ä¹Ÿå¯ä»¥é †åˆ©ä¿å­˜è³‡æ–™ï¼Œåœ¨ localStorage æŸ¥çœ‹ test å…§å®¹ä¹Ÿç¢ºå¯¦è¢«åŠ å¯†äº†ï¼ åƒè€ƒæ–‡ç« ï¼š https://medium.com/itsems-frontend/vue-vuex1-state-mutations-364163b3acac https://chiafangsung.medium.com/ä½¿ç”¨-vuex-persistedstate-ç¶­æŒ-vuex-ç‹€æ…‹-f0d7c522c73a","link":"/2022/11/22/nuxt/nuxt-vuex-store/"},{"title":"Nuxt.js 3.x Assets vs Public ç›®éŒ„ï¼éœæ…‹è³‡æºç®¡ç†","text":"æœ¬ç¯‡æ–‡ç« åŒæ­¥ç™¼è¡¨æ–¼ 2023 iThome éµäººè³½ Nuxt3 æä¾›å…©å€‹è³‡æ–™å¤¾ assets/ ä»¥åŠ public/ï¼Œç”¨ä¾†ç®¡ç†éœæ…‹è³‡æºï¼Œåƒæ˜¯åœ–ç‰‡ã€CSS æ¨£å¼ã€å­—é«”ã€icon ç­‰ï¼Œæ¥ä¸‹ä¾†èªªæ˜å…©å€‹ç›®éŒ„é©åˆå­˜æ”¾çš„æª”æ¡ˆé¡å‹èˆ‡ä½¿ç”¨æ–¹å¼ Publicéœæ…‹è³‡æºè³‡æ–™å¤¾ï¼ˆåŒ Nuxt2 çš„&nbsp;static/ï¼‰ï¼Œç”¨ä¾†å­˜æ”¾ä¸éœ€è¢«ç·¨è­¯çš„éœæ…‹æª”ï¼Œå¯ä»¥é€éæ ¹ç›®éŒ„ / ç›´æ¥ä½¿ç”¨æª”æ¡ˆ é©åˆæª”æ¡ˆæ€§è³ª ä¸éœ€ç¶“ç”± Vite / Webpack ç­‰æ‰“åŒ…å·¥å…·ç·¨è­¯ï¼šåƒæ˜¯ sitemap.xml é€šå¸¸ä¸éœ€å¦å¤–å£“ç¸®è™•ç† æª”æ¡ˆå›ºå®šæ€§é«˜ / æª”åä¸èƒ½è¢«æ›´æ”¹ï¼šç¶“éç·¨è­¯å¾Œçš„æª”æ¡ˆï¼Œæª”åå¾ŒæœƒåŠ ä¸Šä¸€çµ„ hashï¼Œåƒæ˜¯ robots.txt å¿…é ˆå›ºå®šæª”åï¼Œæœå°‹å¼•æ“çˆ¬èŸ²æ‰èƒ½æ­£ç¢ºè§£æï¼Œé©åˆæ”¾åœ¨ public/ å¸¸è¦‹æª”æ¡ˆé¡å‹ favicon.ico robots.txt sitemap.xml CNAMEï¼ˆDNS ç´€éŒ„ï¼‰ ä½¿ç”¨æ–¹å¼é€éæ ¹ç›®éŒ„ / ç›´æ¥ä½¿ç”¨ public/ æª”æ¡ˆ ç¯„ä¾‹ï¼š public/|â€”â€” favicon.ico|â€”â€” image/ |â€”â€” picture.jpg ä½¿ç”¨ favicon.icoï¼š // nuxt.config.jsexport default defineNuxtConfig({ app: { head: { link: [ { rel: 'icon', type: 'image/x-icon', href: '/favicon.ico' } ] } }}); ä½¿ç”¨ image/picture.jpgï¼š // pages/index.vue&lt;template&gt; &lt;div&gt; &lt;img src=\"/image/picture.jpg\"&gt; &lt;/div&gt;&lt;/template&gt; é€éé–‹ç™¼è€…å·¥å…·æª¢è¦– åœ–ç‰‡ä¾†æºï¼šhttps://unsplash.com/ Assetsç”¨ä¾†å­˜æ”¾åƒæ˜¯ CSSã€Sassã€åœ–ç‰‡ç­‰éœ€è¦è¢« webpack æˆ–æ˜¯ Vite ç·¨è­¯çš„éœæ…‹è³‡æºã€‚ä¸€èˆ¬ä¾†èªªï¼Œassets/ çš„ä½¿ç”¨ç‡è¼ƒ public/ é«˜ é©åˆæª”æ¡ˆæ€§è³ª éœ€è¦é€é Vite / Webpack æ‰“åŒ…å·¥å…·ç·¨è­¯ï¼ˆå£“ç¸®ã€æœ€ä½³åŒ–ï¼‰ï¼šåƒæ˜¯ JS æˆ–æ˜¯ CSSã€åœ–ç‰‡ç­‰ï¼Œå¸Œæœ›åœ¨å°ˆæ¡ˆç™¼ä½ˆå‰ï¼Œé å…ˆå°æª”æ¡ˆé€²è¡Œå£“ç¸®å’Œæœ€ä½³åŒ–è™•ç†ï¼Œæå‡ç¶²ç«™è¼‰å…¥é€Ÿåº¦èˆ‡æ•ˆèƒ½ æª”æ¡ˆè¼ƒå¸¸æ›´æ–°ï¼Œé¿å…è¢«å¿«å–å½±éŸ¿ï¼šç¶“éç·¨è­¯å¾Œçš„æª”æ¡ˆï¼Œæª”åæœƒåŠ ä¸Šä¾æ“šæ–‡ä»¶å…§å®¹ç”¢ç”Ÿçš„ hashï¼Œæ¯æ¬¡æ›´æ–°ç·¨è­¯å¾Œ hash æœƒè®Šæ›´ï¼Œèƒ½é¿å…å—ç€è¦½å™¨å¿«å–å½±éŸ¿ï¼Œå¼·åˆ¶ç€è¦½å™¨è®€å–æ›´æ–°å¾Œçš„æª”æ¡ˆã€‚ä¾‹å¦‚ï¼šimg.png ç·¨è­¯å¾Œè®Šæˆ img.2d8efhg.png å¸¸è¦‹æª”æ¡ˆé¡å‹ CSSã€Sass Javascript åœ–ç‰‡ å­—é«” ä½¿ç”¨æ–¹å¼é€é ~/assets/ è·¯å¾‘ä½¿ç”¨æª”æ¡ˆ ç¯„ä¾‹ï¼š assets/|â€”â€” scss/ |â€”â€” style.scss|â€”â€” image/ |â€”â€” picture.jpg å…¨åŸŸä½¿ç”¨ scss/style.scssï¼š // nuxt.config.jsexport default defineNuxtConfig({ css: [ '~/assets/scss/app.scss' ]}); ä½¿ç”¨ image/picture.jpgï¼š // pages/index.vue&lt;template&gt; &lt;div&gt; &lt;img src=\"~/assets/image/picture.jpg\"&gt; &lt;/div&gt;&lt;/template&gt; åŸ·è¡Œç”Ÿç”¢ç’°å¢ƒç·¨è­¯ nuxt build (npm run build) å¾Œï¼Œå¯ä»¥çœ‹åˆ°æª”ååŠ ä¸Šäº† hash åœ–ç‰‡ä¾†æºï¼šhttps://unsplash.com/ è·¯å¾‘åˆ¥åNuxt3 é è¨­è·¯å¾‘åˆ¥åå¦‚ä¸‹ï¼š { \"~\": \"/&lt;rootDir&gt;\", \"@\": \"/&lt;rootDir&gt;\", \"~~\": \"/&lt;rootDir&gt;\", \"@@\": \"/&lt;rootDir&gt;\", \"assets\": \"/&lt;rootDir&gt;/assets\", \"public\": \"/&lt;rootDir&gt;/public\"} å› æ­¤ä¹Ÿå¯ä»¥é€é @/assets/image/picture.jpg å–å¾—åœ–ç‰‡ï¼Œæˆ–æ˜¯è‡ªè¨‚åˆ¥åä¾†ç°¡åŒ–è·¯å¾‘ å‹•æ…‹åœ–ç‰‡åœ¨ Nuxt2 æ­é… Webpack æ‰“åŒ…å·¥å…·ï¼Œé€é require å³å¯å‹•æ…‹è¼‰å…¥åœ–ç‰‡ // Nuxt2 + Webpack&lt;img :src=\"require(`~/assets/image/${imageName}`)\" /&gt; Nuxt3 æ­é… Vite è§£æ±ºæ–¹æ³•å¦‚ä¸‹ï¼ˆè¨è«–ä¸²ï¼‰ï¼Œé€é import.meta.glob æ–¹æ³•ä¸€æ¬¡å¼•å…¥å¤šå¼µåœ–ç‰‡ // Nuxt3 + Vite&lt;template&gt; &lt;div&gt; &lt;img :src=\"getImageUrl(imageName)\" /&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;const getImageUrl = name =&gt; { const assets = import.meta.glob('~/assets/image/*', { eager: true, import: 'default' }); return assets[`/assets/image/${name}`];};const imageName = 'picture.jpg';&lt;/script&gt; .output ç›®éŒ„åŸ·è¡Œç”Ÿç”¢ç’°å¢ƒç·¨è­¯&nbsp;nuxt buildï¼ˆnpm run buildï¼‰æ™‚è‡ªå‹•ç”Ÿæˆçš„è³‡æ–™å¤¾ï¼Œassets/ èˆ‡ public/ æ‰“åŒ…å¾Œæœƒæ”¾åœ¨ .output/public/ å…§ åŸå§‹æª”æ¡ˆï¼š public/|â€”â€” public-pic.jpgassets/|â€”â€” assets-pic.jpg æ‰“åŒ…å¾Œï¼š public/ å…§çš„æª”æ¡ˆä¸ç¶“è™•ç†ç›´æ¥æ”¾åˆ° .output/public/ assets/ å…§çš„æª”æ¡ˆç·¨è­¯å¾ŒåŠ ä¸Š hash æ”¾åˆ° .output/public/_nuxt/ .output/|â€”â€” public/ |â€”â€” _nuxt/ |â€”â€” assets-pic.ef9916a0.jpg |â€”â€” public-pic.jpg åƒè€ƒè³‡æºï¼š https://nuxt.com/docs/getting-started/assetshttps://masteringnuxt.com/blog/handling-assets-in-nuxt-3https://vitejs.dev/guide/assets.html","link":"/2023/09/12/nuxt3/nuxt-v3-assets-vs-public/"},{"title":"Nuxt.js 3.x å¥—ä»¶æ‡‰ç”¨ï¼CKEditor 5 æ–‡å­—ç·¨è¼¯å™¨ï¼ˆæ­é… Vite é–‹ç™¼ï¼‰","text":"æœ¬ç¯‡æ–‡ç« åŒæ­¥ç™¼è¡¨æ–¼ 2023 iThome éµäººè³½ CKEditor ç‰ˆæœ¬ï¼šv39.0.0 Nuxt2 æ­é… CKEditor 5 è«‹åƒè€ƒ é€™ç¯‡æ–‡ç«  CKEditor æ˜¯ä¸€å¥—æ­·å²æ‚ ä¹…ä¸”åŠŸèƒ½å®Œæ•´ã€è¼•é‡çš„å¯Œæ–‡æœ¬ç·¨è¼¯å™¨ï¼ˆrich text editorï¼‰ï¼Œç‚ºä½¿ç”¨è€…æä¾›æ‰€è¦‹å³æ‰€å¾—ï¼ˆWYSIWYGï¼‰çš„ç·¨è¼¯å€åŸŸã€‚èˆ‡èˆŠç‰ˆä¸åŒï¼ŒCKEditor 5 ä½¿ç”¨ MVC æ¶æ§‹ã€ES6 ç·¨å¯«ã€UI ç°¡æ½”ï¼Œä¸”å› æ‡‰ç¾åœ¨çš„å‰å¾Œç«¯åˆ†é›¢è¶¨å‹¢ï¼Œèˆ‡å‰ç«¯æ¡†æ¶ Reactã€Angularã€and Vue.js åšæ•´åˆï¼Œè®“æˆ‘å€‘å¯ä»¥æ›´ä¾¿åˆ©çš„é–‹ç™¼æ‡‰ç”¨ã€‚ æ¥ä¸‹ä¾†èªªæ˜å¦‚ä½•åœ¨ Nuxt3 + Vite ç’°å¢ƒæ­é… CKEditor é–‹ç™¼ï¼Œåˆ†åˆ¥ä»‹ç´¹ä»¥ä¸‹å…©ç¨®å®‰è£æ–¹å¼ï¼š 1. ä½¿ç”¨é å…ˆå®šç¾©çš„çµ„åˆ2. è‡ªè¡Œé…ç½®åŠŸèƒ½ æ³¨æ„ï¼š CKEditor åªèƒ½åœ¨ client ç«¯é‹ä½œï¼Œå¦å‰‡æœƒæ‹‹ self is not defined éŒ¯èª¤æä¾›å…©å€‹è§£æ³•ï¼š è¨­å®šç‚º ssr: falseï¼Œé—œé–‰ server ç«¯æ¸²æŸ“ å°‡ CKEditor å…ƒä»¶åŒ…åœ¨è‡ªè¨‚å…ƒä»¶å…§ï¼Œæª”ååŠ ä¸Š .client å¾Œç¶´ï¼Œé™åˆ¶å…ƒä»¶åœ¨ client ç«¯é‹ä½œEXï¼šcomponents/TheCkeditor.client.vue 1. ä½¿ç”¨é å…ˆå®šç¾©çš„çµ„åˆæä¾›ä»¥ä¸‹å¹¾ç¨®çµ„åˆï¼Œå„çµ„åˆåŠŸèƒ½å¯ä»¥åƒè€ƒ å®˜æ–¹æ–‡ä»¶ Classic editor Inline editor Balloon editor Balloon block editor Document editor Multi-root editor Superbuild ä»¥ Classic editor é€²è¡Œèªªæ˜ï¼š å¥—ä»¶å®‰è£npm install --save \\ @ckeditor/ckeditor5-vue \\ @ckeditor/ckeditor5-build-classic ä½¿ç”¨å…ƒä»¶èˆ‡çµ„åˆåŠŸèƒ½ckeditor componentsï¼š editorï¼šå®šç¾©ç·¨è¼¯å™¨ä½¿ç”¨çš„çµ„ä»¶ v-modelï¼šè³‡æ–™é›™å‘ç¶å®š configï¼šå®šç¾©è¨­å®šæª” // components/TheCkeditor.client.vue&lt;template&gt; &lt;div&gt; &lt;ckeditor :editor=\"ClassicEditor\" v-model=\"editorData\" :config=\"editorConfig\"&gt; &lt;/ckeditor&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;import CKEditor from '@ckeditor/ckeditor5-vue';import ClassicEditor from '@ckeditor/ckeditor5-build-classic';const ckeditor = defineComponent(CKEditor.component);const editorData = ref('content of the editor');const editorConfig = { placeholder: 'type the content here'}&lt;/script&gt; @ckeditor/ckeditor5-build-classic å°‡ç›¸é—œåŠŸèƒ½åŒ…è£æˆçµ„ä»¶ï¼Œä½¿ç”¨æ–¹å¼éå¸¸ç°¡å–®ï¼Œä½†ç„¡æ³•å¦å¤–æ“´å……åŠŸèƒ½ï¼Œå›  @ckeditor/ckeditor5-build-classic å·²å°‡ç›¸ä¾å¥—ä»¶å®‰è£é€²å»ï¼Œé‡è¤‡å®‰è£æœƒæ‹‹éŒ¯èª¤ï¼š CKEditorError: ckeditor-duplicated-modules CKEditor åœ¨åˆå§‹åŒ–æ™‚å› æ¨¡çµ„é‡è¤‡åŸ·è¡Œå°è‡´éŒ¯èª¤ï¼Œéœ€æ”¹ç”¨ä»¥ä¸‹ã€Œè‡ªè¡Œé…ç½®åŠŸèƒ½ã€ 2. è‡ªè¡Œé…ç½®åŠŸèƒ½é¸æ“‡å°ˆæ¡ˆéœ€è¦çš„åŠŸèƒ½ï¼Œå¯ä»¥å½ˆæ€§çš„å®¢è£½åŒ–çµ„åˆæ–‡å­—ç·¨è¼¯å™¨ æ³¨æ„ï¼šæ‰€æœ‰ ckeditor å¥—ä»¶ç‰ˆæœ¬å¿…é ˆç›¸åŒï¼ˆé™¤äº† @ckeditor/ckeditor5-dev-*ã€@ckeditor/ckeditor5-vue è·Ÿ @ckeditor/vite-plugin-ckeditor5ï¼‰ å¥—ä»¶å®‰è£ å®‰è£ Vue / Vite æ•´åˆå¥—ä»¶ npm install --save \\ @ckeditor/vite-plugin-ckeditor5 \\ @ckeditor/ckeditor5-vue å®‰è£é è¨­ä¸»é¡Œæ¨£å¼ npm install --save @ckeditor/ckeditor5-theme-lark è‡ªé¸åŠŸèƒ½ï¼ˆåŠŸèƒ½çœ¾å¤šä¸ä¸€ä¸€èªªæ˜ï¼‰ ä»¥ä¸‹èˆ‰ä¾‹ï¼š @ckeditor/ckeditor5-editor-classicï¼štoolbar style @ckeditor/ckeditor5-paragraphï¼šparagraph style @ckeditor/ckeditor5-essentialsï¼šselectAllã€undoã€redo â€¦ @ckeditor/ckeditor5-fontï¼šfontSizeã€fontFamilyã€fontColorã€fontBackgroundColor @ckeditor/ckeditor5-basic-stylesï¼šboldã€italicã€underlineã€strikethroughã€code â€¦ @ckeditor/ckeditor5-linkï¼šlinkã€linkImage npm install --save \\ @ckeditor/ckeditor5-editor-classic \\ @ckeditor/ckeditor5-paragraph \\ @ckeditor/ckeditor5-essentials \\ @ckeditor/ckeditor5-font \\ @ckeditor/ckeditor5-basic-styles \\ @ckeditor/ckeditor5-link nuxt.config é…ç½®// nuxt.config.jsimport ckeditor5 from '@ckeditor/vite-plugin-ckeditor5';export default defineNuxtConfig({ vite: { plugins: [ ckeditor5({ theme: require.resolve('@ckeditor/ckeditor5-theme-lark') }) ] }}); ä½¿ç”¨å…ƒä»¶èˆ‡è‡ªé¸åŠŸèƒ½ckeditor componentsï¼š editorï¼šå®šç¾©ç·¨è¼¯å™¨ä½¿ç”¨çš„çµ„ä»¶ v-modelï¼šè³‡æ–™é›™å‘ç¶å®š configï¼šå®šç¾©è¨­å®šæª” placeholderï¼šç·¨è¼¯å™¨ä½”ä½ç¬¦ pluginsï¼šä½¿ç”¨æ’ä»¶ toolbarï¼šé…ç½®å·¥å…·åˆ—ï¼Œå¯ä»¥åŠ æ’å…¥åˆ†éš”ç¬¦è™Ÿ | // components/TheCkeditor.client.vue&lt;template&gt; &lt;div&gt; &lt;ckeditor :editor=\"ClassicEditor\" v-model=\"editorData\" :config=\"editorConfig\"&gt; &lt;/ckeditor&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;import CKEditor from '@ckeditor/ckeditor5-vue';import { ClassicEditor } from '@ckeditor/ckeditor5-editor-classic';import { FontSize, FontFamily, FontColor, FontBackgroundColor } from '@ckeditor/ckeditor5-font';import { Bold, Italic, Underline, Strikethrough } from '@ckeditor/ckeditor5-basic-styles';import { Link } from '@ckeditor/ckeditor5-link';import { Paragraph } from '@ckeditor/ckeditor5-paragraph';import { Essentials } from '@ckeditor/ckeditor5-essentials';const ckeditor = defineComponent(CKEditor.component);const editorData = ref('content of the editor');const editorConfig = { placeholder: 'type the content here', plugins: [ FontSize, FontFamily, FontColor, FontBackgroundColor, Bold, Italic, Underline, Strikethrough, Link, Paragraph, Essentials ], toolbar: { items: [ 'fontSize', 'fontFamily', 'fontColor', 'fontBackgroundColor', '|', 'bold', 'italic', 'underline', 'strikethrough', '|', 'link', '|', 'undo', 'redo', '|' ], // RWD è‡ªå‹•æ›è¡Œ shouldNotGroupWhenFull: true }, fontSize: { // è‡ªè¨‚ç¾©å­—ç´šé¸é … options: [ 12, 14, 16, 18, 20, 24, 28, 30, 32 ] }, link: { // é»æ“Šé€£çµå¦èµ·æ–°åˆ†é  addTargetToExternalLinks: true }};&lt;/script&gt; ç•«é¢å‘ˆç¾å¦‚ä¸‹ï¼š è‡ªè¨‚ CSS æ¨£å¼å‰é¢æåˆ°é€é @ckeditor/ckeditor5-theme-lark å®šç¾©äº†é è¨­æ¨£å¼ï¼Œå¦‚æœæƒ³ä¾ç…§å°ˆæ¡ˆéœ€æ±‚èª¿æ•´é…è‰²ï¼Œåªè¦ä¿®æ”¹ CKEditor çš„ CSS è‡ªè¨‚è®Šæ•¸å³å¯ï¼š &lt;style&gt;:root { /* Overrides the border radius setting in the theme. */ --ck-border-radius: 4px; /* Overrides the default font size in the theme. */ --ck-font-size-base: 14px; /* Helper variables to avoid duplication in the colors. */ --ck-custom-background: hsl(177, 16%, 49%); --ck-custom-foreground: hsl(166, 21%, 65%); --ck-custom-border: hsl(161, 18%, 28%); --ck-custom-white: hsl(0, 0%, 100%); /* -- Overrides generic colors. ------------------------------------------------------------- */ --ck-color-base-foreground: var(--ck-custom-background); --ck-color-focus-border: hsl(177, 16%, 49%); --ck-color-text: hsl(0, 0%, 98%); --ck-color-shadow-drop: hsla(0, 0%, 0%, 0.2); --ck-color-shadow-inner: hsla(0, 0%, 0%, 0.1); --ck-color-button-on-color: hsl(0, 0%, 100%); --ck-color-base-active: hsl(0, 0%, 100%); --ck-color-base-active-focus: hsl(0, 0%, 100%); /* -- Overrides the default .ck-button class colors. ---------------------------------------- */ --ck-color-button-default-background: var(--ck-custom-background); --ck-color-button-default-hover-background: hsl(177, 16%, 49%); --ck-color-button-default-active-background: hsl(177, 16%, 49%); --ck-color-button-default-active-shadow: hsl(177, 16%, 49%); --ck-color-button-default-disabled-background: var(--ck-custom-background); --ck-color-button-on-background: var(--ck-custom-foreground); --ck-color-button-on-hover-background: var(--ck-custom-foreground); --ck-color-button-on-active-background: var(--ck-custom-foreground); --ck-color-button-on-active-shadow: hsl(177, 16%, 49%); --ck-color-button-on-disabled-background: var(--ck-custom-foreground); --ck-color-button-action-background: hsl(168deg 76% 42%); --ck-color-button-action-hover-background: hsl(168deg 76% 38%); --ck-color-button-action-active-background: hsl(168deg 76% 36%); --ck-color-button-action-active-shadow: hsl(168deg 75% 34%); --ck-color-button-action-disabled-background: hsl(168deg 76% 42%); --ck-color-button-action-text: var(--ck-custom-white); --ck-color-button-save: hsl(120deg 100% 46%); --ck-color-button-cancel: hsl(15deg 100% 56%); /* -- Overrides the default .ck-dropdown class colors. -------------------------------------- */ --ck-color-dropdown-panel-background: var(--ck-custom-background); --ck-color-dropdown-panel-border: var(--ck-custom-foreground); /* -- Overrides the default .ck-splitbutton class colors. ----------------------------------- */ --ck-color-split-button-hover-background: var(--ck-color-button-default-hover-background); --ck-color-split-button-hover-border: var(--ck-custom-foreground); /* -- Overrides the default .ck-input class colors. ----------------------------------------- */ --ck-color-input-background: var(--ck-custom-background); --ck-color-input-border: hsl(257deg 3% 43%); --ck-color-input-text: hsl(24deg 21% 31%); --ck-color-input-disabled-background: hsl(255deg 4% 21%); --ck-color-input-disabled-border: hsl(250deg 3% 38%); --ck-color-input-disabled-text: hsl(0deg 0% 78%); /* -- Overrides the default .ck-labeled-field-view class colors. ---------------------------- */ --ck-color-labeled-field-label-background: var(--ck-custom-background); /* -- Overrides the default .ck-list class colors. ------------------------------------------ */ --ck-color-list-background: var(--ck-custom-background); --ck-color-list-button-hover-background: hsl(24deg 27% 54% / 20%); --ck-color-list-button-on-background: var(--ck-color-base-active); --ck-color-list-button-on-background-focus: var(--ck-color-base-active-focus); --ck-color-list-button-on-text: var(--ck-color-base-background); /* -- Overrides the default .ck-balloon-panel class colors. --------------------------------- */ --ck-color-panel-background: var(--ck-custom-background); --ck-color-panel-border: var(--ck-custom-border); /* -- Overrides the default .ck-toolbar class colors. --------------------------------------- */ --ck-color-toolbar-background: var(--ck-custom-background); --ck-color-toolbar-border: var(--ck-custom-border); /* -- Overrides the default .ck-tooltip class colors. --------------------------------------- */ --ck-color-tooltip-background: hsl(252deg 7% 14%); --ck-color-tooltip-text: hsl(0deg 0% 93%); /* -- Overrides the default colors used by the ckeditor5-image package. --------------------- */ --ck-color-image-caption-background: hsl(0deg 0% 97%); --ck-color-image-caption-text: hsl(0deg 0% 20%); /* -- Overrides the default colors used by the ckeditor5-widget package. -------------------- */ --ck-color-widget-blurred-border: hsl(0deg 0% 87%); --ck-color-widget-hover-border: hsl(43deg 100% 68%); --ck-color-widget-editable-focus-background: var(--ck-custom-white); /* -- Overrides the default colors used by the ckeditor5-link package. ---------------------- */ --ck-color-link-default: hsl(190deg 100% 75%); /* -- Overrides the default content border. -------------------- */ --ck-color-base-border: var(--ck-custom-border); /* Configure the z-index of the editor UI, so when inside a Bootstrap modal, it will be rendered over the modal. */ --ck-z-default: 100 !important; --ck-z-modal: calc( var(--ck-z-default) + 2000 ) !important;}&lt;/style&gt; èª¿æ•´å¾Œç•«é¢ï¼š åƒè€ƒè³‡æºï¼š https://ckeditor.com/docs/ckeditor5/latest/installation/integrations/vuejs-v3.htmlhttps://ckeditor.com/docs/ckeditor5/latest/installation/advanced/alternative-setups/integrating-from-source-vite.htmlhttps://ckeditor.com/docs/ckeditor5/latest/framework/deep-dive/ui/theme-customization.html","link":"/2023/08/08/nuxt3/nuxt-v3-ckeditor5/"},{"title":"Nuxt.js 3.x Components ç›®éŒ„ï¼å»ºç«‹å…±ç”¨å…ƒä»¶","text":"æœ¬ç¯‡æ–‡ç« åŒæ­¥ç™¼è¡¨æ–¼ 2023 iThome éµäººè³½ Components ç›®éŒ„ç”¨ä¾†å®šç¾© Vue å…±ç”¨å…ƒä»¶ï¼Œå…ƒä»¶çš„ç‰¹æ€§ç‚ºå°‡éƒ¨åˆ†æ¨¡æ¿ã€ç¨‹å¼ç¢¼é€²è¡Œå°è£ï¼Œè®“æˆ‘å€‘å¯ä»¥é‡è¤‡ä½¿ç”¨ã€‚åœ¨ Components å»ºç«‹çš„æª”æ¡ˆï¼ŒNuxt æœƒè‡ªå‹•å¼•å…¥ï¼ˆauto-importï¼‰ï¼Œæ¥è‘—åœ¨æ•´å€‹å°ˆæ¡ˆ pages / components / layouts éƒ½èƒ½æ­é…ä½¿ç”¨ å»ºç«‹å…ƒä»¶components/|â€”â€” TheHeader.vue|â€”â€” TheFooter.vue // components/TheHeader.vue&lt;template&gt; &lt;nav&gt; Header &lt;/nav&gt;&lt;/template&gt; é é¢ä½¿ç”¨å…ƒä»¶ // pages/index.vue&lt;template&gt; &lt;div&gt; &lt;TheHeader /&gt; &lt;h1&gt;Home Page&lt;/h1&gt; &lt;/div&gt;&lt;/template&gt; å…ƒä»¶åç¨±å…ƒä»¶åç¨±è¦å‰‡ï¼šè·¯å¾‘å‰ç¶´ï¼ˆpathPrefixï¼‰ + å…ƒä»¶åç¨± ç¯„ä¾‹ï¼šå·¢ç‹€ç›®éŒ„çµæ§‹å¦‚ä¸‹ components/|â€”â€” home/ |â€”â€” CustomButton.vue ä½¿ç”¨å…ƒä»¶åç¨± &lt;HomeCustomButton /&gt; ç§»é™¤ / èª¿æ•´è·¯å¾‘å‰ç¶´å¦‚æœå…ƒä»¶åç¨±ä¸æƒ³åŠ ä¸Šè·¯å¾‘å‰ç¶´ï¼Œåœ¨ nuxt.config åŠ ä¸Š pathPrefix: falseï¼Œä½¿ç”¨components/home/Button.vue å…ƒä»¶åç¨±ç‚º &lt;CustomButton /&gt; // nuxt.config.jsexport default defineNuxtConfig({ components: [ { path: '~/components', pathPrefix: false } ]}); æˆ–æ˜¯èª¿æ•´å‰ç¶´åç¨±ï¼Œå°‡ components/home/Button.vue å…ƒä»¶åç¨±èª¿æ•´ç‚º &lt;SpecialCustomButton /&gt; // nuxt.config.jsexport default defineNuxtConfig({ components: [ { path: '~/components', pathPrefix: true, prefix: 'Special' } ]}); å‹•æ…‹å…ƒä»¶ä½¿ç”¨ &lt;component :is=\"componentName\"&gt; å‹•æ…‹æ¸²æŸ“å…ƒä»¶ï¼Œæ­é… resolveComponent è¼”åŠ©å‡½å¼å¼•å…¥å…ƒä»¶ ç¯„ä¾‹ï¼šå…ƒä»¶å…§å®¹å¦‚ä¸‹ components/|â€”â€” BasePrevButton.vue|â€”â€” BaseNextButton.vue é é¢ä¸Šä½¿ç”¨å‹•æ…‹å…ƒä»¶ // pages/index.vue&lt;template&gt; &lt;div&gt; &lt;component :is=\"isPrev ? BasePrevButton : BaseNextButton\" /&gt; &lt;button @click=\"isPrev = !isPrev\"&gt;Toggle Button&lt;/button&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;const isPrev = ref(true);const BasePrevButton = resolveComponent('BasePrevButton');const BaseNextButton = resolveComponent('BaseNextButton');&lt;/script&gt; Lazy Loading å»¶é²è¼‰å…¥å…ƒä»¶å»¶é²è¼‰å…¥å°±æ˜¯è¼‰å…¥é é¢æ™‚ï¼Œä¸æœƒç«‹å³è¼‰å…¥å…ƒä»¶ï¼Œç­‰åˆ°ä½¿ç”¨å…ƒä»¶æ™‚æ‰åŠ ä»¥è¼‰å…¥ï¼Œæ¸›ç·©è³‡æºæ¶ˆè€—ï¼Œæå‡ç¶²é è¼‰å…¥é€Ÿåº¦ï¼Œåƒæ˜¯ Notifyã€Modalã€Footer ç­‰å…ƒä»¶éƒ½é©åˆä½¿ç”¨ å°å…¥æ–¹å¼å¾ˆç°¡å–®ï¼Œåœ¨ä½¿ç”¨å…ƒä»¶æ™‚åŠ ä¸Š Lazy å‰ç¶´å°±å¯ä»¥ // pages/index.vue&lt;template&gt; &lt;div&gt; &lt;TheHeader /&gt; &lt;h1&gt;Home Page&lt;/h1&gt; &lt;!-- ... --&gt; &lt;LazyTheFooter /&gt; &lt;/div&gt;&lt;/template&gt; èª¿æ•´å…ƒä»¶æ¸²æŸ“æ™‚æ©Ÿï¼ˆserver or clientï¼‰åœ¨æª”ååŠ ä¸Š .client æˆ–æ˜¯ .server å¾Œç¶´å³å¯ï¼Œå…©è€…å¯ä»¥æ­é…ä½¿ç”¨ï¼š components/|â€”â€” Poster.server.vue|â€”â€” Poster.client.vue æ³¨æ„ï¼š .server ç›®å‰é‚„åœ¨å¯¦é©—éšæ®µï¼Œéœ€åœ¨ nuxt.config å•Ÿç”¨åŠŸèƒ½ // nuxt.config.jsexport default defineNuxtConfig({ experimental: { componentIslands: true }}) ä½¿ç”¨ Poster å…ƒä»¶ï¼ŒåŸ·è¡Œé †åºå¦‚ä¸‹ï¼š åœ¨ server ç«¯å…ˆæ¸²æŸ“ Poster.server æ¥è‘—åœ¨ client ç«¯ mouted ç”Ÿå‘½é€±æœŸæ¸²æŸ“ Poster.client // pages/index.vue&lt;template&gt; &lt;div&gt; &lt;Poster /&gt; &lt;/div&gt;&lt;/template&gt; è¦é™åˆ¶å…ƒä»¶åœ¨ client ç«¯æ¸²æŸ“ï¼Œå¯ä»¥æ­é… &lt;ClientOnly&gt; Nuxt å…§å»ºå…ƒä»¶ // pages/index.vue&lt;template&gt; &lt;div&gt; &lt;ClientOnly&gt; &lt;Poster /&gt; &lt;/ClientOnly&gt; &lt;/div&gt;&lt;/template&gt; ç•¶æˆ‘å€‘ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹å¥—ä»¶å®šç¾©äº†&nbsp;windowã€document&nbsp;ç­‰ç€è¦½å™¨å…¨åŸŸè®Šæ•¸ï¼Œç›´æ¥ä½¿ç”¨ç›¸é—œå…ƒä»¶æ™‚æœƒæ‹‹éŒ¯èª¤ window is not definedï¼Œå› ç‚º server ç«¯é æ¸²æŸ“æ™‚æ‰¾ä¸åˆ°è®Šæ•¸ï¼Œé€™æ™‚å€™å°±å¯ä»¥æ­é… &lt;ClientOnly&gt; ä½¿ç”¨ åƒè€ƒè³‡æºï¼š https://nuxt.com/docs/guide/directory-structure/componentshttps://v3.ru.vuejs.org/guide/component-dynamic-async.html","link":"/2023/09/11/nuxt3/nuxt-v3-components/"},{"title":"Nuxt.js 3.x Composables vs Utils ç›®éŒ„ï¼è‡ªè¨‚å…±ç”¨æ–¹æ³•","text":"æœ¬ç¯‡æ–‡ç« åŒæ­¥ç™¼è¡¨æ–¼ 2023 iThome éµäººè³½ å®šç¾©åœ¨ composables ä»¥åŠ utils è³‡æ–™å¤¾çš„æª”æ¡ˆ Nuxt éƒ½æœƒè‡ªå‹•å¼•å…¥ï¼ˆauto-importsï¼‰ï¼Œå…©è€…éƒ½æ˜¯ç”¨ä¾†å®šç¾©è¤‡ç”¨é‚è¼¯çš„å‡½å¼ï¼Œä¸éä½¿ç”¨æƒ…å¢ƒæœ‰é»ä¸åŒï¼Œæ¥ä¸‹ä¾†åˆ†åˆ¥èªªæ˜ã€‚ Composables &amp; Utils ä½¿ç”¨æ™‚æ©Ÿæ¯”è¼ƒ composibles/ï¼šçµ„åˆå¼å‡½å¼ï¼Œåˆ©ç”¨ Composition API ä¾†å°è£å’Œè¤‡ç”¨ æœ‰ç‹€æ…‹é‚è¼¯ï¼ˆStateful Logicï¼‰çš„å‡½å¼ï¼Œå–ä»£ Options API mixins/ çš„åŠŸèƒ½ã€‚æˆ‘å€‘å¯ä»¥å°‡ä¸åŒçš„é‚è¼¯æŠ½è±¡æˆå–®ç¨çš„ composableï¼Œä¸¦çµ„åˆåœ¨ setup å‡½å¼ä¸­ utils/ï¼šèˆ‡ composibles åšèªæ„ä¸Šçš„å€éš”ï¼Œç”¨ä¾†å®šç¾© ç„¡ç‹€æ…‹é‚è¼¯ï¼ˆStateless Logicï¼‰çš„å‡½å¼ ç‹€æ…‹é‚è¼¯èªªæ˜ï¼š ç„¡ç‹€æ…‹é‚è¼¯å‡½å¼ï¼šä¾‹å¦‚è¨ˆç®—å…©å€‹æ•¸å­—ç›¸åŠ çš„å‡½å¼ã€‚ç•¶è¼¸å…¥å€¼å¾Œï¼Œç¶“éå‡½å¼é‹ç®—è¿”å›å€¼ï¼Œä¸æœƒå—å…¶ä»–ç‹€æ…‹å½±éŸ¿ã€‚ç„¡è«–ä½•æ™‚è¼¸å…¥ç›¸åŒçš„å€¼ï¼Œéƒ½å¯ä»¥å¾—åˆ°ç›¸åŒçµæœï¼Œå¤§éƒ¨åˆ†å°è£å…±ç”¨æ–¹æ³•å±¬æ–¼æ­¤é¡ æœ‰ç‹€æ…‹é‚è¼¯å‡½å¼ï¼šä¾‹å¦‚è¨ˆæ•¸å™¨å‡½å¼ï¼Œå‡½å¼æœƒæ§åˆ¶è®Šæ•¸ã€‚è§¸ç™¼å‡½å¼æ™‚ï¼Œç‹€æ…‹å°±æœƒæ”¹è®Šï¼Œæ¯æ¬¡è§¸ç™¼çš„çµæœä¸æœƒç›¸åŒ ComposablesOptions API Mixins &amp; Composition API ComposablesNuxt3 çš„ Composition API composibles/ èˆ‡ Nuxt2 çš„ Options API mixins/ æ¯”è¼ƒï¼š mixins/ï¼šç•¶å°ˆæ¡ˆé‚è¼¯è¶Šä¾†è¶Šè¤‡é›œï¼Œä½¿ç”¨å¤šå€‹ mixins æ™‚ï¼Œå®¹æ˜“ç™¼ç”Ÿä¸æ˜“æ‰¾åˆ°åƒæ•¸ã€æ–¹æ³•ä¾†æºï¼Œæˆ–æ˜¯å‘½åè¡çªçš„å•é¡Œï¼Œä¸” Options API æ˜¯ä¾ç…§ ã€Œç”Ÿå‘½é€±æœŸèˆ‡æ€§è³ªã€ æ‹†åˆ†ç¨‹å¼ç¢¼ï¼Œçµæ§‹ä¸Šä¾†èªªå¯è®€æ€§è¼ƒä½ composibles/ï¼šComposition API æ˜¯ä¾æ“š ã€Œé‚è¼¯åŠŸèƒ½ã€ æ‹†åˆ†ç¨‹å¼ç¢¼ï¼Œå¯è®€æ€§è¼ƒé«˜ï¼Œä¸”ä¸æ˜“é€ æˆå‘½åè¡çªï¼Œé©ç”¨æ–¼é«˜è¤‡é›œé‚è¼¯å’Œå¤šåŠŸèƒ½é–‹ç™¼ ç”¨æ³•ä¸€ï¼šå…·ååŒ¯å‡ºå…·ååŒ¯å‡ºæœƒè®€å– å‡½å¼åç¨± // composables/test.jsexport const useCount = () =&gt; { const count = ref(0); const add = () =&gt; { count.value++; }; return { count, add };} ç”¨æ³•äºŒï¼šåŒ¿ååŒ¯å‡ºåŒ¿ååŒ¯å‡ºæœƒè®€å– æª”åï¼Œä»¥æ­¤ç‚ºä¾‹å‘½åç‚º useCount.js æˆ– use-count.jsï¼Œçµ„åˆå¼å‡½å¼åç¨±åŒç‚º useCount() // composables/useCount.js or composables/use-count.jsexport default function() { const count = ref(0); const add = () =&gt; { count.value++; }; return { count, add };} é é¢ä½¿ç”¨çµ„åˆå‡½å¼ // pages/index.vue&lt;template&gt; &lt;div&gt; {{ count }} &lt;button type=\"button\" @click=\"add\"&gt;add&lt;/button&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;const { count, add } = useCount();&lt;/script&gt; å»¶ä¼¸æ‡‰ç”¨ åœ¨ composable å…§ä½¿ç”¨å…¶å®ƒ composable ä½¿ç”¨ plugin injections // composables/useCount.jsexport const function() { const { x, y } = usePosition(); const { $hello } = useNuxtApp(); // ...} Utilsåç¨±å®šç¾©æ–¹å¼åŒ composables/ ç”¨æ³•ä¸€ï¼šå…·ååŒ¯å‡ºå…·ååŒ¯å‡ºæœƒè®€å– å‡½å¼åç¨± // utils/test.jsexport const toThousands = () =&gt; { if (!num) { return num; } const parts = num.toString().split('.'); parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, ','); return parts.join('.');} ç”¨æ³•äºŒï¼šåŒ¿ååŒ¯å‡ºåŒ¿ååŒ¯å‡ºæœƒè®€å– æª”åï¼Œä»¥æ­¤ç‚ºä¾‹å‘½åç‚º toThousands.js æˆ– to-thousands.js ç·¨è­¯å¾Œåç¨±åŒç‚º toThousands() // utils/toThousands.js or utils/to-thousands.jsexport default num =&gt; { if (!num) { return num; } const parts = num.toString().split('.'); parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, ','); return parts.join('.');}; ä½¿ç”¨ Utils // pages/index.vue&lt;template&gt; &lt;div&gt; $ {{ {{ toThousands(19999) }} }} &lt;/div&gt;&lt;/template&gt; åŸ·è¡Œçµæœï¼š $ 19,999 åƒè€ƒè³‡æºï¼š https://nuxt.com/docs/guide/directory-structure/composableshttps://nuxt.com/docs/guide/directory-structure/utilshttps://ithelp.ithome.com.tw/articles/10279321","link":"/2023/07/11/nuxt3/nuxt-v3-composables-vs-utils/"},{"title":"Nuxt.js 3.x Data fetching ä¸²æ¥ APIï¼$fetchã€useAsyncDataã€useFetch","text":"æœ¬ç¯‡æ–‡ç« åŒæ­¥ç™¼è¡¨æ–¼ 2023 iThome éµäººè³½ å…ˆå‰åœ¨ Nuxt2 ä»‹ç´¹å¦‚ä½•ä½¿ç”¨ axios å–å¾— API è³‡æ–™ï¼ˆæ–‡ç« é€£çµï¼‰ Nuxt3 æä¾›äº†å…¨åŸŸå¯ä½¿ç”¨çš„å…§å»ºå‡½å¼åº« $fetch ä»¥åŠ composables useFetchã€useAsyncDataï¼Œä¸éœ€è¦åœ¨å¦å¤–å®‰è£å¥—ä»¶ï¼Œä¸‰å€‹æ–¹æ³•ä¾æ“šæ™‚æ©Ÿæ­é…ä½¿ç”¨ï¼Œå¯ä»¥ç¢ºä¿æ•´é«”å…¼å®¹æ€§èˆ‡å¿«å–æ•ˆèƒ½ï¼Œä¸”èƒ½é¿å…é‡è¤‡è«‹æ±‚çš„å•é¡Œ Nuxt2 çš„ asyncData ä»¥åŠ fetch æ–¹æ³•ï¼Œåœ¨ Nuxt3 èª¿æ•´ç‚º useAsyncData èˆ‡ useFetch $fetchNuxt3 ä½¿ç”¨ ofetch å»ºç«‹å…¨åŸŸä½¿ç”¨ $fetch æ–¹æ³•ï¼Œé©åˆç”¨ä¾†è™•ç† é€éä½¿ç”¨è€…äº’å‹•è§¸ç™¼çš„ API è«‹æ±‚ $fetch ä¸é©åˆç›´æ¥å®šç¾©åœ¨ setup functionï¼Œæœƒå°è‡´ API è«‹æ±‚å…©æ¬¡ï¼šä¼ºæœå™¨ç«¯è·Ÿç”¨æˆ¶ç«¯å„ä¸€æ¬¡ï¼Œå› ç‚º $fetch ä¸æœƒå°‡ç‹€æ…‹å¾ä¼ºæœå™¨ç«¯å‚³è¼¸åˆ°ç”¨æˆ¶ç«¯ï¼Œå¦‚æœè¦åœ¨ setup function å®šç¾©ï¼Œå®˜æ–¹å»ºè­°ä½¿ç”¨ useFetch æˆ–æ˜¯ useAsyncData + $fetch ä½¿ç”¨æ–¹å¼ï¼š $fetch(url, options) åƒæ•¸ï¼š urlï¼šAPI url options method baseURL body ignoreResponseErrorï¼šæ˜¯å¦å¿½ç•¥ status error retryï¼šç™¼ç”ŸéŒ¯èª¤æ™‚é‡æ–°è«‹æ±‚æ¬¡æ•¸ï¼ˆé è¨­ 1ï¼ŒPOSTã€PUTã€PATCHã€DELETE é è¨­ 0ï¼‰ query Interceptorsï¼šæ””æˆªå™¨ï¼ŒåŒ…å« onRequestã€onRequestErrorã€onResponseã€onResponseErrorï¼Œè¦‹ä¸‹é¢èªªæ˜ ç¯„ä¾‹ï¼šå°‡ $fetch åŒ…è£åœ¨ submit() æ–¹æ³•å…§ï¼Œå¡«å¯«å®Œè¡¨å–®å¾Œï¼ŒæŒ‰ä¸‹é€å‡ºç™¼å‡º API è«‹æ±‚ &lt;template&gt; &lt;div&gt; &lt;label for=\"name\"&gt;name&lt;/label&gt; &lt;input type=\"text\" name=\"name\" v-model=\"user.name\"&gt; &lt;label for=\"phone\"&gt;phone&lt;/label&gt; &lt;input type=\"text\" name=\"phone\" v-model=\"user.phone\"&gt; &lt;button type=\"button\" @click=\"submit()\"&gt;submit&lt;/button&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;const user = reactive({ name: '', phone: ''});const submit = async () =&gt; { const response = await $fetch('/api/user', { method: 'POST', body: { ...user } }); console.log('success', response);};&lt;/script&gt; ä½¿ç”¨æ””æˆªå™¨ï¼ˆinterceptorsï¼‰const response = await $fetch('/api/user', { onRequest({ request, options }) { // è¨­å®šè«‹æ±‚æ™‚çš„ headers options.headers.authorization = '...' }, onRequestError({ request, options, error }) { // æ•æ‰è«‹æ±‚æ™‚ç™¼ç”Ÿçš„éŒ¯èª¤ }, onResponse({ request, response, options }) { // è™•ç†è«‹æ±‚å›è¦†è³‡æ–™ return response._data; }, onResponseError({ request, response, options }) { // æ•æ‰è«‹æ±‚å›è¦†æ™‚ç™¼ç”Ÿçš„éŒ¯èª¤ }}) useAsyncDataéåŒæ­¥å‡½å¼çš„å°è£çµ„åˆæ–¹æ³•ï¼Œä¸¦ä¸èƒ½ç›´æ¥ç™¼å‡º API è«‹æ±‚ï¼Œè¦æ­é… handler éåŒæ­¥å‡½å¼ä½¿ç”¨ï¼Œåœ¨ setup function ç›´æ¥è§¸ç™¼ï¼Œæ–¼ä¼ºæœå™¨ç«¯ç™¼å‡ºè«‹æ±‚å–å¾—è³‡æ–™ï¼Œä¸¦å°‡ç‹€æ…‹å‚³è¼¸åˆ°ç”¨æˆ¶ç«¯ ä½¿ç”¨æ–¹å¼ï¼ˆæ­é… $fetch handlerï¼‰ï¼š useAsyncData(key, () =&gt; $fetch(url)) åƒæ•¸ï¼š keyï¼šå”¯ä¸€å€¼ï¼Œç¢ºä¿ API ä¸æœƒé‡è¤‡è«‹æ±‚ï¼Œå¦‚æœæ²’æœ‰æä¾›ï¼ŒuseAsyncData æœƒè‡ªå‹•ç”¢ç”Ÿ handlerï¼šå›å‚³ä¸€å€‹å€¼çš„éåŒæ­¥å‡½å¼ optionsï¼š lazyï¼šæ˜¯å¦åœ¨è·¯ç”±è¼‰å…¥å¾Œæ‰åŸ·è¡ŒéåŒæ­¥å‡½å¼ï¼Œé è¨­ falseï¼Œå› æ­¤æœƒåœ¨å‡½å¼åŸ·è¡Œå®Œæˆï¼Œå–å¾—è³‡æ–™å¾Œæ‰åˆ‡æ›ç•«é¢ defaultï¼šå·¥å» å‡½å¼ï¼Œç”¨ä¾†è¨­å®šéåŒæ­¥å‡½å¼è«‹æ±‚å®Œæˆå‰çš„é è¨­å€¼ï¼Œlazy: true ç‰¹åˆ¥é©ç”¨ serverï¼šæ˜¯å¦åœ¨ä¼ºæœå™¨ç«¯é€²è¡Œè«‹æ±‚ï¼Œé è¨­ true transformï¼šä¸€å€‹å‡½å¼ï¼Œç”¨æ–¼ä¿®æ”¹ handler è«‹æ±‚çš„çµæœ pickï¼šhandler å›å‚³çµæœå¦‚æœç‚ºç‰©ä»¶ï¼Œå¯ä»¥é¸æ“‡éœ€è¦çš„ key çµ„æˆæ–°ç‰©ä»¶ watchï¼šç›£è½éŸ¿æ‡‰å¼è³‡æ–™è®Šæ›´ï¼Œè‡ªå‹•é‡æ–°è«‹æ±‚ immediateï¼šæ˜¯å¦ç«‹å³è§¸ç™¼ï¼Œé è¨­ true å›å‚³å€¼ï¼š dataï¼šéåŒæ­¥å‡½å¼å›å‚³çµæœ pendingï¼šBoolean å€¼ï¼Œç”¨ä¾†è¡¨ç¤ºæ˜¯å¦é‚„åœ¨åŸ·è¡Œä¸­ refresh / executeï¼šé‡æ–°åŸ·è¡Œå‡½å¼ errorï¼šè«‹æ±‚å¤±æ•—çš„å›å‚³ç‰©ä»¶ statusï¼šè¡¨ç¤ºè«‹æ±‚ç‹€æ…‹ï¼ˆâ€idleâ€,&nbsp;â€œpendingâ€,&nbsp;â€œsuccessâ€,&nbsp;â€œerrorâ€ï¼‰ ç¯„ä¾‹ï¼š &lt;template&gt; &lt;div&gt; {{ user }} &lt;button type=\"button\" @click=\"lastUser()\"&gt;prev&lt;/button&gt; &lt;button type=\"button\" @click=\"nextUser()\"&gt;next&lt;/button&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;const id = ref(1);const url = computed(() =&gt; `/api/user/${id.value}`);const { data: user, refresh } = useAsyncData('user', () =&gt; $fetch(url.value));const nextUser = () =&gt; { id.value++; refresh();};const lastUser = () =&gt; { id.value--; refresh();};&lt;/script&gt; useFetchç‚º useAsyncData è·Ÿ $fetch åŒ…è£å¾Œçš„èªæ³•ç³–ï¼Œç­‰åŒæ–¼ï¼šuseAsyncData(key, () =&gt; $fetch(url)) è«‹æ±‚æ™‚æœƒä¾æ“š url è·Ÿ options è‡ªå‹•ç”¢ç”Ÿ keyï¼Œåœ¨ setup function ç›´æ¥è§¸ç™¼ï¼Œæ–¼ä¼ºæœå™¨ç«¯ç™¼å‡ºè«‹æ±‚å–å¾—è³‡æ–™ï¼Œä¸¦å°‡ç‹€æ…‹å‚³è¼¸åˆ°ç”¨æˆ¶ç«¯ã€‚å¯ä»¥ä½¿ç”¨ $fetch çš„æ””æˆªå™¨ onRequestã€onRequestErrorã€onResponseã€onResponseError ä½¿ç”¨æ–¹å¼ï¼š useFetch(url, options) åƒæ•¸ï¼šç¹¼æ‰¿ $fetch è·Ÿ useAsyncData çš„é¸é … å›å‚³å€¼ï¼šç¹¼æ‰¿ useAsyncData çš„å›å‚³å€¼ ç¯„ä¾‹ï¼š &lt;template&gt; &lt;div&gt; {{ data }} &lt;button type=\"button\" @click=\"refresh()\"&gt;refresh&lt;/button&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;const { data, pending, refresh, execute, error, status } = useFetch('/api/users');&lt;/script&gt; ç›£è½åƒæ•¸è®ŠåŒ–è‡ªå‹•ç™¼å‡ºè«‹æ±‚ç•¶åƒæ•¸ç‚ºéŸ¿æ‡‰å¼æ™‚ï¼ˆref,&nbsp;reactive,&nbsp;computedï¼‰ï¼ŒuseFetch æœƒè‡ªå‹•ç™¼å‡ºè«‹æ±‚ ç¯„ä¾‹ï¼šç•¶ç‹€æ…‹æ”¹è®Šï¼ŒuseFetch æœƒè‡ªå‹•é‡æ–°è§¸ç™¼ï¼Œå› æ­¤æˆ‘å€‘åªéœ€è¦å°ˆæ³¨åœ¨ id çš„è®ŠåŒ–å³å¯ &lt;template&gt; &lt;div&gt; {{ userInfo }} &lt;button type=\"button\" @click=\"lastUser()\"&gt;last&lt;/button&gt; &lt;button type=\"button\" @click=\"nextUser()\"&gt;next&lt;/button&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;const id = ref(1);const url = computed(() =&gt; `/api/user/${id.value}`);const { data: userInfo } = useFetch(url);const lastUser = () =&gt; { id.value--;};const nextUser = () =&gt; { id.value++;};&lt;/script&gt; æ¯”è¼ƒç¯„ä¾‹ï¼šä½¿ç”¨ $fetch å–ä»£ useFetch å‰é¢æåˆ°ä½¿ç”¨ $fetch è«‹æ±‚éœ€é€éå‡½å¼åŒ…è£ï¼Œå¦‚ä»¥ä¸‹ç¯„ä¾‹ getData()ï¼Œä»¥é¿å…é‡è¤‡è«‹æ±‚ï¼Œé™¤äº†éœ€åœ¨ç”Ÿå‘½é€±æœŸå…ˆå‘¼å« getData()ï¼Œç•¶ id æ›´æ–°æ™‚ä¹Ÿéœ€è¦æ‰‹å‹•è§¸ç™¼ getData()ï¼Œç›¸å°çš„ç¶­è­·è·Ÿæ˜“è®€æ€§è¼ƒä½ &lt;template&gt; &lt;div class=\"m-4\"&gt; {{ userInfo }} &lt;button type=\"button\" @click=\"lastUser()\"&gt;last&lt;/button&gt; &lt;button type=\"button\" @click=\"nextUser()\"&gt;next&lt;/button&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;const id = ref(1);const userInfo = ref({});const getData = async () =&gt; { const response = await $fetch(`/api/user/${id.value}`); userInfo.value = response;};onMounted(() =&gt; { getData();});const lastUser = () =&gt; { id.value--; getData();};const nextUser = () =&gt; { id.value++; getData();};&lt;/script&gt; useLazyAsyncData &amp; useLazyFetchç­‰åŒæ–¼ useAsyncData èˆ‡ useFetch options è¨­å®š lazy: true åƒè€ƒè³‡æºï¼š https://medium.com/comsystoreply/nuxt-3-usefetch-reactive-vue-at-its-best-14729f6f5be7https://ithelp.ithome.com.tw/articles/10298741","link":"/2023/07/19/nuxt3/nuxt-v3-data-fetching/"},{"title":"Nuxt.js 3.x Universalï¼ˆSSRï¼‰å°ˆæ¡ˆéƒ¨ç½²åˆ° Firebase","text":"æœ¬ç¯‡æ–‡ç« åŒæ­¥ç™¼è¡¨æ–¼ 2023 iThome éµäººè³½ å°ˆæ¡ˆé–‹ç™¼å®Œæˆå¾Œï¼Œçµ‚æ–¼åˆ°æœ€å¾Œä¸€æ­¥ã€Œéƒ¨ç½²ã€ï¼Œæœ¬ç¯‡å°‡èªªæ˜ Universal å°ˆæ¡ˆéƒ¨ç½²åˆ° Firebaseã€‚Universal æ¸²æŸ“æ¨¡å¼éœ€è¦ä¼ºæœå™¨æ‰èƒ½é‹ä½œï¼Œå› æ­¤æœƒæ­é… Firebase Cloud Functionsï¼ˆServerlessï¼‰ä¾†å”åŠ©è™•ç† SSR çš„éƒ¨åˆ†ã€‚ Universal Rendering ç›¸é—œèªªæ˜å¯ä»¥åƒè€ƒ é€™ç¯‡æ–‡ç«  å¯¦ä½œåˆ†ç‚ºä»¥ä¸‹æ­¥é©Ÿï¼š ç”³è«‹ Firebase Project é€é CLI éƒ¨ç½²è‡³ Firebase ç”³è«‹ Firebase Projectåˆ° Firebase Console æ–°å¢å°ˆæ¡ˆ é–‹å•Ÿæ–°å¢çš„å°ˆæ¡ˆï¼Œé»æ“Šå»ºæ§‹ â†’ åŠ å…¥ Hosting èˆ‡ Functionï¼ˆéœ€å‡ç´šç‚ºä»˜è²»æ–¹æ¡ˆï¼Œç‚º Pay as you go åˆ¶åº¦ï¼Œå¯ä»¥é™åˆ¶é ç®—ä¸Šé™ï¼‰ åˆ°æ­¤æ­¥ Firebase å°ˆæ¡ˆå°±å»ºç«‹å®Œæˆï¼ŒCloud Function åç¨±ç‚º ã€Œserverã€ å…ˆè¨˜è‘—å°ˆæ¡ˆ IDï¼Œå¾Œé¢éƒ¨ç½²æœƒä½¿ç”¨åˆ° é€é CLI éƒ¨ç½²è‡³ Firebaseæ¥è‘—å›åˆ°æˆ‘å€‘çš„ Nuxt App STEP1ï¼šå®‰è£ CLIé¦–å…ˆåœ¨å…¨åŸŸç’°å¢ƒå®‰è£ Firebase CLIï¼ˆCommand-Line Interfaceï¼‰æŒ‡ä»¤åˆ—å·¥å…· npx install -g firebase-tools STEP2ï¼šç™»å…¥ Firebaseæ¥è‘—é€éæŒ‡ä»¤ç™»å…¥ Firebase firebase login ç™»å…¥æˆåŠŸå¾Œæœƒçœ‹åˆ°å¦‚ä¸‹ç•«é¢ STEP3ï¼šåˆå§‹åŒ– firebase å°ˆæ¡ˆfirebase init hosting æ¥è‘—é¸æ“‡é éƒ¨ç½²çš„ Firebase å°ˆæ¡ˆ IDï¼Œä¹Ÿå°±æ˜¯å‰é¢æ–°å¢çš„å°ˆæ¡ˆ è¨—ç®¡è¨­å®šä¾åºé¸æ“‡å¦‚ä¸‹ï¼Œæ¥è‘—æœƒè‡ªå‹•ç”¢ç”Ÿ firebase.json è·Ÿ .firebaserc å…©æ”¯æª”æ¡ˆ æ³¨æ„ï¼šå¿…é ˆè¦åˆªé™¤ä¸Šä¸€æ­¥é©Ÿè‡ªå‹•ç”¢ç”Ÿçš„ public/404.html è·Ÿ public/index.html å…©å€‹éœæ…‹æª”ï¼Œå¦å‰‡éƒ¨ç½²å¾Œç•«é¢æœƒå—å½±éŸ¿ STEP4ï¼šé…ç½® nuxt.config presetï¼šé è¨­ç‚º node.js serverï¼Œèª¿æ•´ç‚º firebaseï¼Œç•¶åŸ·è¡Œ npm run build æ™‚ï¼Œæœƒç”¢ç”Ÿç¬¦åˆ Firebase è¨—ç®¡æ‰€éœ€çš„æª”æ¡ˆå…§å®¹ firebase.genï¼šé è¨­ä½¿ç”¨ç¬¬ä¸€ä»£ Cloud Functionsï¼Œé€™è£¡èª¿æ•´ç‚ºäºŒä»£ï¼ˆä¸€ã€äºŒä»£æ¯”è¼ƒï¼‰ // nuxt.config.jsexport default defineNuxtConfig({ nitro: { preset: 'firebase', firebase: { gen: 2 } }}); STEP5ï¼šé…ç½® firebase.json èˆ‡ .firebasercfirebasercå¦‚æœå‰é¢æ­¥é©Ÿé‹ä½œé †åˆ©ï¼Œé æœŸ .firebaserc æœƒç¶å®š Firebase å°ˆæ¡ˆ ID å¦‚ä¸‹ï¼Œä¸éœ€ç•°å‹• // .firebaserc{ \"projects\": { \"default\": \"nuxt3-firebase-ca4cb\" }} firebase.jsonéœ€æ‰‹å‹•èª¿æ•´ï¼Œé€™å€‹æ­¥é©Ÿå¾ˆé‡è¦ï¼Œæœƒå½±éŸ¿å°ˆæ¡ˆç·¨è­¯çµæœ functionsï¼ˆCloud Functionsï¼‰ sourceï¼šæŒ‡å®š Cloud Functions ç¨‹å¼ç¢¼è·¯å¾‘ hostingï¼ˆFirebase Hostingï¼‰ siteï¼šFirebase å°ˆæ¡ˆ ID publicï¼šå°ˆæ¡ˆéœæ…‹ç›®éŒ„è·¯å¾‘ rewritesï¼šæ”¹å¯« URL è¦å‰‡ï¼Œæ‰€æœ‰çš„ URL è«‹æ±‚éƒ½æœƒç”±åç‚ºã€Œserverã€çš„ Cloud Functions è™•ç†ï¼Œä¹Ÿå°±æ˜¯ç”±ä¼ºæœå™¨ç«¯è™•ç†æ‰€æœ‰è«‹æ±‚ï¼ˆSSRï¼‰ predeployï¼šéƒ¨ç½²å‰é å…ˆåŸ·è¡Œçš„æŒ‡ä»¤ã€‚é€™ä¸€æ®µçš„è¨­å®šç‚ºï¼šé€²åˆ°ç·¨è­¯å¾Œçš„ .output/server è³‡æ–™å¤¾ï¼Œåˆªé™¤ node_modules ä¸¦é‡æ–°å®‰è£ï¼Œå¦å‰‡åœ¨åŸ·è¡Œéƒ¨ç½²æ™‚æœƒç™¼ç”Ÿæ‰¾ä¸åˆ° firebase-functions å¥—ä»¶çš„éŒ¯èª¤ // firebase.json{ \"functions\": { \"source\": \".output/server\", \"runtime\": \"nodejs18\" }, \"hosting\": { \"public\": \".output/public\", \"cleanUrls\": true, \"rewrites\": [ { \"source\": \"**\", \"function\": \"server\" }], \"predeploy\": [ \"cd .output/server &amp;&amp; rm -rf node_modules &amp;&amp; npm install\" ] }} STEP6ï¼šç·¨è­¯èˆ‡éƒ¨ç½²é¦–å…ˆå°‡å°ˆæ¡ˆæ‰“åŒ… npm run build æ‰“åŒ…å¾Œçš„æª”æ¡ˆæ”¾åœ¨æ ¹ç›®éŒ„ .output è³‡æ–™å¤¾å…§ .output/|â€”â€” public/ |â€”â€” ...|â€”â€” server/ |â€”â€” ...|â€”â€” nitro.json æ¥è‘—éƒ¨ç½²åˆ° Firebase firebase deploy çœ‹åˆ°ä»¥ä¸‹è¨Šæ¯è¡¨ç¤ºéƒ¨ç½²æˆåŠŸå›‰ï¼ æ‰“é–‹ Hosting URLï¼Œå¯ä»¥çœ‹åˆ°æˆ‘å€‘çš„ç¶²ç«™ï¼Œä¹Ÿå¯ä»¥é€é Firebase å„€è¡¨æ¿ä¾†æŸ¥çœ‹ç™¼å¸ƒç´€éŒ„èˆ‡ç”¨é‡ ç¯„ä¾‹æª”ï¼šæœ¬ç¯‡ç¨‹å¼ç¢¼æ”¾åœ¨ GitHub æä¾›åƒè€ƒï¼šé€£çµ åƒè€ƒè³‡æºï¼š https://nitro.unjs.io/deploy/providers/firebasehttps://firebase.google.com/docs/hosting/quickstarthttps://www.youtube.com/watch?v=AzO-KVMx7lo","link":"/2023/10/08/nuxt3/nuxt-v3-deploy-to-firebase/"},{"title":"Nuxt.js 3.x ç›®éŒ„çµæ§‹ Directory Structure","text":"æœ¬ç¯‡æ–‡ç« åŒæ­¥ç™¼è¡¨æ–¼ 2023 iThome éµäººè³½ Nuxt3 å®šç¾©äº†å®Œæ•´çš„ç›®éŒ„è¦å‰‡ï¼Œè®“æˆ‘å€‘å¯ä»¥è¼•é¬†é…ç½®åŠŸèƒ½ï¼Œå°ˆæ³¨åœ¨é–‹ç™¼ä¸Š é€é npx nuxi@latest init &lt;project-name&gt; å®‰è£å°ˆæ¡ˆå¾Œï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹çš„é è¨­ç›®éŒ„ çœ‹èµ·ä¾†åˆ†é¡ä¼¼ä¹æœ‰é»ä¸é½Šå…¨ï¼Œæ¥ä¸‹ä¾†è·Ÿè‘—å®˜æ–¹æ–‡ä»¶ä¸€èµ·å»ºç«‹å®Œæ•´çš„å°ˆæ¡ˆç›®éŒ„ my-app/|â€”â€” .nuxt/|â€”â€” .output/|â€”â€” assets/|â€”â€” components/|â€”â€” composables/|â€”â€” content/|â€”â€” layouts/|â€”â€” middleware/|â€”â€” node_modules/|â€”â€” pages/|â€”â€” plugins/|â€”â€” public/|â€”â€” server/ |â€”â€” api/ |â€”â€” routes/ |â€”â€” middleware/|â€”â€” utils/|â€”â€” .env|â€”â€” .gitignore|â€”â€” .nuxtignore|â€”â€” app.config.ts|â€”â€” app.vue|â€”â€” nuxt.config.ts|â€”â€” package.json|â€”â€” tsconfig.json .nuxtNuxt åœ¨ç·¨è­¯éç¨‹ä¸­ç”Ÿæˆçš„æš«å­˜è³‡æ–™å¤¾ã€‚æ˜¯ Nuxt åŸ·è¡Œç·¨è­¯å’Œ server ç«¯æ¸²æŸ“æ™‚ä½¿ç”¨çš„é‡è¦è³‡æºï¼Œç„¡æ³•æ‰‹å‹•èª¿æ•´è£¡é¢çš„å…§å®¹ï¼ˆæ¯æ¬¡åŸ·è¡Œç·¨è­¯æ™‚æœƒè¦†å¯«ï¼‰ .outputåŸ·è¡Œç”Ÿç”¢ç’°å¢ƒç·¨è­¯ nuxt buildï¼ˆnpm run buildï¼‰æ™‚è‡ªå‹•ç”Ÿæˆçš„è³‡æ–™å¤¾ï¼Œè·Ÿ .nuxt è³‡æ–™å¤¾ä¸€æ¨£ï¼Œæ¯æ¬¡åŸ·è¡Œç·¨è­¯æ™‚æœƒæ›´æ–°è¦†å¯« assetsç”¨ä¾†å­˜æ”¾åƒæ˜¯ CSSã€Sassã€å­—é«”ã€åœ–ç‰‡ç­‰éœ€è¦è¢« webpack æˆ–æ˜¯ Vite ç·¨è­¯çš„éœæ…‹è³‡æºï¼ˆå£“ç¸®ã€æœ€ä½³åŒ–ï¼‰ï¼Œå¦‚ä¸éœ€ç¶“éç·¨è­¯ï¼Œå‰‡å­˜æ”¾æ–¼ public/ componentsç”¨ä¾†å®šç¾© Vue å…±ç”¨å…ƒä»¶ï¼ŒNuxt æœƒè‡ªå‹•å¼•å…¥ï¼Œåç¨±è¦å‰‡ç‚ºï¼šè·¯å¾‘å‰ç¶´ + å…ƒä»¶åç¨±ï¼Œä¾‹å¦‚å·¢ç‹€ç›®éŒ„çµæ§‹å¦‚ä¸‹ components/|â€”â€” base/ |â€”â€” about/ |â€”â€” Button.vue Button.vue çš„å…ƒä»¶åç¨±ç‚º &lt;BaseAboutButton /&gt; composablesçµ„åˆå¼å‡½å¼ï¼Œåˆ©ç”¨ Composition API ä¾†å°è£å’Œè¤‡ç”¨ æœ‰ç‹€æ…‹é‚è¼¯ï¼ˆStateful Logicï¼‰çš„å‡½å¼ï¼Œå–ä»£ Options API mixins çš„åŠŸèƒ½ã€‚å®šç¾©åœ¨ composables/ å…§çš„æª”æ¡ˆ Nuxt æœƒè‡ªå‹•å¼•å…¥ æˆ‘å€‘å¯ä»¥å°‡ä¸åŒçš„é‚è¼¯æŠ½è±¡æˆå–®ç¨çš„ composableï¼Œä¸¦çµ„åˆåœ¨ setup å‡½å¼ä¸­ã€‚æ¯”èµ· mixins ï¼Œcomposable å”åŠ©æˆ‘å€‘æ›´å¥½ç†è§£çµ„ä»¶çš„çµæ§‹å’ŒåŠŸèƒ½ï¼Œä¸¦æé«˜ç¨‹å¼ç¢¼çš„å¯è®€æ€§ ä»¥ composables/useCounter.js ç‚ºä¾‹ // composables/useCounter.jsexport default function() { const count = ref(0); const increment = () =&gt; { count.value++; }; return { count, increment };} åœ¨å…ƒä»¶å…§ä½¿ç”¨å…±ç”¨æ–¹æ³• // pages/count.vue&lt;template&gt; &lt;div&gt; &lt;span&gt;{{ count }}&lt;/span&gt; &lt;button type=\"button\" @click=\"increment\"&gt;add&lt;/button&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;const { count, increment } = useCounter();&lt;/script&gt; composables å’Œ utils æ¯”è¼ƒå¯ä»¥åƒè€ƒ é€™ç¯‡æ–‡ç«  contentæ­é… Nuxt Content å¥—ä»¶ï¼Œå¯ä»¥è®€å– content/ ç›®éŒ„ï¼Œä¸¦è§£æå­˜æ”¾æ–¼æ­¤è³‡æ–™å¤¾å…§çš„ .mdã€.ymlã€.csv&nbsp;ä»¥åŠ&nbsp;.json æª”æ¡ˆï¼Œå»ºç«‹ä¸€å¥—å…§å®¹ç®¡ç†ç³»çµ±ï¼ˆCMSï¼‰ï¼Œä¸»è¦åŠŸèƒ½ï¼š æ­é… components å…ƒä»¶æ¸²æŸ“å†…å®¹ ä½¿ç”¨é¡ä¼¼ mongodb çš„ API ä¾† query æ–‡ç« å…§å®¹ åœ¨ Markdown æ–‡ä»¶ä¸­ä½¿ç”¨ Vue components ä½¿ç”¨ Shiki ç¨‹å¼ç¢¼ highlight è‡ªå‹•æ¸²æŸ“å…§å®¹èˆ‡è·¯ç”± ç°¡å–®ä¾†èªªï¼ŒNuxt Content èƒ½å¤ è§£æ Markdown èªæ³•æ–‡ç« ï¼Œåšåˆ°åƒ Hexo ä¸€æ¨£çš„åŠŸèƒ½ï¼Œå”åŠ©æˆ‘å€‘æ‰“é€ æŠ€è¡“éƒ¨è½æ ¼ Nuxt Content ç›¸é—œæ‡‰ç”¨æ¨è–¦åƒè€ƒ é€™ç¯‡æ–‡ç«  layoutsç”¨ä¾†å­˜æ”¾å…±ç”¨æ¨¡æ¿ï¼Œå®˜æ–¹æ–‡ä»¶æåˆ°ï¼Œå¦‚æœæ•´å€‹å°ˆæ¡ˆåªæœ‰ä¸€å€‹æ¨¡æ¿ï¼Œå»ºè­°ç›´æ¥åœ¨ app.vue å®šç¾©å³å¯ é è¨­æ¨¡æ¿é¦–å…ˆæ–°å¢é è¨­æ¨¡æ¿ layouts/default.vueï¼Œå¿…é ˆåŠ ä¸Š &lt;slot /&gt;ï¼Œå¼•ç”¨çš„é é¢æ‰èƒ½æ’å…¥å…§å®¹ // layouts/default.vue&lt;template&gt; &lt;div&gt; default layout &lt;slot /&gt; &lt;/div&gt;&lt;/template&gt; åœ¨é é¢ä¸Šä½¿ç”¨ layout // app.vue&lt;template&gt; &lt;div&gt; &lt;NuxtLayout&gt; &lt;NuxtPage /&gt; &lt;/NuxtLayout&gt; &lt;/div&gt;&lt;/template&gt; ä½¿ç”¨å…¶ä»–æ¨¡æ¿layouts/|â€”â€” default.vue|â€”â€” custom.vue å¦‚æœæˆ‘å€‘æƒ³åœ¨å–®ä¸€å…ƒä»¶ä½¿ç”¨ custom.vue layoutï¼Œå¯ä»¥ç”¨ definePageMeta è¦†è“‹é è¨­æ¨¡æ¿ // pages/about.vue&lt;script&gt;definePageMeta({ layout: 'custom'});&lt;/script&gt; middlewareNuxt å…§çš„ è·¯ç”±å®ˆè¡›ï¼ˆNavigation Guardsï¼‰ï¼Œç›¸ç•¶æ–¼ Vue Router å…§çš„ beforeEach callbackï¼Œå”åŠ©æˆ‘å€‘åœ¨é€²åˆ°é é¢å‰åŸ·è¡Œä¸€äº›äº‹ä»¶ï¼Œåƒæ˜¯æ¬Šé™æª¢æŸ¥ middleware å®šç¾©æ–¹å¼ï¼š åŒ¿åï¼šç›´æ¥åœ¨å–®ä¸€å…ƒä»¶æª”å…§å®šç¾© å…·åï¼šåœ¨ middleware/ å®šç¾©ï¼Œä¸¦åœ¨éœ€è¦çš„é é¢å¼•å…¥ å…¨åŸŸï¼šåŒå…·åçš„å®šç¾©æ–¹å¼ï¼Œä¸éæª”åéœ€åŠ ä¸Š .global å¾Œç¶´ï¼Œåœ¨æ‰€æœ‰é é¢åˆ‡æ›æ™‚è‡ªå‹•åŸ·è¡Œ middleware/|â€”â€” auth.ts|â€”â€” setup.global.ts å»ºç«‹ä¸€å€‹ middleware // middleware/auth.tsexport default defineNuxtRouteMiddleware((to, from) =&gt; { const auth = useState('auth'); if (!auth.value.isAuth) { return navigateTo('/login'); }}); åœ¨é é¢å…§ä½¿ç”¨ // pages/about.vue&lt;script setup&gt;definePageMeta({ middleware: [ function (to, from) { // åŒ¿åæ–¹å¼ // å®¢è£½ middleware }, 'auth' ]});&lt;/script&gt; pagesç”¨ä¾†é…ç½®ä¸»è¦é é¢çš„è³‡æ–™å¤¾ï¼Œå®šç¾©å¾Œ Nuxt æœƒè‡ªå‹•æ•´åˆ Vue Routerï¼Œä¾ç…§è³‡æ–™å¤¾ä»¥åŠæª”æ¡ˆçµæ§‹é…ç½®è·¯ç”±ï¼Œä¾‹å¦‚ï¼špages/work.vue æœƒè¢«æ˜ å°„åˆ° /work å¦‚æœè¦ä½¿ç”¨ pages/ï¼Œapp.vue éœ€åŠ ä¸Š &lt;NuxtPage /&gt; ç”¨æ–¼é¡¯ç¤ºå®šç¾©çš„é é¢ å‹•æ…‹è·¯ç”±å‹•æ…‹è·¯ç”±ä½¿ç”¨æ–¹æ‹¬è™Ÿ [] åŒ…è¦†ï¼ˆNuxt2 ä½¿ç”¨ä¸‹åº•ç·š _ï¼‰ ç¯„ä¾‹ï¼š pages/|â€”â€” index.vue|â€”â€” products-[category]/ |â€”â€” [id].vue é€é $route å¯ä»¥å–å¾— category è·Ÿ id å€¼ï¼š &lt;template&gt; &lt;p&gt;{{ $route.params.category }} - {{ $route.params.id }}&lt;/p&gt;&lt;/template&gt; ç•¶æˆ‘å€‘åˆ‡åˆ°é é¢ /products-bag/112345ï¼Œç•«é¢æ¸²æŸ“å¦‚ä¸‹ï¼š bag - 112345 Catch-all Routeä½¿ç”¨ [...slug].vue åŒ¹é…è©²è·¯å¾‘ä¸‹çš„æ‰€æœ‰å±¤ç´šè·¯ç”±ï¼Œå¯ä»¥ç”¨ä¾†è™•ç†æ‰¾ä¸åˆ°è·¯ç”±çš„é è¨­é é¢ ç¯„ä¾‹ï¼š pages/|â€”â€” index.vue|â€”â€” [...slug].vue ç•¶ä½¿ç”¨è€…è¼¸å…¥ä¸å­˜åœ¨çš„é é¢ï¼Œä¾‹å¦‚ï¼š/hello æˆ–æ˜¯ /hello/claireï¼Œæœƒè‡ªå‹•è½‰åˆ° [...slug].vue pluginsç”¨ä¾†å®šç¾©æ’ä»¶ï¼Œplugins/ å…§çš„æª”æ¡ˆ Nuxt æœƒè‡ªå‹•å¼•å…¥ï¼Œå¦‚æœè¦é™åˆ¶åœ¨ server æˆ–æ˜¯ client ç«¯ä½¿ç”¨ï¼Œæª”åéœ€åŠ ä¸Š .server æˆ– .client å¾Œç¶´ ç¯„ä¾‹ï¼šå¼•å…¥ vue3-notification ç¬¬ä¸‰æ–¹å¥—ä»¶ å®‰è£å¥—ä»¶ npm i @kyvg/vue3-notification å»ºç«‹ plugin plugins/|â€”â€” notification.client.ts import Notifications from '@kyvg/vue3-notification';export default defineNuxtPlugin(nuxtApp =&gt; { nuxtApp.vueApp.use(Notifications);}); é é¢ä¸Šä½¿ç”¨ &lt;script&gt;import { useNotification } from '@kyvg/vue3-notification';export default { setup() { const { notify } = useNotification(); onMounted(() =&gt; { notify({ title: \"Authorization\", text: \"You have been logged in!\", }); }); }};&lt;/script&gt; publicéœæ…‹è³‡æºè³‡æ–™å¤¾ï¼ˆåŒ Nuxt2 çš„ static/ï¼‰ï¼Œç”¨ä¾†å­˜æ”¾ä¸éœ€è¦è¢«ç·¨è­¯çš„æª”æ¡ˆï¼Œåƒ CSSã€ æ–‡å­—æˆ–åœ–ç‰‡ï¼Œé€éæ ¹ç›®éŒ„&nbsp;/ å³å¯ä½¿ç”¨ public/ æª”æ¡ˆï¼Œæª”æ¡ˆå¦‚éœ€è¢«ç·¨è­¯ï¼Œå‰‡å­˜æ”¾æ–¼ assets/ serverNuxt3 æ­é…æ–°çš„ä¼ºæœå™¨å¼•æ“ Nitroï¼Œè®“æˆ‘å€‘å¯ä»¥åœ¨ server ç«¯å®šç¾©å…§å®¹ï¼Œåƒæ˜¯å»ºç«‹ API ä»¥åŠé€é Server Middleware è™•ç†äº‹ä»¶ ç°¡å–®èªªæ˜ server/ å…§çš„è³‡æ–™å¤¾åŠŸèƒ½ï¼š apiï¼šå»ºç«‹å¸¶æœ‰ /api å‰ç¶´çš„ API è·¯å¾‘ routesï¼šå»ºç«‹ä¸å¸¶ /api å‰ç¶´çš„ API è·¯å¾‘ middlewareï¼šåœ¨æ¯æ¬¡ç™¼å‡ºè«‹æ±‚æ™‚è§¸ç™¼ã€‚è·Ÿ router middleware ä¸åŒï¼Œé é¢åˆ‡æ›ï¼ˆpage navigationï¼‰ä¸¦ä¸æœƒè§¸ç™¼ server middleware utilså®šç¾©åœ¨ utils/ å…§çš„æª”æ¡ˆ Nuxt3 æœƒè‡ªå‹•å¼•å…¥ï¼Œå®˜æ–¹æ–‡ä»¶æåˆ° utils/ è³‡æ–™å¤¾çš„æ‹†åˆ†ä¸»è¦æ˜¯ç‚ºäº†è·Ÿ composibles/ åšå€éš”ï¼Œå‰é¢æœ‰æåˆ° composibles/ åˆ©ç”¨ Composition API ä¾†å°è£å’Œè¤‡ç”¨&nbsp;æœ‰ç‹€æ…‹é‚è¼¯ï¼ˆStateful Logicï¼‰ï¼Œè€Œ utils/ å‰‡ç”¨ä¾†å®šç¾©&nbsp;ç„¡ç‹€æ…‹é‚è¼¯ï¼ˆStateless Logicï¼‰ ä»¥ utils/toThousands.js ç‚ºä¾‹ï¼ˆå°‡æ•¸å­—å¸¶å…¥åƒåˆ†è™Ÿï¼‰ // utils/toThousands.jsexport default num =&gt; { if (!num) { return num; } const parts = num.toString().split('.'); parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, ','); return parts.join('.');}; åœ¨é é¢ä½¿ç”¨ // pages/count.vue&lt;template&gt; &lt;div&gt; $ {{ toThousands(19999) }} &lt;/div&gt;&lt;/template&gt; ç·¨è­¯çµæœï¼š $ 19,999 .nuxtignoreè¨­å®š Nuxt ç·¨è­¯æ™‚å¿½ç•¥æ ¹ç›®éŒ„ layoutsã€pagesã€componentsã€composablesã€middleware å…§çš„æª”æ¡ˆ # å¿½ç•¥ layout custom.vuelayouts/custom.vue# å¿½ç•¥ layout -ignore.vue çµå°¾çš„æª”æ¡ˆlayouts/*-ignore.vue# å¿½ç•¥ page about.vuepages/about.vue# å¿½ç•¥ ignore è³‡æ–™å¤¾å…§çš„ page æª”æ¡ˆpages/ignore/*.vue# å¿½ç•¥ route middleware custom è³‡æ–™å¤¾å…§æª”æ¡ˆï¼Œæ’é™¤ custom/bar.jsmiddleware/custom/*.js!middleware/custom/bar.js app.config.tsè¨­å®šå…¨åŸŸå…±ç”¨çš„è³‡æ–™ï¼Œåªèƒ½åœ¨ client ç«¯å–å¾— å®˜æ–¹æ–‡ä»¶æåˆ°ï¼Œä¸å»ºè­°å°‡ä»»ä½•æ©Ÿå¯†è³‡æ–™å­˜æ”¾æ–¼æ­¤ // app.config.tsexport default defineAppConfig({ theme: { color: '#0d6efd' }}) åœ¨é é¢ä½¿ç”¨ // pages/about.vue&lt;script&gt;export default { setup() { const appConfig = useAppConfig(); onMounted(() =&gt; { console.log(appConfig.theme.color); // output: #0d6efd }); }};&lt;/script&gt; app.vueå°ˆæ¡ˆé€²å…¥é»ï¼ŒNuxt3 å°‡ app.vue ç§»åˆ°ç›®éŒ„é ï¼Œè®“é–‹ç™¼è€…å¯ä»¥åªä½¿ç”¨ app.vue ä¾†å»ºç½®ç¶²ç«™ï¼ˆä¾‹å¦‚å–®é  Landing Pageï¼‰ï¼Œè€Œä¸å®šç¾© pages/ è³‡æ–™å¤¾ã€‚ å¦‚æœè¦ä½¿ç”¨ pages/ï¼Œapp.vue éœ€åŠ ä¸Š &lt;NuxtPage /&gt; ç”¨æ–¼é¡¯ç¤ºå®šç¾©çš„é é¢ï¼ˆåŠŸèƒ½åŒ Vue Router &lt;router-view&nbsp;/&gt;ï¼‰ // app.vue&lt;template&gt; &lt;div&gt; &lt;NuxtLayout&gt; &lt;NuxtPage /&gt; &lt;/NuxtLayout&gt; &lt;/div&gt;&lt;/template&gt; nuxt.config.tsNuxt è¨­å®šæª”ï¼Œç›¸é—œè¨­å®š åƒè€ƒæ–‡ä»¶ // nuxt.config.tsexport default defineNuxtConfig({ // My Nuxt config}) tsconfig.jsoné…ç½® extends æˆ–æ˜¯è¦†è“‹é è¨­çš„ TypeScript è¨­å®š å¦‚è¦è¨­å®šè·¯å¾‘åˆ¥åï¼Œè‹¥ç›´æ¥åœ¨ tsconfig.json è¨­å®šï¼Œå°‡æœƒè¦†å¯«é è¨­çš„ aliasï¼Œå»ºè­°åœ¨ nuxt.config æª”è¨­å®šï¼ŒNuxt æœƒåŠ åˆ°è‡ªå‹•ç”Ÿæˆçš„ tsconfig // tsconfig.json{ \"extends\": \"./.nuxt/tsconfig.json\" // è‡ªå‹•ç”Ÿæˆçš„ tsconfig} åƒè€ƒè³‡æºï¼š https://ithelp.ithome.com.tw/articles/10295432https://nuxt.com/docs/guide/directory-structure/nuxt","link":"/2023/07/07/nuxt3/nuxt-v3-directory-structure/"},{"title":"Nuxt.js 3.x è‡ªè¨‚ Error Page èˆ‡éŒ¯èª¤è™•ç†","text":"æœ¬ç¯‡æ–‡ç« åŒæ­¥ç™¼è¡¨æ–¼ 2023 iThome éµäººè³½ Nuxt 3 æä¾›å¤§é‡å…§å»ºåŠŸèƒ½ï¼ŒåŒ…æ‹¬é è¨­éŒ¯èª¤é é¢ï¼Œå¯ä»¥åœ¨éš±è—è³‡æ–™å¤¾ .nuxt/dev/index.mjs çœ‹åˆ°ï¼Œæˆ‘å€‘ä¹Ÿå¯ä»¥è‡ªè¨‚éŒ¯èª¤é é¢ï¼ŒNuxt é è¨­éŒ¯èª¤ç•«é¢å¦‚ä¸‹ï¼š è‡ªè¨‚éŒ¯èª¤é åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„æ–°å¢ error.vueï¼Œerror page ä¸å…·æœ‰è·¯ç”±ï¼Œå› æ­¤ä¸èƒ½ä½¿ç”¨ definePageMeta æ–¹æ³• æª”æ¡ˆçµæ§‹å¦‚ä¸‹ï¼š |â€”â€” app.vue|â€”â€” error.vue éŒ¯èª¤é æœƒæ”¶åˆ°ä¸€å€‹åç‚º error çš„ props ç‰©ä»¶ error ç‰©ä»¶å…§å®¹åŒ…å«ä»¥ä¸‹åƒæ•¸ urlã€statusCodeã€statusMessageã€messageã€descriptionã€dataï¼Œè‡ªè¨‚åƒæ•¸å¯ä»¥æ”¾åœ¨ data å…§ // error.vue&lt;template&gt; &lt;div&gt; &lt;h2&gt;{{ error.statusCode }}&lt;/h2&gt; &lt;p&gt;{{ error.message }}&lt;/p&gt; &lt;NuxtLink to=\"/\"&gt;å›é¦–é &lt;/NuxtLink&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;const props = defineProps({ error: { type: Object, required: true }});&lt;/script&gt; éŒ¯èª¤é é¢æ¸²æŸ“æ™‚æ©Ÿç•¶ç™¼ç”Ÿè‡´å‘½éŒ¯èª¤ï¼ˆfatal errorï¼‰æ™‚ï¼Œè‡ªå‹•è§¸ç™¼éŒ¯èª¤é é¢ï¼Œå¦‚æœæ˜¯éè‡´å‘½éŒ¯èª¤ï¼ˆnon-fatal errorï¼‰åªæœƒæ‹‹å‡ºéŒ¯èª¤è¨Šæ¯ï¼Œå¯èƒ½è§¸ç™¼éŒ¯èª¤é çš„æ™‚æ©Ÿå¦‚ä¸‹ï¼š Server Side åŸ·è¡Œ Nuxt plugins ç™¼ç”ŸéŒ¯èª¤ ç·¨è­¯ Vue app åˆ° HTML ç™¼ç”ŸéŒ¯èª¤ Server API ç™¼ç”ŸéŒ¯èª¤ Client Side åŸ·è¡Œ Nuxt plugins ç™¼ç”ŸéŒ¯èª¤ app:beforeMount ç”Ÿå‘½é€±æœŸç™¼ç”ŸéŒ¯èª¤ ä¸æœƒè¢« onErrorCaptured æ–¹æ³•æˆ– vue:error ç”Ÿå‘½é€±æœŸæ•æ‰çš„éŒ¯èª¤ Vue app åˆå§‹åŒ–èˆ‡ app:mounted ç”Ÿå‘½é€±æœŸç™¼ç”ŸéŒ¯èª¤ è¼”åŠ©å‡½å¼é€éä»¥ä¸‹è¼”åŠ©å‡½å¼ä¾†æ‰‹å‹•è§¸ç™¼éŒ¯èª¤é é¢ï¼Œä»¥åŠé€²è¡ŒéŒ¯èª¤è™•ç† createErroråŒæ™‚æ”¯æ´ server-side èˆ‡ client-sideï¼Œç”¨ä¾†å»ºç«‹å¸¶æœ‰éŒ¯èª¤è¨Šæ¯çš„ç‰©ä»¶ server-sideï¼šè§¸ç™¼éŒ¯èª¤é é¢ï¼Œè¦–ç‚ºè‡´å‘½éŒ¯èª¤ï¼ˆfatal errorï¼‰ client-sideï¼šæ‹‹å‡ºéè‡´å‘½éŒ¯èª¤ï¼Œå¦‚è¦é¡¯ç¤ºéŒ¯èª¤é é¢ï¼Œéœ€åŠ ä¸Š fatal: true // pages/user/[id].vue&lt;script setup&gt;const route = useRoute();const { data } = await useFetch('/api/user/${route.params.id}');if (!data.value) { throw createError({ statusCode: 404, statusMessage: 'Page Not Found', fatal: true });}&lt;/script&gt; showErroråŠŸèƒ½åŒ createError server-sideï¼šéœ€å®šç¾©åœ¨ middlewareã€plugins æˆ–æ˜¯ setup() æ–¹æ³•å…§ï¼Œè§¸ç™¼éŒ¯èª¤é é¢ client-sideï¼šè§¸ç™¼éŒ¯èª¤é é¢ // pages/user/[id].vue&lt;script setup&gt;const route = useRoute();const { data } = await useFetch('/api/user/${route.params.id}');if (!data.value) { throw showError({ statusCode: 404, statusMessage: 'Page Not Found' });}&lt;/script&gt; clearErrorç”¨ä¾†æ¸…é™¤ç•¶å‰è™•ç†çš„éŒ¯èª¤è¨Šæ¯ï¼Œå¯ä»¥é€é redirect é‡æ–°å°å‘åˆ°å…¶ä»–é é¢ // error.vue&lt;template&gt; &lt;div&gt; &lt;h2&gt;{{ error.statusCode }}&lt;/h2&gt; &lt;p&gt;{{ error.message }}&lt;/p&gt; &lt;button @click=\"handleError\"&gt;å›é¦–é &lt;/button&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;const props = defineProps({ error: { type: Object, required: true }});const handleError = () =&gt; clearError({ redirect: '/' });&lt;/script&gt; åƒè€ƒè³‡æºï¼š https://nuxt.com/docs/getting-started/error-handlinghttps://nuxt.com/docs/api/advanced/hooks","link":"/2023/09/07/nuxt3/nuxt-v3-error-page/"},{"title":"Nuxt.js 3.x å°å…¥ I18n å¯¦ä½œå¤šåœ‹èªç³»","text":"æœ¬ç¯‡æ–‡ç« åŒæ­¥ç™¼è¡¨æ–¼ 2023 iThome éµäººè³½ @nuxtjs/i18n ç‰ˆæœ¬ï¼šv8.0.0-rc.3 å¤šåœ‹èªç³»è®“æˆ‘å€‘çš„ç¶²ç«™é‚å‘åœ‹éš›å¸‚å ´ï¼Œæœ¬ç¯‡å°‡èªªæ˜å¦‚ä½•æ­é… Nuxt3 æ•´åˆæ¨¡çµ„ @nuxtjs/i18n é€²è¡Œé–‹ç™¼ @nuxtjs/i18n ç°¡ä»‹ æ•´åˆ Vue I18n è‡ªå‹•ç”¢ç”Ÿè·¯ç”± SEO æœå°‹å¼•æ“æœ€ä½³åŒ– Lazy Loading å»¶é²è¼‰å…¥ è‡ªå‹•åµæ¸¬èªè¨€ä¸¦åˆ‡æ› å¤šåœ‹èªè¨€æ”¯æ´ä¸åŒåŸŸå å¥—ä»¶å®‰è£Nuxt3 éœ€æ­é… v8 ç‰ˆæœ¬ï¼Œç›®å‰ç‚º rc ç‰ˆï¼Œé€é next tag å®‰è£ npm install -D @nuxtjs/i18n@next nuxt.config é…ç½®æ¨¡çµ„// nuxt.config.jsexport default defineNuxtConfig({ modules: [ '@nuxtjs/i18n' ]}) nuxt.config è¨­å®šæ¨¡çµ„é¸é …i18n module å®Œæ•´é¸é …åƒè€ƒ å®˜æ–¹æ–‡ä»¶ï¼Œä»¥ä¸‹ç¯„ä¾‹é…ç½®ï¼š strategyï¼šå®šç¾©è·¯ç”±æ˜¯å¦åŠ ä¸Šèªç³»å‰ç¶´ï¼Œç¯„ä¾‹ä½¿ç”¨ prefixï¼Œæ‰€æœ‰èªç³»éƒ½æœƒåŠ ä¸Šè·¯å¾‘å‰ç¶´ï¼ˆex: http://localhost:3000/zh/ï¼‰ langDirï¼šç¿»è­¯æª”ç›®éŒ„è·¯å¾‘ï¼Œç¯„ä¾‹ç‚ºæ ¹ç›®éŒ„ä¸‹ locales/ è³‡æ–™å¤¾ localesï¼šèªç³»é¸é …ï¼Œç¯„ä¾‹è¨­å®šç¹é«”ä¸­æ–‡è·Ÿè‹±æ–‡ï¼Œå­˜æ”¾æ–¼ langDir ç›®éŒ„ä¸‹ï¼Œä»¥ä¸‹ç¯„ä¾‹æª”çµæ§‹ï¼š locales/ |â€”â€” en.js |â€”â€” zh.jsnuxt.config.js defaultLocaleï¼šé è¨­èªç³» detectBrowserLanguageï¼šæ˜¯å¦è‡ªå‹•åµæ¸¬ä½¿ç”¨è€…ç€è¦½å™¨èªç³» useCookieï¼šè¨­å®šç‚º true å°‡èªç³»å„²å­˜æ–¼ cookieï¼Œé¿å…ä½¿ç”¨è€…æ¯æ¬¡é€²å…¥ç¶²ç«™éƒ½é‡æ–°å°å‘ cookieKeyï¼šé è¨­ i18n_redirected redirectOnï¼šè¨­å®šç‚º root æ ¹ç›®éŒ„ï¼Œåªåœ¨æ ¹ç›®éŒ„åµæ¸¬èªç³»ï¼Œé¿å…ä½¿ç”¨è€…é€²å…¥ç¶²ç«™æ™‚è¢«é‡æ–°å°å‘ï¼Œä»¥åˆ© SEO // nuxt.config.jsexport default defineNuxtConfig({ i18n: { strategy: 'prefix', langDir: 'locales', locales: [ { code: 'en', iso: 'en-US', file: 'en.js' }, { code: 'zh', iso: 'zh-TW', file: 'zh.js' } ], defaultLocale: 'zh', detectBrowserLanguage: { useCookie: true, cookieKey: 'i18n_redirected', redirectOn: 'root' } }}) æ–°å¢èªç³»ç¿»è­¯æª”è·¯å¾‘çµæ§‹ï¼š locales/ |â€”â€” en.js |â€”â€” zh.js // locales/en.jsexport default { welcome: 'Welcome', backHome: 'Back Home', about: { title: 'About Us', description: 'This is About Page' }}; // locales/zh.jsexport default { welcome: 'æ‚¨å¥½', backHome: 'å›é¦–é ', about: { title: 'é—œæ–¼æˆ‘å€‘', description: 'é€™æ˜¯é—œæ–¼æˆ‘å€‘é é¢' }}; å¤šåœ‹èªç³»åŸºæœ¬æ‡‰ç”¨ useLocalePathï¼šä¾æ“šç•¶å‰èªç³»è§£æè·¯å¾‘ï¼ŒEXï¼š/about â†’ /zh/about useSwitchLocalePathï¼šç”¨ä¾†åˆ‡æ›èªç³» $tï¼šVue å¯¦é«”æ–¹æ³•ï¼Œç”¨ä¾†ç¿»è­¯è¨Šæ¯ // pages/about.vue&lt;template&gt; &lt;div class=\"m-4\"&gt; &lt;NuxtLink :to=\"localePath('/')\"&gt;{{ $t('backHome') }}&lt;/NuxtLink&gt; &lt;div&gt; &lt;NuxtLink :to=\"switchLocalePath('en')\"&gt;English&lt;/NuxtLink&gt; &lt;NuxtLink :to=\"switchLocalePath('zh')\"&gt;ç¹é«”ä¸­æ–‡&lt;/NuxtLink&gt; &lt;/div&gt; &lt;h2&gt;{{ $t('welcome') }}&lt;/h2&gt; &lt;h3&gt;{{ $t('about.title') }}&lt;/h3&gt; &lt;p&gt;{{ $t('about.description') }}&lt;/p&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;const localePath = useLocalePath();const switchLocalePath = useSwitchLocalePath();&lt;/script&gt; ç•«é¢å‘ˆç¾å¦‚ä¸‹ï¼š å–®ä¸€å…ƒä»¶ç¿»è­¯å‰é¢èªªæ˜å¦‚ä½•å»ºç«‹å„èªç³»ç¿»è­¯æª”ï¼Œä¹Ÿå¯ä»¥å–®ç¨åœ¨å…ƒä»¶å…§é€é &lt;i18n&gt; å®šç¾©ç¿»è­¯è³‡è¨Š useScope: 'local' å°‡ t æ–¹æ³•ä½œç”¨åŸŸé™åˆ¶æ–¼å…ƒä»¶å…§ï¼Œé€™éº¼åšå¯ä»¥é¿å…å—åˆ°å…¨åŸŸç¿»è­¯æª”å½±éŸ¿ // pages/about.vue&lt;template&gt; &lt;div class=\"m-4\"&gt; å…ƒä»¶ç¿»è­¯ &lt;h2&gt;{{ t('welcome') }}&lt;/h2&gt; å…¨åŸŸç¿»è­¯ &lt;h2&gt;{{ $t('welcome') }}&lt;/h2&gt; &lt;/div&gt;&lt;/template&gt;&lt;i18n lang=\"yaml\"&gt; en: welcome: 'hello world' zh: welcome: 'å“ˆå›‰ä¸–ç•Œ'&lt;/i18n&gt;&lt;script setup&gt;const { t } = useI18n({ useScope: 'local'});&lt;/script&gt; å…¨åŸŸç¿»è­¯æª” // locales/zh.jsexport default { welcome: 'æ‚¨å¥½'}; ç•«é¢å‘ˆç¾å¦‚ä¸‹ï¼š æ’å…¥å‹•æ…‹è®Šæ•¸1. å…·åè®Šæ•¸// pages/about.vue&lt;template&gt; &lt;h1&gt;{{ t('hello', { name: 'Daniel' }) }}&lt;/h1&gt;&lt;/template&gt;&lt;i18n lang=\"yaml\"&gt; en: hello: 'hello {name}' zh: hello: 'å“ˆå›‰ {name}'&lt;/i18n&gt;&lt;script setup&gt;const { t } = useI18n({ useScope: 'local'});&lt;/script&gt; 2. åŒ¿åè®Šæ•¸ï¼ˆé™£åˆ—ï¼‰// pages/about.vue&lt;template&gt; &lt;h1&gt;{{ t('hello', [ 'Daniel' ]) }}&lt;/h1&gt;&lt;/template&gt;&lt;i18n lang=\"yaml\"&gt; en: hello: 'hello {0}' zh: hello: 'å“ˆå›‰ {0}'&lt;/i18n&gt;// ... &lt;NuxtLinkLocale&gt; å…ƒä»¶ç­‰åŒæ–¼ &lt;NuxtLink&gt; æ­é… useLocalePath() Composableï¼Œä»¥ä¸‹å…©å€‹å¯«æ³•ç·¨è­¯å¾Œçµæœç›¸åŒ &lt;template&gt; &lt;NuxtLinkLocale to=\"/\"&gt;{{ $t('home') }}&lt;/NuxtLinkLocale&gt;&lt;/template&gt; &lt;template&gt; &lt;NuxtLink :to=\"localePath('/')\"&gt;{{ $t('home') }}&lt;/NuxtLink&gt;&lt;/template&gt;&lt;script setup&gt;const localePath = useLocalePath();&lt;/script&gt; SEO å„ªåŒ–é€é useLocaleHead() å„ªåŒ–å¤šåœ‹èªç³»çš„ &lt;head&gt; è¨­å®šï¼š useLocaleHeadï¼šä¾æ“šç•¶å‰èªç³»å›å‚³ head å±¬æ€§ &lt;html&gt; æ¨™ç±¤ lang å±¬æ€§ hreflang æ¨™ç±¤å±¬æ€§ï¼šå‘Šè¨´æœå°‹å¼•æ“é é¢ä½¿ç”¨çš„èªè¨€ï¼Œè®“ä½¿ç”¨è€…åœ¨æœå°‹æ™‚ï¼Œæœå°‹å¼•æ“èƒ½æä¾›å°æ‡‰èªè¨€çµ¦ç”¨æˆ¶ og:locale ä»¥åŠ og:locale:alternate æ¨™ç±¤ Canonical URLï¼ˆæ¨™æº–ç¶²å€ï¼‰æ¨™ç±¤ï¼šå‘Šè¨´æœå°‹å¼•æ“æ­¤é é¢çš„ä¸»è¦é€£çµï¼Œé¿å…æœå°‹å¼•æ“è™•ç†é‡è¤‡å…§å®¹ç¶²é  addSeoAttributesï¼šæ˜¯å¦åŠ ä¸Š SEO å±¬æ€§ useHeadï¼šNuxt Composableï¼Œç”¨ä¾†å®šç¾©å®Œæ•´ &lt;head&gt; æ¨™ç±¤å…§å®¹ Nuxt3 meta tags ç›¸é—œé…ç½®å¯ä»¥åƒè€ƒ é€™ç¯‡æ–‡ç«  // pages/about.vue&lt;template&gt; &lt;div&gt;...&lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;const i18nHead = useLocaleHead({ addSeoAttributes: true});useHead({ htmlAttrs: { lang: i18nHead.value.htmlAttrs.lang }, link: [ ...(i18nHead.value.link || []) ], meta: [ ...(i18nHead.value.meta || []) ]});&lt;/script&gt; ç”¢ç”Ÿçš„ç¶²é åŸå§‹ç¢¼ï¼š åƒè€ƒè³‡æºï¼š https://v8.i18n.nuxtjs.org/https://vue-i18n.intlify.dev/","link":"/2023/08/29/nuxt3/nuxt-v3-i18n/"},{"title":"Nuxt.js 3.x å°ˆæ¡ˆæ¶è¨­","text":"æœ¬ç¯‡æ–‡ç« åŒæ­¥ç™¼è¡¨æ–¼ 2023 iThome éµäººè³½ Nuxt ç‰ˆæœ¬ï¼šv3.7.1 å…ˆå‰å¯«äº†ä¸€ç³»åˆ— Nuxt.js 2.x ç›¸é—œæ–‡ç« ï¼Œåœ¨ Vue 3 å‡ºäº†å¥½ä¸€æ®µæ™‚é–“å¾Œï¼ŒNuxt 3 çµ‚æ–¼åœ¨ 2022 å¹´åº•æ¨å‡ºäº†ç©©å®šç‰ˆæœ¬ï¼Œé™¤äº†æ”¯æ´ TypeScriptï¼Œæ›´å¾¹åº•çš„é€²è¡Œé‡æ§‹ï¼Œç²¾ç°¡äº†æ ¸å¿ƒã€ç·¨è­¯é€Ÿåº¦æ›´å¿«ï¼Œæå‡é–‹ç™¼é«”é©—ã€‚ æ¥ä¸‹ä¾†ä¸€èµ·ä¾†å»ºç«‹ä¸€å€‹ Nuxt 3 å°ˆæ¡ˆå§ï¼ é¦–å…ˆä½¿ç”¨ Nuxt æŒ‡ä»¤åˆ—å·¥å…·ï¼ˆcommand line interfaceï¼‰Nuxi é€²è¡Œå®‰è£ï¼Œ&lt;project-name&gt; å°ˆæ¡ˆåç¨±å¯ä»¥è‡ªè¨‚ï¼š npx nuxi@latest init &lt;project-name&gt; é€™è£¡å‘½åç‚º my-app npx nuxi@latest init my-app æ³¨æ„ï¼šnode ç‰ˆæœ¬å¿…é ˆè¦ v16.0.0 ä»¥ä¸Šæ‰èƒ½é †åˆ©åŸ·è¡Œï¼Œå¯ä»¥é€é node -v æŒ‡ä»¤ä¾†æŸ¥çœ‹ç•¶å‰ä½¿ç”¨ç‰ˆè™Ÿ æ¥è‘—é¸æ“‡ä½¿ç”¨çš„å¥—ä»¶ç®¡ç†å·¥å…·ï¼Œé€™è£¡é¸æ“‡ npm å®‰è£å®Œæˆå¾Œï¼Œæ¥è‘—é€²å…¥åˆ°å°ˆæ¡ˆæ ¹ç›®éŒ„ cd my-app å®‰è£ç›¸ä¾å¥—ä»¶ npm install æ–¼é–‹ç™¼ç’°å¢ƒå•Ÿå‹•å°ˆæ¡ˆ npm run dev æ¥è‘—åœ¨ç€è¦½å™¨è¼¸å…¥ç¶²å€ï¼Œå°±å¯ä»¥çœ‹åˆ°ç•«é¢å›‰ ç¾åœ¨æ‰“é–‹å°ˆæ¡ˆæ ¹å…ƒä»¶&nbsp;app.vueï¼Œ&lt;NuxtWelcome /&gt;&nbsp;æ˜¯ Nuxt é è¨­çš„æ­¡è¿ç•«é¢ï¼Œå¯ä»¥å–ä»£æˆè‡ªå·±çš„ç¨‹å¼ç¢¼ï¼Œåˆ°é€™è£¡å°ˆæ¡ˆå°±å»ºç½®å®Œæˆå•¦ï¼ // app.vue&lt;template&gt; &lt;div&gt; &lt;NuxtWelcome /&gt; &lt;/div&gt;&lt;/template&gt; å¦‚æœæ¡ç”¨ Visual Studio Code é–‹ç™¼ï¼Œå®˜æ–¹æ–‡ä»¶å»ºè­°å¯ä»¥å®‰è£ Vue Language Features (Volar) ï¼Œå¦å¤–å¦‚æœæ­é… TypeScript é€²è¡Œé–‹ç™¼ï¼Œä¹Ÿæ¨è–¦å®‰è£ TypeScript Vue Plugin (Volar) ï¼Œé€™å…©å€‹å¥—ä»¶å¯ä»¥å”åŠ©æˆ‘å€‘åœ¨é–‹ç™¼æ™‚æç¤ºã€è£œè¶³ã€highlight ç¨‹å¼ç¢¼ï¼ŒåŠŸèƒ½å¼·å¤§ åƒè€ƒæ–‡ç« ï¼š https://nuxt.com/docs/getting-started/installation","link":"/2023/06/17/nuxt3/nuxt-v3-installation/"},{"title":"Nuxt.js 3.x Layouts ç›®éŒ„ï¼è‡ªè¨‚æ¨¡æ¿","text":"æœ¬ç¯‡æ–‡ç« åŒæ­¥ç™¼è¡¨æ–¼ 2023 iThome éµäººè³½ Layouts è³‡æ–™å¤¾å”åŠ©æˆ‘å€‘å®šç¾©å…±ç”¨æ¨¡æ¿ï¼Œå°‡é‡è¤‡ä½¿ç”¨çš„ç‰ˆé¢æå–åˆ°æ¨¡æ¿å…§å…¨åŸŸå…±ç”¨ï¼Œçœ‹èµ·ä¾†è·Ÿ Components æœ‰é»åƒï¼Œé‚£éº¼ Layouts è·Ÿ Components æ€éº¼å€åˆ†ï¼Ÿå¯ä»¥å°‡ Layouts è¦–ç‚ºåŒ…è¦†åœ¨é é¢å¤–å±¤çš„åŒ…è£¹å…ƒä»¶ï¼Œç”¨ä¾†å®šç¾© Headerã€Sidebarã€Footer ç­‰å…±ç”¨ç‰ˆé¢æˆ–æ˜¯å…ƒä»¶ å®˜æ–¹æ–‡ä»¶æåˆ°ï¼Œå¦‚æœæ•´å€‹å°ˆæ¡ˆåªæœ‰ä¸€å€‹æ¨¡æ¿ï¼Œå»ºè­°ç›´æ¥åœ¨&nbsp;app.vue&nbsp;å®šç¾©å³å¯ é è¨­æ¨¡æ¿é è¨­æ¨¡æ¿åç¨±ç‚º defaultï¼Œæ–°å¢ layouts/default.vueï¼Œä¸¦é€é &lt;slot /&gt; å°‡å…ƒä»¶çš„å…§å®¹è¼‰å…¥ // layouts/default.vue&lt;template&gt; &lt;div&gt; &lt;nav&gt;Header&lt;/nav&gt; &lt;slot /&gt; &lt;div&gt;Footer&lt;/div&gt; &lt;/div&gt;&lt;/template&gt; æˆ–æ˜¯å°‡ Headerã€Footer ç­‰å…±ç”¨å…ƒä»¶ï¼ˆComponentsï¼‰åŠ å…¥æ¨¡æ¿ // layouts/default.vue&lt;template&gt; &lt;div&gt; &lt;TheHeader /&gt; &lt;slot /&gt; &lt;TheFooter /&gt; &lt;/div&gt;&lt;/template&gt; æ¥è‘—åœ¨ app.vue é€é &lt;NuxtLayout&gt; å…ƒä»¶ä½¿ç”¨æ¨¡æ¿ï¼Œé è¨­ä½¿ç”¨ layouts/default.vue æ¨¡æ¿ // app.vue&lt;template&gt; &lt;NuxtLayout&gt; &lt;NuxtPage /&gt; &lt;/NuxtLayout&gt;&lt;/template&gt; æ–°å¢é¦–é  pages/index.vue // pages/index.vue&lt;template&gt; &lt;div&gt; &lt;h3&gt;Home Page&lt;/h3&gt; &lt;/div&gt;&lt;/template&gt; ç•«é¢å‘ˆç¾ï¼š ä½¿ç”¨å…¶ä»–å…·åæ¨¡æ¿layouts|â€”â€” default.vue|â€”â€” main.vue // layouts/main.vue&lt;template&gt; &lt;div&gt; &lt;h2&gt;Main Layout&lt;/h2&gt; &lt;slot /&gt; &lt;/div&gt;&lt;/template&gt; 1. app.vue æŒ‡å®šå…¨åŸŸæ¨¡æ¿ï¼Œè¦†è“‹é è¨­æ¨¡æ¿ä½¿ç”¨ name props æŒ‡å®šæ¨¡æ¿ åç¨±å¿…é ˆä½¿ç”¨ kebab-caseï¼Œä¾‹å¦‚ Layout æª”åç‚º customLayoutï¼Œéœ€ä½¿ç”¨ name='custom-layout' // app.vue&lt;template&gt; &lt;NuxtLayout name=\"main\"&gt; &lt;NuxtPage /&gt; &lt;/NuxtLayout&gt;&lt;/template&gt; 2. åœ¨å–®ä¸€å…ƒä»¶æŒ‡å®šæ¨¡æ¿ä½¿ç”¨ definePageMeta() è¼”åŠ©å‡½å¼æŒ‡å®šæ¨¡æ¿åç¨± // pages/index.vue&lt;template&gt; &lt;div&gt;...&lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;definePageMeta({ layout: 'main'});&lt;/script&gt; 3. åœ¨å–®ä¸€å…ƒä»¶ç›´æ¥å®šç¾© NuxtLayoutå…ˆå°‡é è¨­æ¨¡æ¿è¨­ç‚º falseï¼Œä¸¦é€é &lt;NuxtLayout name=\"xxx\"&gt; å®šç¾©æ¨¡æ¿ // pages/index.vue&lt;template&gt; &lt;div&gt; &lt;NuxtLayout name=\"main\"&gt; &lt;h3&gt;Home Page&lt;/h3&gt; &lt;/NuxtLayout&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;definePageMeta({ layout: false});&lt;/script&gt; åœ¨å–®ä¸€å…ƒä»¶ç›´æ¥ä½¿ç”¨ &lt;NuxtLayout&gt;ï¼Œè¦é¿å…æ”¾åœ¨ æ ¹å…ƒç´ ï¼ˆroot elementï¼‰ï¼Œæˆ–æ˜¯é—œé–‰ page è·Ÿ layout çš„ transitions æ•ˆæœ ç•«é¢å‘ˆç¾ï¼š å‹•æ…‹åˆ‡æ›æ¨¡æ¿é€é setPageLayout() è¼”åŠ©å‡½å¼å‹•æ…‹åˆ‡æ›æ¨¡æ¿ // pages/index.vue&lt;template&gt; &lt;div&gt; &lt;h3&gt;Home Page&lt;/h3&gt; &lt;button @click=\"setPageLayout('default')\"&gt;default&lt;/button&gt; &lt;button @click=\"setPageLayout('main')\"&gt;main&lt;/button&gt; &lt;/div&gt;&lt;/template&gt; å…·åæ’æ§½ç¯„ä¾‹ï¼šlayouts/main.vue æ­é…å…·åæ’æ§½ // layouts/main.vue&lt;template&gt; &lt;div&gt; &lt;nav&gt;Header&lt;/nav&gt; &lt;slot name=\"content\" /&gt; &lt;div&gt;Sidebar&lt;/div&gt; &lt;slot name=\"footer\" /&gt; &lt;/div&gt;&lt;/template&gt; åœ¨é é¢ä¸Šä½¿ç”¨ï¼Œéœ€å°‡é è¨­æ¨¡æ¿è¨­ç‚º false // pages/index.vue&lt;template&gt; &lt;div&gt; &lt;NuxtLayout name=\"main\"&gt; &lt;template #content&gt; &lt;h3&gt;Home Page&lt;/h3&gt; &lt;/template&gt; &lt;template #footer&gt; &lt;h3&gt;Footer&lt;/h3&gt; &lt;/template&gt; &lt;/NuxtLayout&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;definePageMeta({ layout: false});&lt;/script&gt; åƒè€ƒè³‡æºï¼š https://nuxt.com/docs/guide/directory-structure/layoutshttps://nuxt.com/docs/examples/features/layoutshttps://medium.com/codex/nuxt3-layouts-276ed64a4a1c","link":"/2023/09/01/nuxt3/nuxt-v3-layouts/"},{"title":"Nuxt.js 3.x è‡ªè¨‚ Loading æ•ˆæœ","text":"æœ¬ç¯‡æ–‡ç« åŒæ­¥ç™¼è¡¨æ–¼ 2023 iThome éµäººè³½ Nuxt3 æä¾›äº†é è¨­é€²åº¦æ¢å…ƒä»¶ &lt;NuxtLoadingIndicator&gt;ï¼Œåœ¨è·¯å¾‘åˆ‡æ›æ™‚é¡¯ç¤ºã€‚ä¹Ÿå¯ä»¥è‡ªè¨‚å…±ç”¨å…ƒä»¶ä¾†èª¿æ•´è§¸ç™¼æ™‚æ©Ÿæˆ–æ¨£å¼ã€‚ è·¯ç”±åˆ‡æ›ï¼ˆPage Navigationï¼‰Loadingæ–¹æ³•ä¸€ï¼šNuxt3 å…§å»ºå…ƒä»¶ï¼Œåœ¨é é¢åˆ‡æ›æ™‚è§¸ç™¼ ä½¿ç”¨æ–¹å¼ï¼š åœ¨ app.vue æˆ–æ˜¯ layouts åŠ ä¸Š &lt;NuxtLoadingIndicator&gt; Props é¸é …ï¼š colorï¼šloading bar é¡è‰²ï¼Œé è¨­ç‚ºæ¼¸å±¤è‰² heightï¼šloading bar é«˜åº¦ï¼Œé è¨­ 3ï¼ˆpxï¼‰ durationï¼šloading bar æŒçºŒæ™‚é–“ï¼Œé è¨­ 2000ï¼ˆæ¯«ç§’ï¼‰ throttleï¼šç¯€æµæ™‚é–“ï¼Œæœƒéš±è— loading barï¼Œé è¨­ 200ï¼ˆæ¯«ç§’ï¼‰ // app.vue&lt;template&gt; &lt;div&gt; &lt;NuxtLoadingIndicator :throttle=\"0\" /&gt; &lt;NuxtPage /&gt; &lt;/div&gt;&lt;/template&gt; æ³¨æ„ï¼šNuxt â‰¥ 3.1.0 éœ€åŠ ä¸Š :throttle=\"0\"ï¼Œå¦å‰‡å—ç¯€æµæ™‚é–“å½±éŸ¿çœ‹ä¸åˆ° loading æ•ˆæœï¼ˆåƒè€ƒè¨è«–ä¸²ï¼‰ æ–¹æ³•äºŒï¼šè‡ªè¨‚ Loading Indicatorå»ºç«‹ Loading å…ƒä»¶ï¼Œä½¿ç”¨åƒæ•¸ isLoading åˆ¤æ–·æ˜¯å¦é¡¯ç¤º Loading Indicatorï¼Œæ¥è‘—é€é Nuxt app runtime hooks å»ºç«‹æ””æˆªå™¨ï¼Œé€™è£¡ä½¿ç”¨ page:start ä»¥åŠ page:finish // components/CustomLoadingIndicator.vue&lt;template&gt; &lt;div class=\"loading-indicator\" :class=\"{ 'show': isLoading }\"&gt; Loading... &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt; const nuxtApp = useNuxtApp(); const isLoading = ref(false); nuxtApp.hook('page:start', () =&gt; { isLoading.value = true; }); nuxtApp.hook('page:finish', () =&gt; { setTimeout(() =&gt; { isLoading.value = false; }, 200); });&lt;/script&gt;&lt;style lang=\"scss\" scoped&gt;.loading-indicator { opacity: 0; transition: opacity 0.5s ease-in-out; &amp;.show { opacity: 1; transition: opacity 0.2s ease-in-out; }}&lt;/style&gt; åœ¨ app.vue åŠ å…¥è‡ªè¨‚å…ƒä»¶ // app.vue&lt;template&gt; &lt;div&gt; &lt;CustomLoadingIndicator /&gt; &lt;NuxtPage /&gt; &lt;/div&gt;&lt;/template&gt; æ•ˆæœå¦‚ä¸‹ï¼š è³‡æ–™è«‹æ±‚ï¼ˆData Fetchingï¼‰Loadingä½¿ç”¨ useFetch æˆ– useAsyncData Composablesï¼Œåƒæ•¸ pending ç‚ºå¸ƒæ—å€¼ï¼Œé¡¯ç¤ºè³‡æ–™æ˜¯å¦é‚„åœ¨è«‹æ±‚ç‹€æ…‹ï¼Œç”¨ä¾†åˆ¤æ–·æ˜¯å¦é¡¯ç¤º Loading Indicator Nuxt3 useFetch ç›¸é—œçŸ¥è­˜ï¼Œå¯ä»¥åƒè€ƒ é€™ç¯‡æ–‡ç«  // pages/about.vue&lt;template&gt; &lt;div&gt; &lt;div v-if=\"pending\"&gt; Loading ... &lt;/div&gt; &lt;div v-else&gt; user: &lt;pre&gt;{{ data }}&lt;pre&gt; &lt;button type=\"button\" @click=\"refresh()\"&gt;refresh&lt;/button&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;const { data, pending, refresh } = useFetch('/api/about');&lt;/script&gt; æ•ˆæœå¦‚ä¸‹ï¼š åƒè€ƒè³‡æºï¼š https://medium.com/@flanker72/nuxt3-complex-solutions-page-loading-indicator-e34b5a86be52https://nuxt.com/docs/api/components/nuxt-loading-indicatorhttps://nuxt.com/docs/getting-started/data-fetching","link":"/2023/08/24/nuxt3/nuxt-v3-loading/"},{"title":"Nuxt.js 3.x Meta Tags and SEO","text":"æœ¬ç¯‡æ–‡ç« åŒæ­¥ç™¼è¡¨æ–¼ 2023 iThome éµäººè³½ Nuxt3 æ­é… Unhead å¥—ä»¶ï¼Œè®“æˆ‘å€‘å¯ä»¥åœ¨æ‡‰ç”¨ç¨‹å¼ä¸­å‹•æ…‹æ§åˆ¶ &lt;head&gt; æ¨™ç±¤ï¼Œå®šç¾© meta è³‡è¨Šã€æ¨£å¼è¡¨ã€ç¨‹å¼ç¢¼ç‰‡æ®µç­‰åœ¨ç¶²é ä¸­éœ€è¦çš„å…§å®¹ï¼Œæœ‰åŠ©æ–¼ SEO æœå°‹å¼•æ“å„ªåŒ– å‹•æ…‹æ§åˆ¶å‡½å¼ï¼šComposables çµ„åˆå¼å‡½å¼ useHead() &amp; useHeadSafe() useSeoMeta() &amp; useServerSeoMeta() Components å…§å»ºå…ƒä»¶ &lt;Title&gt;ã€&lt;Style&gt;ã€&lt;Meta&gt;ã€&lt;Link&gt;ã€&lt;Body&gt;ã€&lt;Html&gt;ã€&lt;Head&gt; Composablesï¼šuseHead &amp; useHeadSafeèƒ½å¤ å®šç¾©å®Œæ•´ &lt;head&gt; å…§å®¹ã€‚ useHeadSafe() æ˜¯ useHead() çš„åŒ…è£å‡½å¼ï¼Œå°è¼¸å…¥å…§å®¹é€²è¡Œæª¢æ ¸ï¼Œèƒ½å¤ é¿å…æ½›åœ¨çš„å®‰å…¨é¢¨éšªï¼Œåƒæ˜¯ XSS æ”»æ“Šç­‰å®‰å…¨æ¼æ´ &lt;script setup&gt;useHead({ title: 'My Website', htmlAttrs: { lang: 'zh-TW' }, meta: [ { name: 'description', content: 'Hello this is my site.' } ], script: [], link: []})&lt;/script&gt; Composablesï¼šuseSeoMeta &amp; useServerSeoMetaå°ˆé–€ç”¨ä¾†å®šç¾© meta tagsï¼Œç‰©ä»¶çµæ§‹ç°¡æ½”æ‰å¹³ã€‚ å¦‚æœæˆ‘å€‘çš„è³‡æ–™ééŸ¿æ‡‰å¼ï¼Œå¯ä»¥ä½¿ç”¨ useServerSeoMeta()ï¼Œåœ¨ server ç«¯é å…ˆè™•ç†å®Œ meta ç›¸é—œé‚è¼¯ï¼Œæå‡ç¶²é æ•ˆèƒ½ &lt;script setup&gt;useSeoMeta({ title: 'My Website', ogTitle: 'My Website', description: 'Hello this is my site.', ogDescription: 'Hello this is my site.', ogImage: 'https://mysite/image.png', twitterCard: 'summary_large_image'})&lt;/script&gt; ComponentsNuxt3 å…§å»º &lt;Title&gt;ã€&lt;Style&gt;ã€&lt;Meta&gt;ã€&lt;Link&gt;ã€&lt;Body&gt;ã€&lt;Html&gt;ã€&lt;Head&gt; ç­‰å…ƒä»¶è®“æˆ‘å€‘å¯ä»¥ç›´æ¥åœ¨ template é…ç½® &lt;head&gt; å…§å®¹ &lt;template&gt; &lt;div&gt; &lt;Head&gt; &lt;Title&gt;{{ title }}&lt;/Title&gt; &lt;Meta name=\"description\" :content=\"title\" /&gt; &lt;/Head&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;const title = 'About Page';&lt;/script&gt; å¯¦ä½œï¼šå…¨åŸŸé…ç½®æ–¹æ³•ä¸€ï¼šnuxt.confignuxt.config é…ç½®ä¸æ”¯æ´éŸ¿æ‡‰å¼è³‡æ–™ï¼Œå› æ­¤å®˜æ–¹æ–‡ä»¶å»ºè­°åœ¨ app.vue ä¸­ä½¿ç”¨ useHead() ç­‰æ–¹æ³•å®šç¾© // nuxt.config.jsexport default defineNuxtConfig({ app: { head: { title: 'My Website', htmlAttrs: { lang: 'zh-TW' }, meta: [ { charset: 'utf-8' }, { name: 'viewport', content: 'width=device-width, initial-scale=1, viewport-fit=cover' } ], link: [ { rel: 'icon', type: 'image/x-icon', href: '/favicon.ico' } ] } }}) æ–¹æ³•äºŒï¼šapp.vueåœ¨ app.vue ä¸­ä½¿ç”¨ useHead() ç­‰æ–¹æ³•å®šç¾© &lt;head&gt; é è¨­å€¼ï¼Œå¯ä»¥åœ¨å…¶ä»– pages é é¢ä¸­å®šç¾©ç›¸åŒçš„ meta å±¬æ€§è¦†å¯«é è¨­å€¼ // app.vue&lt;template&gt; &lt;div&gt; &lt;NuxtPage /&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;useHead({ title: 'My Website', meta: [ { name: 'description', content: 'Hello this is my site.' } ]});&lt;/script&gt; å¯¦ä½œï¼šå±€éƒ¨é…ç½®åœ¨é é¢ä¸Šå®šç¾©ï¼Œèƒ½å¤ è¦†è“‹åœ¨ app.vue é…ç½®çš„ &lt;head&gt; é è¨­å€¼ï¼Œä»¥ä¸‹ç¯„ä¾‹æ­é… useHead() // pages/about.vue&lt;template&gt; &lt;div&gt; ... &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;useHead({ title: 'About Page', meta: [ { name: 'description', content: 'Hello this is about page.' } ]});&lt;/script&gt; å»¶ä¼¸ï¼šé€éå¾Œç«¯ API å‹•æ…‹å–å¾— meta å…§å®¹ç¯„ä¾‹æƒ…å¢ƒï¼šæ¯æ¬¡é€²å…¥é é¢æ™‚è«‹æ±‚è©²é  meta è³‡æ–™ ä½¿ç”¨ useAsyncData() æ­é… $fetch æ–¹æ³•å¯¦ä½œï¼Œä¸¦æ­é… useSeoMeta() é€²è¡Œé…ç½® éœ€å…ˆå…·å‚™ Nuxt3 data fetching ç›¸é—œçŸ¥è­˜ï¼Œå¯ä»¥åƒè€ƒ é€™ç¯‡æ–‡ç«  // pages/about.vue&lt;template&gt; &lt;div&gt; ... &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;useAsyncData('seo', async () =&gt; { const { title, description, image } = await $fetch('/api/seo/about'); useSeoMeta({ title, ogTitle: title, description, ogDescription: description, ogImage: image });});&lt;/script&gt; åƒè€ƒè³‡æºï¼š https://nuxt.com/docs/getting-started/seo-metahttps://unhead.harlanzw.com/","link":"/2023/07/26/nuxt3/nuxt-v3-meta-tags/"},{"title":"Nuxt.js 3.x Middleware ç›®éŒ„ï¼ç›£è½è·¯ç”±è®ŠåŒ–","text":"æœ¬ç¯‡æ–‡ç« åŒæ­¥ç™¼è¡¨æ–¼ 2023 iThome éµäººè³½ Middleware ç‚º Nuxt å…§çš„&nbsp;è·¯ç”±å®ˆè¡›ï¼ˆNavigation Guardsï¼‰ï¼Œç›¸ç•¶æ–¼ Vue Router å…§çš„ beforeEach callbackï¼Œå”åŠ©æˆ‘å€‘åœ¨é€²åˆ°é é¢å‰é€²è¡Œäº‹ä»¶è™•ç†ï¼ˆä¾‹å¦‚æ¬Šé™æª¢æŸ¥ï¼‰ Middleware è§¸ç™¼æ™‚æ©Ÿï¼š é é¢åˆå§‹åŒ–ï¼šServer Side è·Ÿ Client Side åŒæ™‚è§¸ç™¼ï¼ˆè§¸ç™¼å…©æ¬¡ï¼‰ é é¢åˆ‡æ›ï¼šClient Side è§¸ç™¼ Middleware å®šç¾©æ–¹å¼ï¼š å…·åï¼šåœ¨&nbsp;middleware/&nbsp;å®šç¾©ï¼Œä¸¦åœ¨éœ€è¦çš„é é¢å¼•å…¥ å…¨åŸŸï¼šåŒå…·åçš„å®šç¾©æ–¹å¼ï¼Œä¸éæª”åéœ€åŠ ä¸Š&nbsp;.global&nbsp;å¾Œç¶´ï¼Œåœ¨æ‰€æœ‰é é¢åˆ‡æ›æ™‚è‡ªå‹•åŸ·è¡Œ åŒ¿åï¼šç›´æ¥åœ¨å–®ä¸€å…ƒä»¶æª”å…§å®šç¾© å…·å Middlewareç¯„ä¾‹ï¼š middleware/|â€”â€” auth.js defineNuxtRouteMiddleware() è¼”åŠ©å‡½ç¤ºï¼šå®šç¾© route middleware navigateTo() è¼”åŠ©å‡½ç¤ºï¼šå°èˆªåˆ°å…¶ä»–é é¢ abortNavigation()&nbsp;è¼”åŠ©å‡½ç¤ºï¼šä¸­æ–·å°èˆªï¼Œé¡¯ç¤ºéŒ¯èª¤è³‡è¨Šä»¥åŠè·³åˆ°éŒ¯èª¤é é¢ // middleware/auth.jsexport default defineNuxtRouteMiddleware((to, from) =&gt; { const isLoggedIn = true; // åˆ¤æ–·æ˜¯å¦ç™»å…¥ const hasPermission = false; // åˆ¤æ–·æœ‰ç„¡é é¢æ¬Šé™ if (!isLoggedIn) { return navigateTo('/login'); } if (!hasPermission) { return abortNavigation({ statusCode: 403 statusMessage: 'ç„¡é é¢æ¬Šé™' }); }}); åœ¨é é¢é€é definePageMeta() è¼”åŠ©å‡½å¼å®šç¾© middleware // pages/about.vue&lt;template&gt; &lt;div&gt;...&lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;definePageMeta({ middleware: [ auth ] // or middleware: 'auth'});&lt;/script&gt; æ¥ä¸‹ä¾†ç•¶æˆ‘å€‘åˆ‡åˆ° http:localhost:3000/aboutï¼Œé©—è­‰ç„¡é é¢æ¬Šé™è·³è½‰è‡³éŒ¯èª¤ç•«é¢ å…¨åŸŸ Middlewareå…¨åŸŸå¼•å…¥çš„ Middlewareã€‚åŒå…·åå®šç¾©æ–¹å¼ï¼Œä¸éæª”åéœ€åŠ ä¸Š&nbsp;.global&nbsp;å¾Œç¶´ï¼Œåœ¨æ‰€æœ‰é é¢åˆ‡æ›æ™‚è‡ªå‹•åŸ·è¡Œ ç¯„ä¾‹ï¼š middleware/|â€”â€” auth.global.js åŒ¿å Middlewareåœ¨é é¢å…§å„åˆ¥å®šç¾© // pages/about.vue&lt;template&gt; &lt;div&gt;...&lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;definePageMeta({ middleware: [ (to, from) =&gt; { // é€™è£¡æ˜¯åŒ¿å middleware å…§å®¹ } ]});&lt;/script&gt; Middleware åŸ·è¡Œé †åºåŸ·è¡Œé †åºé¦–å…ˆç‚ºå…¨åŸŸ Middlewareï¼Œæ¥ä¸‹ä¾†æ‰æ˜¯é é¢å®šç¾©çš„ Middlewareï¼ˆä¾ç…§é †åºï¼‰ ç¯„ä¾‹ï¼š middleware/|â€”â€” auth.global.js|â€”â€” redirect.js // pages/about.vue&lt;template&gt; &lt;div&gt;...&lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;definePageMeta({ middleware: [ (to, from) =&gt; { // ... }, 'redirect' ]});&lt;/script&gt; åŸ·è¡Œé †åºåˆ†åˆ¥ç‚ºï¼š auth.global.js è‡ªè¨‚åŒ¿å middleware redirect.js å‹•æ…‹åŠ å…¥ Middlewareä½¿ç”¨ addRouteMiddleware(name, middleware, options) è¼”åŠ©å‡½å¼å‹•æ…‹åŠ å…¥ Middleware ç¯„ä¾‹ï¼šåœ¨ plugins/ åŠ å…¥ middleware å…·åæœƒè¦†è“‹æ‰å®šç¾©åœ¨ middleware/ è³‡æ–™å¤¾å…§åŒåæª”æ¡ˆï¼ˆauth.jsï¼‰ // plugins/add-middleware.jsexport default defineNuxtPlugin(() =&gt; { addRouteMiddleware('auth', (to, from) =&gt; { // ... });}); åŒ¿å// plugins/add-middleware.jsexport default defineNuxtPlugin(() =&gt; { addRouteMiddleware((to, from) =&gt; { // ... });}); å…¨åŸŸoptions åŠ ä¸Š { global: true } // plugins/add-middleware.jsexport default defineNuxtPlugin(() =&gt; { addRouteMiddleware('auth', (to, from) =&gt; { // ... }, { global: true } );}); åƒè€ƒè³‡æºï¼š https://nuxt.com/docs/guide/directory-structure/middlewarehttps://nuxt.com/docs/api/utils/define-nuxt-route-middleware","link":"/2023/09/05/nuxt3/nuxt-v3-middleware/"},{"title":"Nuxt.js 3.x Server API æ•´åˆ MongoDB å¯¦ä½œï¼Œé‚å‘å…¨ç«¯ç¬¬ä¸€æ­¥","text":"æœ¬ç¯‡æ–‡ç« åŒæ­¥ç™¼è¡¨æ–¼ 2023 iThome éµäººè³½ Nuxt3 æ­é…äº†æ–°çš„ä¼ºæœå™¨å¼•æ“ Nitroï¼Œè®“æˆ‘å€‘èƒ½è¼•é¬†å»ºç«‹ Server APIï¼Œä¸¦åœ¨ Nuxt3 å°ˆæ¡ˆå…§ä½¿ç”¨ã€‚Nitro çš„å„ªé»åŒ…å«è·¨å¹³å°æ”¯æ´ Node.js èˆ‡ç€è¦½å™¨ã€æ”¯æ´ HMRã€è‡ªå‹•ç”Ÿæˆ API è·¯ç”±ç­‰ã€‚ å¯¦å‹™ä¸Š API é–‹ç™¼å¸¸æœƒæ­é…è³‡æ–™åº«é€£æ¥ï¼Œæœ¬ç¯‡å°‡èªªæ˜å¦‚ä½•çµåˆ MongoDBï¼Œå¯¦ä½œå¾Œç«¯ API é–‹ç™¼èˆ‡å‰ç«¯ä¸²æ¥ï¼Œè®“æˆ‘å€‘çš„ Nuxt å°ˆæ¡ˆå…·å‚™å…¨ç«¯åŠŸèƒ½ã€‚ æœ¬æ–‡é‡é»åœ¨ Nuxt èˆ‡ MongoDB æ•´åˆï¼Œéœ€å…ˆå…·å‚™ä»¥ä¸‹çŸ¥è­˜ï¼š Nuxt Server APIï¼Œå¯ä»¥åƒè€ƒ é€™ç¯‡æ–‡ç«  Nuxt $fetch æ–¹æ³•ï¼Œå¯ä»¥åƒè€ƒ&nbsp;é€™ç¯‡æ–‡ç«  MongoDB æ‡‰ç”¨ï¼ˆæœ¬æ–‡åƒ…ç°¡å–®èªªæ˜ï¼‰ é–‹å§‹å‰å…ˆç°¡å–®ä»‹ç´¹ä¸€ä¸‹ MongoDB è·Ÿ Mongoose MongoDBMongoDB æ˜¯ä¸€å€‹ NoSQL è³‡æ–™åº«ï¼Œä»¥ BSONï¼ˆBinary JSONï¼‰æ ¼å¼å„²å­˜ï¼Œé©åˆå½ˆæ€§å’Œè®ŠåŒ–æ€§é«˜çš„è³‡æ–™å„²å­˜ï¼Œä¸€å€‹ Database æ˜¯ç”±ä¸€å€‹æˆ–å¤šå€‹ Collection çµ„æˆï¼Œä¸€å€‹ Collection å‰‡æ˜¯ç”±ä¸€å€‹æˆ–å¤šå€‹ Document çµ„æˆï¼Œæ¯ä¸€ç­†è³‡æ–™ç‚ºä¸€å€‹ Documentï¼Œè£¡é¢å¯ä»¥æœ‰å¤šå€‹æ¬„ä½ Field MongooseMongoose æ˜¯ MongoDB çš„ ODMï¼ˆObject Data Modelingï¼‰å¥—ä»¶ï¼Œåœ¨ Node.js é€é MongoDB driver è·Ÿè³‡æ–™åº«æºé€šï¼ŒåŸ·è¡Œ CRUDï¼ˆæ–°å¢ã€åˆªé™¤ã€æ›´æ–°ã€æŸ¥è©¢ï¼‰æ“ä½œ å¯¦ä½œåˆ†ç‚ºä»¥ä¸‹æ­¥é©Ÿ MongoDB å‰ç½®ç’°å¢ƒæº–å‚™ å®‰è£ Mongoose å»ºç«‹ Database é€é Mongoose é€£æ¥ Database å»ºç«‹ Model èˆ‡ Collection å»ºç«‹ Server API å‰ç«¯ä¸²æ¥ APIï¼šå¯¦ä½œæ–°å¢ Step1ï¼šMongoDB å‰ç½®ç’°å¢ƒæº–å‚™ MongoDB å®‰è£ Compass å®‰è£ï¼šmongoDB çš„ GUI Step2ï¼šå®‰è£ Mongooseåœ¨å°ˆæ¡ˆå…§åŸ·è¡ŒæŒ‡ä»¤å®‰è£ npm i -D mongoose Step3ï¼šé€é Mongoose é€£æ¥ Databaseæ–°å¢ server/index.js é€é mongoose.connect(URI) é€£æ¥ database URI æ ¼å¼ï¼šmongodb://[username:password@][host][:port]/dbNameï¼ŒdbName è³‡æ–™åº«åç¨±è‡ªè¨‚ // server/index.jsimport mongoose from 'mongoose';export default async () =&gt; { try { await mongoose.connect('mongodb://localhost:27017/nuxt_app'); console.log('DB connection established'); } catch (err) { console.error('DB connection failed', err); }}; URI é€šå¸¸æœƒå®šç¾©ç‚º env è®Šæ•¸ï¼Œåœ¨æ ¹ç›®éŒ„æ–°å¢ .env // .envMONGODB_URI=\"mongodb://localhost:27017/nuxt_app\" é€é process.env.MONGODB_URI å–å¾—è®Šæ•¸ mongoose.connect(process.env.MONGODB_URI); å°‡ server/index.js è¨»å†Šç‚º Server Pluginsï¼Œåœ¨ä¼ºæœå™¨åˆå§‹åŒ–æ™‚åŸ·è¡Œè³‡æ–™åº«é€£æ¥ // nuxt.config.jsexport default defineNuxtConfig({ nitro: { plugins: [ '@/server/index' ] }}); Step4ï¼šå»ºç«‹ Model èˆ‡ Collectionç¯„ä¾‹ï¼š æ–°å¢ server/models/userModel.js å®šç¾©æ¨¡å‹ å»ºç«‹ Schemaï¼Œé€é Schema è¦ç¯„ Document è³‡æ–™å…§å®¹ã€å‹åˆ¥ã€é è¨­å€¼ç­‰ å»ºç«‹ Model æ¨¡å‹ï¼Œé€£æ¥è³‡æ–™åº« Collection èˆ‡ä¸Šä¸€æ­¥çš„ Schemaã€‚ç•¶å»ºç«‹çš„æ¨¡å‹è³‡æ–™åº«æ²’æœ‰ç›¸å°æ‡‰ Collectionï¼ŒMongoose æœƒè‡ªå‹•å»ºç«‹ // server/models/userModel.jsimport mongoose from 'mongoose';// å»ºç«‹ Schemaconst userSchema = new mongoose.Schema({ name: { type: 'string', required: true }, email: { type: 'string', required: true, unique: true }}, { versionKey: false});// å»ºç«‹ Modelconst User = mongoose.model('User', userSchema);export default User; mongoose.model() ç¬¬ä¸€å€‹åƒæ•¸ç‚º Collection åç¨±ã€ç¬¬äºŒå€‹åƒæ•¸ç‚º Schemaã€‚å…¶ä¸­ç¬¬ä¸€å€‹é¤è¤² Collection åç¨±ç‚ºå¤§å¯«é–‹é ­å–®æ•¸ï¼Œæœƒå°æ‡‰åˆ°è³‡æ–™åº«å…§å°å¯«é–‹é ­è¤‡æ•¸ Collection mongoose.model('User', userSchema); å°æ‡‰åˆ° Collection åç¨±ç‚º users åŸ·è¡Œç·¨è­¯å¾Œï¼Œé€™æ™‚å€™é–‹å•Ÿ Compassï¼Œæ‡‰è©²å¯ä»¥çœ‹åˆ° nuxt_app Database è·Ÿ users Collectionï¼Œæ¥ä¸‹ä¾†å°±å¯ä»¥å°è³‡æ–™åº«é€²è¡Œæ“ä½œå›‰ Step5ï¼šå»ºç«‹ Server APIå»ºç«‹ä¸€æ”¯ POST API server/api/user.post.js ä½¿ç”¨&nbsp;unjs/h3&nbsp;æä¾› readBody()&nbsp;è¼”åŠ©å‡½å¼ï¼Œå–å¾— request body å…§å®¹ é€é Model å° Collection é€²è¡Œæºé€šèˆ‡æ“ä½œï¼Œä½¿ç”¨ ï¼­ongoose create() æ–¹æ³•æ–°å¢ä¸€ç­†è³‡æ–™ // server/api/user.post.jsimport User from '@/server/models/userModel';export default defineEventHandler(async event =&gt; { try { const { name, email } = await readBody(event); await User.create({ name, email }); const user = await User.findOne({ email }); return user; } catch (error) { return createError(error); }}); Step6ï¼šå‰ç«¯ä¸²æ¥ APIçµ‚æ–¼ä¾†åˆ°æœ€å¾Œä¸€æ­¥å•¦ï¼ åœ¨é é¢ä¸Šä½¿ç”¨ Nuxt3 $fetch æ–¹æ³•ç™¼é€è«‹æ±‚ï¼Œæ–°å¢ä¸€ç­†è³‡æ–™ // pages/index.vue&lt;template&gt; &lt;div&gt; &lt;label&gt;name&lt;/label&gt; &lt;input type=\"text\" v-model=\"user.name\" /&gt; &lt;label&gt;email&lt;/label&gt; &lt;input type=\"email\" v-model=\"user.email\" /&gt; &lt;button @click=\"addUser()\"&gt;Add User&lt;/button&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;const user = ref({ name: '', email: ''});const addUser = async () =&gt; { const response = await $fetch('/api/user', { method: 'POST', body: { ...user.value } }); console.log(response);};&lt;/script&gt; å›åˆ° Compass ç¢ºèªä¸€ä¸‹ï¼Œå¦‚æœæœ‰çœ‹åˆ°ä¸€ç­†è³‡æ–™ï¼Œå°±ä»£è¡¨ä¸²æ¥æˆåŠŸå›‰ï¼ åƒè€ƒè³‡æºï¼š https://medium.com/@flanker72/nuxt3-complex-solutions-database-integration-8df941f0fb82https://www.mongodb.com/","link":"/2023/09/22/nuxt3/nuxt-v3-mongodb-integration/"},{"title":"Nuxt.js 3.x Pages ç›®éŒ„ï¼è‡ªå‹•ç”Ÿæˆè·¯ç”±","text":"æœ¬ç¯‡æ–‡ç« åŒæ­¥ç™¼è¡¨æ–¼ 2023 iThome éµäººè³½ Pages è³‡æ–™å¤¾ç”¨ä¾†æ–°å¢é é¢ï¼Œç•¶æˆ‘å€‘åœ¨ Pages è³‡æ–™å¤¾å»ºç«‹æª”æ¡ˆï¼ŒNuxt æœƒæ ¹æ“šè³‡æ–™å¤¾ä»¥åŠæª”æ¡ˆçµæ§‹è‡ªå‹•ç”ŸæˆåŸºæ–¼ Vue Router çš„è·¯ç”±ï¼Œè®“æˆ‘å€‘èƒ½æ›´æœ‰æ•ˆç‡çš„é–‹ç™¼å’Œç®¡ç† app.vueå°ˆæ¡ˆé€²å…¥é»ï¼ŒNuxt3 å°‡&nbsp;app.vue&nbsp;ç§»åˆ°ç›®éŒ„é ï¼ˆNuxt2 ç„¡æ³•ç·¨è¼¯ app.vueï¼‰ï¼Œå› æ­¤ä¹Ÿå¯ä»¥åªç”¨&nbsp;app.vue&nbsp;å–®ä¸€é é¢ä¾†å»ºç½®ç¶²ç«™ï¼ˆä¾‹å¦‚å–®é  Landing Pageï¼‰ï¼Œè€Œä¸å®šç¾©&nbsp;pages/ï¼Œåœ¨æ­¤æƒ…æ³ä¸‹ Vue Router ä¸æœƒè¢«è¼‰å…¥ã€‚ å¦‚è¦ä½¿ç”¨&nbsp;pages/ï¼Œapp.vue&nbsp;éœ€åŠ ä¸Š&nbsp;&lt;NuxtPage&gt;&nbsp;ç”¨æ–¼é¡¯ç¤ºé é¢å…§å®¹ï¼ˆåŠŸèƒ½åŒ Vue.js çš„&nbsp;&lt;router-view&gt;ï¼‰ // app.vue&lt;template&gt; &lt;div&gt; &lt;NuxtPage /&gt; &lt;/div&gt;&lt;/template&gt; æ–°å¢ Pagesé¦–å…ˆå»ºç«‹é¦–é  pages/index.vue // pages/index.vue&lt;template&gt; &lt;div&gt; &lt;h1&gt;Home Page&lt;/h1&gt; &lt;/div&gt;&lt;/template&gt; åŸ·è¡Œ npm run dev ç·¨è­¯å¾Œï¼Œåœ¨ç€è¦½å™¨é–‹å•Ÿ http://localhost:3000ï¼Œå¯ä»¥çœ‹åˆ° Nuxt å·²ç¶“å¹«æˆ‘å€‘å®šç¾©è·¯ç”± è‡ªå‹•ç”¢ç”Ÿçš„è·¯ç”±çµæ§‹ï¼š { \"routes\": [ { \"path\": \"/\", \"component\": \"pages/index.vue\" } ]} æ³¨æ„ï¼šä¸€å€‹é é¢åªèƒ½å­˜åœ¨ä¸€å€‹æ ¹å…ƒç´ ï¼ˆroot elementï¼‰ï¼Œè·¯ç”±æ‰èƒ½æ­£å¸¸åœ¨é é¢é–“åˆ‡æ›ï¼ˆhtml è¨»è§£ä¹Ÿè¦–ç‚ºä¸€å€‹å…ƒç´ ï¼‰ä»¥ä¸‹ç‚ºéŒ¯èª¤ç¤ºç¯„ï¼š &lt;template&gt; &lt;!-- è¨»è§£ä¹Ÿè¦–ç‚ºä¸€å€‹å…ƒç´ ï¼Œå› æ­¤é é¢ç„¡æ³•æ­£å¸¸æ¸²æŸ“ --&gt; &lt;h1&gt;Home page&lt;/h1&gt;&lt;/template&gt; &lt;template&gt; &lt;h1&gt;Home page&lt;/h1&gt; &lt;p&gt;å…©å€‹æ ¹å…ƒç´ ï¼Œé é¢ç„¡æ³•æ­£å¸¸æ¸²æŸ“&lt;/p&gt;&lt;/template&gt; å‹•æ…‹è·¯ç”±Nuxt2 ä½¿ç”¨ä¸‹åº•ç·š _ å®šç¾©å‹•æ…‹è·¯ç”±ï¼ŒNuxt3 èª¿æ•´ç‚ºä½¿ç”¨æ–¹æ‹¬è™Ÿ [] ç¯„ä¾‹ï¼š pages/|â€”â€” index.vue|â€”â€” product-[category]/ |â€”â€” [id].vue é€é $route æˆ–æ˜¯ useRoute çµ„åˆå‡½å¼å–å¾—è·¯ç”±åƒæ•¸ï¼ŒuseRoute å…§å®¹åƒè€ƒ å®˜æ–¹æ–‡ä»¶ // pages/product-[category]/[id].vue&lt;template&gt; &lt;div&gt; &lt;h3&gt;{{ $route.params.category }}&lt;/h3&gt; &lt;p&gt;{{ $route.params.id }}&lt;/p&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;const route = useRoute();console.log(route.params.category);console.log(route.params.id);&lt;/script&gt; ç€è¦½å™¨è¼¸å…¥é é¢ http://localhost:3000/product-apple/112345ï¼Œç•«é¢æ¸²æŸ“å¦‚ä¸‹ Catch-all æ•æ‰è·¯å¾‘ä¸‹æ‰€æœ‰è·¯ç”±é€é [â€¦slug].vue å°‡å‹•æ…‹è·¯ç”±è§£æ§‹ï¼Œä¾†æ•æ‰åœ¨æ­¤è·¯å¾‘ä¸‹æœªè¢«å®šç¾©çš„é é¢ ç¯„ä¾‹ï¼š pages/|â€”â€” index.vue|â€”â€” [...slug].vue|â€”â€” about.vue // pages/[â€¦slug].vue&lt;template&gt; &lt;div&gt; &lt;h3&gt;Page Not Found&lt;/h3&gt; &lt;p&gt;{{ $route.params.slug }}&lt;/p&gt; &lt;/div&gt;&lt;/template&gt; ç•¶æˆ‘å€‘è¼¸å…¥æœªè¢«å®šç¾©çš„é é¢ /hello/worldï¼Œé¡¯ç¤º [â€¦slug].vue ç•«é¢å¦‚ä¸‹ é€é [â€¦slug].vueï¼Œæˆ‘å€‘å¯ä»¥ç°¡å–®åœ°æ•æ‰ç‰¹å®šè·¯å¾‘ä¸‹ä¸å­˜åœ¨çš„é é¢ï¼Œå…¨åŸŸçš„éŒ¯èª¤é é¢ï¼ˆä¸åªæ•æ‰ 404 éŒ¯èª¤ï¼‰ï¼Œå‰‡ç”± app.vue åŒå±¤çš„ error.vue è™•ç† error.vue è‡ªè¨‚æ–¹å¼å¯ä»¥åƒè€ƒ é€™ç¯‡æ–‡ç«  å·¢ç‹€è·¯ç”±ï¼ˆåµŒå¥—è·¯ç”±ï¼‰åœ¨é é¢æ’å…¥ &lt;NuxtPage&gt;ï¼ŒåµŒå¥—ä¸‹ä¸€å±¤è·¯ç”± ç¯„ä¾‹ï¼šå­é é¢ /parent/child-aã€/parent/child-b å…±äº«ä¸Šå±¤è·¯ç”±ï¼ˆ/parentï¼‰ç•«é¢ æª”æ¡ˆçµæ§‹ï¼ˆparent/ è³‡æ–™å¤¾èˆ‡ parent.vue å‘½åå¿…é ˆç›¸åŒï¼‰ï¼š pages/|â€”â€” parent/ |â€”â€” child-a.vue |â€”â€” child-b.vue|â€”â€” parent.vue è‡ªå‹•ç”¢ç”Ÿçš„è·¯ç”±çµæ§‹ï¼š { \"routes\": [ { path: '/parent', component: '~/pages/parent.vue', name: 'parent', children: [ { path: 'child', component: '~/pages/parent/child-a.vue', name: 'parent-child-a' }, { path: 'child', component: '~/pages/parent/child-b.vue', name: 'parent-child-b' } ] } ]} parent.vue å¿…é ˆåŠ ä¸Š &lt;NuxtPage&gt;ï¼Œç”¨ä¾†åµŒå¥—å­é é¢å…§å®¹ // pages/parent.vue&lt;template&gt; &lt;div&gt; // å…±ç”¨ Sidebar &lt;div class=\"sidebar\"&gt; &lt;NuxtLink to=\"/parent/child-a\"&gt;child-a&lt;/NuxtLink&gt; &lt;NuxtLink to=\"/parent/child-b\"&gt;child-b&lt;/NuxtLink&gt; &lt;/div&gt; // ç”¨ä¾†é¡¯ç¤ºå­é é¢å…§å®¹ &lt;NuxtPage /&gt; &lt;/div&gt;&lt;/template&gt; å¦‚æœçˆ¶å±¤è·¯ç”± /parent æœ‰è‡ªå·±çš„ç¨ç«‹ç•«é¢ï¼Œåœ¨ parent/ è³‡æ–™å¤¾æ–°å¢ index.vueï¼ˆä¹Ÿæœƒå…±äº« parent.vue ç•«é¢ï¼‰ pages/|â€”â€” parent/ |â€”â€” ... |â€”â€” index.vue|â€”â€” parent.vue // pages/parent/index.vue&lt;template&gt; &lt;div&gt; &lt;h2&gt;Parent Content&lt;/h2&gt; &lt;/div&gt;&lt;/template&gt; è‹¥å¸Œæœ›ä½¿ç”¨è€…é€²å…¥ /parent è·¯ç”±æ™‚å°å‘åˆ° /parent/child-aï¼Œå¯ä»¥åœ¨ /parent/index.vue é€é navigateTo() è¼”åŠ©å‡½å¼è¨­å®šè‡ªå‹•å°å‘ // pages/parent/index.vue&lt;template&gt; &lt;div&gt;Parent Content&lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;navigateTo('/parent/child-a', , { redirectCode: 301 });&lt;/script&gt; NuxtLink è·¯ç”±é€£çµé€é &lt;NuxtLink&gt; å…ƒä»¶é€²è¡Œé é¢å°èˆªï¼ŒNuxt3 çš„ &lt;NuxtLink&gt; æ•´åˆäº† Vue Router &lt;RouterLink&gt; è·Ÿ HTML &lt;a&gt; æ¨™ç±¤ï¼Œèƒ½å¤ æ™ºèƒ½åˆ¤æ–·å…§éƒ¨æˆ–å¤–éƒ¨é€£çµï¼Œä¸¦åŠ ä»¥å„ªåŒ–ï¼ˆåŠ å…¥é è¨­å±¬æ€§ï¼‰ &lt;template&gt; &lt;div&gt; // å…§éƒ¨é€£çµ &lt;NuxtLink to=\"/hello\"&gt;Internal&lt;/NuxtLink&gt; // å¤–éƒ¨é€£çµ &lt;NuxtLink to=\"https://mywebsite.com\"&gt;External&lt;/NuxtLink&gt; &lt;/div&gt;&lt;/template&gt; ç·¨è­¯å¾Œçµæœï¼Œå¤–éƒ¨é€£çµè‡ªå‹•åŠ ä¸Š rel å±¬æ€§ // å…§éƒ¨é€£çµ&lt;a href=\"/hello\"&gt;Internal&lt;/a&gt;// å¤–éƒ¨é€£çµ&lt;a href=\"https://mywebsite.com\" rel=\"noopener noreferrer\"&gt;External&lt;/a&gt; ä¹Ÿå¯ä»¥é€é props è‡ªå®šç¾©å±¬æ€§ï¼Œå±¬æ€§é¸é …åƒè€ƒ å®˜æ–¹æ–‡ä»¶ ç¯„ä¾‹ï¼š target=\"_blank\"ï¼šå¦é–‹æ–°åˆ†é  external=\"false\"ï¼šè¨­å®šç‚ºå…§éƒ¨é€£çµ no-relï¼šå°‡ rel å±¬æ€§ç§»é™¤ &lt;template&gt; &lt;div&gt; &lt;NuxtLink to=\"https://mywebsite.com\" target=\"_blank\" external=\"false\" no-rel&gt; External &lt;/NuxtLink&gt; &lt;/div&gt;&lt;/template&gt; åƒè€ƒè³‡æºï¼š https://nuxt.com/docs/guide/directory-structure/pageshttps://nuxt.com/docs/getting-started/routinghttps://medium.com/unalai/èªè­˜-vue-router-åµŒå¥—è·¯ç”±-nested-routes-8168f5395941","link":"/2023/08/18/nuxt3/nuxt-v3-pages/"},{"title":"Nuxt.js 3.x Plugins ç›®éŒ„ï¼æ“´å……æ’ä»¶ï¼‹è‡ªè¨‚æŒ‡ä»¤","text":"æœ¬ç¯‡æ–‡ç« åŒæ­¥ç™¼è¡¨æ–¼ 2023 iThome éµäººè³½ Plugins ç›®éŒ„å”åŠ©æˆ‘å€‘åœ¨ Nuxt æ“´å……å¥—ä»¶åŠŸèƒ½ã€‚å‰ç«¯é–‹ç™¼å¸¸æœƒæ­é… ç¬¬ä¸‰æ–¹å¥—ä»¶ï¼ˆpackageï¼‰ä½¿ç”¨ï¼Œå¦‚è¡¨å–®é©—è­‰ã€åœ–ç‰‡è¼ªæ’­ã€æç¤ºè¨Šæ¯ç­‰ï¼Œé€™äº›å¥—ä»¶é€šå¸¸å·²ç¶“è¢«é–‹ç™¼è€…è¨­è¨ˆå¥½ä¸¦ç¶“éæ¸¬è©¦ï¼Œå¯ä»¥ç›´æ¥å®‰è£ä½¿ç”¨ï¼Œç¯€çœå°ˆæ¡ˆé–‹ç™¼æ™‚é–“ã€‚ å»ºç«‹ Pluginsplugins/ è³‡æ–™å¤¾å…§ç¬¬ä¸€å±¤æª”æ¡ˆï¼ˆè³‡æ–™å¤¾å…§ç¬¬ä¸€å±¤ï¼‰ï¼ŒNuxt3 æœƒè‡ªå‹•è¼‰å…¥ï¼ˆauto-importsï¼‰ï¼Œä¸éœ€è¦åœ¨ nuxt.config å„åˆ¥è¨»å†Š plugins/|â€”â€” myPlugin.js // è‡ªå‹•å¼•å…¥|â€”â€” supportingFile/ |â€”â€” index.js // ä¸æœƒè‡ªå‹•å¼•å…¥ Plugin åªæä¾› nuxtApp å”¯ä¸€åƒæ•¸ï¼ŒnuxtApp ç‚ºä¸€å€‹ç‰©ä»¶ï¼ˆç›¸é—œå±¬æ€§ åƒè€ƒæ–‡ä»¶ï¼‰ // plugins/myPlugin.jsexport default defineNuxtPlugin(nuxtApp =&gt; { // ...}) è¼‰å…¥é †åºèª¿æ•´è¼‰å…¥é †åºç•¶ plugin ä¾è³´å¦ä¸€å€‹ plugin æ™‚å¯ä»¥ä½¿ç”¨æ­¤åŠŸèƒ½ï¼Œå°‡è¢«ä¾è³´çš„ plugin å„ªå…ˆè¼‰å…¥ ç¯„ä¾‹ï¼š 01.myPlugin.js æœƒå„ªå…ˆè¼‰å…¥ï¼Œå› æ­¤ 02.testPlugin.js èƒ½å¤ ä½¿ç”¨ 01.myPlugin.js æ³¨å…¥çš„å…§å®¹ plugins/|â€”â€” 01.myPlugin.js|â€”â€” 02.testPlugin.js æª”æ¡ˆåç¨±çš„æ’åºæ˜¯æ ¹æ“šå­—ä¸²æ’åºï¼ˆalphabeticalï¼‰è€Œä¸æ˜¯æ•¸å­—ï¼Œ10.xxx.js æ’åºæœƒåœ¨ 2.xxx.js å‰ï¼Œå› æ­¤ä¸Šè¿°ç¯„ä¾‹éœ€åŠ ä¸Š ã€Œ0ã€ å‰ç¶´ è¨­å®šåŒæ™‚è¼‰å…¥plugins/ é è¨­æœƒä¾åºè¼‰å…¥ï¼Œå¦‚æœå¸Œæœ›åŒæ™‚è¼‰å…¥ï¼Œåªè¦åœ¨ plugin å…§åŠ ä¸Š parallel: trueï¼Œä¸‹ä¸€é †ä½ plugin å°±æœƒè·Ÿé€™å€‹ plugin åŒæ™‚è¼‰å…¥ åœ¨ç‰¹æ®Šä½¿ç”¨æƒ…å¢ƒä¸‹ï¼Œplugin ä¹Ÿå¯ä»¥é€éç‰©ä»¶æ ¼å¼ä¾†å®šç¾© // plugins/asyncPlugin.jsexport default defineNuxtPlugin({ name: 'async-plugin', parallel: true, async setup (nuxtApp) { // é€™è£¡çš„åŠŸèƒ½ç­‰åŒæ–¼ä¸€èˆ¬å‡½å¼å®šç¾©çš„ plugin }}) åœ¨ Plugin å…§ä½¿ç”¨ Composablesï¼ˆçµ„åˆå¼å‡½å¼ï¼‰// plugins/myPlugin.jsexport default defineNuxtPlugin(nuxtApp =&gt; { const counter = useCounter();}) éœ€æ³¨æ„ï¼Œåœ¨ Plugins ä½¿ç”¨ Composables æœ‰ä¸€äº›é™åˆ¶ï¼š è‹¥ composable ä¾è³´æ–¼ç¨å¾Œè¼‰å…¥çš„å¦ä¸€å€‹ pluginï¼Œå¯èƒ½ç„¡æ³•æ­£å¸¸é‹ä½œ è‹¥ composable ä¾è³´ Vue ç”Ÿå‘½é€±æœŸï¼Œç”±æ–¼ composable ç¶å®šçš„æ˜¯ä½¿ç”¨ä»–çš„å…ƒä»¶å¯¦é«”ï¼Œä½† plugin åªæœƒç¶å®šåœ¨ nuxtApp å¯¦ä¾‹ï¼Œå¯èƒ½ç„¡æ³•æ­£å¸¸é‹ä½œ Provide æ³¨å…¥å…¨åŸŸè®Šæ•¸æ³¨å…¥å…¨åŸŸè®Šæ•¸åˆ° nuxtAppï¼Œæä¾›å…©ç¨®å®šç¾©æ–¹å¼ï¼š export default defineNuxtPlugin(nuxtApp =&gt; { // æ–¹æ³•ä¸€ nuxtApp.provide('hello', (msg: string) =&gt; `Hello ${msg} !`); // æ–¹æ³•äºŒ return { provide: { hello: (msg: string) =&gt; `Hello ${msg} !` } };}) åŠŸèƒ½åŒ Nuxt2 inject å¯«æ³•ï¼š inject('hello', msg =&gt; Hello ${msg} !) æ¥è‘—å°±å¯ä»¥åœ¨é é¢é€é useNuxtApp() å‡½å¼å–å¾—å®šç¾©åœ¨ nuxtApp çš„å…¨åŸŸè®Šæ•¸ $hello // pages/hello.vue&lt;template&gt; &lt;div&gt; {{ $hello('World') }} &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;const { $hello } = useNuxtApp();&lt;/script&gt; æ­é…ç¬¬ä¸‰æ–¹å¥—ä»¶ä»¥ https://github.com/kyvg/vue3-notification ï¼ˆæç¤ºè¨Šæ¯å½ˆè·³è¦–çª—ï¼‰ç‚ºä¾‹ å®‰è£å¥—ä»¶npm i @kyvg/vue3-notification å»ºç«‹ Plugin é€é nuxtApp.vueApp.use() åœ¨ Vue.js è¨»å†Šå…¨åŸŸ plugin ä¸¦æ­é…å‰é¢æåˆ°çš„ nuxtApp.provide() åœ¨ Nuxt è¨»å†Šå…¨åŸŸè®Šæ•¸æˆ–æ–¹æ³• // plugins/notification.jsimport Notifications, { useNotification } from '@kyvg/vue3-notification';const { notify } = useNotification();export default defineNuxtPlugin(nuxtApp =&gt; { nuxtApp.vueApp.use(Notifications); return { provide: { notify } };}); ä½¿ç”¨æç¤ºè¨Šæ¯åŸ·è¡Œæ³¨å…¥åœ¨ Nuxt çš„å…¨åŸŸè®Šæ•¸ $notifyï¼Œé¡¯ç¤ºæç¤ºç•«é¢ // pages/index.vue&lt;template&gt; &lt;div&gt; &lt;notifications /&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;export default { const { $notify } = useNuxtApp(); onMounted(() =&gt; { $notify({ type: 'success', title: 'Notification Title' text: 'Notification Text' }); });};&lt;/script&gt; Custom Directives è‡ªè¨‚æŒ‡ä»¤Vue è‡ªè¨‚æŒ‡ä»¤èªªæ˜å¯ä»¥åƒè€ƒ é€™ç¯‡æ–‡ç«  é™¤äº† Vue å…§å»ºçš„ç³»åˆ—æŒ‡ä»¤ï¼Œåƒæ˜¯&nbsp;v-model,&nbsp;v-for,&nbsp;v-show&nbsp;ç­‰ï¼Œæˆ‘å€‘ä¹Ÿå¯ä»¥ä½¿ç”¨ Vue directives è‡ªè¨‚æŒ‡ä»¤ï¼Œå°‡ DOM å…ƒç´ å’Œå…ƒä»¶é€²è¡Œå‹•æ…‹ç¶å®šï¼Œä¸¦å°å…¶é€²è¡Œæ“ä½œ // plugins/focus.jsexport default defineNuxtPlugin(nuxtApp =&gt; { nuxtApp.vueApp.directive('focus', { mounted(el) { el.focus(); } });}); ä½¿ç”¨è‡ªè¨‚æŒ‡ä»¤ // pages/index.vue&lt;template&gt; &lt;div&gt; &lt;label&gt;name&lt;/label&gt; &lt;input type=\"text\" v-focus /&gt; &lt;label&gt;password&lt;/label&gt; &lt;input type=\"password\" /&gt; &lt;/div&gt;&lt;/template&gt; èª¿æ•´è¼‰å…¥æ™‚æ©Ÿï¼ˆserver or clientï¼‰åœ¨æª”ååŠ ä¸Š&nbsp;.client&nbsp;æˆ–æ˜¯&nbsp;.server&nbsp;å¾Œç¶´å³å¯ plugins/|â€”â€” myPlugin.client.js|â€”â€” testPlugin.server.js ç•¶æˆ‘å€‘ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹å¥—ä»¶å®šç¾©äº†&nbsp;windowã€document&nbsp;ç­‰ç€è¦½å™¨å…¨åŸŸè®Šæ•¸ï¼Œç›´æ¥å®šç¾© pluginï¼ŒåŸ·è¡Œæ™‚å¯èƒ½æœƒæ‹‹éŒ¯èª¤&nbsp;window is not definedï¼Œå› ç‚º server ç«¯é æ¸²æŸ“æ™‚æ‰¾ä¸åˆ°è®Šæ•¸ï¼Œé€™æ™‚å€™å°±å¯ä»¥åŠ ä¸Š .client å¾Œç¶´ä¾†é™åˆ¶è¼‰å…¥æ™‚æ©Ÿ åƒè€ƒè³‡æºï¼š https://nuxt.com/docs/guide/directory-structure/plugins#plugins-directoryhttps://ithelp.ithome.com.tw/articles/10299002","link":"/2023/07/10/nuxt3/nuxt-v3-plugins/"},{"title":"Nuxt.js 3.x Server ç›®éŒ„ï¼å»ºç«‹ API","text":"æœ¬ç¯‡æ–‡ç« åŒæ­¥ç™¼è¡¨æ–¼ 2023 iThome éµäººè³½ Nuxt3 æ­é…äº†æ–°çš„ä¼ºæœå™¨å¼•æ“ Nitroï¼Œè®“æˆ‘å€‘èƒ½è¼•é¬†åœ¨ Nuxt å°ˆå…§å»ºç«‹ Server APIã€‚Nitro çš„å„ªé»åŒ…å«è·¨å¹³å°æ”¯æ´ Node.js èˆ‡ç€è¦½å™¨ã€æ”¯æ´ HMRã€è‡ªå‹•ç”Ÿæˆ API è·¯ç”±ç­‰ï¼Œè®“ Nuxt å…·å‚™å…¨ç«¯åŠŸèƒ½ï¼Œæ¥ä¸‹ä¾†ä¸€èµ·é€²è¡Œå¯¦ä½œå§ã€‚ å»ºç«‹ API åœ¨ server/ ç›®éŒ„å»ºç«‹ APIï¼ŒNuxt æœƒä¾æ“šè³‡æ–™å¤¾çµæ§‹è‡ªå‹•ç”Ÿæˆ API è·¯å¾‘ ä½¿ç”¨ defineEventHandler() å»ºç«‹äº‹ä»¶è™•ç†å™¨ ç¯„ä¾‹æª”æ¡ˆçµæ§‹ï¼š server/|â€”â€” api/ |â€”â€” hello.js|â€”â€” routes/ |â€”â€” hello.js æ”¾ç½®æ–¼ /server/api ä¸‹çš„æª”æ¡ˆï¼Œä¾æ“šæª”æ¡ˆåç¨±ç”¢ç”Ÿ /api å‰ç¶´è·¯å¾‘ï¼ˆ/api/helloï¼‰ï¼Œå¦‚æœä¸æƒ³åŠ ä¸Š /api å‰ç¶´ï¼Œå°‡æª”æ¡ˆæ”¾ç½®æ–¼ /server/routes å³å¯ ä¸è«–å‰¯æª”åç‚º .jsã€.tsï¼Œå‡ä¾æ“šæª”æ¡ˆåç¨±ç”¢ç”Ÿ API è·¯å¾‘ ç¯„ä¾‹ï¼šæ–°å¢ /api/hello API // server/api/hello.jsexport default defineEventHandler(() =&gt; 'Hello World!'); æ¥è‘—åœ¨ç€è¦½å™¨é–‹å•Ÿé é¢ http://localhost:3000/api/hello HTTP MethodsServer API é è¨­è«‹æ±‚æ–¹æ³•ç‚º getï¼Œå¦‚æœè¦èª¿æ•´å…¶ä»–æ–¹æ³• postã€patchã€deleteï¼ŒåŠ åœ¨æª”åå¾Œç¶´å³å¯ server/|â€”â€” api/ |â€”â€” user.post.js |â€”â€” user.delete.js ç¯„ä¾‹ï¼šæ–°å¢ /api/user APIï¼Œä¸¦ä½¿ç”¨ post æ–¹æ³• Nitro æ­é… unjs/h3 ä¾†å»ºç«‹ Server APIï¼ŒreadBody() ç‚º unjs/h3 æä¾›çš„ utilitesï¼Œç”¨ä¾†å–å¾— request bodyï¼Œå…¶ä»– utilites å¯ä»¥åƒè€ƒ å®˜æ–¹æ–‡ä»¶ // server/api/user.post.jsexport default defineEventHandler(async event =&gt; { const body = await readBody(event); return { ...body };}); åœ¨é é¢ä½¿ç”¨ Nuxt3 useFetch æ–¹æ³•ç™¼å‡ºè«‹æ±‚ï¼ˆuseFetch åƒè€ƒæ–‡ç« ï¼‰ // pages/index.vue&lt;template&gt; &lt;div&gt; &lt;div&gt;name: {{ user.name }}&lt;/div&gt; &lt;div&gt;age: {{ user.age }}&lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;const { data: user } = useFetch('/api/user', { method: 'post', body: { name: 'Daniel', age: 18 }});&lt;/script&gt; ç•«é¢å¦‚ä¸‹ï¼š æ•æ‰æ‰€æœ‰è·¯ç”±ï¼ˆCatch-all Routeï¼‰é€éæª”å [â€¦] ä¾†æ•æ‰æœªè¢«å®šç¾©çš„ API è·¯å¾‘ï¼ˆfallback routeï¼‰ ç¯„ä¾‹æª”æ¡ˆçµæ§‹ï¼š server/|â€”â€” api/ |â€”â€” hello.js |â€”â€” [...].js é€é createError() æ–¹æ³•ä¾†è™•ç†éŒ¯èª¤ // server/api/[...].jsexport default defineEventHandler(() =&gt; { throw createError({ statusCode: 404, statusMessage: 'API Path Not Found' })}); ç•¶æˆ‘å€‘å‘æœªå®šç¾©çš„è·¯ç”±ç™¼å‡ºè«‹æ±‚ï¼Œä¾‹å¦‚ /api/nothing // pages/index.vue&lt;template&gt; &lt;div&gt; error: &lt;pre&gt;{{ error.data }}&lt;/pre&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;const { error } = useFetch('/api/nothing');&lt;/script&gt; é¡¯ç¤ºéŒ¯èª¤è¨Šæ¯å¦‚ä¸‹ å¯¦ä½œ API è«‹æ±‚ä»¥ä¸‹ç¯„ä¾‹æ­é…éœæ…‹è³‡æ–™ä¸²æ¥ Nuxt3 æ•´åˆ MongoDB è«‹åƒè€ƒ é€™ç¯‡æ–‡ç«  Step1ï¼šå»ºç«‹éœæ…‹è³‡æ–™é¦–å…ˆåœ¨ public/users.json å»ºç«‹è³‡æ–™ï¼ˆç¯„ä¾‹è³‡æ–™ä¾†æºï¼šjsonplaceholderï¼‰ // public/users.json[ { \"id\": 1, \"name\": \"Leanne Graham\", \"username\": \"Bret\", \"email\": \"Sincere@april.biz\", \"phone\": \"1-770-736-8031\" }, { \"id\": 2, \"name\": \"Ervin Howell\", \"username\": \"Antonette\", \"email\": \"Shanna@melissa.tv\", \"phone\": \"010-692-6593\" }] Step2ï¼šå»ºç«‹ APIæ–°å¢ server/api/user/[id].js ä½¿ç”¨æ–¹æ‹¬è™Ÿ [] è¡¨ç¤ºå‹•æ…‹åƒæ•¸ ä½¿ç”¨ getRouterParam() æ–¹æ³•å–å¾—åƒæ•¸ // server/api/user/[id].jsimport users from '@/public/users.json';export default defineEventHandler(event =&gt; { const id = getRouterParam(event, 'id'); return users.find(user =&gt; user.id === parseInt(id)) || {};}); Step3ï¼šç™¼å‡ºè«‹æ±‚æ–°å¢ pages/user/[id].vue æ–¹æ‹¬è™Ÿ [] è¡¨ç¤ºå‹•æ…‹è·¯ç”± ä½¿ç”¨ useRoute() æ–¹æ³•å–å¾—è·¯ç”±åƒæ•¸ é€é useFetch() æ–¹æ³•ç™¼å‡ºè«‹æ±‚ // pages/user/[id].vue&lt;template&gt; &lt;div&gt; &lt;div&gt;name: {{ user.name }}&lt;/div&gt; &lt;div&gt;email: {{ user.email }}&lt;/div&gt; &lt;div&gt;phone: {{ user.phone }}&lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt; const route = useRoute(); const { data: user } = useFetch(`/api/user/${route.params.id}`);&lt;/script&gt; æ¥ä¸‹ä¾†åœ¨ç€è¦½å™¨è¼¸å…¥ http://localhost:3000/user/1 åƒè€ƒè³‡æºï¼š https://nuxt.com/docs/guide/concepts/server-enginehttps://nuxt.com/docs/guide/directory-structure/serverhttps://masteringnuxt.com/blog/server-routes-in-nuxt-3","link":"/2023/09/04/nuxt3/nuxt-v3-server/"},{"title":"Nuxt.js 3.x æ›¿ç¶²ç«™å¢åŠ  Sitemap ç¶²ç«™åœ°åœ–","text":"æœ¬ç¯‡æ–‡ç« åŒæ­¥ç™¼è¡¨æ–¼ 2023 iThome éµäººè³½ Sitemap æ˜¯ä¸€ç¨®ç”¨ä¾†æä¾›ç¶²ç«™è³‡è¨Šçš„æª”æ¡ˆï¼Œè¨˜éŒ„ç¶²ç«™å…§çš„ç¶²é ã€åœ–ç‰‡ç­‰ï¼Œä¸»è¦åŠŸç”¨ç‚ºå”åŠ©æœå°‹å¼•æ“å¿«é€Ÿäº†è§£æˆ‘å€‘çš„ç¶²é ã€‚ æ–°ç¶²ç«™ä¸Šç·šå¾Œï¼Œé›–ç„¶æœå°‹å¼•æ“çˆ¬èŸ²æœƒè‡ªå‹•è®€å–ç¶²ç«™å…§å®¹ä¸¦æ”¶éŒ„ï¼Œä¸éç•¶ç¶²ç«™è¦æ¨¡è¼ƒå¤§ã€æ¶æ§‹è¼ƒè¤‡é›œã€å½¼æ­¤é–“é€£çµæ€§è¼ƒä½ï¼Œå¯èƒ½éœ€è¦èŠ±è¼ƒé•·çš„æ™‚é–“æ‰èƒ½å®Œæ•´æ”¶éŒ„ï¼Œé€é Sitemapï¼Œç›´æ¥å‘Šè¨´æœå°‹å¼•æ“ç¶²é è³‡è¨Šï¼Œèƒ½æœ‰æ•ˆåŠ å¿«ç¶²é æ”¶éŒ„çš„é€Ÿåº¦ã€‚ æ¥ä¸‹ä¾†èªªæ˜å¦‚ä½•åœ¨ Nuxt3 å°ˆæ¡ˆå…§åŠ å…¥ Sitemap ç¶²ç«™åœ°åœ–ï¼š å¥—ä»¶å®‰è£å®‰è£ Nuxt3 æ•´åˆæ¨¡çµ„ nuxt-simple-sitemapï¼Œæœ¬ç¯‡æ­é…ç‰ˆæœ¬ v.3.3.2 npm i -D nuxt-simple-sitemap nuxt.config é…ç½®æ¨¡çµ„// nuxt.config.jsexport default defineNuxtConfig({ modules: [ 'nuxt-simple-sitemap' ]}); æ¨™æº–ç¶²å€å®šç¾©Canonical URLï¼ˆæ¨™æº–ç¶²å€ï¼‰å®šç¾©å°æ–¼ SEO å¾ˆé‡è¦ï¼Œç”¨ä¾†å‘Šè¨´æœå°‹å¼•æ“æ¨™æº–çš„ç¶²å€ï¼Œè§£æ±ºé‡è¤‡å…§å®¹ç¶²é å•é¡Œï¼ˆexï¼šwww.example.com&nbsp;ä»¥åŠ&nbsp;example.comï¼‰ æ¨™æº–ç¶²å€å° SEO åˆ°åº•æœ‰å¤šé‡è¦ï¼Ÿé€™è£¡æ¨è–¦ä¸€ç¯‡ æ–‡ç«  // nuxt.config.jsexport default defineNuxtConfig({ site: { url: 'http://example.com' }}); å»ºç«‹ Sitemapå‡è¨­å°ˆæ¡ˆ pages/ é é¢çµæ§‹å¦‚ä¸‹ pages/|â€”â€” index.vue|â€”â€” hello.vue|â€”â€” about.vue|â€”â€” user/ |â€”â€” [id].vue|â€”â€” post/ |â€”â€” [id].vue åŸ·è¡Œ nuxt dev ç·¨è­¯å¾Œï¼Œç€è¦½å™¨è¼¸å…¥ http://localhost:3000/sitemap.xmlï¼Œå¯ä»¥çœ‹åˆ°éœæ…‹è·¯å¾‘è‡ªå‹•è¢«åŠ å…¥ Sitemap é»é¸ /sitemap.xml?cancicalï¼Œå¯ä»¥çœ‹åˆ° URL èª¿æ•´ç‚ºå‰é¢å®šç¾©çš„æ¨™æº–ç¶²å€ è‡ªå‹•åŠ å…¥çš„éœæ…‹é é è¨­æ²’æœ‰å¸¶ä¸Š priority èˆ‡ changefreq åƒæ•¸ï¼Œéœ€åœ¨è¨­å®šæª” defaults åŠ å…¥ // nuxt.config.jsexport default defineNuxtConfig({ sitemap: { defaults: { changefreq: 'daily', priority: 0.8 } }}); sitemap configure ç›¸é—œåƒæ•¸èˆ‡é è¨­å€¼ï¼Œè«‹åƒè€ƒ å®˜æ–¹æ–‡ä»¶ Sitemap åŠ å…¥å‹•æ…‹è·¯å¾‘éœæ…‹è·¯å¾‘åŸ·è¡Œç·¨è­¯æ™‚æœƒè‡ªå‹•ç”¢ç”Ÿï¼Œå‹•æ…‹è·¯å¾‘å‰‡éœ€è¦çµåˆå¾Œç«¯ API å–å¾— éœ€å…ˆå…·å‚™ Nuxt3 data fetching ç›¸é—œè§€å¿µï¼Œå¯ä»¥åƒè€ƒ é€™ç¯‡æ–‡ç«  Step1ï¼šæ–°å¢ _sitemap-urls.jsé è¨­è·¯å¾‘çµæ§‹å¦‚ä¸‹ï¼š server/|â€”â€” api/ |â€”â€” _sitemap-urls.js é è¨­è·¯å¾‘ç‚º server/api/_sitemap-urls.jsï¼Œå¯ä»¥é€é dynamicUrlsApiEndpoint åƒæ•¸èª¿æ•´è·¯å¾‘ // nuxt.config.jsexport default defineNuxtConfig({ sitemap: { dynamicUrlsApiEndpoint: '/_sitemap' }}); Step2ï¼šé€é API å–å¾—å‹•æ…‹è·¯ç”±ç¯„ä¾‹ï¼š å‡è¨­ API å¦‚ä¸‹ // server/api/users.jsexport default defineEventHandler(() =&gt; { return [ '/user/1', '/user/2' ];}); åœ¨ server/api/_sitemap-urls.js ç™¼å‡ºè«‹æ±‚ä¸¦å›å‚³ URL å…§å®¹ Nuxt3 $fetch æ–¹æ³•ï¼Œå¯ä»¥åƒè€ƒ&nbsp;é€™ç¯‡æ–‡ç«  // server/api/_sitemap-urls.jsexport default defineEventHandler(async () =&gt; { const [ users, posts ] = await Promise.all([ $fetch('/api/users'), $fetch('/api/posts') ]); return [ ...users, ...posts ].map(url =&gt; { return { loc: url, lastmod: new Date() }; });}); åŸ·è¡Œ nuxt dev ç·¨è­¯å¾Œï¼Œå¯ä»¥çœ‹åˆ°å‹•æ…‹è·¯ç”±ä¹Ÿè¢«åŠ å…¥ Sitemap Sitemap æ•´åˆ I18næ­é… Nuxt3 I18n æ•´åˆæ¨¡çµ„ @nuxtjs/i18n é–‹ç™¼ï¼Œnuxt-simple-sitemap æœƒè‡ªå‹•æ•´åˆï¼Œç”¢å‡ºå„èªç³» sitemap æª” @nuxtjs/i18n å¥—ä»¶å®‰è£åƒè€ƒ é€™ç¯‡æ–‡ç«  ç¯„ä¾‹ï¼šèªç³»åˆ†ç‚ºè‹±æ–‡èˆ‡ç¹ä¸­ é è¨­æœƒç”¢å‡ºä¸€å€‹ index sitemapï¼ˆexï¼šsitemap_index.xmlï¼‰ä½œç‚ºå„èªç³» sitemap ç´¢å¼• é»æ“ŠæŸ¥çœ‹è‹±æ–‡ç‰ˆ sitemap http://localhost:3000/en-sitemap.xml å¦‚æœæƒ³åˆä½µèªç³»æª”ï¼Œå°‡ sitemaps è¨­ç‚º false å³å¯ // nuxt.config.jsexport default defineNuxtConfig({ sitemap: { sitemaps: false }}); çœ‹åˆ°é€™è£¡ï¼Œæˆ–è¨±æœ‰äººæœƒç´æ‚¶ç‚ºä»€éº¼ sitemap ç¼ºå°‘äº†é‡è¦çš„ hreflang èªç³»æ¨™ç±¤ï¼Œå…¶å¯¦hreflang æ˜¯å­˜åœ¨çš„ï¼Œä¸Šé¢çœ‹åˆ°çš„åªæ˜¯é–±è¦½ç”¨çš„ XSL æª”ï¼Œè¦æŸ¥çœ‹åŸå§‹çš„ sitemap.xmlï¼Œè«‹è¦‹ä¸‹ä¸€æ®µèªªæ˜ èª¿æ•´ Sitemap UIå‰é¢çœ‹åˆ°çš„ sitemap åªæ˜¯æ–¹é¢æˆ‘å€‘é–±è¦½ç”¨çš„ XSL æª”ï¼Œæœå°‹å¼•æ“çœŸå¯¦è®€å–åˆ°çš„ sitemap.xml æ˜¯æ²’æœ‰ CSS æ¨£å¼çš„æª”æ¡ˆ æŸ¥çœ‹åŸå§‹ Sitemapå¦‚æœæƒ³ç¢ºèªåŸå§‹ sitemap.xmlï¼Œå°‡ xsl è¨­ç‚º false // nuxt.config.jsexport default defineNuxtConfig({ sitemap: { xsl: false }}); sitemap å¦‚æœæœ‰ &lt;xhtml:link /&gt; å±¬æ€§ï¼Œåƒæ˜¯å¤šåœ‹èªç³»æ­é… hreflang æ¨™ç±¤ï¼Œç€è¦½å™¨ç•«é¢æ¸²æŸ“æœƒç•°å¸¸ï¼Œå¦‚ä¸‹åœ–æ‰€ç¤ºã€‚é€™åªæ˜¯ç€è¦½å™¨æ¸²æŸ“å•é¡Œï¼Œä¸¦ä¸å½±éŸ¿ Sitemap æœ¬èº«åŠŸèƒ½ï¼Œæœå°‹å¼•æ“çˆ¬èŸ²ä¸€æ¨£å¯ä»¥æ­£å¸¸è®€å–ï¼Œè©³ç´°èªªæ˜å¯ä»¥åƒè€ƒ è¨è«–ä¸² èª¿æ•´æ¬„ä½é¡¯ç¤ºå…§å®¹é€é xslColumns èª¿æ•´æ¬„ä½ // nuxt.config.jsexport default defineNuxtConfig({ sitemap: { xslColumns: [ { label: 'URL', width: '25%' }, // URL æ¬„ä½å¿…å¡« { label: 'Last Modified', select: 'sitemap:lastmod', width: '25%' }, { label: 'Change Frequency', select: 'sitemap:changefreq', width: '25%' }, { label: 'Priority', select: 'sitemap:priority', width: '12.5%' }, { label: 'Hreflangs', select: 'count(xhtml:link)', width: '12.5%' } ] }}); Hreflangs å±¬æ€§ï¼Œå¿…é ˆè¦æ­é… nuxt-simple-sitemap v3.3.2 ä»¥ä¸Šç‰ˆæœ¬æ‰èƒ½ä½¿ç”¨ ä¾†çœ‹ä¸€ä¸‹èª¿æ•´å¾Œçš„ç•«é¢ åƒè€ƒè³‡æºï¼š https://nuxtseo.com/https://nuxt.com/docs/getting-started/deployment#selective-pre-renderinghttps://stackblitz.com/edit/nuxt-starter-umyso3?file=nuxt.config.ts","link":"/2023/09/18/nuxt3/nuxt-v3-sitemap/"},{"title":"Nuxt.js 3.x ç‹€æ…‹ç®¡ç† State Management (3)ï¼Pinia Plugin Persistedstate","text":"æœ¬ç¯‡æ–‡ç« åŒæ­¥ç™¼è¡¨æ–¼ 2023 iThome éµäººè³½ å‰ä¸€ç¯‡ èªªæ˜äº†åœ¨ Nuxt3 æ­é… Pinia ç‹€æ…‹ç®¡ç†å·¥å…·å…¨åŸŸå…±äº«ç‹€æ…‹ï¼Œæœ¬ç¯‡å°‡ä»‹ç´¹ pinia-plugin-persistedstate å¥—ä»¶ï¼Œç”¨ä¾†å°‡ Store ç‹€æ…‹å„²å­˜æ–¼ç€è¦½å™¨ä¸­ï¼Œé¿å…ç‹€æ…‹è¢«é‚„åŸ Pinia Plugin Persistedstatepinia-plugin-persistedstate ç”¨ä¾†å°‡ Store ç‹€æ…‹ä¿å­˜æ–¼ä½¿ç”¨è€…çš„ç€è¦½å™¨ä¸­ï¼Œä»¥ä¸‹å…©å€‹æƒ…å¢ƒæ¨è–¦ä½¿ç”¨ï¼š ä½¿ç”¨è€…ä¸‹æ¬¡å†ç€è¦½ç•«é¢æ™‚ï¼Œéœ€ä¿å­˜å…ˆå‰æ“ä½œçš„ç‹€æ…‹ é¿å…é é¢é‡æ–°æ•´ç†æ™‚ï¼Œç‹€æ…‹è¢«é‚„åŸ å¥—ä»¶å®‰è£æ­é… Nuxt æ•´åˆæ¨¡çµ„ @pinia-plugin-persistedstate/nuxt é€²è¡Œå®‰è£ï¼š npm install -D @pinia-plugin-persistedstate/nuxt pinia-plugin-persistedstate å¿…é ˆæ­é… Pinia ä½¿ç”¨ nuxt.config é…ç½®// nuxt.config.jsexport default defineNuxtConfig({ modules: [ '@pinia/nuxt', '@pinia-plugin-persistedstate/nuxt' ]}) Store é–‹å•Ÿç‹€æ…‹ä¿å­˜Option Storeå°‡ persist åƒæ•¸è¨­å®šç‚º true // store/index.jsexport const useMainStore = defineStore('main', { state: () =&gt; ({ counter: 0 }), getters: { doubleCounter() { return this.counter * 2; } }, actions: { increment() { this.counter++; } }, persist: true}); Setup StoredefineStore å‚³å…¥åƒæ•¸ { persist: true } // store/index.jsexport const useMainStore = defineStore( 'main', () =&gt; { const counter = ref(0); const doubleCounter = computed(() =&gt; counter.value * 2); const increment = () =&gt; { counter.value++; }; return { counter, doubleCounter, increment }; }, { persist: true }); é¸é …é…ç½®é è¨­é…ç½®ï¼š å„²å­˜æ–¼ cookie é è¨­ key ç‚º store.$id ä½¿ç”¨ JSON.stringify() èˆ‡ JSON.parse() é€²è¡Œåºåˆ—åŒ– / ååºåˆ—åŒ– é è¨­æ•´å€‹ state éƒ½æœƒè¢«ä¿å­˜ Key å‹åˆ¥ï¼šstringé è¨­å€¼ï¼šstore.$id ä»¥ä¸‹ç‚ºä¾‹ï¼Œé è¨­ key ç‚º mainï¼Œèª¿æ•´ç‚º my-custom-key // store/index.jsexport const useMainStore = defineStore('main', () =&gt; { // ... }, { persist: { key: 'my-custom-key' } }); åœ¨å„²å­˜åº«å¯ä»¥çœ‹åˆ°èª¿æ•´å¾Œçš„ key å€¼ storage é è¨­å€¼ï¼šcookieé¸é …ï¼šlocalStorageã€sessionStorageã€cookie ä½¿ç”¨è‡ªå‹•å¼•å…¥çš„ persistedState è®Šæ•¸é€²è¡Œé…ç½® // store/index.jsexport const useMainStore = defineStore('main', () =&gt; { // ... }, { persist: { storage: persistedState.localStorage } }); å›  storage åªå­˜åœ¨ç€è¦½å™¨ç«¯ï¼Œå¦‚æœæœªæ­é… persistedState å®šç¾©ï¼Œåœ¨ ssr æœƒå‡ºç¾éŒ¯èª¤ï¼Œä¹Ÿå¯ä»¥é€éåˆ¤æ–·å¼å®šç¾©ï¼š { persist: { storage: process.client ? localStorage : null }} cookiesWithOptions()ç”¨ä¾†è¨­å®š cookieï¼Œé¸é …åŒ Nuxt Composable useCookieï¼Œstorage éœ€ç‚º cookie æ‰èƒ½ä½¿ç”¨ // store/index.jsexport const useMainStore = defineStore('main', () =&gt; { // ... }, { persist: { storage: persistedState.cookiesWithOptions({ sameSite: 'strict' }) } }); paths å‹åˆ¥ï¼šstring[]é è¨­å€¼ï¼šundefined é è¨­æ•´å€‹ state éƒ½æœƒè¢«ä¿å­˜åœ¨ storageã€‚å¦‚æœæƒ³æŒ‡å®šåƒæ•¸ï¼Œä½¿ç”¨ paths é€²è¡Œèª¿æ•´ // store/index.jsexport const useMainStore = defineStore('main', () =&gt; { const counter = ref(0); const user = ref({ name: 'Daniel', age: 18 }); }, { persist: { paths: [ 'user.name' ] } }); serializer é è¨­å€¼ï¼šJSON.stringifyã€JSON.parse æŒ‡å®šåºåˆ—åŒ–æ–¹æ³•ï¼ˆå¿…é ˆåŒ…å« serializeã€deserializeï¼‰ï¼Œä»¥ä¸‹ç¯„ä¾‹èª¿æ•´ç‚ºå£“ç¸®æª” // store/index.jsimport { parse, stringify } from 'zipson';export const useMainStore = defineStore('main', () =&gt; { // ... }, { persist: { serializer: { serialize: stringify, deserialize: parse } } }); debug å‹åˆ¥ï¼šbooleané è¨­å€¼ï¼šfalse è¨­å®šç‚º trueï¼Œç•¶ç™¼ç”Ÿä»»ä½•éŒ¯èª¤ï¼Œéƒ½æœƒä½¿ç”¨ conosle.error å°å‡º å…¨åŸŸé¸é …é…ç½®åœ¨ nuxt.config ä½¿ç”¨ piniaPersistedstate å…¨åŸŸèª¿æ•´é¸é … // nuxt.config.jsexport default defineNuxtConfig({ modules: [ '@pinia/nuxt', '@pinia-plugin-persistedstate/nuxt' ], piniaPersistedstate: { storage: 'cookie', cookieOptions: { sameSite: 'strict' } }}) åƒè€ƒè³‡æºï¼š https://prazdevs.github.io/pinia-plugin-persistedstate/","link":"/2023/08/16/nuxt3/nuxt-v3-state-management-persistedstate/"},{"title":"Nuxt.js 3.x ç‹€æ…‹ç®¡ç† State Management (2)ï¼Pinia","text":"æœ¬ç¯‡æ–‡ç« åŒæ­¥ç™¼è¡¨æ–¼ 2023 iThome éµäººè³½ å°ˆæ¡ˆé–‹ç™¼éç¨‹ä¸­å¸¸æœƒæœ‰ç‹€æ…‹å…±äº«çš„éœ€æ±‚ã€‚çˆ¶å­å…ƒä»¶é–“è³‡æ–™å‚³éå¯ä»¥ä½¿ç”¨ Props å’Œ $emitï¼Œæˆ–æ˜¯ Provide å’Œ Injectï¼ˆåƒè€ƒæ–‡ç« ï¼‰ï¼Œå…ˆå‰åœ¨ Nuxt2 ä»‹ç´¹äº† VueX ç®¡ç†å·¥å…·æ­é… vuex-persistedstate ä¿å­˜ç‹€æ…‹ï¼ˆåƒè€ƒæ–‡ç« ï¼‰ï¼Œæ¥ä¸‹ä¾†èªªæ˜å¦‚ä½•åœ¨ Nuxt3 åˆ©ç”¨æ›´ä¾¿åˆ©é«˜æ•ˆçš„æ–¹å¼ç®¡ç†å…±äº«ç‹€æ…‹ã€‚ ç‹€æ…‹ç®¡ç†é è¨ˆåˆ†ç‚ºä»¥ä¸‹ä¸‰ç¯‡èªªæ˜ï¼Œæœ¬ç¯‡å°‡ä»‹ç´¹ Piniaï¼š 1. useStateï¼šNuxt Composable é€£çµ2. Piniaï¼šVue.js ç‹€æ…‹ç®¡ç†å·¥å…·3. pinia-plugin-persistedstateï¼šç¶­æŒ Store ç‹€æ…‹ é€£çµ PiniaPinia æ˜¯ Vue å®˜æ–¹æ¨è–¦ä½¿ç”¨çš„ç‹€æ…‹ç®¡ç†å·¥å…·ï¼Œæ”¯æ´ Vue2 è·Ÿ Vue3ï¼Œå¯ä»¥ç†è§£ç‚º VueX çš„æ¥ç­äºº Pinia vs VueXï¼š ç§»é™¤ mutationsï¼Œçµ±ä¸€é€é action æ“ä½œ state æ”¯æ´ Typescriptï¼Œä¸éœ€è¦ types ä¾†åŒ…è£ ä¸éœ€å¼•å…¥å„ç¨® magic stringsï¼Œç›´æ¥å¼•å…¥å‡½å¼å³å¯ ä¸éœ€è¦å‹•æ…‹å¼•å…¥æ¨¡çµ„ï¼Œé è¨­ç‚ºè‡ªå‹• import ç§»é™¤å·¢ç‹€ modulesï¼Œæä¾›æ›´æ‰å¹³çš„çµæ§‹ï¼Œstore é–“ä¹Ÿå¯ç›¸äº’ä½¿ç”¨ ç§»é™¤ namespaced modulesï¼Œæ‰€æœ‰æ¨¡çµ„éƒ½å·²è‡ªå‹•å®šç¾© Pinia å…¶ä»–å„ªé»ï¼š æ”¯æ´ Devtools Hot module replacementï¼ˆHMRï¼‰ æ”¯æ´ Plugins æ”¯æ´ Server Side Render å¥—ä»¶å®‰è£æ­é… Nuxt æ•´åˆæ¨¡çµ„ @pinia/nuxt é€²è¡Œå®‰è£ï¼š npm install pinia @pinia/nuxt ä½¿ç”¨ npm å®‰è£æ™‚å¦‚æœå ±éŒ¯ ERESOLVE could not resolveï¼Œåœ¨ package.json åŠ å…¥ä»¥ä¸‹å…§å®¹ï¼Œé‡æ–°å®‰è£å³å¯ // package.json\"overrides\": { \"vue\": \"latest\"} nuxt.config é…ç½®å¦‚æœä¸æƒ³å…¨åŸŸå¼•å…¥ defineStoreï¼Œä¹Ÿå¯ä»¥åœ¨é é¢å„åˆ¥å¼•å…¥ï¼šimport { defineStore } from 'pinia' // nuxt.config.jsexport default defineNuxtConfig({ modules: [ '@pinia/nuxt' ], pinia: { // æƒ³è¦å„åˆ¥å¼•å…¥å¯ä»¥ç§»é™¤é€™æ®µ autoImports: [ 'defineStore' ] }}) å®šç¾© Storeåœ¨ store è³‡æ–™å¤¾å»ºç«‹æª”æ¡ˆï¼Œç¯„ä¾‹ store/index.js Option Storeå…ˆä»¥ Option Stores é€²è¡Œèªªæ˜ï¼Œæ¯”è¼ƒç›´è§€å¥½ç†è§£ stateï¼šåŠŸèƒ½åŒ data gettersï¼šåŠŸèƒ½åŒ computed actionsï¼šåŠŸèƒ½åŒ methods // store/index.jsexport const useMainStore = defineStore('main', { state: () =&gt; ({ counter: 0 }), getters: { doubleCounter() { return this.counter * 2; } }, actions: { increment() { this.counter++ } }}) Setup Storeæ¥è‘—å°‡ä»¥ä¸Šå…§å®¹æ”¹å¯«ç‚º Composition API ref()ï¼šç”¨ä¾†å®šç¾© state å±¬æ€§ computed()ï¼šå®šç¾© getters function()ï¼šå®šç¾© actions // store/index.jsexport const useMainStore = defineStore('main', () =&gt; { const counter = ref(0); const doubleCounter = computed(() =&gt; counter.value * 2) const increment = () =&gt; { counter.value++ } return { counter, doubleCounter, increment }}) ä½¿ç”¨ Store// pages/count.vue&lt;template&gt; &lt;div&gt; {{ mainStore.counter }} {{ mainStore.doubleCounter }} &lt;button @click=\"mainStore.increment()\"&gt;increment&lt;/button&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;import { useMainStore } from '@/store/index';const mainStore = useMainStore();&lt;/script&gt; ä½¿ç”¨ Plugins Provide å…¨åŸŸæ³¨å…¥ Store// plugins/pinia.jsimport { useMainStore } from '@/store';export default defineNuxtPlugin(({ $pinia }) =&gt; { return { provide: { store: useMainStore($pinia) } };}); ä½¿ç”¨ $store å–å¾—ç‹€æ…‹ // pages/count.vue&lt;template&gt; &lt;div&gt; {{ $store.counter }} {{ $store.doubleCounter }} &lt;button @click=\"$store.increment()\"&gt;increment&lt;/button&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;const { $store } = useNuxtApp();&lt;/script&gt; é‚„åŸç‹€æ…‹Option Storeä½¿ç”¨ $reset() é‚„åŸç‹€æ…‹ // pages/index.vue&lt;template&gt; &lt;div&gt; {{ $store.counter }} &lt;button @click=\"reset()\"&gt;reset&lt;/button&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;const { $store } = useNuxtApp();const reset = () =&gt; { $store.$reset();};&lt;/script&gt; Setup Storeå¿…é ˆè‡ªè¨‚ reset æ–¹æ³• // store/index.jsexport const useMainStore = defineStore('main', () =&gt; { const counter = ref(0); const reset = () =&gt; { counter.value = 0; } return { counter, reset }}) åƒè€ƒè³‡æºï¼š https://nuxt.com/docs/getting-started/state-managementhttps://pinia.vuejs.org/ssr/nuxt.html#nuxt-jshttps://nuxt.com/docs/migration/configuration#vuexhttps://blog.twjoin.com/vue-state-management-ä»‹ç´¹-pinia-9f8695110cd7","link":"/2023/08/15/nuxt3/nuxt-v3-state-management-pinia/"},{"title":"Nuxt.js 3.x ç‹€æ…‹ç®¡ç† State Management (1)ï¼useState","text":"æœ¬ç¯‡æ–‡ç« åŒæ­¥ç™¼è¡¨æ–¼ 2023 iThome éµäººè³½ å°ˆæ¡ˆé–‹ç™¼éç¨‹ä¸­å¸¸æœƒæœ‰ç‹€æ…‹å…±äº«çš„éœ€æ±‚ã€‚çˆ¶å­å…ƒä»¶é–“è³‡æ–™å‚³éå¯ä»¥ä½¿ç”¨ Props å’Œ $emitï¼Œæˆ–æ˜¯ Provide å’Œ Injectï¼ˆåƒè€ƒæ–‡ç« ï¼‰ï¼Œå…ˆå‰åœ¨ Nuxt2 ä»‹ç´¹äº† VueX ç®¡ç†å·¥å…·æ­é… vuex-persistedstate ä¿å­˜ç‹€æ…‹ï¼ˆåƒè€ƒæ–‡ç« ï¼‰ï¼Œæ¥ä¸‹ä¾†èªªæ˜å¦‚ä½•åœ¨ Nuxt3 åˆ©ç”¨æ›´ä¾¿åˆ©é«˜æ•ˆçš„æ–¹å¼ç®¡ç†å…±äº«ç‹€æ…‹ã€‚ ç‹€æ…‹ç®¡ç†é è¨ˆåˆ†ç‚ºä»¥ä¸‹ä¸‰ç¯‡èªªæ˜ï¼Œæœ¬ç¯‡å°‡ä»‹ç´¹ useStateï¼š 1. useStateï¼šNuxt Composable2. Piniaï¼šVue.js ç‹€æ…‹ç®¡ç†å·¥å…· é€£çµ3. pinia-plugin-persistedstateï¼šç¶­æŒ Store ç‹€æ…‹ é€£çµ useStateuseState æ˜¯ Nuxt3 æä¾›çš„ Composableï¼Œé©åˆç”¨ä¾†å»ºç«‹éŸ¿æ‡‰å¼ã€ä¼ºæœå™¨ç«¯å‹å–„ï¼ˆSSR-friendlyï¼‰çš„å…±äº«ç‹€æ…‹ æœƒç‰¹åˆ¥æåˆ° SSR-friendlyï¼Œè¦å…ˆç†è§£ Nuxt Universal æ¸²æŸ“æ¨¡å¼ï¼ˆserver-side ï¼‹ client-sideï¼‰ï¼Œç”±ä¼ºæœå™¨ç«¯é å…ˆè¼‰å…¥ HTMLï¼Œä¸¦å‚³çµ¦ç€è¦½å™¨ï¼Œæ¥è‘—ç”±ç€è¦½å™¨è¼‰å…¥å®Œæ•´çš„ Javascript ä¸¦åŸ·è¡Œï¼Œè‡³æ­¤ç¶²é æ‰å…·æœ‰äº’å‹•æ€§ã€‚å› æ­¤ï¼Œè‹¥åœ¨é é¢ä¸Šå®šç¾©éŸ¿æ‡‰å¼å‹•æ…‹è³‡æ–™å¦‚ä¸‹ï¼š &lt;template&gt; &lt;div&gt; {{ count }} &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;const count = ref(Math.round(Math.random() * 1000));&lt;/script&gt; ç€è¦½å™¨æœƒæ‹‹å‡ºè­¦å‘Šï¼šHydration text content mismatchåŸå› æ˜¯åœ¨ä¼ºæœå™¨ç«¯é å…ˆæ¸²æŸ“å‡ºä¾†çš„ countï¼Œè·Ÿç€è¦½å™¨å¾Œä¾†åŸ·è¡Œ JS é‹ç®—å‡ºä¾†çš„çµæœä¸åŒ useState åƒæ•¸ï¼š keyï¼šå”¯ä¸€å€¼ï¼Œé¿å…é‡è¤‡å–å¾—è³‡æ–™ï¼ˆå‰é¢æåˆ°çš„ Hydration å•é¡Œï¼‰ï¼Œå¦‚æœæ²’å¸¶å…¥ï¼ŒuseState æœƒè‡ªå‹•ç”Ÿæˆ initï¼šå›å‚³åˆå§‹å€¼çš„å‡½å¼ï¼Œæœƒå›å‚³ä¸€å€‹ ref ç‰©ä»¶ Tï¼šä½¿ç”¨ TypeScript å‹åˆ¥ useState&lt;T&gt;(key: string, init?: () =&gt; T | Ref&lt;T&gt;): Ref&lt;T&gt; useState å…±äº«ç‹€æ…‹// pages/index.vue&lt;template&gt; &lt;div&gt; {{ counter }} &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;const counter = useState('counter', () =&gt; Math.round(Math.random() * 1000));&lt;/script&gt; å…¶ä»–é é¢ä½¿ç”¨ useState('counter') å¯ä»¥åŒæ­¥å–å¾—ï¼æ›´æ–°ç‹€æ…‹ // pages/count.vue&lt;template&gt; &lt;div&gt; {{ counter }} &lt;button @click=\"counter++\"&gt;+&lt;/button&gt; &lt;button @click=\"counter--\"&gt;-&lt;/button&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;const counter = useState('counter', () =&gt; Math.round(Math.random() * 1000));&lt;/script&gt; æ³¨æ„ï¼šè‹¥ç›´æ¥ä½¿ç”¨ const counter = useState('counter') å–å€¼ï¼Œè€Œ useState('counter') å°šæœªè¢«è³¦å€¼ï¼Œå¯èƒ½æœƒç™¼ç”ŸéŒ¯èª¤ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•å®šç¾©é è¨­å€¼ useState æ­é… Composables å…¨åŸŸå…±äº«ç‹€æ…‹å°‡ç‹€æ…‹å®šç¾©åœ¨ Composablesï¼Œå¯ä»¥å®šç¾©é è¨­å€¼ï¼Œä¸¦åœ¨é é¢é–“å…±äº«ç‹€æ…‹ åç¨±è‡ªè¨‚ï¼Œç¯„ä¾‹ä½¿ç”¨ composables/state.js // composables/state.jsexport const useCounter = () =&gt; useState('counter', () =&gt; Math.round(Math.random() * 1000)); é é¢ä½¿ç”¨ useCounter() å–å€¼ï¼ˆç­‰åŒæ–¼ useState('counter')ï¼‰ï¼Œä¸¦å¯æ›´æ–°ç‹€æ…‹ // pages/count.vue&lt;template&gt; &lt;div&gt; {{ counter }} &lt;button @click=\"counter++\"&gt;+&lt;/button&gt; &lt;button @click=\"counter--\"&gt;-&lt;/button&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;const counter = useCounter();&lt;/script&gt; clearNuxtState æ¸…é™¤ç‹€æ…‹ä½¿ç”¨ clearNuxtState(key) æ¸…é™¤ç•¶å‰å„²å­˜çš„ç‹€æ…‹ // pages/index.vue&lt;template&gt; &lt;div&gt; {{ counter }} &lt;button @click=\"clearCounter()\"&gt;clear&lt;/button&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;const counter = useCounter();const clearCounter = () =&gt; { clearNuxtState('counter');};&lt;/script&gt; åƒè€ƒè³‡æºï¼š https://nuxt.com/docs/getting-started/state-managementhttps://ithelp.ithome.com.tw/articles/10302323","link":"/2023/08/14/nuxt3/nuxt-v3-state-management-usestate/"},{"title":"Nuxt.js 3.x å°‡éœæ…‹ç¶²ç«™éƒ¨ç½²åˆ° GitHub Pages","text":"æœ¬ç¯‡æ–‡ç« åŒæ­¥ç™¼è¡¨æ–¼ 2023 iThome éµäººè³½ å°ˆæ¡ˆé–‹ç™¼å®Œæˆå¾Œï¼Œçµ‚æ–¼åˆ°æœ€å¾Œä¸€æ­¥ã€Œéƒ¨ç½²ã€ï¼Œæœ¬ç¯‡ä½¿ç”¨éœæ…‹ç¶²ç«™ç”Ÿæˆï¼ˆSSGï¼‰ï¼Œæ­é… GitHub Pages è¨—ç®¡éœæ…‹ç¶²é å…§å®¹ã€‚ Static Site Generationï¼ˆSSGï¼‰éœæ…‹ç¶²ç«™ç”Ÿæˆåœ¨ç·¨è­¯æ™‚ç”¢ç”Ÿéœæ…‹ HTML é é¢ã€‚éœæ…‹éƒ¨ç½²é©åˆå…§å®¹å›ºå®šã€ä¸éœ€è³‡æ–™åº«ã€ä¸å«ä¼ºæœå™¨ç«¯å‹•æ…‹æ¸²æŸ“çš„ç¶²ç«™ï¼ˆä¾‹å¦‚å…¬å¸å½¢è±¡ç¶²ç«™æˆ–æ˜¯å€‹äººéƒ¨è½æ ¼ï¼‰ï¼Œé›–ç„¶ä¸åƒ Universal Rendering ä¸€æ¨£å½ˆæ€§ï¼Œä¸ééœæ…‹ç¶²ç«™å¾ˆé©åˆæ­é… CDN ç·©å­˜ã€‚ å¯¦ä½œéƒ¨ç½²Step1ï¼šå»ºç«‹ GitHub Repositoryåœ¨ Github å»ºç«‹ä¸€å€‹å„²å­˜åº« &lt;username&gt;.github.io/&lt;repository&gt;ï¼ˆé€£çµï¼‰ &lt;username&gt;ï¼šè‡ªå·±çš„ä½¿ç”¨è€…åç¨± &lt;repository&gt;ï¼šè‡ªè¨‚å°ˆæ¡ˆåï¼Œæœ¬ç¯‡ç¯„ä¾‹å‘½åç‚º nuxt3-generate Step2ï¼šä¸Šå‚³å°ˆæ¡ˆè‡³ GitHubæ¥è‘—çœ‹åˆ°ä»¥ä¸‹æŒ‡å¼•ç•«é¢ï¼Œå›åˆ°å°ˆæ¡ˆï¼Œä¾ç…§æŒ‡ä»¤ä¸Šå‚³è‡³ GitHub Step3ï¼šå®‰è£ gh-pageså°ˆæ¡ˆå®‰è£ gh-pages å¥—ä»¶è‡³ devDependencies npm i -D gh-pages Step4ï¼šnuxt.config é…ç½® baseURLï¼šå› éƒ¨ç½²ä¸Š GitHub ç¶²å€æœƒåŠ ä¸Š /&lt;repository&gt;/ï¼Œå› æ­¤é ˆèª¿æ•´ç‚º /&lt;repository&gt;/process.env.NODE_ENV ç‚º Node.js ç’°å¢ƒè®Šæ•¸ï¼ŒåŸ·è¡Œ npm run dev é–‹ç™¼æ¨¡å¼ä¸‹å•Ÿå‹•å°ˆæ¡ˆï¼Œprocess.env.NODE_ENV å€¼ç‚º â€œdevelopmentâ€ï¼Œåœ¨ç”Ÿç”¢æ¨¡å¼å•Ÿå‹•å°ˆæ¡ˆï¼Œå‰‡ç‚º â€œproductionâ€ buildAssetsDirï¼šassets/ ç·¨è­¯å¾Œçš„ç›®éŒ„åç¨±ï¼Œé è¨­ç‚º /_nuxt/ï¼ŒGithub Pages é è¨­ä½¿ç”¨ Jekyll éœæ…‹ç¶²ç«™ç”Ÿæˆå·¥å…·ï¼ŒJekyll æœƒè‡ªå‹•å¿½ç•¥æ‰€æœ‰ä¸‹åº•ç·šï¼ˆ_ï¼‰å‰ç¶´çš„è³‡æ–™å¤¾èˆ‡æª”æ¡ˆï¼Œå› æ­¤å°‡ _nuxt èª¿æ•´ç‚ºå…¶ä»–åç¨± // nuxt.config.jsexport default defineNuxtConfig({ app: { baseURL: process.env.NODE_ENV === 'production' ? '/nuxt3-generate/' : '/', buildAssetsDir: '/static/' }} Step5ï¼šåŠ ä¸Š public/.nojekyll æª”æ¡ˆä¸Šä¸€æ­¥æœ‰æåˆ°ï¼ŒJekyll æœƒè‡ªå‹•å¿½ç•¥æ‰€æœ‰ä¸‹åº•ç·šå‰ç¶´çš„è³‡æ–™å¤¾èˆ‡æª”æ¡ˆï¼Œå› æ­¤å°ˆæ¡ˆéƒ¨ç½²åˆ° GitHub å¾Œï¼Œæœƒå›  _payload.json è®€å–ä¸åˆ°ï¼Œæ‹‹å‡º 404 éŒ¯èª¤ã€‚åœ¨æ ¹ç›®éŒ„ public/ è³‡æ–™å¤¾åŠ ä¸Š .nojekyll ç©ºç™½æª”æ¡ˆï¼Œç”¨ä¾†å‘Šè¨´ GitHub ç•¶å‰ç¶²ç«™ä¸¦ä¸æ˜¯åŸºæ–¼ Jekyll å»ºç½® Step6ï¼šåŠ å…¥ gh-pages æŒ‡ä»¤package.json scripts åŠ å…¥ä»¥ä¸‹æŒ‡ä»¤ï¼Œä»¥ä¸‹æŒ‡ä»¤æœƒå°‡ç·¨è­¯å®Œæˆçš„ .output/public éœæ…‹å…§å®¹éƒ¨ç½²è‡³ GitHub Pages \"deploy\": \"gh-pages --dotfiles -d .output/public\" Step7ï¼šåŸ·è¡Œéƒ¨ç½²åŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ï¼Œç”¢ç”Ÿéœæ…‹æª” npm run generate ç·¨è­¯å®Œæˆå¾Œï¼Œå°ˆæ¡ˆæ ¹ç›®éŒ„æœƒç”¢ç”Ÿä¸€å€‹ .output è³‡æ–™å¤¾ public ç‚ºéœæ…‹è³‡æºæª”ï¼Œå®šç¾©åœ¨ public/ èˆ‡ assets/ çš„æª”æ¡ˆéƒ½æœƒè¢«æ‰“åŒ…åœ¨é€™ assets/ ç·¨è­¯å¾Œçš„æª”æ¡ˆåˆæœƒè¢«åŒ…åœ¨ static/ï¼Œå°æ‡‰å‰é¢è¨­å®šçš„ buildAssetsDir ç›®éŒ„åç¨± æ¯å€‹éœæ…‹é æœƒå„è‡ªç·¨è­¯æˆ _payload.json èˆ‡ index.html .output/|â€”â€” public/ |â€”â€” static/ |â€”â€” bg.7e80f349.png |â€”â€” index.3fc7cdc4.js |â€”â€” index.9c7e60ac.css |â€”â€” about/ |â€”â€” _payload.json |â€”â€” index.html |â€”â€” _payload.json |â€”â€” index.html |â€”â€” favicon.ico |â€”â€” ...|â€”â€” nitro.json æ¥è‘—åŸ·è¡Œéƒ¨ç½²åˆ° GitHub Pages npm run deploy éƒ¨ç½²å®Œæˆå¾Œï¼Œå›åˆ° GitHub åˆ‡åˆ° gh-pages åˆ†æ”¯ï¼Œé †åˆ©çš„è©±ï¼Œåœ¨ç€è¦½å™¨è¼¸å…¥ç¶²å€ https://&lt;username&gt;.github.io/&lt;repository&gt;/ å°±å¯ä»¥çœ‹åˆ°é¦–é ç•«é¢å›‰ï½ ç¯„ä¾‹æª” ç¨‹å¼ç¢¼ï¼šé€£çµ é é¢ï¼šé€£çµ åŠ å…¥å‹•æ…‹è·¯ç”±é é¢åŸ·è¡Œ npm run generate æ™‚ï¼ŒNitro çˆ¬èŸ²æœƒå…ˆæŠ“å–éœæ…‹é é¢ï¼Œä»¥åŠæœ‰è¢«é€£çµåˆ°çš„å‹•æ…‹è·¯ç”±ï¼Œæ²’æœ‰è¢«é€£çµåˆ°çš„å‹•æ…‹è·¯ç”±å¿…é ˆæ‰‹å‹•é…ç½® ç¯„ä¾‹ï¼šå‹•æ…‹è·¯ç”±çµæ§‹å¦‚ä¸‹ pages/ï½œâ€”â€” user/ ï½œâ€”â€” [id].vue åœ¨ nuxt.config æ‰‹å‹•é…ç½®é æ¸²æŸ“è·¯ç”±ï¼Œä¹Ÿå¯ä»¥é€é ignore/ æ’é™¤è·¯ç”± // nuxt.config.jsdefineNuxtConfig({ nitro: { prerender: { routes: ['/user/1', '/user/2'], ignore: ['/dynamic'] } }}); åŸ·è¡Œ npm run generate ç·¨è­¯å¾Œï¼Œåœ¨ .output å¯ä»¥çœ‹åˆ° /user/1ã€/user/2 ä¹Ÿé å…ˆç·¨è­¯ç‚ºéœæ…‹é  .output/|â€”â€” public/ |â€”â€” user/ |â€”â€” 1/ |â€”â€” _payload.json |â€”â€” index.html |â€”â€” 2/ |â€”â€” _payload.json |â€”â€” index.html |â€”â€” ... å»¶ä¼¸ï¼šè‡ªè¨‚ç¶²åŸŸé™¤äº†ä½¿ç”¨ GitHub æä¾›çš„å…è²»åŸŸåï¼Œä¹Ÿå¯ä»¥è³¼è²·è‡ªå·±çš„ç¶²åŸŸï¼Œå…ˆå‰å¯«éä¸€ç¯‡æ–‡ç« æä¾›åƒè€ƒï¼šGitHub Pages è‡ªè¨‚åŸŸåèˆ‡ HTTPS è¨­å®š åƒè€ƒè³‡æºï¼š https://nuxt.com/docs/getting-started/deploymenthttps://github.com/lucpotage/nuxt-github-pages","link":"/2023/10/03/nuxt3/nuxt-v3-static-site-generation/"},{"title":"Nuxt.js 3.x Stylelint SCSS ç¨‹å¼ç¢¼æª¢æŸ¥èˆ‡è‡ªå‹•æ’ç‰ˆ","text":"æœ¬ç¯‡æ–‡ç« åŒæ­¥ç™¼è¡¨æ–¼ 2023 iThome éµäººè³½ Stylelint æ˜¯ä¸€å¥—ç”¨æ–¼è¦ç¯„ CSS å’Œ CSS é è™•ç†å™¨ï¼ˆSCSSã€Less ç­‰ï¼‰ç¨‹å¼ç¢¼çš„å·¥å…·ï¼Œå¹«åŠ©æˆ‘å€‘ç¶­æŒç¨‹å¼ç¢¼çš„å“è³ªå’Œé¢¨æ ¼ã€‚Stylelint é€²è¡Œæª¢æŸ¥æ™‚ï¼Œæœƒæ ¹æ“šæŒ‡å®šçš„è¦å‰‡ä¾†ç™¼ç¾æ½›åœ¨çš„éŒ¯èª¤ã€ä¸ä¸€è‡´çš„é¢¨æ ¼å’Œä¸æ¨è–¦çš„æ¨¡å¼ã€‚ ä»¥ *.vue æª”ç‚ºä¾‹ï¼Œæª”æ¡ˆå…§åŒ…å«ä¸‰ç¨®ä¸»è¦çš„ç¨‹å¼ç¢¼ï¼š&lt;template&gt;ã€&lt;script&gt; å’Œ &lt;style&gt;ï¼š &lt;template&gt;ï¼šVue.js æ¨¡æ¿èªæ³•ï¼Œç”¨ä»¥å®šç¾© HTMLï¼Œä¾‹å¦‚æ’æ§½ {{ }}ã€æ¢ä»¶åˆ¤æ–·å’Œè¿´åœˆç­‰ã€‚é›–ç„¶é€™ä¸æ˜¯åš´æ ¼çš„ JavaScript èªæ³•ï¼Œä½† ESLint ä¹Ÿæä¾›äº†ç›¸é—œè¦å‰‡å°æ¨¡æ¿èªæ³•é€²è¡Œæª¢æŸ¥ &lt;script&gt;ï¼šJavaScript å€å¡Šï¼Œç”± ESLint é€²è¡Œç¨‹å¼ç¢¼æª¢æŸ¥ &lt;style&gt;ï¼šCSS å€å¡Šï¼Œç”¨æ–¼å®šç¾©å…ƒä»¶æ¨£å¼ï¼Œç”± Stylelint é€²è¡Œç¨‹å¼ç¢¼æª¢æŸ¥ ESLint æ­é… Stylelintï¼Œè®“å°ˆæ¡ˆä¿æŒè‰¯å¥½çš„ Coding Styleã€‚æœ¬ç¯‡å°‡èªªæ˜å¦‚ä½•åœ¨ Nuxt3 å°ˆæ¡ˆæ­é… Stylelint å·¥å…·ã€‚ ESLint JavaScript ç¨‹å¼ç¢¼æª¢æŸ¥å·¥å…·åƒè€ƒ é€™ç¯‡æ–‡ç«  å¥—ä»¶å®‰è£æ•´åˆå¥—ä»¶ @nuxtjs/stylelint-moduleï¼šNuxt æ­é… Stylelint çš„æ•´åˆæ¨¡çµ„ @nuxtjs/stylelint-module æä¾›äº†åœ¨ Nuxt ä½¿ç”¨ Stylelint çš„æ•´åˆæ¨¡çµ„ï¼Œä½†ä¸¦æœªåŒ…å« Stylelintã€ç›¸é—œé…ç½®ä»¥åŠ PostCSS ç›¸é—œå¥—ä»¶ï¼Œéœ€æ‰‹å‹•å®‰è£ç›¸ä¾å¥—ä»¶ ç›¸ä¾å¥—ä»¶ stylelintï¼šå¯¦éš›åŸ·è¡Œ CSS ç¨‹å¼ç¢¼æª¢æŸ¥çš„å·¥å…· stylelint-config-standard-vueï¼šstylelint è¦å‰‡é…ç½®ï¼Œç”¨æ–¼æª¢æŸ¥æ–‡ä»¶ä¸­ &lt;style&gt; å€å¡Šçš„ CSS stylelint-config-standard-scssï¼šstylelint è¦å‰‡é…ç½®ï¼ŒåŸºæ–¼ stylelint-config-standard ****çš„æ“´å……ï¼Œç”¨æ–¼æª¢æŸ¥ SCSS ç¨‹å¼ç¢¼ stylelint-orderï¼šstylelint æ’ä»¶ï¼Œè¦ç¯„ CSS å±¬æ€§çš„æ’åºé †åº postcssã€postcss-scssã€postcss-htmlï¼šæ“´å±• CSS å’Œ SCSS çš„å¾Œè™•ç†å™¨å·¥å…· npm install -D @nuxtjs/stylelint-module \\ stylelint \\ stylelint-config-standard-vue \\ stylelint-config-standard-scss \\ stylelint-order \\ postcss postcss-scss postcss-html nuxt.config é…ç½®stylelint é…ç½®é¸é …åƒè€ƒ å®˜æ–¹æ–‡ä»¶ // nuxt.config.jsexport default defineNuxtConfig({ modules: [ ... '@nuxtjs/stylelint-module' ], stylelint: { lintOnStart: false, // å°ˆæ¡ˆå•Ÿå‹•æ™‚ä¸è‡ªå‹•æª¢æŸ¥æ‰€æœ‰ç›¸é—œæª”æ¡ˆ chokidar: true // ç›£è½æ–‡ä»¶ç•°å‹•é€²è¡Œæª¢æ ¸ï¼ˆæ–‡ä»¶æœªåˆ—å‡ºæ­¤é¸é …ï¼‰ }}) .stylelintrc.js è¨­å®šæª”é…ç½®ç›®éŒ„æ–°å¢ .stylelintrc.jsï¼Œé…ç½®å¦‚ä¸‹ï¼š extendsï¼šæ“´å±• stylelint é…ç½® overridesï¼šå®šç¾©ç‰¹å®šæ–‡ä»¶æˆ–æ–‡ä»¶é¡å‹è¦†è“‹é…ç½®ï¼Œæœƒè¦†å¯« rules å®šç¾©çš„å…¨åŸŸè¦å‰‡ pluginsï¼šé…ç½® stylelint æ’ä»¶ rulesï¼šå®šç¾©å…¨åŸŸ stylelint è¦å‰‡ï¼Œé¸é …åƒè€ƒ å®˜æ–¹æ–‡ä»¶ // .stylelintrc.jsmodule.exports = { extends: [ 'stylelint-config-standard-scss', 'stylelint-config-standard-vue/scss' ], plugins: [ 'stylelint-order' ], overrides: [ { files: [ '*.scss', '**/*.scss' ], // æŒ‡å®š .scss æª” rules: { 'scss/no-global-function-names': null // é—œé–‰æ­¤è¦å‰‡ } } ], rules: { // ... 'unit-allowed-list': [ 'em', 'rem', 'deg', 'px' ], // å¯ä½¿ç”¨çš„å–®ä½ 'order/properties-order': [ // è¨­å®šæ’åºé †åºï¼ˆplugins å¿…é ˆå…ˆå®šç¾© stylelint-orderï¼‰ 'position', 'top', 'bottom', 'right', 'left', 'display', 'align-items', 'justify-content', 'float', 'clear', 'overflow', 'overflow-x', 'overflow-y', 'margin', 'margin-top', 'margin-right', 'margin-bogttom', 'margin-left', 'padding', 'padding-top', 'padding-right', 'padding-bottom', 'padding-left', 'width', 'min-width', 'max-width', 'height', 'min-height', 'max-height', 'font-size', 'font-family', 'font-weight', 'text-align', 'text-justify', 'text-indent', 'text-overflow', 'text-decoration', 'white-space', 'color', 'background', 'background-position', 'background-repeat', 'background-size', 'background-color', 'background-clip', 'border', 'border-style', 'border-width', 'border-color', 'border-top-style', 'border-top-width', 'border-top-color', 'border-right-style', 'border-right-width', 'border-right-color', 'border-bottom-style', 'border-bottom-width', 'border-bottom-color', 'border-left-style', 'border-left-width', 'border-left-color', 'border-radius', 'opacity', 'filter', 'list-style', 'outline', 'visibility', 'z-index', 'box-shadow', 'text-shadow', 'resize', 'transition' ] }} VSCode é…ç½®ç¨‹å¼ç¢¼æ ¼å¼åŒ–1. å®‰è£æ“´å……é¦–å…ˆéœ€åœ¨ VSCode å®‰è£æ“´å……ï¼šStylelint 2. è¨­å®šè‡ªå‹•æ ¼å¼åŒ–åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„æ–°å¢ .vscode/settings.json |â€”â€”.vscode/ |â€”â€” settings.json|â€”â€”my-app/ |â€”â€” .nuxt/ |â€”â€” .stylelintrc.js |â€”â€” app.vue |â€”â€” ... æ¥è‘—é…ç½®å¦‚ä¸‹ï¼š editor.codeActionsOnSaveï¼šå„²å­˜æ–‡ä»¶æ™‚åŸ·è¡Œçš„ç¨‹å¼ç¢¼æ“ä½œï¼ˆCode Actionsï¼‰ stylelint.validateï¼šè¨­å®šéœ€é©—è­‰çš„æ–‡ä»¶é¡å‹ { \"editor.codeActionsOnSave\": { \"source.fixAll\": false, \"source.fixAll.stylelint\": true }, \"stylelint.validate\": [ \"css\", \"scss\", \"vue\" ]} è¨­å®šå®Œæˆå¾Œï¼Œå¯èƒ½éœ€è¦é‡å•Ÿå°ˆæ¡ˆæ‰èƒ½æˆåŠŸé‹ä½œï¼Œæ¥è‘—åœ¨å„²å­˜æª”æ¡ˆæ™‚ï¼ŒStylelint å°±æœƒå”åŠ©æˆ‘å€‘è‡ªå‹•æ’ç‰ˆå›‰ï¼ åƒè€ƒè³‡æºï¼š https://github.com/ota-meshi/stylelint-config-standard-vuehttps://github.com/nuxt-modules/stylelinthttps://ithelp.ithome.com.tw/articles/10297223?sc=pt#_=_https://paper-hsiao.medium.com/stylelint-å¹«åŠ©ä½ æ•´ç†-css-çš„å¥½å¹«æ‰‹-b708adab430e","link":"/2023/08/04/nuxt3/nuxt-v3-stylelint/"},{"title":"Nuxt.js 3.x æ­é… CSS Frameworkï¼ä»¥ Bootstrap 5 ç‚ºä¾‹","text":"æœ¬ç¯‡æ–‡ç« åŒæ­¥ç™¼è¡¨æ–¼ 2023 iThome éµäººè³½ Bootstrap ç‰ˆæœ¬ï¼šv5.3.1Sass ç‰ˆæœ¬ï¼šv1.63.6 åœ¨ Nuxt å°ˆæ¡ˆä¸­ï¼Œæˆ‘å€‘å¯ä»¥è‡ªç”±é¸æ“‡ CSS é è™•ç†å™¨ã€CSS æ¡†æ¶æˆ–æ˜¯ UI Library ä¾†å®šç¾©æ¨£å¼ã€‚åœ¨ CSS æ¡†æ¶ç™¾å®¶çˆ­é³´çš„æ™‚ä»£ï¼Œé€™å¹¾å¹´ç†±é–€çš„ Tailwind CSSã€åŸºæ–¼ Vue.js é–‹ç™¼çš„ Quasarã€æˆ–æ˜¯æ­é… Vue3 é–‹ç™¼çš„ Element Plus éƒ½èƒ½å¿«é€Ÿä¸Šæ‰‹ï¼Œå”åŠ©æˆ‘å€‘æ‰“é€ ç²¾ç¾çš„ç¶²ç«™ã€‚ ç”±æ–¼å·¥ä½œä¸Šè¼ƒå¸¸ä½¿ç”¨ Bootstrap å”ä½œï¼Œæœ¬ç¯‡å°‡ä»¥ Bootstrap 5 æ­é… SCSS é€²è¡Œèªªæ˜ã€‚ Bootstrap 5 ç°¡ä»‹ Bootstrap æœ‰è±å¯Œçš„ Sass è®Šæ•¸ã€mixinsã€ç¶²æ ¼ç³»çµ±ã€å…ƒä»¶ã€JS æ’ä»¶ï¼ŒBootstrap 5 èˆ‡å…ˆå‰ç‰ˆæœ¬æœ€å¤§çš„ä¸åŒï¼Œé™¤äº†å°‡ jQuery å¾ç›¸ä¾é …ç›®ä¸­ç§»é™¤ï¼Œä¹Ÿæ–°å¢ Utilities APIï¼ˆåŸºæ–¼ Sass Maps ç”Ÿæˆ Utilities Classï¼‰ï¼Œå¯ä»¥æ›´ç°¡æ˜“çš„ç®¡ç†æˆ–æ“´å……æ¨£å¼ï¼Œä¸éœ€æ‰‹åˆ»å¤ªå¤š CSS å³å¯å®Œæˆå¤šå…ƒã€è¤‡é›œçš„ç•«é¢ã€‚ å¥—ä»¶å®‰è£npm install bootstrapnpm install sass ä½¿ç”¨ Bootstrap æ¨£å¼æ­é…è‡ªè¨‚æ¨£å¼åœ¨ assets/ éœæ…‹è³‡æºç›®éŒ„å®šç¾© SCSSï¼Œç¯„ä¾‹ assets/scss/app.scssï¼Œéœ€æ³¨æ„ Bootstrap æ¨£å¼èˆ‡è‡ªè¨‚æ¨£å¼å¼•å…¥é †åºï¼š ä¸å»ºè­°ç›´æ¥å¼•å…¥æ•´åŒ… bootstrap components bootstrap/scss/bootstrap ï¼Œé¸æ“‡éœ€è¦çš„æ¨£å¼å¼•å…¥å³å¯ï¼Œé¿å… CSS æª”æ¡ˆéå¤§ï¼Œé€ æˆç³»çµ±è² æ“” // assets/scss/app.scss/** 1. å¼•å…¥ functionsï¼Œæ‰èƒ½æ“æ§ color, svg, calc... */@import \"bootstrap/scss/functions\";/** 2. è‡ªè¨‚è®Šæ•¸ç½®æ–¼ bootstrap variables å‰ï¼Œè¦†è“‹ bootstrap è®Šæ•¸ */@import \"./color\";@import \"./variables\";/** 3. å¼•å…¥ variables, mixins, root */@import \"bootstrap/scss/variables\";@import \"bootstrap/scss/variables-dark\";@import 'bootstrap/scss/maps';@import \"bootstrap/scss/mixins\";@import \"bootstrap/scss/root\";/** 4. å¼•å…¥ utilities */@import \"~bootstrap/scss/utilities\";/** 5. è‡ªè¨‚ã€æ“´å……ã€èª¿æ•´ utilities */@import \"./utilities\";/** 6. å¼•å…¥éœ€è¦çš„ bootstrap components */@import \"bootstrap/scss/reboot\";@import \"bootstrap/scss/type\";@import \"bootstrap/scss/containers\";@import \"bootstrap/scss/grid\";@import \"bootstrap/scss/tables\";@import \"bootstrap/scss/forms\";@import \"bootstrap/scss/buttons\";@import \"bootstrap/scss/helpers\";/** ... *//** 7. ä½¿ç”¨ utilities éœ€å¼•å…¥ utilities apiï¼ˆå°‡ sass map è½‰æ›ç‚º utility classesï¼‰ */@import \"bootstrap/scss/utilities/api\";/** 8. å®¢è£½æ¨£å¼ç½®æ–¼æœ€å¾Œï¼Œè¦†è“‹å‰é¢çš„æ¨£å¼ */@import \"./style\"; è‡ªè¨‚æ¨£å¼æª”æ¡ˆçµæ§‹ï¼š assets/|â€”â€” scss/ |â€”â€” app.scss |â€”â€” _color.scss |â€”â€” _variables.scss |â€”â€” _style.scss è‡ªè¨‚ã€æ“´å……ã€èª¿æ•´ utilitiesï¼š é€é map-merge åˆä½µ bootstrap utilitiesï¼Œè©³ç´°å®šç¾©æ–¹å¼åƒè€ƒ å®˜æ–¹æ–‡ä»¶ // assets/scss/utilities.scss$utilities: map-merge( $utilities, ( \"cursor\": ( property: cursor, class: cursor, responsive: true, values: auto pointer grab ) )); é…ç½®å…¨åŸŸå…±ç”¨ CSSæ¥è‘—åœ¨ nuxt.config é…ç½®å…¨åŸŸå…±ç”¨ CSSï¼Œæ¥ä¸‹ä¾†æ•´å€‹å°ˆæ¡ˆ HTML éƒ½èƒ½ä½¿ç”¨ç·¨è­¯å¾Œçš„æ¨£å¼ // nuxt.config.jsexport default defineNuxtConfig({ css: [ '@/assets/scss/app.scss' ], postcss: { // CSS å±¬æ€§åŠ ä¸Šç€è¦½å™¨ç›¸å®¹æ€§å‰ç¶´ plugins: { autoprefixer: true } }}) Nuxt å°ˆæ¡ˆå·²å…§å»º postcssï¼ŒåŠ ä¸Š autoprefixer: true æœƒè‡ªå‹•ç‚ºå±¬æ€§åŠ ä¸Šç€è¦½å™¨ç›¸å®¹æ€§å‰ç¶´ç¯„ä¾‹å®šç¾©ä»¥ä¸‹æ¨£å¼ï¼š .container { display: flex;} ç·¨è­¯å¾Œçš„ CSSï¼š .container { display: -webkit-box; display: -ms-flexbox; display: flex;} å®šç¾©å…¨åŸŸå…±ç”¨ Sass / SCSS è®Šæ•¸ï¼ˆæ­é… Viteï¼‰å¦‚æœæƒ³åœ¨ .vue æª”å…§çš„ &lt;style&gt; ç›´æ¥ä½¿ç”¨ Sass / SCSS è®Šæ•¸ï¼Œéœ€æ­é… preprocessorOptions é€²è¡Œé…ç½® // nuxt.config.jsexport default defineNuxtConfig({ vite: { css: { preprocessorOptions: { scss: { additionalData: ` @import \"@/assets/scss/_color.scss\"; @import \"@/assets/scss/_variables.scss\"; ` } } } }}); // assets/scss/_color.scss$primary: #49240F;$secondary: #E4A79D; æ¥è‘—å°±å¯ä»¥åœ¨ SCFï¼ˆå–®ä¸€å…ƒä»¶æª”ï¼‰ä½¿ç”¨ SCSS è®Šæ•¸ // pages/hello.vue&lt;template&gt; &lt;div&gt; &lt;h1&gt;Hello World&lt;/h1&gt; &lt;/div&gt;&lt;/template&gt;&lt;style lang=\"scss\" scoped&gt;h1 { color: $primary;}&lt;/style&gt; åŠ ä¸Š scopedï¼Œå°‡æ¨£å¼ä½œç”¨åŸŸé™åˆ¶åœ¨å…ƒä»¶å…§ï¼Œé¿å…é€ æˆå…¨åŸŸæ±¡æŸ“ï¼Œå¦‚æœå¸Œæœ›æ¨£å¼å¯ä»¥æ¸²æŸ“åˆ°å­å…ƒä»¶ï¼Œé€é :deep() å®šç¾©å¦‚ä¸‹ :deep(h3) { color: $primary;} ä½¿ç”¨ Bootstrap Pluginsåœ¨ plugins/ ç›®éŒ„è¨»å†Š Bootstrap JavaScript Plugins æ–°å¢ plugins/bootstrap.client.js æ³¨æ„ï¼šNuxt æœƒè‡ªå‹•å¼•å…¥ï¼ˆauto importsï¼‰pluginsï¼Œbootstrap plugins è¦é™åˆ¶åœ¨ client ç«¯ä½¿ç”¨ï¼Œå¦å‰‡æœƒæ‹‹éŒ¯ document is not defined ï¼Œæª”åéœ€åŠ ä¸Š .client å¾Œç¶´ é€é Provide å®šç¾©å…¨å±€è®Šæ•¸ï¼Œå°‡éœ€è¦çš„ Bootstrap Plugins æ³¨å…¥åˆ° NuxtApp // plugins/bootstrap.client.jsimport * as bootstrap from 'bootstrap';const { Modal, Collapse } = bootstrap;export default defineNuxtPlugin(_nuxtApp =&gt; { return { provide: { bootstrap: { modal: element =&gt; new Modal(element), collapse: element =&gt; new Collapse(element) } } };}); ä½¿ç”¨ Modal Plugins // pages/about.vue&lt;template&gt; &lt;div&gt; &lt;div class=\"modal fade\" tabindex=\"-1\" ref=\"modalRef\"&gt; &lt;div class=\"modal-dialog\"&gt; &lt;div class=\"modal-content\"&gt; &lt;div class=\"modal-header\"&gt; ... &lt;/div&gt; &lt;div class=\"modal-body\"&gt; ... &lt;/div&gt; &lt;div class=\"modal-footer\"&gt; &lt;button type=\"button\" data-bs-dismiss=\"modal\"&gt;close&lt;/button&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;button type=\"button\" class=\"btn btn-success\" @click=\"showModal\"&gt; é»æˆ‘çœ‹ Modal &lt;/button&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;const { $bootstrap } = useNuxtApp();const modalRef = ref(null);let modal;const showModal = () =&gt; { modal.show();};onMounted(() =&gt; { modal = $bootstrap.modal(modalRef.value);});onBeforeUnmount(() =&gt; { // åŠ ä¸Š disposeï¼Œé¿å…åˆ‡æ›é é¢æ™‚æˆ–æ˜¯ HMR çœ‹åˆ°æ®˜ç•™ç•«é¢ modal.dispose();});&lt;/script&gt; å‹•æ…‹æ¨£å¼å‹•æ…‹æ¨£å¼å®šç¾©æ–¹å¼åŒ Vue3ï¼Œåœ¨ CSS ä½¿ç”¨ v-bind function // pages/hello.vue&lt;template&gt; &lt;div&gt; &lt;h1&gt;hello&lt;/h1&gt; &lt;h2&gt;world&lt;/h2&gt; &lt;button @click=\"theme.color = 'red'\"&gt;change color&lt;/button&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;const theme = ref({ color: 'green'});&lt;/script&gt;&lt;style lang=\"scss\" scoped&gt;h1, h2 { color: v-bind('theme.color');}&lt;/style&gt; åƒè€ƒè³‡æºï¼š https://nuxt.com/docs/getting-started/stylinghttps://vite.nuxtjs.org/misc/common-issues#styleresourceshttps://getbootstrap.com/","link":"/2023/08/25/nuxt3/nuxt-v3-styling/"},{"title":"Nuxt.js 3.x å¥—ä»¶æ‡‰ç”¨ï¼Swiper è£½ä½œè¼ªæ’­å‹•ç•«","text":"æœ¬ç¯‡æ–‡ç« åŒæ­¥ç™¼è¡¨æ–¼ 2023 iThome éµäººè³½ nuxt-swiper ç‰ˆæœ¬ï¼šv1.2.0 ç¶²ç«™é–‹ç™¼å¸¸ä½¿ç”¨åˆ°è¼ªæ’­åŠŸèƒ½ï¼ŒSwiper æ˜¯ä¸€æ¬¾åŸºæ–¼ Javascript é–‹ç™¼ã€åŠŸèƒ½å®Œæ•´ã€å¯¦ç”¨æ€§é«˜çš„è¼ªæ’­å¥—ä»¶ï¼Œæ¥ä¸‹ä¾†èªªæ˜åœ¨ Nuxt3 å°ˆæ¡ˆæ­é… nuxt-swiper å¯¦ä½œ Nuxt2 æ­é… Swiper è«‹åƒè€ƒ é€™ç¯‡æ–‡ç«  å¥—ä»¶å®‰è£ä½¿ç”¨ Nuxt æ•´åˆæ¨¡çµ„ nuxt-swiper é€²è¡Œå®‰è£ï¼ˆåŸºæ–¼ Swiper Vueï¼‰ npm install nuxt-swiper nuxt.config é…ç½®swiper é…ç½®é¸é …ï¼š prefixï¼šå…ƒä»¶åç¨±å‰ç¶´ï¼Œé è¨­ç‚º Swiper styleLangï¼šstyle èªè¨€ï¼Œé è¨­ç‚º css modulesï¼šå¼•å…¥çš„æ¨¡çµ„ï¼Œé è¨­ç‚ºå…¨éƒ¨å¼•å…¥ï¼Œæ¨¡çµ„é¸é …åƒè€ƒ å®˜æ–¹æ–‡ä»¶ // nuxt.config.jsexport default defineNuxtConfig({ modules: [ 'nuxt-swiper' ], swiper: { modules: ['navigation', 'pagination', 'effect-creative' ] }}) å»ºç«‹è¼ªæ’­å‹•ç•«åœ¨é é¢ä¸Šä½¿ç”¨å…ƒä»¶ï¼Œç¯„ä¾‹é é¢ pages/swiper.vue è‡ªå‹•å¼•å…¥å…ƒä»¶ï¼š&lt;Swiper&gt;ã€&lt;SwiperSlide&gt; ï¼ˆåç¨±ä¾ç…§å‰é¢è¨­å®šçš„ prefixï¼‰ è‡ªå‹•å¼•å…¥æ¨¡çµ„ï¼šä¾ç…§å‰é¢è¨­å®šçš„ modulesï¼Œé€™è£¡ç‚º &lt;SwiperNavigation&gt; ä»¥åŠ &lt;SwiperPagination&gt; props å‚³å…¥å±¬æ€§ï¼šå±¬æ€§é¸é …åƒè€ƒ Swiper å®˜æ–¹æ–‡ä»¶ // pages/swiper.vue&lt;template&gt; &lt;div&gt; &lt;Swiper :modules=\"[ SwiperNavigation, SwiperEffectCreative ]\" :slides-per-view=\"1\" :space-between=\"16\" :loop=\"true\"&gt; &lt;SwiperSlide&gt;Slide 1&lt;/SwiperSlide&gt; &lt;SwiperSlide&gt;Slide 2&lt;/SwiperSlide&gt; &lt;SwiperSlide&gt;Slide 3&lt;/SwiperSlide&gt; &lt;SwiperSlide&gt;Slide 4&lt;/SwiperSlide&gt; &lt;/Swiper&gt; &lt;/div&gt;&lt;/template&gt; æˆ–æ˜¯å°‡å±¬æ€§åŒ…è£æˆç‰©ä»¶ï¼Œé€é v-bind å‚³å…¥ï¼Œé…ç½®é¸é …è¼ƒè¤‡é›œæ™‚ï¼Œèƒ½æå‡æ¨¡æ¿å¯è®€æ€§ // pages/swiper.vue&lt;template&gt; &lt;div&gt; &lt;Swiper v-bind=\"swiperConfig\"&gt; &lt;SwiperSlide&gt;Slide 1&lt;/SwiperSlide&gt; &lt;SwiperSlide&gt;Slide 2&lt;/SwiperSlide&gt; &lt;SwiperSlide&gt;Slide 3&lt;/SwiperSlide&gt; &lt;SwiperSlide&gt;Slide 4&lt;/SwiperSlide&gt; &lt;/Swiper&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;const swiperConfig = { modules: [ SwiperNavigation, SwiperEffectCreative ], slidesPerView: 1, spaceBetween: 16, loop: true, breakpoints: { 545: { slidesPerView: 2 }, 1080: { slidesPerView: 3 }, 1280: { slidesPerView: 4 } }};&lt;/script&gt; Swiper äº‹ä»¶äº‹ä»¶é¸é …åƒè€ƒ å®˜æ–¹æ–‡ä»¶ // pages/swiper.vue&lt;template&gt; &lt;div&gt; &lt;Swiper @slide-change=\"slideChange()\"&gt; ... &lt;/Swiper&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt;const slideChange = () =&gt; { console.log('slideChange');};&lt;/script&gt; Swiper æ¨£å¼ä½¿ç”¨ Swiper é è¨­æ¨£å¼ï¼ˆæ¨£å¼é¸æ“‡ï¼‰ // import Swiper èˆ‡æ¨¡çµ„æ¨£å¼import 'swiper/css';import 'swiper/css/navigation';import 'swiper/css/pagination'; useSwiper å¯¦ä½œæ§åˆ¶æŒ‰éˆ•ä½¿ç”¨ Swiper Vue useSwiper hookï¼Œä¾†å–å¾— Swiper å¯¦é«”ï¼Œå‘¼å«ç›¸é—œæ–¹æ³•ï¼ˆex: slidePrev()ï¼‰ // components/SwiperController.vue&lt;template&gt; &lt;button @click=\"direction === 'prev' ? swiper.slidePrev() : swiper.slideNext()\"&gt; {{ direction }} &lt;/button&gt;&lt;/template&gt;&lt;script setup&gt;const props = defineProps({ direction: { type: String, default: '', validator: value =&gt; { return [ 'prev', 'next' ].includes(value); } }});const swiper = useSwiper();&lt;/script&gt; // pages/swiper.vue&lt;template&gt; &lt;div&gt; &lt;Swiper&gt; &lt;SwiperSlide&gt;Slide 1&lt;/SwiperSlide&gt; &lt;SwiperSlide&gt;Slide 2&lt;/SwiperSlide&gt; &lt;SwiperSlide&gt;Slide 3&lt;/SwiperSlide&gt; &lt;SwiperSlide&gt;Slide 4&lt;/SwiperSlide&gt; &lt;SwiperController direction=\"prev\" /&gt; &lt;SwiperController direction=\"next\" /&gt; &lt;/Swiper&gt; &lt;/div&gt;&lt;/template&gt; åƒè€ƒè³‡æºï¼š https://github.com/cpreston321/nuxt-swiper#readmehttps://swiperjs.com/vue","link":"/2023/08/16/nuxt3/nuxt-v3-swiper/"},{"title":"Nuxt.js 3.x ESLint ç¨‹å¼ç¢¼è¦ç¯„èˆ‡è‡ªå‹•æ’ç‰ˆï¼æ­é… TypeScript","text":"æœ¬ç¯‡æ–‡ç« åŒæ­¥ç™¼è¡¨æ–¼ 2023 iThome éµäººè³½ Nuxt 3 å®Œæ•´æ”¯æ´ TypeScript é–‹ç™¼ï¼ŒTypeScript ç›¸é—œè¨­å®šåœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„ tsconfig.jsonï¼Œæœ¬ç¯‡å°‡èªªæ˜ï¼š å®‰è£ ESLint ç¨‹å¼ç¢¼æª¢æ ¸å·¥å…·ï¼ˆJavaScriptï¼TypeScriptï¼‰ TypeScript å‹åˆ¥æª¢æŸ¥ VScode å®‰è£ Volar Extension VSCode é…ç½®ç¨‹å¼ç¢¼æ ¼å¼åŒ– ESLintï¼ˆECMAScript Lintï¼‰ESLint æ˜¯ä¸€å€‹é–‹æºçš„ JavaScript / TypeScript ç¨‹å¼ç¢¼è¦ç¯„å·¥å…·ï¼Œç”¨æ–¼æª¢æŸ¥å’Œå°‹æ‰¾ç¨‹å¼ç¢¼ä¸­çš„å•é¡Œã€éŒ¯èª¤ï¼Œä¾‹å¦‚æœªä½¿ç”¨çš„è®Šæ•¸ã€æœªå®šç¾©çš„è®Šæ•¸ã€é‡è¤‡çš„ç¨‹å¼ç¢¼ã€éŒ¯èª¤çš„èªæ³•ç­‰ã€‚ é€é ESLintï¼Œæˆ‘å€‘å¯ä»¥æ ¹æ“šå°ˆæ¡ˆéœ€æ±‚å’Œåœ˜éšŠè¦ç¯„ï¼Œå®šç¾©é©åˆçš„ç¨‹å¼ç¢¼æª¢æŸ¥è¦å‰‡ï¼Œä¾‹å¦‚ç¸®æ’ã€æ›è¡Œã€å¼•è™Ÿä½¿ç”¨ç­‰ï¼Œä¸¦æ•´åˆåˆ°é–‹ç™¼æµç¨‹ä¸­ï¼Œä»¥æé«˜ç¨‹å¼ç¢¼å“è³ªã€æ¸›å°‘éŒ¯èª¤ï¼Œä¸¦ç¢ºä¿ä¸€è‡´çš„ç¨‹å¼ç¢¼é¢¨æ ¼ã€‚ é–‹ç™¼è€…å¸¸ç”¨çš„è¦ç¯„æœ‰ Googleã€Airbnbã€JavaScript Standard Style ç­‰ï¼Œæœ¬ç¯‡ä½¿ç”¨ Nuxt3 å®˜æ–¹æ­é…çš„ ESLint é€²è¡Œèªªæ˜ã€‚ CSSï¼SCSS ç¨‹å¼ç¢¼æª¢æ ¸éœ€æ­é… Stylelintï¼Œå¯ä»¥åƒè€ƒ é€™ç¯‡æ–‡ç«  1. å¥—ä»¶å®‰è£ä½¿ç”¨ nuxt æ•´åˆæ¨¡çµ„ @nuxtjs/eslint-config-typescript devDependencies npm install --save-dev @nuxtjs/eslint-config-typescript eslint 2. é…ç½® .eslintrc.js è¨­å®šæª”åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„æ–°å¢ .eslintrc.jsï¼Œé…ç½®å¦‚ä¸‹ï¼š rulesï¼šæ ¹æ“šå°ˆæ¡ˆéœ€æ±‚è‡ªè¨‚è¦ç¯„ï¼Œé¸é …åŠé è¨­å€¼å¯ä»¥åƒè€ƒ å®˜æ–¹æ–‡ä»¶ // .eslintrc.jsmodule.exports = { root: true, extends: [ '@nuxtjs/eslint-config-typescript' ], parserOptions: { parser: '@typescript-eslint/parser' }, rules: { // è‡ªè¨‚è¦å‰‡ quotes: ['error', 'single'], // ä½¿ç”¨å–®å¼•è™Ÿ 'no-console': 'warn' // ä½¿ç”¨ console æ™‚è­¦å‘Šæç¤º }} æ ¹æ“š å®˜æ–¹æ–‡ä»¶ èªªæ˜ï¼Œ@nuxtjs/eslint-config-typescript æ“´å……è¨­å®šå®Œæˆå¾Œï¼ŒESLint é è¨­æœƒä½¿ç”¨ @typescript-eslint/parser ä½œç‚ºèªæ³•åˆ†æå™¨ï¼Œä¸éœ€è¨­å®šï¼Œä¸ééœ€ç•™æ„ parserOptions.parser é¸é …ä¸èƒ½è¢«å…¶ä»–è¨­å®šè¦†å¯« 3. åŸ·è¡Œ lint æª¢æŸ¥åœ¨ package.json scripts é…ç½® lint æŒ‡ä»¤ \"lint\": \"eslint --ext .ts,.js,.vue .\" åŸ·è¡Œ npm run lint æŸ¥çœ‹æª¢æ ¸çµæœ TypeScript å‹åˆ¥æª¢æŸ¥TypeScript ç›¸è¼ƒæ–¼ Javascript æœ€å¤§å„ªé»æ˜¯éœæ…‹å‹åˆ¥å®šç¾©å’Œæª¢æŸ¥ã€‚Nuxt åŸºæ–¼æ•ˆèƒ½è€ƒé‡ï¼Œåœ¨åŸ·è¡Œ nuxi dev æˆ– nuxi build æ™‚ä¸æœƒè‡ªå‹•æª¢æŸ¥å‹åˆ¥ï¼Œå¯ä»¥é€éä»¥ä¸‹æ–¹å¼é€²è¡Œå‹åˆ¥æª¢æ ¸ï¼š é¦–å…ˆåœ¨ app.vue åŠ ä¸Šä¸€æ®µç¨‹å¼ç¢¼ï¼š // app.vue&lt;template&gt; &lt;div&gt; &lt;NuxtWelcome /&gt; &lt;/div&gt;&lt;/template&gt;&lt;script lang=\"ts\" setup&gt;const num: number = '123';&lt;/script&gt; æ–¹æ³•ä¸€ï¼šæ‰‹å‹•åŸ·è¡Œå‹åˆ¥æª¢æŸ¥é€é nuxi æŒ‡ä»¤ä¾†åŸ·è¡Œ vue-tsc æª¢æŸ¥å‹åˆ¥ npx nuxi typecheck é¡¯ç¤ºéŒ¯èª¤æç¤ºå¦‚ä¸‹ æ–¹æ³•äºŒï¼šè‡ªå‹•åŸ·è¡Œå‹åˆ¥æª¢æŸ¥ç›´æ¥å®‰è£ vue-tsc ä»¥åŠ typescript devDependencies npm install --save-dev vue-tsc typescript åœ¨ nuxt.config å•Ÿç”¨ typescript.typeCheck // nuxt.config.jsexport default defineNuxtConfig({ typescript: { typeCheck: true }}); ä¹‹å¾Œåœ¨åŸ·è¡Œ nuxi dev æˆ– nuxi build éƒ½æœƒè‡ªå‹•æª¢æ ¸å‹åˆ¥ VSCode å®‰è£ Volar ExtensionVolar æ˜¯ä¸€å€‹é‡å° Vue.js é–‹ç™¼çš„æ“´å……å¥—ä»¶ï¼Œåœ¨ç·¨è¼¯å™¨ä¸­æä¾›äº†æ›´å¥½çš„å‹åˆ¥æ”¯æ´ã€éŒ¯èª¤æª¢æ¸¬å’Œè‡ªå‹•è£œå…¨åŠŸèƒ½ï¼Œè®“æˆ‘å€‘å¯ä»¥åœ¨ç·¨è­¯å‰é å…ˆç™¼ç¾éŒ¯èª¤ï¼Œæœ‰åŠ©æ–¼æå‡é–‹ç™¼æ•ˆç‡å’Œç¨‹å¼ç¢¼å“è³ªï¼ŒNuxt å®˜æ–¹ä¹Ÿå»ºè­°å®‰è£ã€‚ TypeScript Vue Plugin (Volar)ï¼š é‡å° TypeScript åœ¨ Vue é …ç›®ä¸­çš„æ”¯æ´ï¼Œæä¾›äº†å¼·å¤§çš„ TypeScript æ”¯æ´ï¼ŒåŒ…æ‹¬é¡å‹æ¨æ–·ã€å®šç¾©è·³è½‰ã€é‡æ§‹æ”¯æ´ç­‰åŠŸèƒ½ Vue Language Features (Volar)ï¼š ä¸»è¦æä¾›äº† Vue é …ç›®çš„èªè¨€æ”¯æ´ï¼ŒåŒ…æ‹¬æ¨¡æ¿çš„é¡å‹æª¢æŸ¥ã€å³æ™‚éŒ¯èª¤æª¢æ¸¬ã€è‡ªå‹•å®Œæˆç­‰åŠŸèƒ½ å®‰è£å®Œæˆå¾Œï¼Œå¯ä»¥çœ‹åˆ°ç·¨è¼¯å™¨å‡ºç¾æç¤ºè¨Šæ¯ï¼š VSCode é…ç½®è‡ªå‹•æ’ç‰ˆè¨±å¤šé–‹ç™¼è€…ç¿’æ…£æ•´åˆ ESLint èˆ‡ Prettier é–‹ç™¼ï¼Œä¸éæ ¹æ“š Nuxt3 å®˜æ–¹æ–‡ä»¶ èªªæ˜ï¼Œå› å…©è€…å®¹æ˜“ç”¢ç”Ÿè¡çªï¼Œä¸” ESLint å¯ä»¥é…ç½®è‡ªå‹•æ ¼å¼åŒ–ï¼Œå› æ­¤ä¸å»ºè­°å®‰è£ Prettierã€‚ é€éåœ¨ IDEï¼ˆæ•´åˆé–‹ç™¼ç’°å¢ƒï¼‰é€²è¡Œè¨­å®šï¼Œå°±å¯ä»¥åŸ·è¡Œç¨‹å¼ç¢¼æ ¼å¼åŒ–ã€‚ å®˜æ–¹æåˆ°ï¼Œæœªä¾†æˆ–è¨±é‚„æ˜¯æœƒå…¼å®¹ Prettierï¼Œè©³è«‹åƒè€ƒ è¨è«–ä¸² 1. æ–°å¢ settings.jsonåœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„æ–°å¢ .vscode/settings.json æª” |â€”â€” .vscode/ |â€”â€” settings.json|â€”â€” my-app/ |â€”â€” .nuxt/ |â€”â€” app.vue |â€”â€” ... 2. å•Ÿç”¨è‡ªå‹•ä¿®æ­£å’Œæ ¼å¼åŒ–åŠŸèƒ½// .vscode/settings.json{ \"editor.codeActionsOnSave\": { \"source.fixAll\": false, \"source.fixAll.eslint\": true }} è¨­å®šå®Œæˆå¾Œï¼Œéœ€è¦é‡å•Ÿå°ˆæ¡ˆæ‰èƒ½æˆåŠŸé‹ä½œï¼Œæ¥è‘—åœ¨å„²å­˜æª”æ¡ˆæ™‚ï¼ŒESLint å°±å¯ä»¥å¹«æˆ‘å€‘è‡ªå‹•æ’ç‰ˆå›‰ï¼ åƒè€ƒè³‡æºï¼š https://github.com/nuxt/eslint-config#readmehttps://typescript.nuxtjs.org/guide/lint/https://nuxt.com/docs/guide/concepts/typescript#typescript","link":"/2023/06/30/nuxt3/nuxt-v3-typescript-and-eslint/"},{"title":"Nuxt.js 3.x å¥—ä»¶æ‡‰ç”¨ï¼VeeValidate v4.x è¡¨å–®é©—è­‰","text":"æœ¬ç¯‡æ–‡ç« åŒæ­¥ç™¼è¡¨æ–¼ 2023 iThome éµäººè³½ Nuxt2 vee-validate è«‹åƒè€ƒ é€™ç¯‡æ–‡ç«  vee-validate æ˜¯ä½¿ç”¨æ–¼ Vue.js çš„è¼•é‡è¡¨å–®é©—è­‰å¥—ä»¶ï¼Œåƒ…éœ€åœ¨è¡¨å–®ä¸ŠåŠ å…¥ç°¡æ˜“èªæ³•å°±èƒ½é€²è¡Œé©—è­‰ Vue.js v3.x éœ€æ­é… vee-validate v4.x step1ï¼švee-validate å¥—ä»¶å®‰è£ä½¿ç”¨ Nuxt æ•´åˆå¥—ä»¶ @vee-validate/nuxt npm i @vee-validate/nuxt step2ï¼šnuxt.config é…ç½®// nuxt.config.tsexport default defineNuxtConfig({ // ... modules: [ '@vee-validate/nuxt', ], veeValidate: { // å•Ÿç”¨ auto imports autoImports: true, // æ›´æ› components åç¨± componentNames: { Form: 'VeeForm', Field: 'VeeField', FieldArray: 'VeeFieldArray', ErrorMessage: 'VeeErrorMessage', } }}); step3ï¼š@vee-validate/rules é©—è­‰è¦å‰‡æ“´å……æˆ‘å€‘å¯ä»¥åœ¨ vee-validate è‡ªè¨‚é©—è­‰è¦å‰‡ï¼Œæˆ–æ˜¯æ­é…é è¨­è¦å‰‡ï¼Œè‹¥è¦ä½¿ç”¨é è¨­è¦å‰‡ï¼Œæ­¥é©Ÿå¦‚ä¸‹ å®‰è£é©—è­‰è¦å‰‡å¥—ä»¶ï¼š npm i @vee-validate/rules æ–°å¢ plugins/vee-validate.client.jsï¼Œæ“´å……æ‰€æœ‰è¦å‰‡ï¼š // vee-validate.client.jsimport { defineRule } from 'vee-validate';import allRules from '@vee-validate/rules';// è¿´åœˆä¾åºåŠ å…¥è¦å‰‡Object.keys(allRules).forEach(rule =&gt; { defineRule(rule, allRules[rule]);});// å¿…é ˆå®šç¾©ï¼Œç”¨ä¾†å°è£ pluginexport default defineNuxtPlugin(_nuxtApp =&gt; {}); step4ï¼š@vee-validate/i18n èªç³»è¨­å®šå®‰è£ i18n å¥—ä»¶ï¼š npm i @vee-validate/i18n æ–°å¢ plugins/vee-validate.client.jsï¼Œé€²è¡Œèªç³»èª¿æ•´ï¼š // vee-validate.client.jsimport { configure } from 'vee-validate';import { localize, setLocale } from '@vee-validate/i18n';import zhTW from '@vee-validate/i18n/dist/locale/zh_TW.json';// é…ç½®è¨Šæ¯configure({ generateMessage: localize({ zh_TW: zhTW })});setLocale('zh_TW');// å¿…é ˆå®šç¾©ï¼Œç”¨ä¾†å°è£ pluginexport default defineNuxtPlugin(_nuxtApp =&gt; {}); step5ï¼šè¡¨å–®é©—è­‰ è§¸ç™¼ submit æ™‚ï¼Œæœƒè‡ªå‹•å‚³å‡ºè¡¨å–®å…§å®¹ï¼Œå› æ­¤æ¬„ä½ä¸éœ€è¦å¦å¤–ç¶å®š v-model &lt;VeeForm /&gt; å…ƒä»¶ submit listener è§¸ç™¼æ™‚æœƒè‡ªå‹•èª¿ç”¨ event.preventDefault() rules å€‹åˆ¥è¨­å®šé©—è­‰é …ç›®ï¼Œå¯ä»¥è‡ªè¨‚è¦å‰‡æˆ–ä½¿ç”¨é è¨­è¦å‰‡ã€‚è‹¥ä½¿ç”¨ @vee-validate/rules æ­é…å¤šå€‹è¦å‰‡ï¼Œç”¨ | åšå€éš” &lt;template&gt; &lt;VeeForm @submit=\"submit\"&gt; &lt;VeeField name=\"email\" type=\"email\" rules=\"required|email\" /&gt; &lt;VeeErrorMessage name=\"email\" /&gt; &lt;VeeField name=\"password\" type=\"password\" :rules=\"checkPassword\" /&gt; &lt;VeeErrorMessage name=\"password\" /&gt; &lt;button type=\"submit\"&gt;submit&lt;/button&gt; &lt;/VeeForm&gt;&lt;/template&gt;&lt;script setup&gt;const checkPassword = value =&gt; { if (...) { return false; } return true;}const submit = value =&gt; { console.log('submit', value);};&lt;/script&gt; 1. é©—è­‰æˆåŠŸå‰ç¦æ­¢é€å‡ºè¡¨å–®åˆ©ç”¨ &lt;VeeForm /&gt; çš„ meta.valid å±¬æ€§ä¾†æª¢æŸ¥æ˜¯å¦é©—è­‰æˆåŠŸ &lt;VeeForm @submit=\"submit\" v-slot=\"{ meta }\"&gt; ... &lt;button type=\"submit\" :disabled=\"!meta.valid\"&gt;submit&lt;/button&gt;&lt;/VeeForm&gt; 2. è¡¨å–®é€å‡ºå®Œæˆï¼å¤±æ•—å‰ç¦æ­¢é‡è¤‡è§¸ç™¼åˆ©ç”¨ &lt;VeeForm /&gt; çš„ meta.isSubmitting å±¬æ€§åˆ¤æ–· submit handler æ˜¯å¦åœ¨åŸ·è¡Œä¸­ &lt;template&gt; &lt;VeeForm @submit=\"submit\" v-slot=\"{ isSubmitting }\"&gt; ... &lt;button type=\"submit\" :disabled=\"isSubmitting\"&gt; &lt;span class=\"spinner\" v-show=\"isSubmitting\"&gt;&lt;/span&gt; submit &lt;/button&gt; &lt;/VeeForm&gt;&lt;/template&gt;&lt;script setup&gt;const submit = value =&gt; { return new Promise(resolve =&gt; { setTimeout(() =&gt; { console.log('sumbit', value); resolve(); }, 2000); });};&lt;/script&gt; 3. schema çµ±ä¸€ç®¡ç†è¦å‰‡é™¤äº†é€é rules è¨­å®šé©—è­‰è¦å‰‡ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨è¡¨å–®å¤–å±¤é€é validation-schema props çµ±ä¸€å®šç¾©è¦å‰‡ &lt;template&gt; &lt;VeeForm @submit=\"submit\" :validation-schema=\"schema\"&gt; &lt;VeeField name=\"email\" type=\"email\" /&gt; &lt;VeeErrorMessage name=\"email\" /&gt; &lt;VeeField name=\"password\" type=\"password\" /&gt; &lt;VeeErrorMessage name=\"password\" /&gt; &lt;button type=\"submit\"&gt;submit&lt;/button&gt; &lt;/VeeForm&gt;&lt;/template&gt;&lt;script setup&gt;const schema = { email: 'required|email', password: 'required|min:8'};&lt;/script&gt; 4. å¸¶å…¥é è¨­å€¼setValues(fields) ï¼šå¸¶å…¥æ•´å€‹è¡¨å–®è³‡æ–™ï¼Œè‡ªå‹•è§¸ç™¼é©—è­‰ &lt;template&gt; &lt;VeeForm @submit=\"submit\" ref=\"veeForm\"&gt; &lt;VeeField name=\"email\" type=\"email\" /&gt; &lt;VeeErrorMessage name=\"email\" /&gt; &lt;VeeField name=\"password\" type=\"password\" /&gt; &lt;VeeErrorMessage name=\"password\" /&gt; &lt;button type=\"submit\"&gt;submit&lt;/button&gt; &lt;/VeeForm&gt;&lt;/template&gt;&lt;script setup&gt;const veeForm = ref(null);onMounted(() =&gt; { const form = { email: 'test@myweb.com', password: '12344321' }; veeForm.value.setValues(form);});&lt;/script&gt; setFieldValue(field, value) ï¼šå¸¶å…¥å–®æ¬„è³‡æ–™ï¼Œè§¸ç™¼æ­¤æ¬„é©—è­‰ &lt;template&gt; &lt;VeeForm @submit=\"submit\" ref=\"veeForm\"&gt; &lt;VeeField name=\"email\" type=\"email\" /&gt; &lt;VeeErrorMessage name=\"email\" /&gt; &lt;button type=\"submit\"&gt;submit&lt;/button&gt; &lt;/VeeForm&gt;&lt;/template&gt;&lt;script setup&gt;const veeForm = ref(null);onMounted(() =&gt; { veeForm.value.setFieldValue('email', 'test@myweb.com');});&lt;/script&gt; 5. èª¿æ•´é©—è­‰è§¸ç™¼è¡Œç‚º validateOnBlurï¼šé›¢é–‹ç„¦é»æ™‚è§¸ç™¼ï¼Œé è¨­ true validateOnChangeï¼šæ¬„ä½åœ¨ change äº‹ä»¶è§¸ç™¼ï¼Œé è¨­ true validateOnInputï¼šè¼¸å…¥å…§å®¹æ™‚è§¸ç™¼ï¼Œé è¨­ false validateOnModelUpdateï¼šupdate:modelValue&nbsp;(v-model) äº‹ä»¶è§¸ç™¼ï¼Œé è¨­ true å…¨åŸŸèª¿æ•´ï¼š // vee-validate.client.jsimport { configure } from 'vee-validate';configure({ validateOnInput: true});export default defineNuxtPlugin(_nuxtApp =&gt; {}); å±€éƒ¨èª¿æ•´ï¼š &lt;Field name=\"email\" :validateOnBlur=\"false\" :validateOnChange=\"false\" :validateOnInput=\"false\" /&gt; 6. æ¸…é™¤è¡¨å–®åˆ©ç”¨ &lt;VeeForm /&gt; çš„ resetForm æ–¹æ³•ä¾†æ¸…é™¤è¡¨å–® &lt;VeeForm @submit=\"submit\" v-slot=\"{ resetForm }\"&gt; ... &lt;button type=\"buttom\" @click=\"resetForm\"&gt;clear&lt;/button&gt;&lt;/VeeForm&gt; 7. Checkbox ï¼Radio&lt;VeeField v-slot=\"{ field }\" name=\"gender\" type=\"radio\" value=\"male\"&gt; &lt;label&gt; &lt;input type=\"radio\" name=\"gender\" v-bind=\"field\" value=\"male\" /&gt; male &lt;/label&gt;&lt;/VeeField&gt;&lt;VeeField v-slot=\"{ field }\" name=\"gender\" type=\"radio\" value=\"female\"&gt; &lt;label&gt; &lt;input type=\"radio\" name=\"gender\" v-bind=\"field\" value=\"female\" /&gt; female &lt;/label&gt;&lt;/VeeField&gt; åƒè€ƒè³‡æºï¼š https://vee-validate.logaretm.com/v4/","link":"/2023/07/24/nuxt3/nuxt-v3-vee-validate/"},{"title":"Nuxt.js vs Vue.jsï¼Œæ·ºè«‡ SPA èˆ‡ SSR","text":"æœ¬ç¯‡æ–‡ç« åŒæ­¥ç™¼è¡¨æ–¼ 2023 iThome éµäººè³½ æåˆ° Nuxt.jsï¼Œå¿…é ˆå…ˆå¾ Vue.js èªªèµ·ï¼ŒVue.js ç‚ºå°ˆæ³¨åœ¨è¦–åœ–å±¤ï¼ˆViewï¼‰çš„ Javascript æ¡†æ¶ï¼Œç‚º SPAï¼ˆSingle Page Applicationï¼‰å–®é æ‡‰ç”¨ç¨‹å¼ï¼Œæœå°‹å¼•æ“çˆ¬èŸ²æœªèƒ½æŠ“å–åˆ°æ¸²æŸ“å¾Œçš„ HTML å…§å®¹ï¼Œå› æ­¤ SEOï¼ˆSearch Engine Optimizationï¼‰è¡¨ç¾è¶¨è¿‘æ–¼é›¶ã€‚ è€Œ Nuxt.js æ˜¯åŸºæ–¼ Vue.js çš„æ¡†æ¶ï¼Œç‚ºé€šç”¨æ¸²æŸ“æ¨¡å¼ï¼ˆUniversal Renderingï¼‰ï¼Œçµåˆäº† SSRï¼ˆServer Side Renderï¼‰åŠ CSRï¼ˆClient Side Renderï¼‰ï¼Œæœå°‹å¼•æ“çˆ¬èŸ²å¯ä»¥å–å¾— HTML å…§å®¹ï¼Œå¤§å¹…æå‡ SEO è¡¨ç¾ã€‚ SPA / CSR vs MPA / SSR SPAï¼ˆSingle Page Applicationï¼‰å–®é å¼æ‡‰ç”¨ä½¿ç”¨ CSRï¼ˆClient Side Renderï¼‰ç”¨æˆ¶ç«¯æ¸²æŸ“æ¨¡å¼ã€‚æ•´å€‹ç¶²ç«™æ‡‰ç”¨åªæœ‰å–®ä¸€ HTML é é¢ï¼Œä¸€ä½†é é¢è¢«è¼‰å…¥é€²ä¾†å¾Œï¼Œå°±ä¸æœƒå†é€²è¡Œè©²é é¢è«‹æ±‚ï¼ˆForm Requestï¼‰ï¼Œè€Œæ˜¯é€é AJAX&nbsp;å¾å¾Œç«¯è«‹æ±‚è³‡æ–™ï¼Œä¸¦é€é Javascript å‹•æ…‹æ›´æ–°èˆ‡æ¸²æŸ“ç¶²é å…§å®¹ã€‚ æ¡ CSRï¼ˆClient Side Renderï¼‰ç”¨æˆ¶ç«¯æ¸²æŸ“æ¨¡å¼ã€‚ å„ªé»ï¼šä½¿ç”¨è€…é«”é©—ä½³ï¼Œå› æ¯æ¬¡åˆ‡æ›é é¢æ™‚åªæœ‰éƒ¨åˆ†ç•«é¢æ›´æ–°ï¼Œä¸æœƒé‡æ–°è¼‰å…¥æ•´å€‹é é¢ ç¼ºé»ï¼šæœå°‹å¼•æ“çˆ¬èŸ²æœªèƒ½æŠ“å–åˆ°æ¸²æŸ“å¾Œçš„ HTML å…§å®¹ï¼Œå› æ­¤ SEOï¼ˆSearch Engine Optimizationï¼‰è¡¨ç¾è¶¨è¿‘æ–¼é›¶ MPAï¼ˆMulti Page Applicationï¼‰å¤šé å¼æ‡‰ç”¨ä½¿ç”¨ SSRï¼ˆServer Side Renderï¼‰ä¼ºæœå™¨ç«¯æ¸²æŸ“æ¨¡å¼ã€‚åœ¨é é¢è¼‰å…¥å‰å³æ¸²æŸ“ï¼Œæ¯æ¬¡è·³è½‰é é¢ï¼Œç€è¦½å™¨éƒ½æœƒé‡æ–°å‘ä¼ºæœå™¨ç™¼é€é é¢è«‹æ±‚ï¼Œç”±ä¼ºæœå™¨å›å‚³é é¢çš„ HTML å…§å®¹ã€‚ å„ªé»ï¼šåœ¨ä¼ºæœå™¨ä¸Šç”Ÿæˆå®Œæ•´çš„ HTML é é¢ï¼Œé¦–æ¬¡å…§å®¹ç¹ªè£½ï¼ˆFCPï¼ŒFirst Contentful Paintï¼‰é€Ÿåº¦å¿«ï¼Œä¸”æœå°‹å¼•æ“çˆ¬èŸ²å¯ä»¥å–å¾—å®Œæ•´ HTML å…§å®¹ï¼ŒSEO è¡¨ç¾ä½³ ç¼ºé»ï¼šä½¿ç”¨è€…é«”é©—è¼ƒå·®ï¼Œå› æ¯æ¬¡åˆ‡æ›é é¢éƒ½è¦é‡æ–°åˆ·æ–°é é¢ï¼Œä¸”å°ä¼ºæœå™¨è² æ“”è¼ƒå¤§ Universal Renderingé€šç”¨æ¸²æŸ“ï¼ŒNuxt.js ä½¿ç”¨çš„æ¸²æŸ“æ¨¡å¼ï¼ŒåŒæ™‚æ”¯æ´ SSR èˆ‡ CSR æŠ€è¡“ï¼Œåˆæ¬¡é€²åˆ°é é¢æ™‚æ¡ç”¨ SSR æ¨¡å¼ï¼Œåœ¨ä¼ºæœå™¨ä¸­ç”¢ç”Ÿå®Œæ•´ HTML å…§å®¹ï¼Œå›å‚³çµ¦ç€è¦½å™¨ç«¯ã€‚å¾ŒçºŒå‹•æ…‹åˆ‡æ›é é¢æ™‚ï¼Œå‰‡æ¡ç”¨ CSR æ¨¡å¼ï¼Œçµåˆäº† SSR èˆ‡ SPA çš„å„ªé»ï¼Œé™¤äº†ä½¿ç”¨è€…é«”é©—ä½³ï¼ŒåŒæ™‚ä¿æœ‰è‰¯å¥½çš„ SEO è¡¨ç¾ã€‚ åœ–ç‰‡åƒè€ƒï¼šNuxt å®˜ç¶² æµç¨‹ï¼š ä¼ºæœå™¨ç«¯ç”¢ç”Ÿéœæ…‹ HTMLï¼Œå›å‚³çµ¦ç€è¦½å™¨ç«¯ ç€è¦½å™¨ç«¯è¼‰å…¥ JavaScript ä¸¦åŸ·è¡Œ Hydration æ··åˆæ¸²æŸ“å®Œæˆï¼Œä½¿ç”¨è€…å¯ä»¥é–‹å§‹èˆ‡ç¶²é äº’å‹• Hydration æ··åˆæ¸²æŸ“ï¼š åœ¨ç”¨æˆ¶ç«¯ä½¿ç”¨ JavaScriptï¼Œè®“ä¼ºæœå™¨ç«¯ç”¢ç”Ÿçš„éœæ…‹ HTML åŠ ä¸Š Event Handlersï¼ˆäº‹ä»¶è™•ç†å™¨ï¼‰ï¼Œè®“ä½¿ç”¨è€…èƒ½èˆ‡ç¶²é é€²è¡Œäº’å‹•çš„æŠ€è¡“ï¼ŒNuxt.js è·Ÿ React æ¡†æ¶ Next.js å³ä½¿ç”¨æ­¤æŠ€è¡“ Nuxt3 ç°¡ä»‹ ä½¿ç”¨ Vue3 é–‹ç™¼ å®Œæ•´ SSR æ”¯æ´ï¼Œä¹Ÿå¯ä»¥é¸ç”¨ CSR æ¨¡å¼ è‡ªå‹•å®šç¾©è·¯ç”±ï¼ˆä½¿ç”¨ Vue-Routerï¼‰ï¼Œä¸éœ€æ‰‹å‹•é…ç½® æ”¯æ´ webpack 5 èˆ‡ Vite é–‹ç™¼ï¼ˆé è¨­æ­é… Viteï¼‰ å®Œæ•´æ”¯æ´ TypeScript å®šç¾©åœ¨ composablesã€componentsã€plugins çš„æª”æ¡ˆï¼ŒNuxt æœƒè‡ªå‹•å¼•å…¥ï¼ˆAuto-importsï¼‰ å…§å»ºæ”¯æ´ SSR çš„ AJAX è«‹æ±‚æ–¹æ³•ï¼ˆ$fetchã€useFetchã€useAsyncDataï¼‰ Nuxt or VueVue.js SPA æ¶æ§‹ä½¿ç”¨è€…é«”é©—ä½³ï¼Œå¦‚æœå°ˆæ¡ˆç‚ºå¾Œå°ç³»çµ±ï¼Œæˆ–æ˜¯ä¸éœ€è¦ SEOï¼Œé¸æ“‡ Vue.js é–‹ç™¼ç›¸å°å–®ç´”ã€‚ Nuxt.js æ˜¯åŸºæ–¼ Vue.js é–‹ç™¼çš„æ¡†æ¶ï¼Œé©åˆå·²ç¶“æœ‰ Vue.js æˆ–å…¶ä»– JavaScript æ¡†æ¶ä½¿ç”¨ç¶“é©—çš„é–‹ç™¼è€…ï¼Œå¦‚æœå°ˆæ¡ˆéœ€è¦è‰¯å¥½çš„ SEO è¡¨ç¾ï¼Œæ¨å‘ Nuxt.jsï¼Œå®‰è£æ–¹å¼ç°¡å–®ã€è‡ªå‹•åŒ–ç¹ç‘£çš„æ­¥é©Ÿï¼Œæä¾›å¾ˆä¸éŒ¯çš„é–‹ç™¼é«”é©—ã€‚ åƒè€ƒè³‡æºï¼š https://nuxt.com/docs/guide/concepts/rendering#universal-renderinghttps://shubo.io/rendering-patterns/https://ithelp.ithome.com.tw/articles/10262891","link":"/2023/08/22/nuxt3/nuxt-vs-vue/"},{"title":"Vue.js Props, $emit, Provide, Inject çˆ¶å­å…ƒä»¶è³‡æ–™å‚³é","text":"ç‰ˆæœ¬ï¼šVue 3.2.x Props &amp; $emitçˆ¶å­å…ƒä»¶é–“æºé€šçš„é‡è¦ç®¡é“ï¼Œå› æ¯å€‹å…ƒä»¶çš„ä½œç”¨ç¯„åœçš†æ‡‰ç¨ç«‹ï¼Œå› æ­¤ä¸æ‡‰åœ¨å­å…ƒä»¶å…§ç›´æ¥ä¿®æ”¹çˆ¶å…ƒä»¶çš„è³‡æ–™ï¼Œå¦å‰‡æœƒé›£ä»¥é™¤éŒ¯ï¼Œé€ æˆç¶­è­·ä¸Šå›°é›£ã€‚ å‡è¨­é é¢å±¤ç´šå¦‚ä¸‹ Root.vue |â€”â€” Child.vue Propsçˆ¶å±¤å‚³éåˆ°å­å±¤ é€é v-bind:çˆ¶å…ƒä»¶åƒæ•¸åç¨±=\"å­å…ƒä»¶åƒæ•¸åç¨±\"ï¼Œå°‡è³‡æ–™å‚³éåˆ°å­å…ƒä»¶ // views/Root.vue&lt;template&gt; &lt;Child :message=\"messageToChild\" /&gt;&lt;/template&gt;&lt;script&gt;export default { name: 'Root', data() { return { messageToChild: 'æ—©å®‰æ‚¨å¥½' } }}&lt;/script&gt; å­å±¤æ¥æ”¶çˆ¶å±¤è³‡æ–™ é€é props æ¥æ”¶ç”±çˆ¶å±¤å‚³éä¾†çš„è³‡æ–™ typeï¼šæŒ‡å®šå‹åˆ¥ï¼Œå¦‚æœæ¥å—å¤šå€‹å‹åˆ¥ï¼Œå¯ä»¥ä½¿ç”¨é™£åˆ—ï¼ˆEXï¼štype: [ String, Number ]ï¼‰ requiredï¼šæ˜¯å¦å¿…å¡«ï¼Œé è¨­ false defaultï¼šé è¨­å€¼ï¼Œå¦‚æœæŒ‡å®šå‹åˆ¥ç‚ºç‰©ä»¶æˆ–é™£åˆ—ï¼Œéœ€ä½¿ç”¨å‡½å¼å®šç¾©ï¼ˆEXï¼šdefault: () =&gt; {}ï¼‰ // components/Child.vue&lt;template&gt; &lt;input type=\"text\" :value=\"message\" /&gt;&lt;/template&gt;&lt;script&gt;export default { name: 'Child', props: { message: { type: String, required: true, default: '' } }}&lt;/script&gt; $emitå‰é¢æåˆ°ï¼Œå­å…ƒä»¶ç„¡æ³•ç›´æ¥ä¿®æ”¹çˆ¶å±¤çš„è³‡æ–™ï¼Œæœƒå ±éŒ¯èª¤å¦‚ä¸‹ [Vue warn]: Avoid mutating a prop directly since the value will be overwritten whenever the parent component re-renders. Instead, use a data or computed property based on the propâ€™s value. å¦‚æœè¦ä¿®æ”¹çˆ¶å±¤å‚³å›çš„å€¼ï¼Œéœ€é€é $emit è§¸ç™¼çˆ¶å±¤äº‹ä»¶ï¼Œç°¡å–®ä¾†èªªæ˜¯é€šçŸ¥çˆ¶å±¤å…ƒä»¶æ›´æ–°å€¼ï¼Œä¸èƒ½ç›´æ¥ç”±å­å…ƒä»¶æ›´æ–°ã€‚ å­å±¤è§¸ç™¼çˆ¶å±¤äº‹ä»¶ this.$emit(/* event name */ 'update-message', /* value */ value) ç¬¬ä¸€å€‹åƒæ•¸ï¼šçˆ¶å±¤äº‹ä»¶åç¨±ï¼Œå‘½åå¿…é ˆç”¨é€£å­—ç¬¦ï¼ˆEX: â€˜update-messageâ€™ï¼‰ï¼Œä¸èƒ½ä½¿ç”¨é§å³°ï¼ˆEX: â€˜updateMessageâ€™ï¼‰ï¼Œå¦å‰‡æœƒå¤±æ•ˆ ç¬¬äºŒå€‹åƒæ•¸ï¼šå‚³éçµ¦çˆ¶å±¤çš„å€¼ // components/Child.vue&lt;template&gt; &lt;input type=\"text\" :value=\"message\" @input=\"updateMessage($event.target.value)\" /&gt;&lt;/template&gt;&lt;script&gt;export default { name: 'Child', props: { message: { type: String, required: true, default: '' } }, methods: { updateMessage(value) { this.$emit('update-message', value); } }}&lt;/script&gt; çˆ¶å±¤äº‹ä»¶è§¸ç™¼è³‡æ–™æ›´æ–° é€é v-on:$emitäº‹ä»¶åç¨±=\"çˆ¶å±¤å‡½å¼\" ï¼Œè—‰ç”±å­å…ƒä»¶è§¸ç™¼äº‹ä»¶ï¼Œä¾†æ¥å—å›å‚³å€¼ // views/Root.vue&lt;template&gt; &lt;Child :message=\"messageToChild\" @update-message=\"updateMessage\" /&gt;&lt;/template&gt;&lt;script&gt;export default { name: 'Root', data() { return { messageToChild: 'æ—©å®‰æ‚¨å¥½' } }, methods: { updateMessage(value) { this.messageToChild = value; } }}&lt;/script&gt; ä»¥ä¸Šä¾‹èªªæ˜ï¼š ç•¶å­å…ƒä»¶è§¸ç™¼ v-on:update-message äº‹ä»¶ é€²è€Œè§¸ç™¼ updateMessage å‡½å¼ æ¥æ”¶å­å…ƒä»¶å›å‚³çš„ value æ›´æ–° messageToChild å…§å®¹ å†é€é props æ›´æ–°å­å…ƒä»¶æ¥æ”¶å€¼ è—‰ç”±ä»¥ä¸Šå¾ªç’°é”æˆé›™å‘ç¶å®šã€‚ Vue 3.xï¼šé€é v-model æŒ‡ä»¤ç°¡åŒ–èªæ³•é™¤äº†ä¸Šè¿°çš„å¯«æ³•å¤–ï¼Œä¹Ÿå¯ä»¥é€é v-model ä¾†ç¸®å¯« å­å…ƒä»¶ï¼š$emit äº‹ä»¶å‘½åè¦å‰‡ç‚º update:åƒæ•¸åç¨± // components/Child.vue&lt;template&gt; &lt;input type=\"text\" :value=\"message\" @input=\"updateMessage($event.target.value)\" /&gt;&lt;/template&gt;&lt;script&gt;export default { name: 'Child', props: { message: { type: String, required: true, default: '' } }, methods: { updateMessage(value) { this.$emit('update:message', value); } }}&lt;/script&gt; çˆ¶å…ƒä»¶ï¼šåˆä½µ :message è·Ÿ @update:messageï¼Œç›´æ¥ä½¿ç”¨ v-model èªæ³•ç³– v-model:åƒæ•¸åç¨± // views/Root.vue&lt;template&gt; &lt;Child v-model:message=\"updateMessage\" /&gt;&lt;/template&gt;&lt;script&gt;export default { name: 'Root', data() { return { messageToChild: 'æ—©å®‰æ‚¨å¥½' } }}&lt;/script&gt; Vue 2.xï¼šé€é .sync ä¿®é£¾ç¬¦ç°¡åŒ–èªæ³•Vue 2.x å…ƒä»¶é–“é›™å‘ç¶å®šä¸æ”¯æ´ v-model:åƒæ•¸åç¨± é€™æ¨£çš„å¯«æ³•ï¼Œæ˜¯é€é .sync ä¿®é£¾ç¬¦ å­å…ƒä»¶ï¼šå¯«æ³•åŒä¸Š Vue 3.xï¼Œä¸è´…è¿° çˆ¶å…ƒä»¶ï¼šä½¿ç”¨ v-bind:åƒæ•¸åç¨±.sync // views/Root.vue&lt;template&gt; &lt;Child :message.sync=\"updateMessage\" /&gt;&lt;/template&gt;&lt;script&gt;export default { name: 'Root', data() { return { messageToChild: 'æ—©å®‰æ‚¨å¥½' } }}&lt;/script&gt; Provide &amp; Injectå‡è¨­é é¢å±¤ç´šå¦‚ä¸‹ Root.vue |â€”â€” Header.vue |â€”â€” DeepChild.vue è¦å¾ å‚³éè³‡æ–™åˆ° ï¼Œæˆ‘å€‘å¿…é ˆè¦ props å‚³éå…©å±¤æ‰èƒ½é †åˆ©å°‡è³‡æ–™å‚³å…¥ï¼Œç•¶å±¤ç´šè¶Šä¾†è¶Šå¤šï¼Œè¦å†å¾€ä¸‹å‚³éå°±æ›´å›°é›£äº†â€¦ &lt;Root&gt; -&gt; &lt;Header&gt; -&gt; &lt;DeepChild&gt; é€™æ™‚å€™é€é provide è·Ÿ injectï¼Œçˆ¶å…ƒä»¶ä½œç‚ºæ‰€æœ‰å­å…ƒä»¶çš„ä¾è³´æä¾›è€…ï¼ˆdependency providerï¼‰ï¼Œè·¨éä¸­é–“çµ„ä»¶ï¼Œå¿«é€Ÿé”æˆè·¨éšå±¤å…ƒä»¶è³‡æ–™å‚³éï¼š &lt;Root&gt; -&gt; &lt;DeepChild&gt; Provideçˆ¶å…ƒä»¶é€é provide å®šç¾©è¦å¾€ä¸‹å‚³é€çš„åƒæ•¸ // &lt;Root&gt;&lt;template&gt; ...&lt;/template&gt;&lt;script&gt;export default { name: 'Root', provide() { return { message: this.message } }, data() { return { message: 'å‚³çµ¦å…ƒä»¶çš„è¨Šæ¯' } }}&lt;/script&gt; App-level Provideå…¨åŸŸå‚³éåƒæ•¸ // main.jsimport { createApp } from 'vue';const app = createApp({});app.provide(/* key */ 'message', /* value */ 'å‚³çµ¦å…ƒä»¶çš„è¨Šæ¯'); Injectå­å…ƒä»¶é€é injectï¼Œå¯ä»¥æ³¨å…¥ä¾†è‡ªæ‰€æœ‰ä¸Šå±¤å‚³éçš„å…§å®¹ï¼ˆä»¥ ç‚ºä¾‹ï¼Œå¯ä»¥æ¥æ”¶ ã€ã€ å‚³å‡ºçš„å…§å®¹ï¼‰ // &lt;DeepChild&gt;&lt;template&gt; &lt;div&gt;{{ message }}&lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default { name: 'DeepChild', inject: [ 'message' ]}&lt;/script&gt; åƒè€ƒæ–‡ç« ï¼š https://book.vue.tw/CH2/2-2-communications.html https://vuejs.org/guide/components/provide-inject.html","link":"/2023/01/13/vue/vue-communications/"},{"title":"Vue.js Custom Directives è‡ªè¨‚æŒ‡ä»¤","text":"ç‰ˆæœ¬ï¼šVue 3.2.x é™¤äº† Vue å…§å»ºçš„ç³»åˆ—æŒ‡ä»¤ï¼Œåƒæ˜¯ v-model, v-for, v-show ç­‰ï¼Œæˆ‘å€‘ä¹Ÿå¯ä»¥ä½¿ç”¨ Vue directives è‡ªè¨‚æŒ‡ä»¤ï¼Œå°‡ DOM å…ƒç´ å’Œå…ƒä»¶é€²è¡Œå‹•æ…‹ç¶å®šï¼Œä¸¦å°å…¶é€²è¡Œæ“ä½œï¼Œæé«˜ç¨‹å¼ç¢¼çš„å¯è¤‡ç”¨æ€§ çµæ§‹ å‘¼å« v-è‡ªè¨‚åç¨± æŒ‡ä»¤ä¾†ç¶å®š DOM å…ƒç´  é€éé¡ä¼¼å…ƒä»¶çš„ç”Ÿå‘½é€±æœŸé‰¤å­ï¼ˆLifecycle Hooksï¼‰ä¾†å®šç¾©æŒ‡ä»¤ï¼ˆEXï¼šmounted, updatedâ€¦ï¼‰ï¼Œä¸¦è§¸ç™¼æ›´æ–° ç¯„ä¾‹è¨»å†ŠæŒ‡ä»¤EXï¼šæŒ‡ä»¤åç¨± v-focus &lt;input type=\"text\" v-model=\"text\" v-focus /&gt; 1. å…¨åŸŸè¨»å†Š import { createApp } from 'vue';import App from './App.vue';const app = createApp(App);app.directive('focus', { mounted(el) { el.focus(); }});app.mount('#app'); 2. å€åŸŸè¨»å†Š &lt;template&gt; &lt;input type=\"text\" v-model=\"text\" v-focus /&gt;&lt;/template&gt;&lt;script&gt;const focus = { mounted: (el) =&gt; el.focus()}export default { name: 'Home', directives: { focus }, data() { return { text: '' } }}&lt;/script&gt; æŒ‡ä»¤å‚³å€¼ / å¸¶å…¥åƒæ•¸ / ä¿®é£¾ç¬¦&lt;template&gt; &lt;input type=\"text\" v-model=\"text\" v-focus:[bindingArg].bar=\"bindingVal\" /&gt;&lt;/template&gt;&lt;script&gt;export default { name: 'Home', data() { return { text: '', bindingArg: 'foo', bindingVal: 'disabled' } }}&lt;/script&gt; å¯ä»¥åœ¨ directive å‡½å¼ binding å–å¾—å…§å®¹ï¼ˆbinding ç‰©ä»¶å±¬æ€§ï¼‰ ...app.directive('focus', { mounted(el, binding) { el.focus(); console.log(binding); }});... çµæœå¦‚ä¸‹ { arg: 'foo', // å‚³çµ¦æŒ‡ä»¤çš„åƒæ•¸ instance: Proxy{ ... }, // ä½¿ç”¨æŒ‡ä»¤çš„å…ƒä»¶å¯¦é«” dir: { mounted: Æ’, updated: Æ’ } // æŒ‡ä»¤å®šç¾©å…§å®¹ modifiers: { bar: true }, // ä¿®é£¾ç¬¦ value: 'disabled', // ç•¶å‰å€¼ oldValue: undefined // å‰ä¸€æ¬¡çš„å€¼} å¯¦éš›æ‡‰ç”¨&lt;template&gt; &lt;form @submit.prevent=\"submitForm()\" v-form=\"tel\"&gt; &lt;input type=\"tel\" v-model=\"tel\" placeholder=\"è«‹è¼¸å…¥æ‰‹æ©Ÿï¼ˆ10ç¢¼ï¼‰\" /&gt; &lt;button type=\"submit\" id=\"submit\" disabled&gt;é€å‡ºè¡¨å–®&lt;/button&gt; &lt;/form&gt;&lt;/template&gt;&lt;script&gt;export default { name: 'Home', data() { return { tel: '' } }}&lt;/script&gt; import { createApp } from 'vue';import App from './App.vue';const app = createApp(App);app.directive('form', { mounted(el) { el.querySelector('input').focus(); }, updated(el, binding) { if (binding.value.length === 10) { el.querySelector('#submit').disabled = false; } else { el.querySelector('#submit').disabled = true; } }});app.mount('#app'); ç¯„ä¾‹ç¨‹å¼ç¢¼ï¼š See the Pen Vue.js Custom Directives è‡ªè¨‚æŒ‡ä»¤ by Claire Chang (@claire-chang-the-bashful) on CodePen. åƒè€ƒæ–‡ç« ï¼š https://vuejs.org/guide/reusability/custom-directives.html","link":"/2023/01/16/vue/vue-custom-directives/"},{"title":"Vue.js Recursive Component éè¿´å…ƒä»¶å¯¦ä½œå·¢ç‹€é¸å–®","text":"ç‰ˆæœ¬ï¼šVue 3.2.x Vue.js çš„å…ƒä»¶å…§é™¤äº†å¯ä»¥åŒ…è¦†å…¶ä»–å…ƒä»¶ï¼Œä¹Ÿå¯ä»¥å°‡ã€Œè‡ªå·±ã€ä½œç‚ºã€Œå­å…ƒä»¶ã€ä½¿ç”¨ï¼Œç¨±ç‚ºéè¿´å…ƒä»¶ï¼ˆRecursive Componentï¼‰ï¼Œå·¢ç‹€çš„è³‡æ–™æ¸²æŸ“ï¼Œåƒæ˜¯å¤šå±¤å°è¦½åˆ—æˆ–æ˜¯çµ„ç¹”åœ–ï¼Œéƒ½å¯ä»¥ä½¿ç”¨éè¿´å…ƒä»¶å¯¦ä½œã€‚ èªªåˆ°éè¿´å…ƒä»¶ï¼Œå¿…é ˆå…ˆäº†è§£éè¿´å‡½å¼ï¼ˆRecursive Functionï¼‰ã€‚ éè¿´å‡½å¼ï¼ˆRecursive Functionï¼‰ç°¡å–®ä¾†èªªæ˜¯åœ¨å‡½å¼ä¸­å‘¼å«ã€Œè‡ªå·±ã€çš„è¡Œç‚ºï¼Œéå›å‡½å¼å¿…é ˆåŒ…å«ï¼š çµæŸéè¿´çš„åŸºæœ¬æƒ…æ³ï¼ˆbase caseï¼‰ å»¶çºŒéè¿´çš„éè¿´æƒ…æ³ï¼ˆrecursive caseï¼‰ å‡è¨­æœ‰ä¸€ç­†å¤šå±¤é¸å–®å…§å®¹å¦‚ä¸‹ const menuList = { id: 0, name: 'é¦–é ', sub: [ { id: 1, name: 'é—œæ–¼æˆ‘å€‘', sub: [ { id: 11, name: 'å…¬å¸ä»‹ç´¹', sub: [] } ] }, { id: 2, name: 'ç”¢å“ä»‹ç´¹', sub: [ { id: 21, name: 'ä¿æ¿•ç³»åˆ—', sub: [] }, { id: 22, name: 'æŠ—è€ç³»åˆ—', sub: [] } ] }, { id: 3, name: 'ç·šä¸Šè³¼ç‰©', sub: [] } ]} ç•¶æˆ‘å€‘æƒ³å¾ä¸­æ‰¾å‡ºä¸€ç­†è³‡æ–™ï¼ˆEXï¼šid: 22ï¼‰ ä¸€èˆ¬å‡½å¼ å¦‚æœæ˜¯ä¸€èˆ¬å‡½å¼ï¼Œé¸å–®æœ‰å¹¾å±¤å°±è¦å¯«å¹¾æ¬¡åˆ¤æ–·å¼ï¼Œç¨‹å¼ç¢¼å†—é•·é›£ä»¥ç¶­è­· function findItem(list, id) { if (list.id === id) { console.log(list.name); } else { list.sub.filter(item =&gt; { if (item.id === id) { console.log(item.name); } else { ... } }); }}findItem(menuList, 22); // 'æŠ—è€ç³»åˆ—' éè¿´å‡½å¼ é€ééè¿´å‡½å¼ï¼Œç¨‹å¼ç¢¼ç°¡æ½”è¨±å¤š function findItem(list, id) { if (list.id === id) { // base case console.log(list.name); return; } list.sub.filter(item =&gt; this.findItem(item, id)); // recursive case}findItem(menuList, 22); // 'æŠ—è€ç³»åˆ—' éè¿´å‡½å¼å¿…é ˆè¦å¯«çµ‚æ­¢æ¢ä»¶ï¼Œå¦å‰‡æœƒæœ‰ç„¡çª®è¿´åœˆï¼ˆinfinite loopï¼‰çš„æƒ…æ³ç™¼ç”Ÿï¼Œç¨‹å¼ç¢¼ç„¡æ³•çµæŸï¼Œå°è‡´ â€˜max stack size exceededâ€™ éŒ¯èª¤ éè¿´å…ƒä»¶ï¼ˆRecursive Componentï¼‰ä½¿ç”¨å‰é¢çš„ menuList ä½œç‚ºç¯„ä¾‹ï¼Œå…ƒä»¶çµæ§‹å¦‚ä¸‹ï¼š -| components/---| TheMenu/-----| index.vue-----| MenuItem.vue å»ºç«‹çˆ¶å…ƒä»¶ å…ƒä»¶å…§åŒ…è¦†å­å…ƒä»¶ï¼Œä¸¦é€é props é€²è¡Œè³‡æ–™å‚³é // components/TheMenu/index.vue&lt;template&gt; &lt;ul&gt; &lt;MenuItem :menu=\"menuList\" /&gt; &lt;/ul&gt;&lt;/template&gt;&lt;script&gt;export default { name: 'Menu', components: { MenuItem: () =&gt; import('./components/TheMenu/MenuItem.vue') }, data() { return { menuList: { ... } // åŒä¸Šé¢ç¯„ä¾‹ }; }}&lt;/script&gt; å»ºç«‹å­å…ƒä»¶ åœ¨å­å…ƒä»¶è£¡é¢å‘¼å«æœ¬èº«ï¼Œå°‡ MenuItem ç•¶ä½œå­å…ƒä»¶ä½¿ç”¨ï¼Œå°±å¯ä»¥å¯¦ç¾éè¿´å…ƒä»¶ï¼Œéè¿´åœæ­¢çš„æ¢ä»¶æ˜¯å…§å®¹æ¸²æŸ“å®Œç•¢çš„æ™‚å€™ å…ƒä»¶å¿…é ˆåŠ ä¸Š name å±¬æ€§ï¼Œæ‰å¯ä»¥åœ¨å…ƒä»¶å…§ä½¿ç”¨ã€Œè‡ªå·±ã€ // components/TheMenu/MenuItem.vue&lt;template&gt; &lt;li&gt; &lt;button type=\"button\" @click=\"toggleMenu\"&gt;{{ menu.name }}&lt;/button&gt; &lt;ul v-if=\"menu.sub.length\" v-show=\"isOpen\"&gt; &lt;MenuItem v-for=\"item in menu.sub\" :key=\"item.id\" :menu=\"item\" /&gt; &lt;/ul&gt; &lt;/li&gt;&lt;/template&gt;&lt;script&gt;export default { name: 'MenuItem', props: { menu: { type: Object, default: () =&gt; {} } }, data() { return { isOpen: false }; }, methods: { toggleMenu() { this.isOpen = !this.isOpen; } }}&lt;/script&gt; å…ƒä»¶æ‡‰ç”¨ // views/Home.vue&lt;template&gt; &lt;TheMenu&gt;&lt;/TheMenu&gt;&lt;/template&gt;&lt;script&gt;export default { name: 'Home', components: { TheMenu: () =&gt; import('./components/TheMenu/index.vue') }}&lt;/script&gt; çµæœå‘ˆç¾å¦‚ä¸‹ See the Pen Vue.js Recursive Component éè¿´å…ƒä»¶å¯¦ä½œå·¢ç‹€é¸å–® by Claire Chang (@claire-chang-the-bashful) on CodePen. åƒè€ƒæ–‡ç« ï¼š https://medium.com/@paulyang1234/ä½¿ç”¨-vue-recursive-component-å¯¦ç¾æ¨¹ç‹€èœå–®-f1128e566cba https://medium.com/js-dojo/7-vue-patterns-that-you-should-be-using-more-often-b13cde4d2ae6","link":"/2023/01/10/vue/vue-recursive-component/"},{"title":"ä»€éº¼æ˜¯ DNSï¼Œè·Ÿ Name Server åˆæœ‰ä»€éº¼é—œè¯ï¼Ÿ","text":"ç¶²åŸŸåç¨±ï¼ˆDomain Nameï¼‰è¦äº†è§£ DNSï¼Œé¦–å…ˆå¿…é ˆçŸ¥é“åŸŸåçš„çµæ§‹ã€‚åŸŸåç”¨æ–¼è­˜åˆ¥å’Œå®šä½ç¶²è·¯ä¸Šç‰¹å®šè³‡æºçš„å¯è®€æ€§å­—ä¸²ï¼Œé€šå¸¸ç”±ä»¥ä¸‹éƒ¨åˆ†çµ„æˆï¼Œä»¥ã€Œé»ã€åˆ†éš”ï¼š é ‚ç´šç¶²åŸŸï¼ˆTop-level domainï¼ŒTLDï¼‰ï¼šé ‚ç´šç¶²åŸŸæ˜¯åŸŸåçµæ§‹ä¸­çš„æœ€é«˜å±¤æ¬¡ï¼Œç”¨æ–¼è¡¨ç¤ºåŸŸåçš„é¡åˆ¥æˆ–é¡å‹ã€‚å¸¸è¦‹åŒ…æ‹¬ comã€orgã€netã€eduã€gov ç­‰ï¼Œé‚„æœ‰åœ‹å®¶å’Œåœ°å€çš„é ‚ç´šç¶²åŸŸï¼Œä¾‹å¦‚ twã€jpã€ukã€‚ä»¥ www.example.com ç‚ºä¾‹ï¼Œã€Œcomã€å°±æ˜¯é ‚ç´šç¶²åŸŸã€‚ æ¬¡ç´šç¶²åŸŸï¼ˆSecond-level domainï¼‰ï¼šæ¬¡ç´šç¶²åŸŸä½æ–¼é ‚ç´šç¶²åŸŸä¹‹ä¸‹çš„ä¸€ç´šåŸŸåï¼Œç”¨æ–¼è­˜åˆ¥çµ„ç¹”ã€å…¬å¸ã€å€‹äººç­‰ã€‚ä»¥ www.example.com ç‚ºä¾‹ï¼Œã€Œexampleã€å°±æ˜¯æ¬¡ç´šç¶²åŸŸã€‚ ä¸»æ©Ÿç¶²åŸŸï¼ˆHost domainï¼‰ï¼šä¸»æ©Ÿç¶²åŸŸä½æ–¼æ¬¡ç´šç¶²åŸŸä¹‹ä¸‹çš„åŸŸåéƒ¨åˆ†ï¼Œç”¨æ–¼æŒ‡å®šç‰¹å®šç¶²ç«™ã€æœå‹™æˆ–ä¸»æ©Ÿçš„åç¨±ã€‚ä»¥ www.example.com ç‚ºä¾‹ï¼Œã€Œwwwã€ç‚ºä¸»æ©Ÿç¶²åŸŸã€‚ å®Œæ•´ç¶²åŸŸåç¨±ï¼ˆFully Qualified Domain Nameï¼Œç°¡ç¨± FQDNï¼‰ï¼šåŒ…å«æ‰€æœ‰å±¤ç´šçš„åŸŸåï¼Œå¾é ‚ç´šç¶²åŸŸåˆ°ä¸»æ©Ÿç¶²åŸŸã€‚www.example.com å°±æ˜¯å®Œæ•´ç¶²åŸŸåç¨±ã€‚ DNS ç¶²åŸŸåç¨±ç³»çµ±ï¼ˆDomain Name Systemï¼‰DNS ç”¨æ–¼å°‡äººé¡å¯è®€çš„åŸŸåï¼ˆexï¼šwww.example.comï¼‰è½‰æ›ç‚ºå°æ‡‰çš„ IP ä½å€ï¼ˆex: 93.184.216.34ï¼‰ï¼Œè®“ä½¿ç”¨è€…åªéœ€è¦è¨˜å¾—åŸŸåï¼Œè€Œä¸éœ€è¦èƒŒä¸‹ç”±æ•¸å­—çµ„æˆçš„ IP ä½å€ï¼Œå°±å¥½åƒæˆ‘å€‘åœ¨ç¨±å‘¼ä¸€å€‹äººçš„æ™‚å€™ï¼Œé€šå¸¸æœƒå«å°æ–¹çš„åå­—ï¼ˆç¶²åŸŸåç¨±ï¼‰ï¼Œè€Œä¸æ˜¯èº«ä»½è­‰å­—è™Ÿï¼ˆIPï¼‰ï¼ŒDNS ç›¸ç•¶é‡è¦ï¼Œå°‘äº†å®ƒç¶²éš›ç¶²è·¯åŸºæœ¬ä¸Šå°±æœƒç™±ç˜“ã€‚ å› ç¶²éš›ç¶²è·¯åªèªå¾— IP ä½å€ï¼Œç•¶ä½¿ç”¨è€…è¼¸å…¥ç¶²åŸŸåç¨±ï¼Œç€è¦½å™¨æœƒå…ˆå»é›¢ä»–æœ€è¿‘çš„ DNS Server é€éç¶²åŸŸåç¨±æŸ¥è©¢ç›¸å°æ‡‰çš„ä¼ºæœå™¨ IPï¼Œä¸¦å›å‚³ IP ä½å€çµ¦ç€è¦½å™¨ï¼Œç€è¦½å™¨å†é€é IP è·Ÿç¶²è·¯ä¼ºæœå™¨å»ºç«‹é€£ç·šï¼Œä¸¦å–å¾—ç¶²é å…§å®¹ã€‚ åˆ©ç”¨çµ‚ç«¯æ©ŸæŸ¥è©¢åŸŸå IPï¼šex: è¼¸å…¥ ping www.example.comï¼Œå¾—åˆ° IP ä½å€ 93.184.216.34 NS åç¨±ä¼ºæœå™¨ï¼ˆName Serverï¼‰åç¨±ä¼ºæœå™¨æ˜¯ DNS ä¸­ä¸€å€‹é‡è¦å…ƒç´ ï¼Œä¸»è¦åŠŸèƒ½ï¼š åŸŸåè§£æï¼šç•¶ä½¿ç”¨è€…åœ¨ç€è¦½å™¨ä¸­è¼¸å…¥ä¸€å€‹åŸŸåï¼Œç€è¦½å™¨å°‡å‘åç¨±ä¼ºæœå™¨ç™¼å‡ºæŸ¥è©¢ï¼Œåç¨±ä¼ºæœå™¨é–‹å§‹å°‡åŸŸåè½‰æ›ç‚ºèˆ‡ä¹‹ç›¸é—œè¯çš„ IP åœ°å€ã€‚é€™å€‹éç¨‹è¢«ç¨±ç‚ºåŸŸåè§£æã€‚åç¨±ä¼ºæœå™¨å­˜å„²è‘—è©²åŸŸåçš„ DNS è¨˜éŒ„ï¼ˆA è¨˜éŒ„ã€CNAME è¨˜éŒ„ç­‰ï¼‰ã€‚ åˆ†æ•£è³‡æ–™å„²å­˜ï¼šä¸€å€‹ç¶²åŸŸè‡³å°‘è¦æœ‰å…©çµ„åç¨±ä¼ºæœå™¨ï¼ŒDNS ç³»çµ±ä½¿ç”¨åˆ†æ•£çš„åç¨±ä¼ºæœå™¨æ¶æ§‹ã€‚ç•¶ä¸€å€‹åç¨±ä¼ºæœå™¨ç„¡æ³•å›è¦†æŸ¥è©¢æ™‚ï¼Œå…¶ä»–åç¨±ä¼ºæœå™¨å¯ä»¥æ¥æ‰‹è™•ç†ã€‚ åŸŸåç®¡ç†ï¼šä¸€æ—¦è®Šæ›´åç¨±ä¼ºæœå™¨ä¹Ÿæœƒè®Šæ›´ç®¡ç† DNS çš„åœ°æ–¹ã€‚èˆ‰ä¾‹ä¾†èªªï¼Œå‡å¦‚æˆ‘å€‘åœ¨ GoDaddy è³¼è²·ç¶²åŸŸï¼Œä¸¦ä½¿ç”¨é è¨­çš„åç¨±ä¼ºæœå™¨ï¼Œé‚£éº¼ DNS å€åŸŸæª”æ¡ˆå°±åœ¨ GoDaddy å…§ï¼Œä½†æ˜¯ç•¶ç¶²åŸŸè®Šæ›´ç‚º Cloudflare åç¨±ä¼ºæœå™¨ï¼Œé‚£éº¼ DNS å€åŸŸæª”æ¡ˆå°±ä½åœ¨ Cloudflareã€‚ å¸¸è¦‹ DNS å€åŸŸæª”æ¡ˆé¡å‹ï¼š SOA è¨˜éŒ„ï¼ˆStart of Authorityï¼‰ï¼šå€åŸŸæª”æ¡ˆä¸­çš„ç¬¬ä¸€å€‹è¨˜éŒ„ï¼ŒæŒ‡å®šè©²å€åŸŸçš„ç®¡ç†è€…å’Œå…¶ä»–åŸºæœ¬è¨­å®šï¼ŒåŒ…å«ä¸»è¦åç¨±æœå‹™å™¨ï¼ˆPrimary Name Serverï¼‰å’Œè² è²¬äººé›»å­éƒµä»¶åœ°å€ï¼ˆResponsible Person Email Addressï¼‰ç­‰ã€‚ A è¨˜éŒ„ï¼ˆAddressï¼ŒIPv4 åœ°å€ï¼‰ï¼šæ˜¯ç”¨æ–¼åç¨±è§£æçš„é‡è¦è¨˜éŒ„ï¼Œå°‡ç¶²åŸŸåç¨±å°æ‡‰åˆ° IPv4 çš„ 32 ä½å…ƒä½å€ã€‚ AAAA è¨˜éŒ„ï¼ˆIPv6 åœ°å€ï¼‰ï¼šå°‡ç¶²åŸŸåç¨±å°æ‡‰åˆ° IPv6 çš„ 32 ä½å…ƒä½å€ã€‚ CNAME è¨˜éŒ„ï¼ˆCanonical Nameï¼Œåˆ¥åï¼‰ï¼šç”¨æ–¼å°‡æŸå€‹ç¶²åŸŸæˆ–å­ç¶²åŸŸæŒ‡å‘åˆ°æŸå€‹ A è¨˜éŒ„ä¸Šï¼Œé€™æ¨£ï¼Œç•¶æˆ‘å€‘éœ€è¦å°‡ä¸€å€‹åŸŸåæŒ‡å‘å¦ä¸€å€‹åŸŸåæˆ–ä¸»æ©Ÿï¼Œå°±ä¸éœ€è¦å†ç‚ºæ–°çš„åˆ¥åå»ºç«‹ä¸€å€‹ A è¨˜éŒ„ã€‚ ä¾‹å¦‚ï¼šè¦å°‡ www.example.com æŒ‡å‘ example.comï¼Œå¯ä»¥åœ¨ www.example.com çš„ CNAME è¨˜éŒ„ä¸­æŒ‡å®š example.comï¼Œç•¶ä½¿ç”¨è€…è¼¸å…¥ www.example.com æ™‚ï¼ŒDNS å°‡è§£æä¸¦å›å‚³ example.com çš„ç›¸æ‡‰ A è¨˜éŒ„ï¼Œå¾è€Œå°‡æµé‡å°å‘åˆ°æ­£ç¢ºçš„ä¸»æ©Ÿã€‚ NS è¨˜éŒ„ï¼ˆName Serverï¼‰ï¼šæŒ‡å®šè©²å€åŸŸä½¿ç”¨çš„åç¨±æœå‹™å™¨ï¼ˆName Serverï¼‰ï¼Œå®šç¾©äº†è² è²¬æä¾›è©²å€åŸŸ DNS è§£æçš„åç¨±æœå‹™å™¨çš„ä¼ºæœå™¨åç¨±ã€‚ SRV è¨˜éŒ„ï¼ˆService Recordï¼Œæœå‹™ï¼‰ï¼šç”¨æ–¼æŒ‡å®šç‰¹å®šæœå‹™çš„ä¼ºæœå™¨ä½ç½®å’Œé€£æ¥è³‡è¨Šï¼ŒåŒ…å«äº†æœå‹™çš„å”è­°ã€æœå‹™åç¨±ã€åŸŸåã€å„ªå…ˆç´šã€æ¬Šé‡ã€åŸ å’Œç›®æ¨™ï¼ˆä¼ºæœå™¨ï¼‰ç­‰ã€‚ MX è¨˜éŒ„ï¼ˆMail Exchangerï¼Œéƒµä»¶äº¤æ›ï¼‰ï¼šæŒ‡å®šç‰¹å®šåŸŸåé›»å­éƒµä»¶å°å‘è‡³éƒµä»¶ä¼ºæœå™¨ï¼Œæ‰€æœ‰è¦é€å¾€ä¼ºæœå™¨çš„éƒµä»¶éƒ½è¦ç¶“é MX è½‰é€ã€‚éœ€è¨­å®šè©²ä¼ºæœå™¨éƒµä»¶å‚³éæ™‚çš„å„ªå…ˆæ¬¡åºï¼Œå€¼è¶Šä½è¡¨ç¤ºæœ‰è¶Šé«˜çš„è™•ç†å„ªå…ˆæ¬Šã€‚ TXT è¨˜éŒ„ï¼ˆæ–‡å­—ï¼‰ï¼šè¨˜éŒ„ä»»æ„æ–‡å­—è¨Šæ¯ï¼Œå¯ç”¨æ–¼é©—è­‰åŸŸåæ‰€æœ‰æ¬Šã€æä¾›äººé¡å¯è®€çš„è¨Šæ¯ç­‰ã€‚ DNS&nbsp;å¦‚ä½•é‹ä½œå‘¢ï¼Ÿ ç•¶ä½¿ç”¨è€…åœ¨ç¶²é ç€è¦½å™¨ä¸­è¼¸å…¥ç¶²åŸŸåç¨± www.example.comï¼Œç€è¦½å™¨æœƒå…ˆæŸ¥çœ‹æœ¬åœ° DNS æš«å­˜ï¼ˆDNS Cacheï¼‰ï¼Œé€™æ˜¯å…ˆå‰è¨ªå•éè©²ç¶²ç«™ä¿å­˜çš„ç´€éŒ„ï¼Œå¦‚æœæœ‰ç´€éŒ„å°±ç›´æ¥é€²å…¥è©²ç¶²ç«™ï¼Œè‹¥ç„¡å‰‡ç¹¼çºŒä»¥ä¸‹æ­¥é©Ÿ å‚³è¼¸åˆ°ç¶²éš›ç¶²è·¯ï¼ŒDNS éè¿´è§£æä¼ºæœå™¨ï¼ˆDNS Resolverï¼‰æ¥æ”¶è©²ç¶²åŸŸåç¨±æŸ¥è©¢è«‹æ±‚ éè¿´è§£æå™¨æŸ¥è©¢ æ ¹åç¨±ä¼ºæœå™¨ï¼ˆRoot Name Serverï¼‰çš„ IP ä½å€ï¼Œä¸¦å‘æ ¹ç¶²åŸŸç™¼å‡ºè«‹æ±‚ æ ¹åç¨±ä¼ºæœå™¨å›å‚³å„²å­˜å…¶ç¶²åŸŸè³‡è¨Šçš„ é ‚ç´šç¶²åŸŸåç¨±ä¼ºæœå™¨ï¼ˆTLD Name Serverï¼‰çš„ IP ä½å€çµ¦éè¿´è§£æå™¨ã€‚æœå°‹ www.example.com æ™‚æœƒæŒ‡å‘ .com TLD éè¿´è§£æå™¨å‘ .com TLD ç™¼å‡ºè«‹æ±‚ TLD åç¨±ä¼ºæœå™¨å›å‚³ä½¿ç”¨è©²ç¶²åŸŸçš„åç¨±ä¼ºæœå™¨ IP ä½å€çµ¦éè¿´è§£æå™¨ éè¿´è§£æå™¨å‘è©² æ¬Šå¨åç¨±ä¼ºæœå™¨ï¼ˆAuthoritative Name Serverï¼‰ç™¼å‡ºè«‹æ±‚ åç¨±ä¼ºæœå›å‚³ www.example.com çš„ IP ä½å€çµ¦éè¿´è§£æå™¨ éè¿´è§£æå™¨å›å‚³æ­£ç¢ºçš„ IP ä½å€çµ¦ç€è¦½å™¨ ç€è¦½å™¨å¸¶è‘— IP å»è¨ªå•ç¶²ç«™ ä½æ–¼è©² IP çš„ Web ä¼ºæœå™¨å›å‚³ç¶²é å…§å®¹çµ¦ç€è¦½å™¨ ç”±ä¸Šè¿°å¯ä»¥å¾—çŸ¥ï¼Œç¶²é è¼‰å…¥æ¶‰åŠ 4 å€‹ DNS ä¼ºæœå™¨ï¼š DNS éè¿´è§£æä¼ºæœå™¨ï¼ˆDNS Resolverï¼‰ æ ¹åç¨±ä¼ºæœå™¨ï¼ˆRoot Name Serverï¼‰ é ‚ç´šç¶²åŸŸåç¨±ä¼ºæœå™¨ï¼ˆTLD Name Serverï¼‰ æ¬Šå¨åç¨±ä¼ºæœå™¨ï¼ˆAuthoritative Name Serverï¼‰ åƒè€ƒè³‡æºï¼š https://www.cloudflare.com/zh-tw/learning/dns/what-is-dns/ https://tw.godaddy.com/help/what-is-dns-665 https://its-okay.medium.com/ææ‡‚-ip-fqdn-dns-name-server-é¼ å¹´å…¨é¦¬éµäººæŒ‘æˆ°-05-aa60f45496fb","link":"/2023/06/27/web/dns-and-name-server/"},{"title":"GitHub Pages è‡ªè¨‚åŸŸåèˆ‡ HTTPS è¨­å®šï¼ˆGoDaddy + Cloudflareï¼‰","text":"2022 å¹´åº•é–‹å§‹åœ¨ GitHub ç¶“ç‡Ÿäº†å€‹äººéƒ¨è½æ ¼ï¼Œä½¿ç”¨å…è²»åŸŸåä¸€æ®µæ™‚é–“å¾Œï¼Œè¦ºå¾— SEOï¼ˆæœå°‹å¼•æ“å„ªåŒ–ï¼‰çš„æˆæ•ˆä¸å¦‚é æœŸï¼Œå› æ­¤æ±ºå®šè³¼è²·è‡ªå·±çš„ç¶²åŸŸï¼Œä¾†æå‡éƒ¨è½æ ¼çš„å°ˆæ¥­åº¦å’Œå¯ä¿¡åº¦ã€‚ ä»¥ä¸‹ä»‹ç´¹ï¼š Step 1ã€è³¼è²·ç¶²åŸŸåç¨±ï¼šä½¿ç”¨ GoDaddy Step 2ã€DNS ç¶²åŸŸè¨—ç®¡ï¼šä½¿ç”¨ Cloudflare Step 3ã€Cloudflare DNS è¨­å®š Step 4ã€GitHub è¨­å®šç¶²åŸŸ Step 5ã€æ›¿ç¶²ç«™åŠ ä¸Š Httpsã€è¨­å®š SSL åŠ å¯† æƒ³äº†è§£ DNS é‹ä½œçš„æµç¨‹ï¼Œå¯ä»¥åƒè€ƒ é€™ç¯‡æ–‡ç«  Step 1ã€è³¼è²·ç¶²åŸŸåç¨± è‡³ GoDaddy è¨»å†Šæœƒå“¡ï¼Œä¸¦é¸è³¼åŸŸåã€‚GoDaddy æœƒåˆ—å‡ºåç¨±ç›¸ä¼¼çš„å¯é¸åŸŸåï¼š ä»˜æ¬¾å®Œæˆå¾Œï¼Œå¯è‡³ whois æŸ¥è©¢ï¼ŒæŸ¥è©¢ç¶²åŸŸæ˜¯å¦è³¼è²·æˆåŠŸï¼Œæœªè¢«é¸è³¼çš„ç¶²åŸŸï¼ŒæŸ¥è©¢å¾Œæœƒé¡¯ç¤º No Found ï¼Œä»¥ä¸‹ç‚ºç¶²åŸŸå·²è¢«ä½¿ç”¨çš„æŸ¥è©¢çµæœ Domain Name: clairechang.tw Domain Status: clientRenewProhibited,clientUpdateProhibited,clientDeleteProhibited,clientTransferProhibited Registrant: (Redacted for privacy) Administrative Contact: (Redacted for privacy) Technical Contact: (Redacted for privacy) Record expires on 2025-06-25 12:03:28 (UTC+8) Record created on 2023-06-25 12:03:28 (UTC+8) Domain servers in listed order: carlane.ns.cloudflare.com kellen.ns.cloudflare.com Registration Service Provider: GoDaddyRegistration Service URL: http://www.GoDaddy.com/Provided by Registry Services, LLC. Registry Gateway ServicesInformation Updated: 2023-06-28 05:06:23 éœ€æ³¨æ„ï¼šç”±æ–¼æˆ‘è³¼è²·çš„é ‚ç´šåŸŸåæ˜¯ twï¼Œç”±å°ç£ç¶²è·¯è³‡è¨Šä¸­å¿ƒï¼ˆTWNICï¼‰è² è²¬ç®¡ç†å’Œç›£ç£ï¼Œå› æ­¤é€é whois æŸ¥è©¢å¾Œï¼Œè¨»å†Šäººè³‡æ–™æœ‰è¢«éš±è—åŠä¿è­·ï¼ˆRegistrantã€Administrative Contactã€Technical Contactï¼‰ï¼Œå¦‚æœè³¼è²·çš„åŸŸåï¼Œéš±ç§è³‡æ–™æœªéš±è—ï¼Œå»ºè­°è³¼è²·ã€Œå…¨æ–¹ä½ç¶²åŸŸä¿è­·ã€ï¼Œå¦å‰‡è¨»å†Šè³‡æ–™å°‡æœƒè¢«å®Œå…¨å…¬é–‹ Step 2ã€DNS ç¶²åŸŸè¨—ç®¡å°‡åŸŸåçš„ DNS ç®¡ç†æ¬Šé™äº¤çµ¦ç¬¬ä¸‰æ–¹çš„æœå‹™æä¾›å•† Cloudflareã€‚ å…¶å¯¦ GoDaddy ä¹Ÿæœ‰æä¾› DNS æœå‹™ï¼Œé‚£ç‚ºä»€éº¼è¦ä½¿ç”¨ Cloudflare å‘¢ï¼Ÿå› ç‚º Cloudflare é™¤äº† DNS ä»£ç®¡ï¼Œé‚„æä¾› WAFï¼ˆç¶²çµ¡é˜²ç«ç‰†ï¼ŒWeb Application Firewallï¼‰ã€CDNï¼ˆå…§å®¹å‚³éç¶²çµ¡ï¼ŒContent Delivery Networkï¼‰æœå‹™ã€DDoS æ”»æ“Šé˜²è­·ç­‰ï¼Œæå‡ç¶²è·¯å®‰å…¨èˆ‡æ•ˆèƒ½å„ªåŒ–ã€‚ è‡³ Cloudflare è¨»å†Šå¸³è™Ÿï¼Œä¸¦æ–°å¢ç¶²ç«™ï¼Œè¼¸å…¥å‰›æ‰åœ¨ GoDaddy è³¼è²·çš„ç¶²åŸŸ é¸æ“‡æ–¹æ¡ˆï¼šé¸æ“‡å…è²»å³å¯ï¼Œè‹¥ä¹‹å¾Œæœ‰éœ€æ±‚å¯å†å‡ç´š æ¥è‘—çœ‹åˆ° DNS ç´€éŒ„ï¼Œé€™è£¡å…ˆè·³éï¼ŒStep 3 æœƒé€²è¡Œè¨­å®š è®Šæ›´åç¨±ä¼ºæœå™¨ï¼šæ­¤æ­¥é©Ÿç‚ºé‡é»ï¼Œé¦–å…ˆæœƒçœ‹åˆ°æŒ‡ç¤ºéœ€åˆ°ç¶²åŸŸè¨»å†Šå•†ï¼ˆä¹Ÿå°±æ˜¯ GoDaddyï¼‰ç§»é™¤ä»–çš„åç¨±ä¼ºæœå™¨ï¼Œä¸¦èª¿æ•´ç‚º Cloudflare çš„åç¨±ä¼ºæœå™¨ å›åˆ° GoDaddy é€²è¡Œèª¿æ•´ï¼Œé¸æ“‡ã€Œè®Šæ›´åç¨±ä¼ºæœå™¨ã€ï¼Œä¸¦èª¿æ•´ç‚º Cloudflare çš„ä¼ºæœå™¨ å›åˆ° Cloudflare ç¢ºèªæ˜¯å¦è¨—ç®¡æˆåŠŸï¼Œéœ€è¦ä¸€æ®µæ™‚é–“ï¼ŒæˆåŠŸå¾Œæœƒçœ‹åˆ°ä»¥ä¸‹è¨Šæ¯ Step 3ã€Cloudflare DNS è¨­å®š é»é–‹ DNS è¨­å®šï¼Œå¯ä»¥çœ‹åˆ°å¾ GoDaddy æŠ“å›ä¾†çš„é è¨­å€¼ï¼Œæˆ‘å€‘è¦å°‡ç¶²åŸŸæŒ‡å‘ GitHub Pagesï¼Œå…ˆé€é GitHub æ–‡ä»¶ æ‰¾åˆ°ä»¥ä¸‹å››çµ„ IP 185.199.108.153185.199.109.153185.199.110.153185.199.111.153 æ¥è‘—åˆ° Cloudflare DNS é€²è¡Œè¨­å®šï¼Œå…ˆåˆªé™¤é è¨­ Type ç‚º A çš„è¨­å®šï¼Œä¸¦åŠ å…¥é€™å››çµ„ GitHub IP åˆ° A ç´€éŒ„ Step 4ã€GitHub è¨­å®šç¶²åŸŸ åˆ° GitHub å°ˆæ¡ˆå„²å­˜åº«ï¼Œé»æ“Š Settings â†’ Pages â†’ Custom domainï¼Œå°‡ç¶²åŸŸè²¼ä¸Š è¨­å®šæˆåŠŸå¾Œï¼Œå›åˆ°å°ˆæ¡ˆé¦–é ï¼Œå¯ä»¥çœ‹åˆ°è‡ªå‹•æ–°å¢äº†ä¸€æ”¯ CNAME æª”æ¡ˆï¼Œå…§å®¹ç‚ºå‰›æ‰è¼¸å…¥çš„ç¶²åŸŸåç¨± Step 5ã€æ›¿ç¶²ç«™åŠ ä¸Š Httpsã€è¨­å®š SSL åŠ å¯† å›åˆ° Cloudflareï¼Œå¢åŠ ä¸€çµ„è¦å‰‡ï¼Œä½¿ç”¨ 301 è½‰å€å°‡ç¶²åŸŸ HTTP url è‡ªå‹•è½‰å€åˆ° HTTPSï¼Œç¢ºä¿æ•´å€‹ç¶²ç«™çš„è¨ªå•éƒ½æ˜¯å®‰å…¨çš„ Cloudflare é è¨­çš„ SSL/TLS ç‚ºã€Œå½ˆæ€§æ¨¡å¼ã€ï¼Œæ”¹ç‚ºã€Œå®Œæ•´æ¨¡å¼ã€ï¼Œé€™æ¨£æµé‡åœ¨ç€è¦½å™¨è·Ÿ Cloudflare Proxy é–“ï¼Œä»¥åŠ Cloudflare Proxy èˆ‡ç¶²ç«™ä¼ºæœå™¨é–“ï¼Œéƒ½æ˜¯ä½¿ç”¨ SSL/TLS åŠ å¯†ï¼Œæå‡ç¶²é å®‰å…¨ æœ€å¾Œï¼Œé»é–‹ç¶²åŸŸè‹¥èƒ½é †åˆ©çœ‹åˆ°ç•«é¢ï¼Œå°±å¤§åŠŸå‘Šæˆå›‰ï¼ åƒè€ƒè³‡æºï¼š https://medium.com/pmçš„ç”Ÿç”¢åŠ›å·¥å…·ç®±/å¦‚ä½•æ›¿-github-pages-è¨­å®šå€‹äººç¶²åŸŸèˆ‡-cloudflare-ssl-è¨­å®š-1e61b9ff0909 https://www.renokai.tw/2022/09/deploy-website/ https://israynotarray.com/other/20221206/2011045213/ https://gist.github.com/cvan/8630f847f579f90e0c014dc5199c337b","link":"/2023/06/28/web/github-pages-with-custom-domain/"},{"title":"Javascript å¸¸ç”¨é™£åˆ—æ–¹æ³•","text":"é™£åˆ—æ–¹æ³•å¯ä»¥å¹«åŠ©é–‹ç™¼è€…æ›´æœ‰æ•ˆç‡çš„é€²è¡Œè³‡æ–™è™•ç†ï¼Œå‰ç«¯æ¡†æ¶ Vue è·Ÿ React éƒ½æ¡å–è¦–è¦ºå–®ä½é—œæ³¨é»åˆ†é›¢ï¼Œæ¡†æ¶å”åŠ©è™•ç†ç•«é¢éƒ¨åˆ†ï¼Œè€Œè³‡æ–™é¢çš„è™•ç†å°±è¦é é–‹ç™¼è€…çš„åŠŸåŠ›ã€‚ å› è‡ªå·±åœ¨å·¥ä½œä¸Šå¤§é‡é‹ç”¨åˆ°ç›¸é—œæŠ€å·§ï¼Œå› æ­¤å°‡å…§å®¹ç­†è¨˜èµ·ä¾†ï¼Œæ–¹ä¾¿æœªä¾†éœ€è¦æ™‚è¤‡ç¿’ä½¿ç”¨ã€‚ ç¯„ä¾‹ä½¿ç”¨è³‡æ–™const fruits = [ { name: 'apple', price: 45 }, { name: 'strawberry', price: 100 }, { name: 'banana', price: 30 }, { name: 'papaya', price: 60 }, { name: 'watermelon', price: 75 }] è¿´åœˆè™•ç†æ–¹æ³• forEach()ä¸æœƒå›å‚³å€¼ï¼ˆä¸éœ€è¦ returnï¼‰ï¼Œè·Ÿ for è¿´åœˆåŠŸèƒ½ç›¸ä¼¼ï¼Œä½†æ“ä½œä¸Šæ›´ç°¡æ½”ï¼Œåªæœƒä¾åºåŸ·è¡Œæ¯å€‹é …ç›® åƒæ•¸èªªæ˜ï¼š itemï¼šé™£åˆ—å…ƒç´ ï¼Œåœ¨æ­¤ç‚ºä¸€å€‹ç‰©ä»¶ indexï¼šç´¢å¼•å€¼ arrayï¼šæ•´å€‹é™£åˆ— fruits.forEach((item, index, array) =&gt; { item.price += 10; // åƒ¹æ ¼èª¿æ¼² 10})console.log(fruits);// output: [// { \"name\": \"apple\", \"price\": 55 },// { \"name\": \"strawberry\", \"price\": 110 },// { \"name\": \"banana\", \"price\": 40 },// { \"name\": \"papaya\", \"price\": 70 },// { \"name\": \"watermelon\", \"price\": 85 }// ] ä»¥ä¸‹ç‚ºéŒ¯èª¤ä½¿ç”¨ï¼š const priceIncreasedFruits = fruits.forEach((item, index, array) =&gt; { return item.price += 10;})console.log(priceIncreasedFruits); // output: undefined map()éœ€è¦å›å‚³å€¼ï¼Œç”¨æ–¼å°é™£åˆ—ä¸­çš„é …ç›®é€²è¡Œèª¿æ•´ï¼Œé€éå›å‚³å€¼çµ„åˆæˆæ–°çš„é™£åˆ— const priceIncreasedFruits = fruits.map((item, index, array) =&gt; { return { ...item, price: item.price + 10 // åƒ¹æ ¼èª¿æ¼² 10 }})console.log(priceIncreasedFruits);// output: [// { \"name\": \"apple\", \"price\": 55 },// { \"name\": \"strawberry\", \"price\": 110 },// { \"name\": \"banana\", \"price\": 40 },// { \"name\": \"papaya\", \"price\": 70 },// { \"name\": \"watermelon\", \"price\": 85 }// ] filter()ç¯©é¸ç¬¦åˆæ¢ä»¶çš„é …ç›®ï¼ˆæ¢ä»¶åˆ¤æ–·ç‚º trueï¼‰ä¸¦å›å‚³æ–°çš„é™£åˆ— const filteredFruits = fruits.filter((item, index, array) =&gt; { return item.price &gt; 50; // åƒ¹æ ¼å¤§æ–¼ 50})console.log(filteredFruits);// output: [// { \"name\": \"strawberry\", \"price\": 100 },// { \"name\": \"papaya\", \"price\": 60 },// { \"name\": \"watermelon\", \"price\": 75 }// ] find()è·Ÿ filter() é¡ä¼¼ï¼Œå·®åˆ¥åœ¨æ–¼æ‰¾åˆ°ç¬¦åˆæ¢ä»¶çš„ä¸€ç­†è³‡æ–™å¾Œå°±æœƒåœæ­¢ï¼Œä¸¦è¿”å›è©²ç­†è³‡æ–™ï¼Œå¦‚æœæ²’æœ‰ç¬¦åˆæ¢ä»¶çš„è³‡æ–™ï¼Œæœƒå›å‚³ undefined const findFruit = fruits.find((item, index, array) =&gt; { return item.price &gt; 50; // åƒ¹æ ¼å¤§æ–¼ 50})console.log(findFruit); // output: { \"name\": \"strawberry\", \"price\": 100 } findIndex()ç¯©é¸æ–¹å¼åŒ find()ï¼Œæ‰¾åˆ°ç¬¦åˆæ¢ä»¶çš„ä¸€ç­†è³‡æ–™å¾Œå°±æœƒåœæ­¢ï¼Œä¸¦è¿”å›è©²ç­†è³‡æ–™ç´¢å¼•å€¼ï¼Œå¦‚æœæ²’æœ‰ç¬¦åˆæ¢ä»¶çš„è³‡æ–™ï¼Œæœƒå›å‚³ -1 const findFruitIndex = fruits.findIndex((item, index, array) =&gt; { return item.price &gt; 50; // åƒ¹æ ¼å¤§æ–¼ 50})console.log(findFruitIndex); // output: 1 every()ç”¨ä»¥æª¢æŸ¥é™£åˆ—å…§ã€Œæ‰€æœ‰é …ç›®ã€æ˜¯å¦ç¬¦åˆæ¢ä»¶ï¼Œä¸¦å›å‚³ Boolean å€¼ const checkPriceValidity = fruits.every((item, index, array) =&gt; { return item.price &gt; 50; // åƒ¹æ ¼å¤§æ–¼ 50})console.log(checkPriceValidity); // output: falseconst checkPriceValidity2 = fruits.every((item, index, array) =&gt; { return item.price &lt;= 100; // åƒ¹æ ¼å°æ–¼ç­‰æ–¼ 100})console.log(checkPriceValidity2); // output: true some()èˆ‡ every() ç›¸ä¼¼ï¼Œå·®åˆ¥åœ¨æ–¼æ¢ä»¶çš„åˆ¤æ–·ï¼Œsome() ç”¨ä»¥æª¢æŸ¥é™£åˆ—å…§æ˜¯å¦æœ‰ã€Œä»»ä¸€é …ç›®ã€ç¬¦åˆæ¢ä»¶ï¼Œä¸¦å›å‚³ Boolean å€¼ const checkPriceValidity = fruits.some((item, index, array) =&gt; { return item.price &gt; 50; // åƒ¹æ ¼å¤§æ–¼ 50})console.log(checkPriceValidity); // output: true sort()èªæ³•ï¼šarray.sort(compareFunction) sort() å…§å¸¶å…¥æ¯”è¼ƒå‡½å¼ compareFunction(a, b)ï¼Œå„é …ç›®ä¾ç…§é‚è¼¯ä¾†æ’åºï¼Œä¸¦è¿”å›èª¿æ•´æ’åºå¾Œçš„é™£åˆ—ï¼Œå¦‚æœæ²’æœ‰å®šç¾©æ¢ä»¶ï¼Œå‰‡æŒ‰ç…§é è¨­çš„å­—ä¸²æ’åºè¦å‰‡é€²è¡Œæ’åº a å’Œ b ä¾åºç‚ºé™£åˆ—è£¡çš„é …ç›® å¦‚æœ compareFunction(a, b) è¿”å›è² æ•¸ï¼Œå‰‡ a æœƒè¢«æ’åœ¨ b å‰é¢ å¦‚æœ compareFunction(a, b) è¿”å›æ­£æ•¸ï¼Œå‰‡ b æœƒè¢«æ’åœ¨ a å‰é¢ å¦‚æœ compareFunction(a, b) è¿”å› 0ï¼Œå‰‡ a å’Œ b ç›¸å°ä½ç½®ä¸è®Š ä¾ç…§ä¸Šè¿°é‚è¼¯ï¼Œå¦‚æœæƒ³é”æˆã€Œå‡å†ªæ’åˆ—ã€ï¼š const sortedFruits = fruits.sort((a, b) =&gt; { return a.price - b.price; // ä¾åƒ¹æ ¼æ’åº})console.log(sortedFruits);// output: [// { \"name\": \"banana\", \"price\": 30 },// { \"name\": \"apple\", \"price\": 45 },// { \"name\": \"papaya\", \"price\": 60 },// { \"name\": \"watermelon\", \"price\": 75 },// { \"name\": \"strawberry\", \"price\": 100 }// ] reduce()èªæ³•ï¼šarr.reduce(callback[accumulator, currentValue, currentIndex, array], initialValue) æ‡‰ç”¨çš„ç¯„åœè¼ƒå»£ï¼Œå¸¸ç”¨æ–¼ç´¯è¨ˆé‹ç®—ã€‚å°‡é™£åˆ—ä¸­çš„é …ç›®ä¾åºå‚³çµ¦ callback å‡½å¼ï¼Œä¸¦å°‡å›å‚³å€¼å‚³å…¥ä¸‹æ¬¡é‹ç®—ï¼Œæœ€å¾Œè¿”å›ç´¯è¨ˆçµæœ åƒæ•¸èªªæ˜ï¼š accumulatorï¼šç´¯è¨ˆå€¼ï¼Œä¸Šä¸€æ¬¡é‹ç®—çš„å›å‚³å€¼ï¼Œå¦‚æœæ˜¯ç¬¬ä¸€æ¬¡è¨ˆç®—ï¼Œå‰‡ç‚ºåˆå§‹å€¼ currentValueï¼šç•¶å‰é …ç›® currentIndexï¼šç•¶å‰é …ç›®ç´¢å¼•å€¼ arrayï¼šæ•´å€‹é™£åˆ— initialValueï¼šåˆå§‹å€¼ const countPrice = fruits.reduce((accumulator, currentValue, currentIndex, array) =&gt; { return accumulator + currentValue.price; // åƒ¹æ ¼è¨ˆç®—}, 0)console.log(countPrice); // output: 310 reduce() ä¹Ÿå¯ä»¥åšæ›´è¤‡é›œçš„é‹ç®—ï¼Œä¾‹å¦‚ï¼š å°‡æ‰€æœ‰æ°´æœåç¨±çµ„æˆé™£åˆ— const fruitsName = fruits.reduce((accumulator, currentValue, currentIndex, array) =&gt; { return [ ...accumulator, currentValue.name ];}, []);console.log(fruitsName);// output: [ \"apple\", \"strawberry\", \"banana\", \"papaya\", \"watermelon\" ] å°‡é™£åˆ—çµæ§‹è½‰æˆç‰©ä»¶ï¼ˆkey: valueï¼‰ const fruitPrices = fruits.reduce((accumulator, currentValue, currentIndex, array) =&gt; { accumulator[currentValue.name] = currentValue.price; return accumulator;}, {});console.log(fruitPrices);// output: { \"apple\": 45, \"strawberry\": 100, \"banana\": 30, \"papaya\": 60, \"watermelon\": 75 } å…¶ä»–æ–¹æ³• push()åœ¨é™£åˆ—æœ€å¾Œé¢åŠ å…¥é …ç›® fruits.push({ name: 'guava', price: 35 });console.log(fruits);// output: [// ...// { name: 'guava', price: 35 }// ] pop()ç§»é™¤é™£åˆ—å…§æœ€å¾Œä¸€ç­†é …ç›® fruits.pop();console.log(fruits);// output: [// ...// { \"name\": \"watermelon\", \"price\": 75 }// ] unshift()åœ¨é™£åˆ—æœ€å‰é¢åŠ å…¥é …ç›® fruits.unshift({ name: 'guava', price: 35 });console.log(fruits);// output: [// { name: 'guava', price: 35 },// ...// ] shift()ç§»é™¤é™£åˆ—å…§ç¬¬ä¸€ç­†é …ç›® fruits.shift();console.log(fruits);// output: [// { name: 'apple', price: 45 },// ...// ] slice()èªæ³•ï¼šarr.slice(begin, end) é¸æ“‡é–‹å§‹èˆ‡çµæŸç´¢å¼•å€¼é–“çš„é …ç›®ï¼ˆåŒ…å«é–‹å§‹ï¼Œä¸åŒ…å«çµæŸï¼‰ï¼ŒçµæŸç´¢å¼•å€¼å¯ä¸å¡«ï¼Œä¸¦å›å‚³ä¸€å€‹æ–°çš„é™£åˆ—ï¼ŒåŸé™£åˆ—ä¸å—å½±éŸ¿ const remainFruits = fruits.slice(1, 3);console.log(remainFruits);// output: [// { \"name\": \"strawberry\", \"price\": 100 },// { \"name\": \"banana\", \"price\": 30 }// ] splice()èªæ³•ï¼šarray.splice(start, deleteCount, addItem1, addItem2, ...) ç§»é™¤ç´¢å¼•å€¼èµ·çš„æ•¸ç­†é …ç›®ï¼Œä¸¦åŠ å…¥æ–°çš„é …ç›®ï¼ŒåŠ å…¥é …ç›®ç‚ºé¸å¡« fruits.splice(1, 3);console.log(fruits);// output: [// { \"name\": \"apple\", \"price\": 45 },// { \"name\": \"watermelon\", \"price\": 75 }// ] åŠ å…¥æ–°çš„é …ç›® fruits.splice(1, 3, { name: 'guava', price: 35 });console.log(fruits);// output: [// { \"name\": \"apple\", \"price\": 45 },// { \"name\": \"guava\", \"price\": 35 }// { \"name\": \"watermelon\", \"price\": 75 }// ] join()èªæ³•ï¼šarr.join(separator) å°‡é™£åˆ—ä¸­çš„å€¼åˆä½µæˆä¸€å€‹å­—ä¸²ï¼Œä¸¦å¯åŠ å…¥åˆ†éš”å­—ç¬¦ï¼Œå›å‚³ä¸€å€‹å­—ä¸² const fruits = [ 'apple', 'strawberry', 'banana', 'papaya', 'watermelon' ];console.log(fruits.join(', '));// output: apple, strawberry, banana, papaya, watermelon indexOf()è·Ÿ findIndex() çš„ç›®çš„ç›¸åŒï¼Œå‡ç‚ºæ‰¾åˆ°é …ç›®åœ¨é™£åˆ—ä¸­çš„ç´¢å¼•å€¼ï¼Œå¦‚æœæ‰¾ä¸åˆ°è©²é …ç›®ï¼Œæœƒè¿”å› -1ï¼Œä½†ä½¿ç”¨æ–¹å¼èˆ‡æƒ…å¢ƒæœ‰äº›å·®ç•°ï¼ŒindexOf() ä¸é©åˆç”¨åœ¨ç‰©ä»¶æœå°‹ const fruits = [ 'apple', 'strawberry', 'banana', 'papaya', 'watermelon' ];console.log(fruits.indexOf('strawberry')); // output: 1 includes()æª¢æŸ¥é™£åˆ—ä¸­æ˜¯å¦åŒ…å«ç‰¹å®šå€¼ï¼Œå›å‚³çµæœç‚º Booleanï¼Œä¸é©åˆç”¨åœ¨ç‰©ä»¶æœå°‹ const fruits = [ 'apple', 'strawberry', 'banana', 'papaya', 'watermelon' ];console.log(fruits.includes('papaya')); // output: true reverse()åè½‰é™£åˆ—å…§çš„é …ç›®æ’åº const reverseFruits = fruits.reverse();console.log(reverseFruits);// output: [// { \"name\": \"watermelon\", \"price\": 75 },// { \"name\": \"papaya\", \"price\": 60 },// { \"name\": \"banana\", \"price\": 30 },// { \"name\": \"strawberry\", \"price\": 100 },// { \"name\": \"apple\", \"price\": 45 }// ] concat()çµ„åˆå…©å€‹é™£åˆ—ï¼Œä¸¦è¿”å›æ–°é™£åˆ—ï¼ŒåŸé™£åˆ—ä¸å—å½±éŸ¿ const newFruits = [ { name: 'guava', price: 35 } ];const concatFruits = fruits.concat(newFruits);console.log(concatFruits);// output: [// ...// { name: 'guava', price: 35 }// ] concat() çš„åŠŸèƒ½ä¹Ÿå¯ä»¥ç”¨ ES6 è§£æ§‹å–ä»£ const concatFruits = [ ...fruits, ...newFruits ]; åƒè€ƒè³‡æºï¼š https://www.casper.tw/javascript/2017/06/29/es6-native-array/https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Global_Objects/Array/reducehttps://hackmd.io/@hsuchihting/ryvYW2YvL","link":"/2023/05/25/javascript/js-array-methods/"},{"title":"Javascript å‡½æ•¸åŸå‹æ–¹æ³•ï¼šcallã€applyã€bind æ”¹è®Š this æŒ‡å‘","text":"å‡½æ•¸åŸå‹ callã€applyã€bind æ–¹æ³•å¯ä»¥ç”¨ä¾†æ”¹è®Š this æŒ‡å‘çš„å°è±¡ï¼Œbind å’Œå…¶ä»–å…©å€‹æ–¹æ³• callã€apply è¼ƒä¸åŒï¼Œcallã€apply æœƒç›´æ¥åŸ·è¡Œå‡½å¼ï¼Œbind åªæ˜¯å°‡ this ç¶å®šåˆ°å‡½å¼å…§ï¼Œä¸¦ä¸æœƒå¯¦éš›åŸ·è¡Œï¼Œé€™æ¨£èªªæ˜é‚„æ˜¯æœ‰é»é›£æ‡‚ï¼Œé‚£å°±æ¥ä¸‹å»çœ‹çœ‹å§ã€‚ é¦–å…ˆå»ºç«‹åŸºæœ¬åƒæ•¸ const customer = { name: 'Daniel'}function callName() { console.log(this.name);}callName(); // undefined å¦‚æœæˆ‘å€‘ç›´æ¥åŸ·è¡Œå‡½å¼ï¼Œé€™æ™‚å€™æœƒå¾—åˆ° undefinedï¼ŒåŸå› æ˜¯ this æŒ‡å‘çš„æ˜¯ windowï¼Œè£¡é¢ä¸¦æ²’æœ‰ name é€™å€‹åƒæ•¸ï¼Œå¦‚æœè¦å°‡ this æŒ‡å‘ customer é€™å€‹ç‰©ä»¶ï¼Œè©²æ€å‘¢åšå‘¢ï¼Ÿ bindbind æœƒå»ºç«‹ä¸€å€‹è¢«åŒ…è£¹å¾Œçš„æ–°å‡½å¼ï¼Œè©²å‡½å¼è¢«å‘¼å«æ™‚ï¼Œæœƒå°‡&nbsp;this è¨­ç‚ºç¶å®šçš„åƒæ•¸ï¼Œå¦å¤–ä¹Ÿå¯ä»¥ç¶å®šå…¶ä»–çš„åƒæ•¸ï¼Œç¶å®šä¹‹å¾Œçš„åƒæ•¸åœ¨è©²å‡½å¼å°±ç„¡æ³•å†ä¿®æ”¹ã€‚ èªæ³•fun.bind(this, arg1, arg2, ...) ä½¿ç”¨ bind å°‡ this ã€Œç¶‘ç¶ã€é€²å»ï¼Œå»ºç«‹ä¸€å€‹æ–°çš„å‡½å¼ const copyCallName = callName.bind(customer);copyCallName(); // Daniel é€™æ™‚å€™åŸ·è¡Œ copyCallName()ï¼Œå°±å¯ä»¥å–å¾— customer ç‰©ä»¶çš„å…§å®¹ ä¹Ÿå¯ä»¥ç›´æ¥åŸ·è¡Œ callName.bind(customer)(); // Daniel æˆ–æ˜¯å¯«åœ¨å‡½å¼è¡¨é”å¼å¾Œé¢ const callName = function() { console.log(this.name);}.bind(customer)callName(); // Daniel this è¢«ç¶å®šå¾Œå°‡ç„¡æ³•è®Šæ›´ const student = { name: 'Andy'}const callName = function() { console.log(this.name);}.bind(customer)callName.bind(student)(); // Daniel ç¶å®šå…¶ä»–åƒæ•¸é¦–å…ˆåœ¨ callName å‡½å¼åŠ å…¥å…©å€‹åƒæ•¸ callName(age, gender) { console.log(this.name); console.log(age); console.log(gender);} æ²’æœ‰ç¶å®šçš„æƒ…æ³ä¸‹ï¼Œå¯ä»¥ä»»æ„ä»£å…¥å€¼ const copyCallName = callName.bind(customer);copyCallName(30, 'male');// Daniel// 30// male åƒæ•¸è¢« bind ç¶å®šå¾Œå°‡ç„¡æ³•è®Šæ›´ const copyCallName = callName.bind(customer, 18, 'female');copyCallName(30, 'male'); // è³¦å€¼ç„¡æ•ˆ// Daniel// 18// female callfun.call() æœƒç›´æ¥åŸ·è¡Œå‡½å¼ï¼Œä¸¦ä¸”å°‡ this è·Ÿå…¶ä»–åƒæ•¸ä¾åºä»£å…¥ èªæ³•fun.call(this, arg1, arg2, ...) å›åˆ°å‰é¢å®šç¾©çš„åƒæ•¸ const customer = { name: 'Daniel'}callName(age, gender) { console.log(this.name); console.log(age); console.log(gender);} å‘¼å«æ–¹å¼å¦‚ä¸‹ function useCallName() { callName.call(customer, ...arguments);}useCallName(30, 'male');// Daniel// 30// male argumentsï¼šjavascript å…§å»ºåƒæ•¸ï¼Œä¸éœ€é å…ˆå®šç¾©ï¼Œå‡½å¼å…§è‡ªå‹•å»ºç«‹æ­¤åƒæ•¸ï¼Œåœ¨å‡½å¼å‘¼å«æ™‚å‚³éé€²å»çš„å¼•æ•¸é€éé™£åˆ—å‚³å…¥ ç›´æ¥å‘¼å«çµæœç›¸åŒ callName.call(customer, 30, 'male');// Daniel// 30// male applyæœ‰é»åƒ call() çš„ç°¡åŒ–ç‰ˆæœ¬ï¼Œåªå‚³å…¥å…©å€‹åƒæ•¸ï¼Œç¬¬äºŒå€‹åƒæ•¸æ˜¯å…¶é¤˜åƒæ•¸åŒ…è£æˆçš„é™£åˆ— èªæ³•fun.apply(this, [ arg1, arg2, ... ]) å‘¼å«æ–¹å¼å¦‚ä¸‹ function useCallName() { callName.apply(customer, arguments);}useCallName(30, 'male');// Daniel// 30// male ç›´æ¥å‘¼å«çµæœç›¸åŒ callName.apply(customer, [ 30, 'male' ]);// Daniel// 30// male å»¶ä¼¸ï¼šæ”¹è®Š this æŒ‡å‘çš„å…¶ä»–åšæ³•ä»¥ä¸‹è¿°ç‚ºä¾‹é€²è¡Œèªªæ˜ï¼š const customer = { name: 'Daniel', LazyCallName() { setTimeout(function() { console.log(this.name); }, 1000); }}customer.LazyCallName(); // undefined å¦‚æœè¦å–åˆ° name çš„å€¼ï¼Œå¯ä»¥é€éä¸‰å€‹æ–¹æ³•ï¼š 1. bind é€éå‡½æ•¸åŸå‹æ–¹æ³• bindï¼Œå°‡ this æŒ‡å‘ customer é€™å€‹ç‰©ä»¶ const customer = { name: 'Daniel', LazyCallName() { setTimeout(function() { console.log(this.name); }.bind(this), 1000); }}customer.LazyCallName(); // Daniel 2. åœ¨å¤–å±¤å‡½å¼å®£å‘Šè®Šæ•¸å„²å­˜ this åœ¨å¤–å±¤ LazyCallName function å…ˆå®šç¾©è®Šæ•¸ vmï¼Œå°‡ this å„²å­˜èµ·ä¾† const customer = { name: 'Daniel', LazyCallName() { const vm = this; setTimeout(function() { console.log(vm.name); }, 1000); }}customer.LazyCallName(); // Daniel 3. ES6 Arrow Function ç”±æ–¼ç®­é ­å‡½å¼çš„ this&nbsp;ç¶å®šçš„æ˜¯å®šç¾©æ™‚æ‰€åœ¨çš„ç‰©ä»¶ï¼Œé€éç®­é ­å‡½å¼ï¼Œthis ä»¥ LazyCallName function ç‚ºåŸºæº–ç”¢ç”Ÿä½œç”¨åŸŸï¼ˆå‡½å¼ä¹Ÿæ˜¯ç‰©ä»¶å‹åˆ¥ï¼‰ï¼ŒæŒ‡å‘ customer ç‰©ä»¶ const customer = { name: 'Daniel', LazyCallName() { setTimeout(() =&gt; { console.log(this.name); }, 1000); }}customer.LazyCallName(); // Daniel åƒè€ƒæ–‡ç« ï¼š https://realdennis.medium.com/javascript-èŠèŠcall-apply-bindçš„å·®ç•°èˆ‡ç›¸ä¼¼ä¹‹è™•-2f82a4b4dd66https://medium.com/swlh/call-apply-bind-javascript-methods-7d96a73816e8https://b-l-u-e-b-e-r-r-y.github.io/post/BindCallApply/","link":"/2023/02/04/javascript/js-call-apply-bind/"},{"title":"Javascript ES6 Class èˆ‡å»ºæ§‹å‡½å¼","text":"ç¹¼æ‰¿èˆ‡åŸå‹éˆåœ¨ class å‡ºç¾å‰ï¼Œé€šå¸¸ä½¿ç”¨å»ºæ§‹å‡½å¼ï¼ˆConstructorï¼‰å»ºç«‹åŸå‹ï¼ˆPrototypeï¼‰ã€‚åŸå‹ä¸¦éå¯¦é«”ï¼ˆå¯ä»¥å°‡å…¶ç†è§£æˆè—åœ–ï¼‰ï¼Œå¿…é ˆé€é new é‹ç®—å­å¯¦é«”åŒ–ï¼Œç¹¼æ‰¿è©²åŸå‹ã€‚ new operatorï¼ˆé‹ç®—å­ï¼‰ï¼šç”¢ç”Ÿä¸€å€‹æ–°çš„ç©ºç™½ç‰©ä»¶ï¼Œé€£çµåŸå…ˆå»ºæ§‹å‡½å¼ï¼ˆå‡½å¼æœ¬èº«ä¹Ÿæ˜¯ç‰©ä»¶ï¼‰ï¼Œå»ºæ§‹å‡½å¼å…§çš„ this æœƒç¶å®šåœ¨æ–°ç‰©ä»¶ä¸Š å‡è¨­ä»Šå¤©æœ‰ä¸€å€‹ã€èŠ±æ —é¼ ã€çš„è—åœ–ï¼Œå†æ ¹æ“šé€™å¼µè—åœ–å‰µé€ å‡ºå¯¦é«”ï¼Œæ¯å€‹å¯¦é«”éƒ½ç¬¦åˆè—åœ–çš„è¦æ ¼ï¼š // å»ºæ§‹å‡½å¼ï¼ˆè—åœ–ï¼‰function Chipmunk(name, color, size) { this.name = name; this.color = color; this.noseSize = size;};const Chip = new Chipmunk('Chip', 'brown', 'small');const Dale = new Chipmunk('Dale', 'yellow', 'large'); é€éå‡½å¼ç‰©ä»¶å…§ prototype æ–°å¢çš„å±¬æ€§ï¼Œæœƒæ›è¼‰åœ¨åŸå‹ä¸Š Chipmunk.prototype.climb = function() { console.log(`${this.name} is climbing the tree`);}; é€éç¹¼æ‰¿ï¼Œ å¯¦é«”åŒ–å¾Œçš„ç‰©ä»¶ä¹Ÿéƒ½å¯ä»¥å–å¾—åŸå‹æ–¹æ³• console.log(Chip);console.log(Dale);// output: çµæœå¦‚ä¸‹ Chip.climb(); // output: Chip is climbing the treeDale.climb(); // output: Dale is climbing the tree å°‡å…±ç”¨æ–¹æ³•æ›åœ¨åœ¨åŸå‹ä¸Šï¼Œæ–¹æ³•åªæœƒè¢«å®šç¾©ä¸€æ¬¡ï¼Œåªéœ€è¦ä¸€å€‹è¨˜æ†¶é«”ç©ºé–“ï¼Œæ¸›å°‘æ•ˆèƒ½çš„æ¶ˆè€—èˆ‡æµªè²» å¤šå±¤ç¹¼æ‰¿å‡è¨­æˆ‘å€‘å¸Œæœ›åœ¨ç‹—ç§‘å‰é¢å†åŠ ä¸Šå‹•ç‰©ç•ŒåŸå‹ï¼Œçµæ§‹å¦‚ä¸‹ï¼š å‹•ç‰©ç•ŒåŸå‹ â†’ èŠ±æ —é¼ å»ºæ§‹å‡½å¼ â†’ å¯¦é«”åŒ–å»ºæ§‹å¼ 1. å‹•ç‰©ç•ŒåŸå‹ function Animal(family) { this.kingdom = 'animals'; this.family = family;};Animal.prototype.eat = function() { console.log(`${this.name} is eating something`);}; 2. èŠ±æ —é¼ å»ºæ§‹å‡½å¼ é€é Object.create() ç¹¼æ‰¿å‹•ç‰©ç•ŒåŸå‹ é€éåŸå‹æ–¹æ³• call() èª¿ç”¨å‹•ç‰©ç•Œå»ºæ§‹å‡½å¼ï¼ˆéœ€æŒ‡å®š thisï¼‰ å› ç¹¼æ‰¿å‹•ç‰©ç•ŒåŸå‹ï¼Œå°è‡´ Chipmunk å»ºæ§‹å‡½å¼è¢«è¦†å¯«ï¼Œé€é Chipmunk.prototype.constructor = Chipmunk è£œå›ï¼Œè®“åŸå‹éˆæ›´åŠ å®Œæ•´ function Chipmunk(name, color, size) { Animal.call(this, 'squirrel'); this.name = name; this.color = color; this.noseSize = size;};Chipmunk.prototype = Object.create(Animal.prototype);Chipmunk.prototype.constructor = Chipmunk;Chipmunk.prototype.climb = function() { console.log(`${this.name} is climbing the tree`);}; 3. å¯¦é«”åŒ–å»ºæ§‹å¼ const Chip = new Chipmunk('Chip', 'brown', 'small');const Dale = new Chipmunk('Dale', 'yellow', 'large'); console.log(Chip);// output: çµæœå¦‚ä¸‹ ä»¥ä¸Šå¯«æ³•æœ‰å¹¾å€‹ç¼ºé»ï¼š å»ºæ§‹å‡½å¼é€šå¸¸ä½¿ç”¨å¤§é§å³°ï¼ˆPascalCaseï¼‰å‘½åï¼Œä½†é‚„æ˜¯å®¹æ˜“èˆ‡ä¸€èˆ¬å‡½å¼æ··æ·† å¦‚æœæ²’æœ‰åŠ ä¸Š new é‹ç®—å­ï¼Œä¸¦ä¸æœƒå ±éŒ¯ï¼Œä½†çµæœæœƒæ˜¯ undefined ç¹¼æ‰¿åŸå‹æ–¹å¼è¼ƒç‚ºè¤‡é›œï¼Œå…±ç”¨æ–¹æ³•ä¹Ÿå¿…é ˆå¦å¤–å®šç¾©ï¼Œç¼ºå°‘ã€å°è£ã€çµæ§‹ï¼Œç¶­è­·æ€§è¼ƒå·® ES6 Class é¡åˆ¥å…ˆå‰çš„å¯«æ³•ï¼Œå®¹æ˜“æ··æ·† Class è·Ÿ Constructor çš„é—œä¿‚ï¼ŒES6 Class æ˜¯ç°¡åŒ–æ“ä½œ Constructor çš„èªæ³•ç³–ï¼Œçµæ§‹ä¸Šæ›´å¥½ç†è§£ class Chipmunk { constructor(name, color, size) { this.name = name; this.color = color; this.noseSize = size; } climb() { console.log(`${this.name} is climbing the tree`); }}const Chip = new Chipmunk('Chip', 'brown', 'small');const Dale = new Chipmunk('Dale', 'yellow', 'large'); Class åªæ˜¯èªæ³•ç³–ï¼Œä¸¦éé¡åˆ¥åŸºç¤ï¼ˆClass-Basedï¼‰ç‰©ä»¶å°å‘ï¼ˆObject Oriented Programmingï¼‰ï¼Œå®ƒä»ç„¶æ˜¯åŸå‹åŸºç¤ï¼ˆPrototype-Basedï¼‰ç‰©ä»¶å°å‘ Class å¤šå±¤ç¹¼æ‰¿çµæ§‹åŒå‰è¿°ï¼šå‹•ç‰©ç•ŒåŸå‹ â†’ èŠ±æ —é¼ å»ºæ§‹å‡½å¼ â†’ å¯¦é«”åŒ–å»ºæ§‹å¼ 1. å‹•ç‰©ç•ŒåŸå‹ class Animal { constructor(family) { this.kingdom = 'animals'; this.family = family; } eat() { console.log(`${this.name} is eating something`); }} 2. èŠ±æ —é¼ å»ºæ§‹å‡½å¼ é€é extends ç¹¼æ‰¿å‹•ç‰©ç•ŒåŸå‹ é€é super() èª¿ç”¨å‹•ç‰©ç•Œå»ºæ§‹å‡½å¼ class Chipmunk extends Animal { constructor(name, color, size) { super('squirrel'); this.name = name; this.color = color; this.noseSize = size; } climb() { console.log(`${this.name} is climbing the tree`); }} 3. å¯¦é«”åŒ–å»ºæ§‹å¼ const Chip = new Chipmunk('Chip', 'brown', 'small');const Dale = new Chipmunk('Dale', 'yellow', 'large'); Class å¸¸ç”¨æ–¹æ³•ç§æœ‰è®Šæ•¸ï¼šè®Šæ•¸å‰ç¶´åŠ ä¸Š #ï¼Œå¤–éƒ¨ç„¡æ³•å–ç”¨ï¼Œclass å…§å¯ä»¥ä½¿ç”¨ class Chipmunk { #tree = 'oak'; // ç§æœ‰è®Šæ•¸ constructor(name, color, size) { this.name = name; this.color = color; this.noseSize = size; } climb() { console.log(`${this.name} is climbing the ${this.#tree}`); }}const Chip = new Chipmunk('Chip', 'brown', 'small');console.log(Chip.tree); // output: undefinedChip.climb(); // output: Chip is climbing the oak Getterï¼Setterï¼šå–å¾—èˆ‡è¨­å®šæ–¹æ³•ï¼Œé€šå¸¸ç”¨æ–¼è¨ˆç®— class Chipmunk { realAge = 0; constructor() { // ... } set age(val) { this.realAge = val; } get age() { return this.realAge * 30; }}const Chip = new Chipmunk('Chip', 'brown', 'small');Chip.age = 1;console.log(Chip.age); // output: 30 Static éœæ…‹æ–¹æ³•ï¼è®Šæ•¸ï¼š ä¸ç¶“éå¯¦é«”åŒ–å³å¯å–ç”¨ Class å…§æ–¹æ³• å¯¦é«”åŒ–ç‰©ä»¶ä¸å¯å–ç”¨è©²æ–¹æ³•ï¼ˆä¸èƒ½èª¿ç”¨ thisï¼‰ class Chipmunk { constructor() { // ... } static caculateAge(age, minus) { return age * minus; }}const Chip = new Chipmunk('Chip', 'brown', 'small');console.log(Chipmunk.caculateAge(2, 30)); // output: 60console.log(Chip.caculateAge(2, 30)); // output: Uncaught TypeError: Chip.caculateAge is not a function åƒè€ƒæ–‡ç« ï¼š https://medium.com/enjoy-life-enjoy-coding/javascript-es6-ä¸­æœ€å®¹æ˜“èª¤æœƒçš„èªæ³•ç³–-class-åŸºæœ¬ç”¨æ³•-23e4a4a5e8edhttps://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Inheritance_and_the_prototype_chainhttps://ithelp.ithome.com.tw/articles/10185583","link":"/2023/03/06/javascript/js-class/"},{"title":"Javascript Currying æŸ¯é‡ŒåŒ–","text":"Currying is a technique in functional programming where a function that takes multiple arguments is transformed into a sequence of functions that each take a single argument. Currying æ˜¯ä¸€ç¨®å‡½å¼ç·¨ç¨‹ï¼ˆç¨‹å¼è¨­è¨ˆçš„ä¸€ç¨®ï¼Œå¯ä»¥åƒè€ƒæ­¤ç¯‡æ–‡ç« ï¼‰æŠ€è¡“ï¼Œå°‡æ¥æ”¶å¤šå€‹åƒæ•¸çš„å‡½å¼ï¼Œæ‹†è§£ç‚ºå¤šå€‹å‡½å¼ï¼Œæ¯å€‹å‡½å¼åªæ¥å—ä¸€å€‹åƒæ•¸ ä½¿ç”¨ç›®çš„ å°‡ç¨‹å¼ç¢¼æ‹†æˆç‰‡æ®µï¼Œè®“å‡½å¼èƒ½é‡è¤‡é‹ç”¨ï¼ˆDRY é¿å…é‡è¤‡ä»£ç¢¼åŸå‰‡ï¼‰ï¼Œæœ‰åŠ©æ–¼å‰µå»º higher-order function ç°¡åŒ–åƒæ•¸è™•ç†ï¼Œä¸€æ¬¡è™•ç†ä¸€å€‹åƒæ•¸ï¼Œæé«˜å½ˆæ€§å’Œæ˜“è®€æ€§ ç¯„ä¾‹ä¸€èˆ¬å‡½å¼ï¼šfunction add(x, y) { return x + y;}add(5, 3); // outputï¼š8 Curry Functionï¼šfunction add(x) { return (y) =&gt; { return x + y; }}add(5)(3); // outputï¼š8 æ‡‰ç”¨æ–¹å¼ï¼š const addFive = add(5);addFive(3); // outputï¼š8 curry function åˆ©ç”¨ closureï¼ˆé–‰åŒ…ï¼‰çš„ç‰¹æ€§ï¼Œç•¶å…§éƒ¨å‡½å¼è¢«å›å‚³å¾Œï¼Œå¯ä»¥å–å¾—å…§éƒ¨å‡½å¼ã€Œæ‰€åœ¨ç’°å¢ƒã€çš„è®Šæ•¸å€¼ã€‚ ç”¨ä»¥ä¸‹æ‹†è§£é€²è¡Œèªªæ˜ï¼š å…§éƒ¨å‡½å¼ï¼ˆinnerï¼‰è¢«å›å‚³å¾Œï¼Œå¯ä»¥å–å¾—æ‰€åœ¨ç’°å¢ƒï¼ˆaddï¼‰çš„è®Šæ•¸å€¼ï¼ˆxï¼‰ function add(x) { function inner(y) { return x + y; } return inner;}const addFive = add(5);addFive(3); // outputï¼š8 é¦–å…ˆå°‡ add(5) å­˜æ”¾åœ¨ addFive åƒæ•¸ï¼Œç•¶å‘¼å« addFive(3)ï¼Œadd å…§éƒ¨å‡½å¼ï¼ˆinnerï¼‰è¢«èª¿ç”¨ï¼Œå®Œæˆé‹ç®—å¾Œå›å‚³çµæœ 8ã€‚ Currying vs. Partial applicationCurrying æœ‰æ™‚æœƒè·Ÿ Partial applicationï¼ˆåå‡½æ•¸æ‡‰ç”¨ï¼‰æ··æ·†ï¼Œä»¥ä¸‹èˆ‰ä¾‹èªªæ˜å·®ç•° Curry Functionï¼šä¸€å€‹å‡½å¼åªèƒ½åŒ…å«ä¸€å€‹ Arityï¼ˆåƒæ•¸å€‹æ•¸ï¼‰ function add(x) { return (y) =&gt; { return (z) =&gt; { return x + y + z; } }}add(1)(2)(3); // outputï¼š6 Partial applicationï¼šä¸€å€‹å‡½å¼å¯ä»¥åŒ…å«å¤šå€‹åƒæ•¸å€‹æ•¸ function add(x) { return (y, z) =&gt; { return x + y + z; }}add(1)(2, 3); // outputï¼š6 é€²éšæ‡‰ç”¨éœ€æ­é… Javascript å‡½æ•¸åŸå‹æ–¹æ³• callã€applyï¼ˆåƒè€ƒæ–‡ç« ï¼‰ï¼Œä»¥åŠéè¿´å‡½å¼æ¦‚å¿µï¼ˆåƒè€ƒæ–‡ç« ï¼‰ å»ºç«‹å…±ç”¨ Curry functionï¼Œå°‡å‡½å¼ä½œç‚ºåƒæ•¸ function curry(func) { return curried = (...args) =&gt; { // å¼•æ•¸å€‹æ•¸å¤§æ–¼æˆ–ç­‰æ–¼åƒæ•¸å€‹æ•¸ if (args.length &gt;= func.length) { return func.apply(this, args); } return (...moreArgs) =&gt; { return curried.apply(this, args.concat(moreArgs)); } }} å°‡ add ä½œç‚ºå¼•æ•¸ä»£å…¥ func åƒæ•¸ function add(x, y, z) { return x + y + z;}const curriedAdd = curry(add); ä»¥ä¸‹ä¸‰å€‹ä½¿ç”¨æ–¹å¼åŸ·è¡Œçµæœç›¸åŒ curriedAdd(1)(2)(3); // outputï¼š6curriedAdd(1, 2)(3); // outputï¼š6curriedAdd(1)(2, 3); // outputï¼š6 åˆ©ç”¨ Curry Functionï¼Œå‡½å¼å¯ä»¥æ›´åŠ å½ˆæ€§çš„é‹ç”¨ï¼Œæé«˜ç¨‹å¼ç¢¼çš„ç¶­è­·æ€§ const curriedAdd1 = curriedAdd(1);curriedAdd1(2, 3); // outputï¼š6curriedAdd1(3, 4); // outputï¼š8const curriedAdd2 = curriedAdd(1, 2);curriedAdd2(3); // outputï¼š6curriedAdd2(5); // outputï¼š8 åƒè€ƒæ–‡ç« ï¼š https://medium.com/javascript-scene/curry-and-function-composition-2c208d774983 https://ithelp.ithome.com.tw/articles/10236374 https://medium.com/swlh/currying-in-javascript-bbe4ddedf86b","link":"/2023/02/16/javascript/js-currying/"},{"title":"Javascript Debounce & Throttle æå‡ç¶²é æ•ˆèƒ½","text":"debounce èˆ‡&nbsp;throttle ç”¨ä¾†é˜²æ­¢ scroll, resize ç­‰äº‹ä»¶è™•ç†å™¨åœ¨çŸ­æ™‚é–“å…§è¢«é »ç¹è§¸ç™¼ï¼Œç¶å®šçš„å‡½ç¤ºé‡è¤‡åŸ·è¡Œï¼Œé€ æˆç¶²é ä¸æ–·é‡æ–°é‹ç®—é€²è€Œå½±éŸ¿æ•ˆèƒ½ï¼Œä½œæ³•å°±æ˜¯æ§åˆ¶å‡½å¼è§¸ç™¼çš„æ¬¡æ•¸æˆ–é »ç‡ï¼Œä»¥ä¸‹åˆ†åˆ¥èªªæ˜å…©è€…çš„æ“ä½œæ–¹å¼ã€‚ Debounceæ¦‚å¿µæ˜¯åŠ å…¥ä¸€å€‹å€’æ•¸è¨ˆæ™‚å™¨ï¼Œé€£çºŒè§¸ç™¼æ™‚æœƒä¸€ç›´é‡æ–°å€’æ•¸ï¼Œç›´åˆ°è¨ˆæ™‚å™¨æ­¸é›¶ï¼Œæ‰åŸ·è¡Œå‡½å¼ã€‚ ç°¡å–®èˆ‰ä¾‹ï¼šå°±åƒæ˜¯ä¾¿åˆ©å•†åº—çš„è‡ªå‹•é–€ï¼Œç•¶ä¸€æ®µæ™‚é–“å…§é »ç¹æœ‰å®¢äººé€²ä¾†ï¼Œè‡ªå‹•é–€æœƒæŒçºŒé–‹è‘—ï¼Œç›´åˆ°å¤§å®¶éƒ½é€²å…¥å¾Œï¼Œç­‰å¾…å¹¾ç§’æ‰é—œä¸Šã€‚ function debounce(func, delay = 1000) { let timer = null; return function(...args) { clearTimeout(timer); timer = setTimeout(() =&gt; { func.apply(this, args); }, delay) }} åˆ©ç”¨é–‰åŒ…ï¼ˆclosureï¼‰å°‡ timer è®Šæ•¸èˆ‡å…§éƒ¨å‡½å¼åˆ†äº«ï¼Œfunc.apply(this, args) å¯ä»¥æ›¿æ›æˆ func.call(this, ...args) æˆ–æ˜¯ func.bind(this)(...args) å¦‚æœä¸å¤ªæ¸…æ¥šå‡½æ•¸åŸå‹æ–¹æ³• callã€applyã€bindï¼Œä»¥åŠè£¡é¢ä»£å…¥çš„ this å’Œ argumentï¼Œå¯ä»¥åƒè€ƒé€™ä¸€ç¯‡ ç¯„ä¾‹ï¼šinput è¼¸å…¥æœå°‹äº‹ä»¶ ç•¶è¼¸å…¥åœæ­¢è¶…éä¸€ç§’å¾Œï¼Œæ‰å»è®€å–è¼¸å…¥å…§å®¹ &lt;input type=\"text\" placeholder=\"è«‹è¼¸å…¥æœå°‹å…§å®¹\" id=\"search\" /&gt;&lt;p id=\"content\"&gt;&lt;/p&gt; const input = document.getElementById('search');const content = document.getElementById('content');input.addEventListener('input', debounce(updateContent));function updateContent(e) { content.textContent = e.target.value;} ç¯„ä¾‹ç•«é¢ï¼š See the Pen Javascript Debounce by Claire Chang (@claire-chang-the-bashful) on CodePen. Throttleç¯€æµå™¨ï¼Œç›®çš„æ˜¯æ¸›å°‘äº‹ä»¶åŸ·è¡Œçš„æ¬¡æ•¸ï¼Œäº‹ä»¶é€£çºŒè§¸ç™¼æ™‚è£½é€ é–“éš”ä¾†æ§åˆ¶é‹è¡Œæ¬¡æ•¸ã€‚ ç°¡å–®èˆ‰ä¾‹ï¼šåƒæ˜¯ç­‰ç´…ç¶ ç‡ˆï¼Œåœ¨å›ºå®šçš„æ™‚é–“æ‰æœƒè½‰æˆç¶ ç‡ˆï¼Œå¦‚æœéŒ¯éäº†ï¼Œå¿…é ˆç­‰å¾…ä¸€æ®µæ™‚é–“ï¼Œç›´åˆ°ä¸‹æ¬¡ç¶ ç‡ˆæ‰èƒ½é€šéã€‚ é¦–æ¬¡åŸ·è¡Œçš„æ™‚æ©Ÿï¼šæœ‰ä»¥ä¸‹å…©ç¨®ï¼Œåªå·®åœ¨é¦–æ¬¡åŸ·è¡Œï¼Œå¾ŒçºŒçš„çµæœéƒ½æ˜¯ä¸€æ¨£çš„ã€‚ 1. é¦–æ¬¡ã€Œç«‹åˆ»ã€åŸ·è¡Œ function throttle(func, timeout = 1000) { let isClose = false; let timer = null; return function(...args) { if (isClose) { return; } func.apply(this, args); // ç¬¬ä¸€æ¬¡åŸ·è¡Œä¸é€²å…¥ settimeout() è¨ˆç®— isClose = true; clearTimeout(timer); timer = setTimeout(() =&gt; { func.apply(this, args); isClose = false; }, timeout) }} 2. é¦–æ¬¡ã€Œå»¶é²ã€åŸ·è¡Œ function throttle(func, timeout = 1000) { let isClose = false; let timer = null; return function(...args) { if (isClose) { return; } isClose = true; clearTimeout(timer); timer = setTimeout(() =&gt; { func.apply(this, args); // ç¬¬ä¸€æ¬¡åŸ·è¡Œé€²å…¥ settimeout() è¨ˆç®— isClose = false; }, timeout); }} ç¯„ä¾‹ï¼šscroll è¦–çª—æ»¾å‹•äº‹ä»¶ æ»¾å‹•è¦–çª—æ™‚ï¼Œæ¯éš”ä¸€ç§’æ‰åŸ·è¡Œå‡½å¼ï¼Œåˆ¤æ–·æ˜¯å¦è¦é¡¯ç¤ºä¸‹ä¸€å€å¡Šå…§å®¹ &lt;ul id=\"content\"&gt;&lt;/ul&gt; const content = document.getElementById('content');window.addEventListener('scroll', throttle(handleScroll));function handleScroll() { if ((window.innerHeight + window.scrollY) &gt;= document.body.offsetHeight) { content.innerHTML += '&lt;li&gt; ... &lt;/li&gt;'; }} ç¯„ä¾‹ç•«é¢ï¼š See the Pen Javascript Throttle by Claire Chang (@claire-chang-the-bashful) on CodePen. debounce èˆ‡&nbsp;throttle é©åˆçš„æƒ…å¢ƒç•¥æœ‰ä¸åŒï¼Œå¯ä»¥è—‰ç”±ä¸Šè¿°ç¯„ä¾‹ä¾†è§€å¯Ÿå…©è€…é–“çš„å·®ç•° debounce é©ç”¨åœ¨åœæ­¢è§¸ç™¼å¾Œæ‰åŸ·è¡Œäº‹ä»¶ï¼ˆinput åœæ­¢è¼¸å…¥å¾Œï¼Œæ‰å»è®€å–æ›´æ–°çš„å€¼ï¼‰ throttle é©ç”¨åœ¨å›ºå®šæ™‚é–“å€é–“åŸ·è¡Œäº‹ä»¶ï¼ˆæ»‘é¼ æ»¾å‹•æ™‚ï¼Œæ¯éš”ä¸€ç§’æª¢æŸ¥ç•¶å‰ä½ç½®ï¼Œåˆ¤æ–·æ˜¯å¦è¦æ’ˆå–ä¸‹ä¸€é çš„è³‡æ–™ï¼‰ åƒè€ƒæ–‡ç« ï¼š https://medium.com/@alexian853/debounce-throttle-é‚£äº›å‰ç«¯é–‹ç™¼æ‡‰è©²è¦çŸ¥é“çš„å°äº‹-ä¸€-76a73a8cbc39 https://ithelp.ithome.com.tw/articles/10222749 https://medium.com/@steven234/throttleè·Ÿ-debounceæœ‰ä»€éº¼å€åˆ¥-e0b1979b1b4f","link":"/2023/02/04/javascript/js-debounce-throttle/"},{"title":"Javascript ES6 è³‡æ–™å‹åˆ¥ Symbol","text":"JavaScript çš„å‹åˆ¥åˆ†ç‚ºå…©ç¨®ï¼šåŸå§‹è³‡æ–™å‹åˆ¥ï¼ˆPrimitive Data Typesï¼‰ä»¥åŠç‰©ä»¶å‹åˆ¥ï¼ˆObject Typesï¼‰ åŸå§‹è³‡æ–™å‹åˆ¥åŒ…å«ä»¥ä¸‹ï¼š String å­—ä¸²å‹åˆ¥ Number æ•¸å­—å‹åˆ¥ Boolean å¸ƒæ—å‹åˆ¥ Null Undefined Symbol ES6 Symbols æ˜¯ JavaScript ä¸­çš„ä¸€ç¨®æ–°è³‡æ–™å‹åˆ¥ï¼Œç”¨æ–¼è¡¨ç¤ºå”¯ä¸€çš„è­˜åˆ¥ç¬¦ã€‚æ¯å€‹ Symbol å€¼éƒ½æ˜¯å”¯ä¸€ä¸”ä¸å¯è®Šçš„ï¼Œä¸¦ä¸”å¯ä»¥ä½œç‚ºç‰©ä»¶å±¬æ€§çš„ key å€¼ã€‚ä¹Ÿå°±æ˜¯èªªï¼Œå³ä½¿å…©å€‹ Symbol å€¼å…·æœ‰ç›¸åŒçš„æè¿°ï¼ˆdescriptionï¼‰ï¼Œå…©è€…ä¹Ÿä¸ç›¸ç­‰ã€‚ æˆ‘å€‘å¯ä»¥ä½¿ç”¨ Symbol() å‡½æ•¸ä¾†å»ºç«‹ä¸€å€‹ Symbol å€¼ï¼Œå¯ä»¥å¸¶ä¸€å€‹åƒæ•¸ï¼Œç”¨ä»¥æè¿°è©² Symbolã€‚ å±¬æ€§èªªæ˜ éå»ºæ§‹å‡½å¼ï¼Œä¸èƒ½æ­é… new ä½¿ç”¨ï¼ˆnew Symbol()ï¼‰ ä¸èƒ½ä½¿ç”¨ for...inã€Object.keys() ç­‰è¿´åœˆè¿­ä»£ï¼Œå¿…é ˆæ­é… Object.getOwnPropertySymbols() æ–¹æ³• ä¸èƒ½ä½¿ç”¨é»é‹ç®—å­ . å–å¾—å±¬æ€§å€¼ï¼Œå¿…é ˆä½¿ç”¨ä¸­æ‹¬è™Ÿ [] å¯ä»¥ä½œç‚ºå”¯ä¸€ key ä½¿ç”¨ï¼Œé¿å…ç›¸åŒ key å€¼è¦†å¯«çš„æƒ…æ³ ä½¿ç”¨æ–¹å¼Symbol(description) å»ºç«‹å”¯ä¸€è­˜åˆ¥ const Daniel = Symbol('student');const Claire = Symbol('student');console.log(Daniel === Claire); // output: false Symbol.for(key) å…¨åŸŸå­˜å–å…±ç”¨ Symbol.for() æ–¹æ³•å»ºç«‹çš„ Symbol æœƒè¢«ä¿å­˜åœ¨å…¨åŸŸä¸­ï¼Œæ¥æ”¶ä¸€å€‹å­—ç¬¦ä¸²ä½œç‚ºåƒæ•¸ï¼Œé€™å€‹å­—ç¬¦ä¸²ç¨±ç‚º Symbol çš„ keyï¼Œå¦‚æœåœ¨å…¨åŸŸ Symbol è¡¨ä¸­å·²ç¶“å­˜åœ¨è©² key å°æ‡‰çš„ Symbolï¼Œå‰‡ç›´æ¥å›å‚³æ­¤ Symbolï¼›å¦‚æœä¸å­˜åœ¨å‰‡æ–°å¢ä¸€å€‹ Symbol const Daniel = Symbol.for('student'); // æ–°å»ºconst Claire = Symbol.for('student'); // è¤‡ç”¨console.log(Daniel === Claire); // output: true Symbol.keyFor(symbol) å–å¾— Symbol.for() çš„ key å€¼ const Daniel = Symbol.for('student');console.log(Symbol.keyFor(Daniel)); // output: student Object.getOwnPropertySymbols() è¿´åœˆ ä¸€èˆ¬ä¾†èªªï¼Œå¦‚æœç‰©ä»¶å…§æœ‰é‡è¤‡ key å€¼ï¼Œå¾Œè€…æœƒè¦†å¯«å‰è€…ï¼Œè¦‹ä»¥ä¸‹ç¯„ä¾‹ const students = { daniel: { age: 18, gender: 'male' }, claire: { age: 17, gender: 'female' }, andy: { age: 16, gender: 'male' }, daniel: { age: 20, gender: 'male' }}console.log(students);// output:// {// andy: {age: 16, gender: 'male'},// claire: {age: 17, gender: 'female'},// daniel: {age: 20, gender: 'male'}// } ä½†å¦‚æœçœŸçš„å­˜åœ¨ç›¸åŒ key å€¼ï¼Œåƒæ˜¯ç›¸åŒåç¨±çš„å­¸ç”Ÿï¼Œå¯ä»¥æ­é… symbol ä½¿ç”¨ const students = { [Symbol('daniel')]: { age: 18, gender: 'male' }, [Symbol('claire')]: { age: 17, gender: 'female' }, [Symbol('andy')]: { age: 16, gender: 'male' }, [Symbol('daniel')]: { age: 20, gender: 'male' }}console.log(students);// output:// {// Symbol(andy): {age: 16, gender: 'male'},// Symbol(claire): {age: 17, gender: 'female'},// Symbol(daniel): {age: 18, gender: 'male'},// Symbol(daniel): {age: 20, gender: 'male'}// } æ­é… Object.getOwnPropertySymbols é‹è¡Œè¿´åœˆåˆ¤æ–· const adults = Object.getOwnPropertySymbols(students).filter(symbol =&gt; { return students[symbol].age &gt;= 18;});console.log(adults);// output: [ Symbol(daniel), Symbol(daniel) ] åƒè€ƒæ–‡ç« ï¼š https://ithelp.ithome.com.tw/articles/10220499 https://ithelp.ithome.com.tw/articles/10242050","link":"/2023/03/28/javascript/js-es6-symbol/"},{"title":"Javascript ç‰©ä»¶è¿´åœˆæ–¹æ³•","text":"é™¤äº† forâ€¦in æ–¹æ³•ï¼Œé‚„æœ‰è¨±å¤šè¿´åœˆæ–¹æ³•å¯ä»¥å”åŠ©è™•ç†é™£åˆ—è³‡æ–™ï¼Œä½†ç‰©ä»¶ä¸¦ä¸æ”¯æ´é€™äº›æ–¹æ³•ï¼Œä»¥ä¸‹ç‚ºä¾‹ const fruits = { apple: { price: 45 }, strawberry: { price: 100 }, banana: { price: 30 }, papaya: { price: 60 }, watermelon: { price: 75 }} å‡è¨­æˆ‘å€‘æƒ³å–å¾—æ¯å€‹å…ƒç´ çš„åƒ¹æ ¼ï¼Œç›´æ¥ä½¿ç”¨é™£åˆ—æ–¹æ³• forEach() æœƒç”¢ç”ŸéŒ¯èª¤ï¼Œå› ç‚ºç‰©ä»¶ä¸¦æ²’æœ‰è©²å¯«æ³• fruits.forEach(item =&gt; { console.log(item.price);});// output: Uncaught TypeError: fruits.forEach is not a function å°‡ç‰©ä»¶è½‰ç‚ºé™£åˆ— Object.keys() Object.values() Object.entries() Object.keys()å–å¾—ä¸€å€‹ç‰©ä»¶çš„æ‰€æœ‰å¯æšèˆ‰å±¬æ€§åç¨±ï¼ˆkeyï¼‰ï¼Œä¸¦å›å‚³é™£åˆ— console.log(Object.keys(fruits));// output: ['apple', 'strawberry', 'banana', 'papaya', 'watermelon'] Object.keys(fruits).forEach(key =&gt; { console.log(fruits[key].price);});// output:// 45// 100// 30// 60// 75 Object.values()å–å¾—ä¸€å€‹ç‰©ä»¶çš„æ‰€æœ‰å¯æšèˆ‰å±¬æ€§çš„å€¼ï¼ˆvalueï¼‰ï¼Œä¸¦å›å‚³é™£åˆ— console.log(Object.values(fruits));// output: [// { \"price\": 45 },// { \"price\": 100 },// { \"price\": 30 },// { \"price\": 60 },// { \"price\": 75 }// ] Object.values(fruits).forEach(item =&gt; { console.log(item.price);});// output:// 45// 100// 30// 60// 75 Object.entries()å¯ä»¥å–å¾—æœ€å®Œæ•´çš„è³‡è¨Šï¼Œå°‡ä¸€å€‹ç‰©ä»¶çš„æ‰€æœ‰å¯æšèˆ‰å±¬æ€§ï¼ˆkeyï¼‰èˆ‡å€¼ï¼ˆvalueï¼‰çµ„åˆä¸€å€‹é™£åˆ—ï¼Œç¬¬ä¸€å€‹å€¼ç‚º keyï¼Œç¬¬äºŒå€‹å€¼ç‚º value console.log(Object.entries(fruits));// output: [// [ \"apple\", { \"price\": 45 } ],// [ \"strawberry\", { \"price\": 100 } ],// [ \"banana\", { \"price\": 30 } ],// [ \"papaya\", { \"price\": 60 } ],// [ \"watermelon\", { \"price\": 75 } ]// ] Object.entries(fruits).forEach(item =&gt; { console.log(item[1].price);});// output:// 45// 100// 30// 60// 75 Object.fromEntries()Object.fromEntries() ç‚º Object.entries() çš„åå‘æ“ä½œï¼Œå°‡ é™£åˆ—è½‰ç‰©ä»¶ const fruits = [ [ 'apple', { price: 45 } ], [ 'strawberry', { price: 100 } ], [ 'banana', { price: 30 } ]];console.log(Object.fromEntries(fruits));// output: {// \"apple\": {// \"price\": 45// },// \"strawberry\": {// \"price\": 100// },// \"banana\": {// \"price\": 30// }// } å°çµ Object.keys() è·Ÿ Object.entries() å¯ä»¥ç”¨ä¾†å–å¾—ç‰©ä»¶çš„å±¬æ€§åç¨±è·Ÿå€¼ Object.values() é©åˆé©åˆç”¨ä¾†å–å¾—ç‰©ä»¶å„å…ƒç´ å€¼ Object.fromEntries() ç‚º Object.entries() çš„é€†å‘æ“ä½œ ä»¥ä¸Šæ–¹æ³•åœ¨è™•ç†ç‰©ä»¶æ™‚æä¾›äº†ä¸åŒçš„å„ªé»å’ŒåŠŸèƒ½ï¼Œå¸¸æœƒæ­é…é™£åˆ—æ–¹æ³•ä½¿ç”¨ï¼ˆåƒè€ƒæ–‡ç« ï¼‰ï¼Œå¯ä»¥æ ¹æ“šéœ€æ±‚é¸æ“‡æœ€é©æ–¹æ³• åƒè€ƒè³‡æºï¼š https://ithelp.ithome.com.tw/articles/10239942https://www.casper.tw/development/2022/03/10/object-for-each/","link":"/2023/06/01/javascript/js-object-loop/"},{"title":"Three.js 3D Library (1) åŸºæœ¬ä»‹ç´¹","text":"Three.js æ˜¯ä¸€å€‹åŸºæ–¼ WebGL é–‹ç™¼çš„ JavaScript å‡½å¼åº«ï¼Œå¯åœ¨ç¶²é ä¸Šå»ºç«‹ 3D åœ–å½¢ã€‚Three.js æä¾›æ¯” WebGL æ›´ç°¡å–®ã€é«˜æ•ˆä¸”åŠŸèƒ½è±å¯Œçš„æ–¹å¼ä¾†å‰µå»ºäº’å‹•æ€§çš„ 3D å ´æ™¯ï¼Œä¸¦æ”¯æ´å¤šç¨®æ¸²æŸ“å™¨ï¼ŒåŒ…æ‹¬ WebGLã€Canvas å’Œ SVG å¥—ä»¶å®‰è£npm i three import * as THREE from 'three' åŸºæœ¬å…ƒç´  å ´æ™¯ Scene ç›¸æ©Ÿ Camera ç‰©é«” Objects å…‰æº Light æ¸²æŸ“å™¨ Renderer å ´æ™¯ Sceneå ´æ™¯æ˜¯ä¸€å€‹ç‰©ä»¶å®¹å™¨ï¼Œç”¨ä¾†å­˜æ”¾æ‰€æœ‰çš„ç‰©é«”ã€å…‰æºå’Œç›¸æ©Ÿç­‰å…ƒç´ ã€‚ç¶²é ä¸Šçš„ 3D åœ–å½¢éƒ½æ˜¯ç”±å ´æ™¯ä¸­çš„å…ƒç´ æ‰€çµ„æˆï¼Œä¸€å€‹ç¶²é å¯ä»¥æœ‰å¤šå€‹å ´æ™¯ const scene = new THREE.Scene()scene.background = new THREE.Color(0xffffff) // è¨­å®šèƒŒæ™¯è¨­ç‚ºç™½åº• å»ºç«‹å ´æ™¯å¾Œï¼Œå¯ä»¥ä½¿ç”¨ scene.add(object) æ–¹æ³•å°‡ç‰©é«”åŠ å…¥åˆ°å ´æ™¯ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ scene.remove(object) æ–¹æ³•å°‡ç‰©é«”å¾å ´æ™¯ç§»é™¤ ç›¸æ©Ÿ Cameraç›¸æ©Ÿæ±ºå®šäº†åœ¨å ´æ™¯ä¸­çœ‹åˆ°çš„ä½ç½®å’Œè§’åº¦ã€‚Three.js æ”¯æ´å¤šç¨®é¡å‹çš„ç›¸æ©Ÿï¼ŒåŒ…æ‹¬ï¼š PerspectiveCamera é€è¦–ç›¸æ©Ÿ OrthographicCamera æ­£äº¤ç›¸æ©Ÿ 1. PerspectiveCamera é€è¦–ç›¸æ©Ÿé€è¦–ç›¸æ©Ÿç”¨æ–¼æ¨¡æ“¬äººçœ¼è§€å¯Ÿç‰©é«”çš„æ•ˆæœï¼Œå»ºç«‹é€è¦–ç›¸æ©ŸåŸºæœ¬åƒæ•¸ï¼š FOV (Field of View)ï¼šè¦–é‡è§’åº¦ï¼Œå–®ä½ç‚ºåº¦æ•¸ï¼Œé€šå¸¸è¨­å®šç‚º 45 åº¦ Aspect Ratioï¼šç•«é¢çš„å¯¬é«˜æ¯”ï¼Œé€šå¸¸è¨­å®šç‚º window.innerWidth / window.innerHeight Nearï¼šç›¸æ©Ÿåˆ°è¿‘ç«¯çš„è·é›¢ï¼Œé€šå¸¸è¨­å®šç‚º 0.1 Farï¼šç›¸æ©Ÿåˆ°é ç«¯çš„è·é›¢ï¼Œé€šå¸¸è¨­å®šç‚º 1000 const camera = new THREE.PerspectiveCamera( 45, window.innerWidth / window.innerHeight, 0.1, 1000); 2. OrthographicCamera æ­£äº¤ç›¸æ©Ÿæ­£äº¤ç›¸æ©Ÿç„¡è«–ç‰©é«”è·é›¢é è¿‘ï¼Œçœ‹èµ·ä¾†å¤§å°éƒ½ç›¸åŒï¼Œé©åˆç”¨æ–¼æ¨¡æ“¬é€è¦–æ•ˆæœä¸æ˜é¡¯çš„å ´æ™¯ï¼Œä¾‹å¦‚å¹³é¢åœ°åœ–ã€‚å»ºç«‹æ­£äº¤ç›¸æ©ŸåŸºæœ¬åƒæ•¸ï¼š Leftï¼šç•«é¢å·¦é‚Šç•Œçš„ä½ç½® Rightï¼šç•«é¢å³é‚Šç•Œçš„ä½ç½® Topï¼šç•«é¢ä¸Šé‚Šç•Œçš„ä½ç½® Bottomï¼šç•«é¢ä¸‹é‚Šç•Œçš„ä½ç½® Nearï¼šç›¸æ©Ÿåˆ°è¿‘ç«¯çš„è·é›¢ Farï¼šç›¸æ©Ÿåˆ°é ç«¯çš„è·é›¢ const camera = new THREE.OrthographicCamera( -window.innerWidth / 2, window.innerWidth / 2, window.innerHeight / 2, -window.innerHeight / 2, 0.1, 1000); å»ºç«‹ç›¸æ©Ÿå¾Œï¼Œå¯ä»¥ä½¿ç”¨ camera.position.set(x, y, z) æ–¹æ³•è¨­å®šç›¸æ©Ÿçš„ä½ç½®ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ camera.lookAt(object) æ–¹æ³•è®“ç›¸æ©Ÿå°æº–å¦ä¸€å€‹ç‰©é«”ã€‚ ç‰©é«” Objectsç‰©é«”æ˜¯åœ¨å ´æ™¯ä¸­é¡¯ç¤ºçš„ 3D åœ–å½¢å…ƒç´ ï¼Œæœ‰ä»¥ä¸‹å¹¾ç¨®ï¼š Mesh ç¶²æ ¼ï¼šç”±å¹¾ä½•å½¢ç‹€å’Œæè³ªçµ„æˆçš„ç‰©é«” Pointsï¼šç”±é»å’Œæè³ªçµ„æˆçš„ç‰©é«”ï¼Œé€šå¸¸ç”¨æ–¼é¡¯ç¤ºç²’å­æ•ˆæœ Lineï¼šç”±ç·šæ®µå’Œæè³ªçµ„æˆçš„ç‰©é«”ï¼Œé€šå¸¸ç”¨æ–¼é¡¯ç¤ºç°¡å–®çš„ç·šæ¢æ•ˆæœ Spriteï¼šåªæœ‰ 2D åœ–ç‰‡çš„ç‰©é«”ï¼Œå¯ä»¥éš¨è‘—ç›¸æ©Ÿä½ç½®æ—‹è½‰å’Œç¸®æ”¾ 1. ç¶²æ ¼ MeshThree.js ä¸­æœ€å¸¸ç”¨çš„ç‰©é«”é¡åˆ¥ï¼Œç”± å¹¾ä½•é«” Geometry å’Œ æè³ª Material çµ„åˆè€Œæˆ å¹¾ä½•é«” Geometryï¼šå®šç¾©ç‰©é«”çš„å½¢ç‹€ã€å¤§å°å’Œä½ç½® æè³ª Materialï¼šå®šç¾©ç‰©é«”çš„æè³ªå’Œå¤–è§€ï¼Œå¯ä»¥è¨­å®šé¡è‰²ã€ç´‹ç†ã€é€æ˜åº¦â€¦ // å»ºç«‹å¹¾ä½•é«”const geometry = new THREE.SphereGeometry(1, 32, 32);// å»ºç«‹æè³ªconst material = new THREE.MeshBasicMaterial({ color: 0xffffff });// å»ºç«‹ç¶²æ ¼const sphere = new THREE.Mesh(geometry, material);// å°‡ç¶²æ ¼åŠ å…¥åˆ°å ´æ™¯ä¸­scene.add(sphere); 2. ç²’å­ Pointsé€šå¸¸ç”¨æ–¼é¡¯ç¤ºç²’å­æ•ˆæœ // å»ºç«‹å¹¾ä½•é«”const geometry = new THREE.BufferGeometry();const vertices = [];for (let i = 0; i &lt; 1000; i++) { const x = 2000 * Math.random() - 1000; const y = 2000 * Math.random() - 1000; const z = 2000 * Math.random() - 1000; vertices.push(x, y, z);}geometry.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3));// å»ºç«‹æè³ªconst material = new THREE.PointsMaterial({size: 35, sizeAttenuation: true, alphaTest: 0.5, transparent: true});// å»ºç«‹ç²’å­const points = new THREE.Points(geometry, material);// å°‡ç²’å­åŠ å…¥åˆ°å ´æ™¯ä¸­scene.add(points); 3. ç·šæ¢ Lineç”±ä¸€äº›é€£æ¥çš„ç·šæ®µå’Œæè³ªçµ„æˆçš„ç‰©é«”ï¼Œé€šå¸¸ç”¨æ–¼é¡¯ç¤ºç°¡å–®çš„ç·šæ¢æ•ˆæœ ä»¥ä¸‹ç¯„ä¾‹ç‚ºä¸€å€‹ç”±ä¸‰å€‹é»çµ„æˆçš„ç·šæ®µ // å»ºç«‹å¹¾ä½•é«”const geometry = new THREE.BufferGeometry();const vertices = new Float32Array([ -1, 0, 0, 0, 1, 0, 1, 0, 0]);geometry.setAttribute('position', new THREE.BufferAttribute(vertices, 3));// å»ºç«‹æè³ªconst material = new THREE.LineBasicMaterial({ color: 0xffffff });// å»ºç«‹ç·šæ¢const line = new THREE.Line(geometry, material);// å°‡ç·šæ¢åŠ å…¥åˆ°å ´æ™¯ä¸­scene.add(line); å…‰æº Lightå…‰æºç”¨æ–¼æ¨¡æ“¬å…‰ç…§æ•ˆæœï¼Œå¯ä»¥è®“å ´æ™¯ä¸­çš„ç‰©é«”æ›´åŠ çœŸå¯¦ã€‚æœ‰äº›æè³ªä¸å—å…‰æºå½±éŸ¿ï¼Œä¾‹å¦‚MeshBasicMaterial è·Ÿ MeshNormalMaterial æ˜¯æ²’æœ‰é™°å½±çš„æè³ªã€‚å¦‚æœéœ€è¦ä½¿ç”¨å…‰æºï¼Œå¯ä»¥å˜—è©¦ä½¿ç”¨ MeshPhongMaterial ã€ MeshStandardMaterial æˆ– MeshLambertMaterial å…‰æºæœ‰å¹¾ä¸‹å¹¾ç¨®ï¼š æ–¹å‘å…‰ DirectionalLightï¼šæ¨¡æ“¬å¤ªé™½å…‰å°„å‘ç‰©é«”çš„æ•ˆæœï¼Œç”¨ä¾†ç”¢ç”Ÿé™°å½±æ•ˆæœ ç’°å¢ƒå…‰ AmbientLightï¼šæ¨¡æ“¬å®¤å…§çš„ç…§æ˜æ•ˆæœï¼Œå°å ´æ™¯ä¸­ç‰©é«”çš„äº®åº¦æ²’æœ‰æ–¹å‘æ€§çš„å½±éŸ¿ é»å…‰æº PointLightï¼šæ¨¡æ“¬ç‡ˆæ³¡ç™¼å‡ºçš„å…‰ç·šï¼Œå¯ä»¥æœ‰ä½ç½®çš„å…‰æº èšå…‰ç‡ˆ SpotLightï¼šæ¨¡æ“¬å°„ç‡ˆæ•ˆæœï¼Œå¯ä»¥æœ‰æ–¹å‘å’Œä½ç½®çš„å…‰æº åŠçƒå…‰ HemisphereLightï¼šæ¨¡æ“¬å¤©ç©ºç’°å¢ƒå…‰çš„å…‰æºï¼Œç‚ºçƒå½¢å…‰æº 1. æ–¹å‘å…‰ DirectionalLightç‚ºå¹³è¡Œå…‰ï¼Œåªæœ‰æ–¹å‘æ²’æœ‰ä½ç½®ï¼Œé¡ä¼¼å¤ªé™½å…‰ï¼Œä¾†è‡ªæ–¼ä¸€å€‹æ–¹å‘ï¼Œå¯ä»¥ç”¨ä¾†æ¨¡æ“¬å¤ªé™½å…‰å°„å‘ç‰©é«”çš„æ•ˆæœ const light = new THREE.DirectionalLight(0xffffff, 1);light.position.set(0, 1, 0);scene.add(light); 2. ç’°å¢ƒå…‰ AmbientLightä¸€ç¨®å‡å‹»çš„å…‰æºï¼Œå°å ´æ™¯ä¸­ç‰©é«”çš„äº®åº¦æ²’æœ‰æ–¹å‘æ€§çš„å½±éŸ¿ï¼Œç”¨ä¾†æ¨¡æ“¬å®¤å…§çš„ç…§æ˜æ•ˆæœ const light = new THREE.AmbientLight(0x404040);scene.add(light); 3. é»å…‰æº PointLightä¸€ç¨®æœ‰ä½ç½®çš„å…‰æºï¼Œå¾ä¸€å€‹é»å‘å››é¢å…«æ–¹ç™¼å°„å…‰ç·šï¼Œç”¨ä¾†æ¨¡æ“¬ç‡ˆæ³¡å…‰ const light = new THREE.PointLight(0xffffff, 1, 100); // å…‰æºé¡è‰²ã€å¼·åº¦å’Œè·é›¢é™åˆ¶light.position.set(0, 0, 50);scene.add(light); 4. èšå…‰ç‡ˆ SpotLightç‚ºæœ‰æ–¹å‘å’Œä½ç½®çš„å…‰æºï¼Œé¡ä¼¼æ‰‹é›»ç­’ï¼Œå¯ä»¥èšç„¦å…‰ç·šï¼Œç”¨ä¾†æ¨¡æ“¬å°„ç‡ˆæ•ˆæœ const light = new THREE.SpotLight(0xffffff, 1, 100, Math.PI / 4); // å…‰æºé¡è‰²ã€å¼·åº¦ã€è·é›¢é™åˆ¶å’Œç…§å°„è§’åº¦light.position.set(0, 0, 50);scene.add(light); 5. åŠçƒå…‰ HemisphereLightä¸€ç¨®æ¨¡æ“¬å¤©ç©ºç’°å¢ƒå…‰çš„å…‰æºï¼Œç‚ºçƒå½¢å…‰æºï¼Œç”¨ä¾†æ¨¡æ“¬å¤©ç©ºå’Œåœ°é¢åå°„å…‰äº’ç›¸ä½œç”¨çš„æ•ˆæœ const hemisphereLight = new THREE.HemisphereLight(0xffffbb, 0x080820, 1); // å¤©ç©ºå’Œåœ°é¢çš„é¡è‰²ä»¥åŠå¼·åº¦scene.add(hemisphereLight); æ¸²æŸ“å™¨ Rendererå‰é¢æåˆ°çš„å¹¾ç¨®å…ƒç´ ï¼Œæœ€å¾Œæœƒé€éæ¸²æŸ“å™¨å°‡å ´æ™¯ä¸­çš„ç‰©ä»¶è½‰æ›æˆ 2D åœ–åƒï¼Œé¡¯ç¤ºåœ¨ç¶²é ä¸Šï¼Œé€šå¸¸ä½¿ç”¨ WebGLRenderer æ¸²æŸ“å™¨ï¼ŒWebGLRenderer ä½¿ç”¨ WebGL é€²è¡Œæ¸²æŸ“ï¼Œå¯ä»¥è®“ç¶²é ä¸Šçš„ 3D åœ–å½¢æ›´åŠ æµæš¢å’Œç²¾ç´° const renderer = new THREE.WebGLRenderer();renderer.setSize(window.innerWidth, window.innerHeight);document.body.appendChild(renderer.domElement); ä½¿ç”¨ renderer.setSize(width, height) æ–¹æ³•è¨­å®šæ¸²æŸ“å™¨çš„å¯¬åº¦å’Œé«˜åº¦ï¼Œä½¿ç”¨ renderer.domElement å±¬æ€§å–å¾—æ¸²æŸ“å™¨çš„ DOM å…ƒç´ ï¼Œä¸¦åŠ å…¥ç¶²é  DOM å…ƒç´ å…§ 1. å ´æ™¯æ¸²æŸ“åŠ å…¥å ´æ™¯è·Ÿç›¸æ©Ÿé€²è¡Œæ¸²æŸ“ renderer.render(scene, camera); 2. å‹•ç•«å¾ªç’°æ¸²æŸ“ Render Loopå¦‚æœæƒ³åŠ å…¥å‹•æ…‹æ•ˆæœï¼Œå¯ä»¥æ­é…ç€è¦½å™¨åŸç”Ÿæ–¹æ³• requestAnimationFrameï¼Œè‡ªå‹•å»ºç«‹æ¯ç§’ 60 æ¬¡çš„å¾ªç’°æ¸²æŸ“ï¼ŒrequestAnimationFrame çš„å„ªé»ç‚ºï¼š åˆ‡æ›ç€è¦½å™¨åˆ†é æ™‚æœƒè‡ªå‹•æš«åœï¼Œå¯ä»¥æå‡ç¶²é æ•ˆèƒ½ æµæš¢çš„å‹•ç•«æ•ˆæœ ...const cube = new THREE.Mesh( geometry, material );function animate() { requestAnimationFrame(animate); cube.rotation.x += 0.01; cube.rotation.y += 0.01; renderer.render(scene, camera);}animate(); ä»¥ä¸ŠåŸºæœ¬æ¦‚å¿µç†è§£å¾Œï¼Œä¸‹ä¸€ç¯‡å°‡çµ„åˆä»¥ä¸Šå…ƒç´ ï¼Œé€²è¡Œã€æ¨¡å‹å¯¦ä½œã€å›‰ï¼ åƒè€ƒè³‡æºï¼š https://ithelp.ithome.com.tw/users/20107572/ironman/1782 https://threejs.org/","link":"/2023/04/06/javascript/js-threejs-intro/"},{"title":"Three.js 3D Library (2) æ¨¡å‹å¯¦ä½œ","text":"ä¾ç…§ä¸Šä¸€ç¯‡ Three.js 3D Library (1) åŸºæœ¬ä»‹ç´¹ ä»‹ç´¹äº†è£½é€  3D åœ–å½¢çš„åŸºæœ¬å…ƒç´ ï¼Œæ¥ä¸‹ä¾†é€²è¡Œå¯¦ä½œå§ï¼ åº§æ¨™ç³»çµ±é–‹å§‹å¯¦ä½œä¹‹å‰ï¼Œå¿…é ˆå…ˆäº†è§£ Three.js ä½¿ç”¨ å³æ‰‹åº§æ¨™ç³»çµ± Right-Hand Coordinate ä¾†å®šç¾© 3D ç©ºé–“ï¼š Xè»¸ï¼šå‘å³ç‚ºæ­£æ–¹å‘ï¼ŒYè»¸ï¼šå‘ä¸Šç‚ºæ­£æ–¹å‘ï¼ŒZè»¸ï¼šå‘å¤–ç‚ºæ­£æ–¹å‘ å¦‚æœå°æ­¤æ¦‚å¿µä¸ç†Ÿæ‚‰ä¹Ÿæ²’é—œä¿‚ï¼ŒThree.js æä¾›åº§æ¨™è¼”åŠ©ï¼š const axesHelper = new THREE.AxesHelper(10); // è‡ªè¨‚åº§æ¨™å¤§å°scene.add(axesHelper); å¯¦ä½œè¡Œæ˜Ÿè‡ªè½‰ç•«é¢ï¼Œæ­¥é©Ÿå¦‚ä¸‹ï¼š å»ºç«‹å ´æ™¯ å»ºç«‹ç›¸æ©Ÿ å»ºç«‹æ¸²æŸ“å™¨ å»ºç«‹ç‰©é«” å»ºç«‹å…‰æº æ¸²æŸ“å ´æ™¯ ä»¥ä¸‹ç‚ºé€²éšåŠŸèƒ½ï¼š åŠ å…¥è»Œé“æ§åˆ¶å™¨ æ‰“é€  RWD éŸ¿æ‡‰å¼ç•«é¢ å»ºç«‹å ´æ™¯è¨­å®šèƒŒæ™¯åº•è‰² const scene = new THREE.Scene();scene.background = new THREE.Color(0x000000); // èƒŒæ™¯è‰² å»ºç«‹ç›¸æ©Ÿä½¿ç”¨é€è¦–ç›¸æ©Ÿï¼Œè¨­å®šç›¸æ©Ÿä½ç½®è·Ÿç›¸æ©Ÿç„¦é» const camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 1000);camera.position.set(120, 120, 120); // ç›¸æ©Ÿä½ç½®camera.lookAt(scene.position); // ç›¸æ©Ÿç„¦é» å»ºç«‹æ¸²æŸ“å™¨const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true});renderer.setSize(window.innerWidth, window.innerHeight);// å°‡canvaså…§å®¹åŠ å…¥DOMdocument.getElementById('container').appendChild(renderer.domElement); å»ºç«‹ç‰©é«”çµæ§‹å¦‚ä¸‹ï¼š è¡Œæ˜Ÿé«”ï¼ˆç¶²æ ¼ç‰©é«”ï¼‰ çƒå‹é«” è¡Œæ˜Ÿç’° ç¾¤æ˜ŸèƒŒæ™¯ï¼ˆç²’å­ç‰©é«”ï¼‰ å†æ¬¡è¤‡ç¿’ä¸€ä¸‹å»ºç«‹ç¶²æ ¼ï¼ˆMeshï¼‰æˆ–ç²’å­ï¼ˆPointsï¼‰ç‰©é«”é †åºï¼šå»ºç«‹å¹¾ä½•é«” â†’ å»ºç«‹æè³ª â†’ å»ºç«‹ç‰©é«” â†’ å°‡ç‰©é«”åŠ å…¥å ´æ™¯ è¡Œæ˜Ÿé«”ï¼ˆç¶²æ ¼ç‰©é«”ï¼‰åˆ†ç‚ºçƒå‹é«”è·Ÿè¡Œæ˜Ÿç’°ï¼Œè»¸å¿ƒæ—‹è½‰ï¼ˆXè»¸-30åº¦ã€Yè»¸-10åº¦ï¼‰ è¼”åŠ©åº§æ¨™é¦–å…ˆå»ºç«‹è¼”åŠ©åº§æ¨™ï¼Œå¯ä»¥å”åŠ©æˆ‘å€‘å¿«é€Ÿç†è§£3Dç©ºé–“ const axesHelper = new THREE.AxesHelper(50);axesHelper.rotation.x = THREE.MathUtils.degToRad(-30); // Xè»¸æ—‹è½‰-30åº¦axesHelper.rotation.y = THREE.MathUtils.degToRad(-10); // Yè»¸æ—‹è½‰-10åº¦scene.add(axesHelper); ä½¿ç”¨ THREE.MathUtils.degToRad() é‹ç®—å‡½å¼ï¼Œå°‡è§’åº¦ï¼ˆdegreesï¼‰è½‰æ›æˆå¼§åº¦ï¼ˆradiansï¼‰ çƒå‹é«”ä½¿ç”¨ IcosahedronGeometry(radius, detail) å»ºç«‹å¤šé¢é«”ï¼Œè©³ç´°èªªæ˜è¦‹å®˜æ–¹æ–‡ä»¶ // å»ºç«‹å¹¾ä½•é«”const sphereGeometry = new THREE.IcosahedronGeometry(20, 1);// å»ºç«‹æè³ªconst sphereMaterial = new THREE.MeshPhongMaterial({ color: 0xffffff, emissive: 0x000000, specular: 0xffffff, shininess: 100, flatShading: true});// å»ºç«‹ç¶²æ ¼const sphere = new THREE.Mesh(sphereGeometry, sphereMaterial); è¡Œæ˜Ÿç’°ä½¿ç”¨ RingGeometry() å»ºç«‹åœ“ç’°å¹¾ä½•é«”ï¼Œè©³ç´°èªªæ˜è¦‹å®˜æ–¹æ–‡ä»¶ // å»ºç«‹å¹¾ä½•é«”const RingGeometry = new THREE.RingGeometry(42, 28, 30, 30);// å»ºç«‹æè³ªconst RingMaterial = new THREE.MeshPhongMaterial({ color: 0xffffff, emissive: 0x000000, specular: 0xffffff, shininess: 100, flatShading: true, transparent: true, opacity: 0.7});// å»ºç«‹ç¶²æ ¼ç‰©é«”const ring = new THREE.Mesh(RingGeometry, RingMaterial);// Xè»¸æ—‹è½‰90åº¦ï¼Œè®“åœ“ç’°å‘ˆç¾æ°´å¹³æ’åˆ—ring.rotation.x = THREE.MathUtils.degToRad(90); çµ„åˆè¡Œæ˜Ÿé«”ä½¿ç”¨ Group() å»ºç«‹ç¾¤çµ„ï¼Œè»¸å¿ƒæ—‹è½‰ï¼ˆåŒå‰é¢èªªæ˜ï¼šXè»¸-30åº¦ã€Yè»¸-10åº¦ï¼‰ const planet = new THREE.Group();planet.add(sphere, ring); // åŠ å…¥çƒå½¢é«”&amp;è¡Œæ˜Ÿç’°planet.rotation.x = THREE.MathUtils.degToRad(-30);planet.rotation.y = THREE.MathUtils.degToRad(-10);// å°‡ç‰©é«”åŠ å…¥å ´æ™¯scene.add(planet); ç¾¤æ˜ŸèƒŒæ™¯ï¼ˆç²’å­ç‰©é«”ï¼‰ ä½¿ç”¨ BufferGeometry() å»ºç«‹å¹¾ä½•é«”ï¼Œå¯ä»¥æ¸›å°‘ GPU çš„æ¶ˆè€—ï¼Œè©³ç´°èªªæ˜è¦‹å®˜æ–¹æ–‡ä»¶ // å»ºç«‹å¹¾ä½•é«”const geometry = new THREE.BufferGeometry();const particleAmount = 2000; // ç¾¤æ˜Ÿæ•¸const vertices = [];for (let i = 0; i &lt; particleAmount; i++) { const x = 2000 * Math.random() - 1000; const y = 2000 * Math.random() - 1000; const z = 2000 * Math.random() - 1000; vertices.push(x, y, z);}geometry.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3));// å»ºç«‹æè³ª// è¼‰å…¥åœ–ç‰‡ä¾†å»ºç«‹ç´‹ç†const particleTexture = new THREE.TextureLoader().load('https://i.imgur.com/9TwBBHH.png');const material = new THREE.PointsMaterial({ size: 5, sizeAttenuation: true, map: particleTexture, transparent: true, alphaTest: 0.5, color: 0xf3f3af});// å»ºç«‹ç²’å­ç‰©é«”const particles = new THREE.Points(geometry, material);// å°‡ç‰©é«”åŠ å…¥å ´æ™¯scene.add(particles); å»ºç«‹å…‰æºä¾åºå»ºç«‹ä¸‰ç¨®å…‰æºï¼Œè®“å…‰ç·šçœ‹èµ·ä¾†æ›´è‡ªç„¶ï¼š ç’°å¢ƒå…‰ AmbientLight é»å…‰æº PointLight èšå…‰ç‡ˆ SpotLight ç’°å¢ƒå…‰const ambientLight = new THREE.AmbientLight(0x222222); é»å…‰æºconst pointLight = new THREE.PointLight(0x777777, 1, 0);pointLight.position.set(100, 100, 0); èšå…‰ç‡ˆconst spotLight = new THREE.SpotLight(0xffffff, 3, 150, Math.PI / 6, 1, 1);spotLight.position.set(50, 100, -80);spotLight.castShadow = true;spotLight.shadow.mapSize.width = 1024;spotLight.shadow.mapSize.height = 1024;spotLight.shadow.camera.near = 10;spotLight.shadow.camera.far = 200;spotLight.shadow.focus = 1; èšå…‰ç‡ˆè¼”åŠ©å¯ä»¥æ›´æ˜ç¢ºåœ°çœ‹åˆ°å…‰ç·šä½ç½® const lightHelper = new THREE.SpotLightHelper(spotLight);scene.add(lightHelper); æœ€å¾Œå°‡å…‰æºåŠ å…¥å ´æ™¯ scene.add(ambientLight, pointLight, spotLight); æ¸²æŸ“å ´æ™¯æ­é…å‰ä¸€ç¯‡èªªæ˜éçš„ å‹•ç•«å¾ªç’°æ¸²æŸ“ Render Loop æ–¹æ³• function animate() { requestAnimationFrame(animate); // æ˜Ÿçƒé«”Yè»¸æ—‹è½‰ï¼Œå‰µé€ è‡ªè½‰æ•ˆæœ planet.rotation.y += 0.01; // å°‡å ´æ™¯æ¸²æŸ“åˆ°æ¸²æŸ“å™¨ renderer.render(scene, camera);}animate(); åˆ°é€™è£¡ç•«é¢å°±å®Œæˆå›‰ï¼ğŸ‘ğŸ‘ğŸ‘ æ¥è‘—èªªæ˜é€²éšçš„åŠŸèƒ½ åŠ å…¥è»Œé“æ§åˆ¶å™¨è»Œé“æ§åˆ¶å™¨ OrbitControls è®“ä½¿ç”¨è€…å¯ä»¥é€éæ»‘é¼ æˆ–æ˜¯è§¸æ§é¢æ¿ä¾†ç¸®æ”¾å’Œç§»å‹•ç›¸æ©Ÿï¼Œæ”¹è®Šå ´æ™¯ä¸­çš„è¦–è§’å’Œä½ç½®ï¼Œè»Œé“åœç¹è‘—å‰é¢æåˆ°çš„ camera.lookAt() ç›¸æ©Ÿç„¦é» è»Œé“æ§åˆ¶å™¨ä¹Ÿå¯ä»¥å•Ÿç”¨è‡ªå‹•æ—‹è½‰åŠŸèƒ½ï¼Œè©³ç´°è«‹è¦‹å®˜æ–¹æ–‡ä»¶ const control = new OrbitControls(camera, renderer.domElement); æ‰“é€  RWD éŸ¿æ‡‰å¼ç•«é¢ç›£è½è¢å¹•å°ºå¯¸è®ŠåŒ–ï¼Œè®“ç•«é¢è‡ªé©æ‡‰ window.addEventListener('resize', () =&gt; { camera.aspect = window.innerWidth / window.innerHeight; camera.updateProjectionMatrix(); renderer.setSize(window.innerWidth, window.innerHeight);}); å®Œæ•´ç¯„ä¾‹ç¨‹å¼ç¢¼ See the Pen Three.js-Planet Animation by Claire Chang (@claire-chang-the-bashful) on CodePen. åƒè€ƒè³‡æºï¼š https://ithelp.ithome.com.tw/users/20107572/ironman/1782 https://threejs.org/ https://medium.com/å°å½¥å½¥çš„å‰ç«¯äº”å››ä¸‰/threejs-å…§å»ºå¹¾ä½•æ¨¡å‹-äºŒ-3df675ba8315","link":"/2023/04/11/javascript/js-threejs-pattren/"},{"title":"Three.js 3D Library (3) UnrealBloomPass å¾Œè£½ç™¼å…‰æ•ˆæœ","text":"ä¸Šä¸€ç¯‡ Three.js 3D Library (2) æ¨¡å‹å¯¦ä½œ æˆ‘å€‘å»ºç«‹äº†è¡Œæ˜Ÿå‹•ç•«ï¼Œæ¥ä¸‹ä¾†è©¦è‘—åŠ å…¥ç™¼å…‰æ•ˆæœï¼Œè®“ç•«é¢æ›´å¸ç›ï½ UnrealBloomPass ç™¼å…‰æ•ˆæœThree.js æä¾›äº†å¼·å¤§çš„æ¸²æŸ“å¼•æ“å’Œè±å¯Œçš„åŠŸèƒ½ï¼Œå…¶ä¸­å¾Œè£½ï¼ˆPost-processingï¼‰æ˜¯åœ¨æ¸²æŸ“åˆ°è¢å¹•å‰å°ç•«é¢é€²è¡Œä¸€äº›è™•ç†ï¼Œå†å°‡ç•«é¢æ¸²æŸ“åˆ°è¢å¹•ä¸Šï¼Œä»¥é”åˆ°ç‰¹å®šçš„è¦–è¦ºæ•ˆæœï¼ŒUnrealBloomPass æ˜¯å…¶ä¸­ä¸€å€‹å¾Œè£½åŠŸèƒ½ï¼Œå¯ä»¥æ‰“é€ å‡ºé€¼çœŸçš„ç™¼å…‰æ•ˆæœã€‚ ä½¿ç”¨ UnrealBloomPass é€šå¸¸æœƒè·Ÿ RenderPass ä»¥åŠ EffectComposerï¼ˆåˆæˆå™¨ï¼‰æ­é…ä½¿ç”¨ï¼Œåˆ°é€™è£¡å…ˆé‡æ¸…ä¸€ä¸‹ã€æ¸²æŸ“å™¨æ¸²æŸ“ã€è·Ÿã€åˆæˆå™¨æ¸²æŸ“ã€çš„å·®ç•°ï¼š æ¸²æŸ“å™¨æ¸²æŸ“ï¼ˆWebGLRendererï¼‰ Three.js ä¸­æœ€åŸºæœ¬çš„å ´æ™¯æ¸²æŸ“æ–¹å¼ ç›´æ¥èª¿ç”¨ WebGLRenderer çš„ render æ–¹æ³•ï¼Œå°‡å ´æ™¯ä¸­çš„ç‰©é«”æ¸²æŸ“åˆ°æ¸²æŸ“å™¨çš„ç•«é¢ä¸­ æ¯æ¬¡èª¿ç”¨æ™‚ï¼Œåªæœƒç”¢ç”Ÿä¸€å€‹æ¸²æŸ“ç•«é¢ ä¸æ”¯æ´å¾Œè£½æ•ˆæœï¼Œçµæœç›´æ¥é¡¯ç¤ºåœ¨ç•«é¢ä¸­ const renderer = new THREE.WebGLRenderer();// ...renderer.render(scene, camera); // æ¸²æŸ“å™¨æ¸²æŸ“ åˆæˆå™¨æ¸²æŸ“ï¼ˆEffectComposerï¼‰ éœ€è¦æ­é… Three.js ä¸­çš„ EffectComposerï¼ˆåˆæˆå™¨ï¼‰è·Ÿ RenderPass ä½¿ç”¨ èª¿ç”¨ EffectComposer çš„ render æ–¹æ³•ï¼Œå°‡å ´æ™¯æ¸²æŸ“åˆ°åˆæˆå™¨çš„ç•«é¢ä¸­ å¯ä»¥åœ¨åˆæˆå™¨ä¸­å¢åŠ å¤šå€‹å¾Œè£½æ•ˆæœï¼ŒEXï¼šè‰²å½©æ ¡æ­£ã€æ¨¡ç³Šã€å…‰æšˆâ€¦ æ¯æ¬¡èª¿ç”¨æ™‚ï¼Œåˆæˆå™¨æœƒä¾åºæ‡‰ç”¨å¾Œè£½æ•ˆæœï¼Œç”Ÿæˆæœ€çµ‚çš„æ¸²æŸ“ç•«é¢ const renderer = new THREE.WebGLRenderer();const composer = new EffectComposer(renderer); // å»ºç«‹åˆæˆå™¨const renderScene = new RenderPass(scene, camera);composer.addPass = new EffectComposer(renderScene); // å°‡ RenderPass åŠ å…¥åˆæˆå™¨// ...composer.render(); // åˆæˆå™¨æ¸²æŸ“ åŸºç¤æ‡‰ç”¨å°‡æ•´å€‹å ´æ™¯å…§çš„ç‰©é«”éƒ½åŠ ä¸Š UnrealBloomPass æ•ˆæœï¼Œæ¥ä¸‹ä¾†ç”¨ä¸€å€‹ç°¡å–®çš„ç¯„ä¾‹ä¾†èªªæ˜ï¼Œæ­¥é©Ÿå¦‚ä¸‹ï¼š å»ºç«‹å ´æ™¯ å»ºç«‹ç›¸æ©Ÿ å»ºç«‹æ¸²æŸ“å™¨ å»ºç«‹ç‰©é«” å»ºç«‹ UnrealBloomPass ç‰©ä»¶ å»ºç«‹åˆæˆå™¨ å°‡ UnrealBloomPass åŠ å…¥åˆæˆå™¨ æ¸²æŸ“å ´æ™¯ // 1. å»ºç«‹å ´æ™¯const scene = new THREE.Scene();// 2. å»ºç«‹ç›¸æ©Ÿconst camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);camera.position.set(0, 0, 10);camera.lookAt(scene.position) // ç›¸æ©Ÿç„¦é»// 3. å»ºç«‹æ¸²æŸ“å™¨const renderer = new THREE.WebGLRenderer();renderer.setSize(window.innerWidth, window.innerHeight);document.getElementById('container').appendChild(renderer.domElement);// 4. å»ºç«‹ç‰©é«”const geometry = new THREE.BoxGeometry();const material = new THREE.MeshBasicMaterial({ color: 0xffffff });const cube = new THREE.Mesh(geometry, material);scene.add(cube);// 5. å»ºç«‹ UnrealBloomPass ç‰©ä»¶const bloomPass = new UnrealBloomPass(new THREE.Vector2(window.innerWidth, window.innerHeight), 1.5, 0.4, 0.85);// 6. å»ºç«‹åˆæˆå™¨const composer = new EffectComposer(renderer);composer.setSize(window.innerWidth, window.innerHeight);// 7. å°‡ UnrealBloomPass åŠ å…¥åˆæˆå™¨const renderScene = new RenderPass(scene, camera);composer.addPass(renderScene);composer.addPass(bloomPass);// 8. æ¸²æŸ“å ´æ™¯function animate() { requestAnimationFrame(animate); // å°‡å ´æ™¯æ¸²æŸ“åˆ°åˆæˆå™¨ composer.render();}animate(); æ•ˆæœå¦‚ä¸‹ï¼š é€²éšæ‡‰ç”¨-éƒ¨åˆ†ç‰©é«”æ¸²æŸ“ä»¥ä¸Šä¸€ç¯‡ Three.js 3D Library (2) æ¨¡å‹å¯¦ä½œ æ¥çºŒå¯¦ä½œï¼Œä½¿ç”¨ UnrealBloomPass æ­é… Shaderï¼ˆè‘—è‰²å™¨ï¼‰ ä¾†å¯¦ç¾éƒ¨åˆ†å€å¡Šç™¼å…‰æ•ˆæœ é‚£éº¼å°±é–‹å§‹å¯¦ä½œå§ï¼é¦–å…ˆèª¿æ•´æ­¥é©Ÿå¦‚ä¸‹ï¼š å»ºç«‹å ´æ™¯ å»ºç«‹ç›¸æ©Ÿ å»ºç«‹æ¸²æŸ“å™¨ å»ºç«‹ç‰©é«” å»ºç«‹å…‰æº å»ºç«‹ UnrealBloomPass ç‰©ä»¶ å»ºç«‹ bloom åˆæˆå™¨ å°‡ UnrealBloomPass åŠ å…¥åˆæˆå™¨ å»ºç«‹ ShaderPassï¼Œä¸¦è¨­å®šè‡ªå®šç¾©è‘—è‰²å™¨ å»ºç«‹è‘—è‰²å™¨çš„åˆæˆå™¨ å°‡ ShaderPass åŠ å…¥åˆæˆå™¨ åˆæˆå™¨æ¸²æŸ“å ´æ™¯ ç›£è½è¢å¹•ç¸®æ”¾ RWD å»ºç«‹å ´æ™¯/ç›¸æ©Ÿ/æ¸²æŸ“å™¨/ç‰©é«”/å…‰æºå‰ä¸€ç¯‡å·²ä»‹ç´¹éï¼Œé€™è£¡ç°¡å–®å¸¶é å ´æ™¯èƒŒæ™¯è‰²å¿…é ˆèª¿æ•´ç‚ºé»‘è‰²ï¼Œå¦å‰‡æœƒå—ç™¼å…‰æ•ˆæœå½±éŸ¿ const scene = new THREE.Scene();scene.background = new THREE.Color(0x000000); // èƒŒæ™¯è‰² ç›¸æ©Ÿconst camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);camera.position.set(120, 120, 120); // ç›¸æ©Ÿä½ç½®camera.lookAt(scene.position); // ç›¸æ©Ÿç„¦é» æ¸²æŸ“å™¨const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });renderer.setSize(window.innerWidth, window.innerHeight);document.getElementById('container').appendChild(renderer.domElement); ç‰©é«” è¡Œæ˜Ÿé«” çƒå‹é«” è¡Œæ˜Ÿç’°ï¼ˆå¾ŒçºŒåŠ å…¥ç™¼å…‰æ•ˆæœï¼‰ ç¾¤æ˜ŸèƒŒæ™¯ äº†å‘ˆç¾è¡Œæ˜Ÿç’°ç™¼å…‰æ•ˆæœï¼Œå°‡åœ–å±¤ï¼ˆLayerï¼‰è¨­ç‚º 1ï¼ˆé è¨­ç‚º 0ï¼‰ï¼šring.layers.enable(1) // è¡Œæ˜Ÿé«”-çƒå½¢é«”const sphereGeometry = new THREE.IcosahedronGeometry(20, 1);const sphereMaterial = new THREE.MeshPhongMaterial({ color: 0xffffff, emissive: 0x000000, specular: 0xffffff, shininess: 100, flatShading: true});const sphere = new THREE.Mesh(sphereGeometry, sphereMaterial);// è¡Œæ˜Ÿé«”-è¡Œæ˜Ÿç’°const RingGeometry = new THREE.RingGeometry(42, 28, 30, 30);// èª¿æ•´ç‚º MeshBasicMaterialï¼Œåªè¨­å®šéš¨æ©Ÿé¡è‰²ï¼Œå¾ŒçºŒæœƒåŠ å…¥ç™¼å…‰æ•ˆæœconst color = new THREE.Color().setRGB(Math.random(), Math.random(), Math.random());const RingMaterial = new THREE.MeshBasicMaterial({ color: color });const ring = new THREE.Mesh(RingGeometry, RingMaterial);ring.layers.enable(1);ring.rotation.x = THREE.MathUtils.degToRad(90);// çµ„åˆè¡Œæ˜Ÿé«”const planet = new THREE.Group();planet.add(sphere, ring);planet.rotation.x = THREE.MathUtils.degToRad(-30);planet.rotation.y = THREE.MathUtils.degToRad(-10);scene.add(planet);// ç¾¤æ˜ŸèƒŒæ™¯const geometry = new THREE.BufferGeometry();const particleAmount = 2000; // ç¾¤æ˜Ÿæ•¸const vertices = [];for (let i = 0; i &lt; particleAmount; i++) { const x = 2000 * Math.random() - 1000; const y = 2000 * Math.random() - 1000; const z = 2000 * Math.random() - 1000; vertices.push(x, y, z);}geometry.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3));const particleTexture = new THREE.TextureLoader().load('https://i.imgur.com/9TwBBHH.png');const material = new THREE.PointsMaterial({ size: 5, sizeAttenuation: true, map: particleTexture, transparent: true, alphaTest: 0.5, color: 0xf3f3af });const particles = new THREE.Points(geometry, material);scene.add(particles); å…‰æº// ç’°å¢ƒå…‰const ambientLight = new THREE.AmbientLight(0x222222);// é»å…‰æºconst pointLight = new THREE.PointLight(0x777777, 1, 0);pointLight.position.set(100, 100, 0);// èšå…‰ç‡ˆconst spotLight = new THREE.SpotLight(0xffffff, 3, 150, Math.PI / 15, 1, 1);spotLight.position.set(50, 100, -80);spotLight.castShadow = true;spotLight.shadow.mapSize.width = 1024;spotLight.shadow.mapSize.height = 1024;spotLight.shadow.camera.near = 10;spotLight.shadow.camera.far = 200;spotLight.shadow.focus = 1;scene.add(ambientLight, pointLight, spotLight); å»ºç«‹ UnrealBloomPass ç‰©ä»¶const bloomPass = new UnrealBloomPass( new THREE.Vector2(window.innerWidth, window.innerHeight), 3, // å¼·åº¦ 0.5, // å°„æ•£ 0 // ç¸®æ”¾); å»ºç«‹ bloom åˆæˆå™¨renderToScreen å¿…é ˆå…ˆè¨­å®šç‚º falseï¼Œå¾… ShaderPass åŸ·è¡Œ render æ™‚å†ä¸€èµ·æ¸²æŸ“ const bloomComposer = new EffectComposer(renderer);bloomComposer.renderToScreen = false; renderToScreen æ˜¯å¾Œè£½æ•ˆæœçš„é¸é …ä¹‹ä¸€ï¼Œè¨­å®šç‚º true æ™‚ï¼Œæ¸²æŸ“çµæœå°‡ç›´æ¥æ¸²æŸ“åˆ°è¢å¹•ä¸Šï¼›è¨­å®šç‚º false æ™‚ï¼Œå‰‡æ¸²æŸ“åˆ°ç›®æ¨™ç´‹ç†ä¸Šï¼Œé è¨­ç‚º true å°‡ UnrealBloomPass åŠ å…¥åˆæˆå™¨å°‡å‰é¢æ–°å¢çš„ UnrealBloomPass ç‰©ä»¶è·Ÿ RenderPass åŠ å…¥åˆæˆå™¨ bloomComposer.addPass(new RenderPass(scene, camera));bloomComposer.addPass(bloomPass); å»ºç«‹ ShaderPassï¼Œä¸¦è¨­å®šè‡ªå®šç¾©è‘—è‰²å™¨ShaderPass ç‚ºæ¸²æŸ“éç¨‹ä¸­æ‡‰ç”¨è‡ªå®šç¾©è‘—è‰²å™¨æ•ˆæœçš„å¾Œè£½é€šé“ï¼ˆPost-processing Passï¼‰ã€‚ æ­¥é©Ÿå¦‚ä¸‹ï¼š å®šç¾© ShaderMaterial å°‡ ShaderMaterial åŠ å…¥ ShaderPass ShaderMaterial å¯ä»¥å®šç¾©è‘—è‰²å™¨æè³ªé¡å‹ï¼Œç”¨ GLSLï¼ˆOpenGL Shading Language Languageï¼‰èªè¨€ç·¨å¯« Uniformsã€é ‚é»è‘—è‰²å™¨ï¼ˆVertex Shaderï¼‰ä»¥åŠç‰‡æ®µè‘—è‰²å™¨ï¼ˆFragment Shaderï¼‰ Uniformsç”¨æ–¼å°‡å¤–éƒ¨è®Šæ•¸ï¼ˆä¾‹å¦‚ç´‹ç†ã€æ™‚é–“ç­‰ï¼‰å‚³éçµ¦ Shader Shader è‘—è‰²å™¨WebGL çµ„æˆä¸­åŒ…å«è‘—è‰²å™¨ï¼ŒåŸºæœ¬ä¸ŠåŒ…å«é ‚é»è‘—è‰²å™¨ï¼ˆVertex Shaderï¼‰åŠç‰‡æ®µè‘—è‰²å™¨ï¼ˆFragment Shaderï¼‰ é ‚é»è‘—è‰²å™¨ï¼ˆVertex Shaderï¼‰ è² è²¬å ´æ™¯ä¸­é ‚é»çš„é‹ç®—ï¼Œå°‡é ‚é»å¾æ¨¡å‹ç©ºé–“ï¼ˆModel Spaceï¼‰è½‰æ›åˆ°è¢å¹•ç©ºé–“ï¼ˆScreen Spaceï¼‰ ç‰‡æ®µè‘—è‰²å™¨ï¼ˆFragment Shaderï¼‰ å°é ‚é»è™•ç†ç”Ÿæˆçš„ç‰‡å…ƒï¼ˆåƒç´ ï¼‰é€²è¡Œè™•ç†ï¼Œä¾‹å¦‚æè³ªè²¼åœ–ã€å…‰ç…§è¨ˆç®—ã€é€æ˜åº¦è¨ˆç®—ç­‰ï¼Œä¸¦ç”Ÿæˆæœ€çµ‚çš„åƒç´ é¡è‰² const shaderMaterial = new THREE.ShaderMaterial({ uniforms: { baseTexture: { value: null }, // base ç´‹ç† bloomTexture: { value: bloomComposer.renderTarget2.texture } // bloom ç´‹ç† }, vertexShader: ` varying vec2 vUv; void main() { vUv = uv; gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0); } `, fragmentShader: ` uniform sampler2D baseTexture; uniform sampler2D bloomTexture; varying vec2 vUv; // ç´‹ç†åº§æ¨™ void main() { // è¼¸å‡ºæœ€çµ‚é¡è‰² gl_FragColor = texture2D(baseTexture, vUv) + vec4(1.0) * texture2D(bloomTexture, vUv); } `});const finalPass = new ShaderPass(shaderMaterial, 'baseTexture'); å»ºç«‹ Shader åˆæˆå™¨const finalComposer = new EffectComposer(renderer); å°‡ ShaderPass åŠ å…¥åˆæˆå™¨finalComposer.addPass(new RenderPass(scene, camera));finalComposer.addPass(finalPass); åˆæˆå™¨æ¸²æŸ“å ´æ™¯å»ºç«‹ä¸€å€‹åœ–å±¤ç‰©ä»¶ï¼Œä¸¦å°‡åœ–å±¤è¨­å®šç‚º 1ï¼ˆé è¨­ç‚º 0ï¼‰ï¼Œå¾Œé¢ç”¨ä¾†æª¢æ ¸ä½¿ç”¨ const bloomLayer = new THREE.Layers();bloomLayer.set(1); åˆ©ç”¨ bloomLayer åˆ¤æ–·åœ–å±¤æ˜¯å¦ç‚º 1ï¼Œå‰é¢è¡Œæ˜Ÿç’°åœ–å±¤è¨­å®šç‚º 1ï¼ˆring.layers.enable(1)ï¼‰ï¼Œå› æ­¤é™¤äº†è¡Œæ˜Ÿç’°ä¹‹å¤–çš„ç‰©é«”ï¼Œéƒ½è¨­å®šç‚ºé»‘è‰²ï¼ˆcolor: 0x000000ï¼‰ const materials = [];const darkenMaterial = obj =&gt; { if (!bloomLayer.test(obj.layers)) { materials[obj.uuid] = obj.material obj.material = new THREE.MeshBasicMaterial({ color: 0x000000 }) }}; å°‡æš«æ™‚è¨­å®šç‚ºé»‘è‰²çš„ç‰©é«”é‚„åŸç‚ºåˆå§‹å€¼ const restoreMaterial = obj =&gt; { if (materials[obj.uuid]) { obj.material = materials[obj.uuid] delete materials[obj.uuid] }}; åŸ·è¡Œæ¸²æŸ“ï¼Œæ­¥é©Ÿå¦‚ä¸‹ï¼š scene.traverse(darkenMaterial)ï¼šscene.traverse æ˜¯ä¸€å€‹ callback å‡½å¼ï¼Œç¬¬ä¸€å€‹åƒæ•¸å¸¶å…¥ç‰©é«”æœ¬èº«ï¼ŒåŸ·è¡Œ darkenMaterial() å°‡è¡Œæ˜Ÿç’°å¤–çš„ç‰©é«”è¨­å®šç‚ºé»‘è‰² bloomComposer.render()ï¼šç™¼å…‰æ•ˆæœåˆæˆå™¨æ¸²æŸ“ï¼Œå› å‰ä¸€æ­¥é©Ÿå°‡è¡Œæ˜Ÿç’°å¤–çš„ç‰©é«”è¨­å®šç‚ºé»‘è‰²ï¼Œå› æ­¤åªæœ‰è¡Œæ˜Ÿç’°æœƒå‘ˆç¾ç™¼å…‰æ•ˆæœï¼Œå‰é¢æåˆ° bloomComposer.renderToScreen è¨­å®šç‚º falseï¼Œå°‡æ•ˆæœå…ˆæ¸²æŸ“åˆ°ç´‹ç†ä¸Š scene.traverse(restoreMaterial)ï¼šå°‡æš«æ™‚è¨­å®šç‚ºé»‘è‰²çš„ç‰©é«”é‚„åŸç‚ºåˆå§‹å€¼ finalComposer.render()ï¼šShaderPass åˆæˆå™¨æ¸²æŸ“ï¼Œå°‡æ•ˆæœæ¸²æŸ“åˆ°è¢å¹•ä¸Šï¼ˆåŒ…å«ç™¼å…‰æ•ˆæœï¼‰ const animate = () =&gt; { requestAnimationFrame(animate); sphere.rotation.y += 0.01; scene.traverse(darkenMaterial); bloomComposer.render(); scene.traverse(restoreMaterial); finalComposer.render();};animate(); ç›£è½è¢å¹•ç¸®æ”¾ RWDå°‡ bloomComposer è·Ÿ finalComposer åŠ å…¥ç›£è½ window.addEventListener('resize', () =&gt; { camera.aspect = window.innerWidth / window.innerHeight camera.updateProjectionMatrix() renderer.setSize(window.innerWidth, window.innerHeight) bloomComposer.setSize(window.innerWidth, window.innerHeight) finalComposer.setSize(window.innerWidth, window.innerHeight)}); å®Œæ•´ç¯„ä¾‹ç¨‹å¼ç¢¼ See the Pen Three.js-UnrealBloomPass by Claire Chang (@claire-chang-the-bashful) on CodePen. åƒè€ƒè³‡æºï¼š https://ithelp.ithome.com.tw/users/20107572/ironman/1782 https://threejs.org/ https://threejs.org/examples/?q=bloom#webgl_postprocessing_unreal_bloom_selective","link":"/2023/04/15/javascript/js-threejs-unrealbloompass/"},{"title":"Javascript Web Share API- Navigator.share åˆ†äº«ç¶²é å…§å®¹","text":"æ‰‹æ©Ÿ App å¯ä»¥é€éåŸç”Ÿä»‹é¢å¯¦ç¾åˆ†äº«åŠŸèƒ½ï¼Œè€Œ Web Share API å¯ä»¥å”åŠ©æˆ‘å€‘åœ¨ Android æˆ– IOS ç¶²é ä¸Šåšåˆ°é¡ä¼¼åƒ App çš„åˆ†äº«åŠŸèƒ½ï¼Œä¸»è¦æ˜¯é€éä½œæ¥­ç³»çµ±åŸç”Ÿä»‹é¢åˆ†äº«ï¼Œå¯ä»¥è¼•é¬†åœ°å°‡å…§å®¹åˆ†äº«è‡³ç¬¬ä¸‰æ–¹å¹³å°ï¼ˆFacebookã€Twitterã€Lineâ€¦ï¼‰ï¼Œåˆ†äº«å…§å®¹å¯ä»¥ç‚ºé€£çµã€æ–‡å­—æˆ–æ˜¯æª”æ¡ˆã€‚ æ–¹æ³•ä»‹ç´¹Navigator.share()å›å‚³ä¸€å€‹ Promise å‡½å¼ï¼Œå¯ä»¥æ•æ‰æˆåŠŸ / å¤±æ•—çµæœï¼Œéœ€é€éæŒ‰éˆ• click ç­‰ UI äº‹ä»¶ä¾†è§¸ç™¼ Navigator.canShare()å›å‚³ Booleanï¼Œç”¨ä»¥åˆ¤æ–·å…§å®¹æ˜¯å¦å¯ä»¥åˆ†äº« ä½¿ç”¨é™åˆ¶ å¿…é ˆé€é HTTPSï¼ˆsecure contextsï¼‰é€£çµç¶²ç«™ å¿…é ˆé€é UI äº‹ä»¶è§¸ç™¼ï¼Œåƒæ˜¯æŒ‰éˆ• click ç€è¦½å™¨æ”¯æ´åº¦è¼ƒä½ï¼ˆcaniuse-Web-Share-APIï¼‰ Navigator.share åƒæ•¸é¸æ“‡ urlï¼šåˆ†äº«çš„é€£çµï¼ˆStringï¼‰ titleï¼šåˆ†äº«çš„æ¨™é¡Œï¼ˆStringï¼‰ textï¼šåˆ†äº«çš„å…§æ–‡ï¼ˆStringï¼‰ filesï¼šåˆ†äº«çš„æª”æ¡ˆï¼ˆArrayï¼‰ åŠŸèƒ½å¯¦ä½œé€£çµã€æ–‡å­—åˆ†äº«&lt;button type=\"button\" id=\"share-btn\"&gt;åˆ†äº«&lt;/button&gt; å› ç€è¦½å™¨æ”¯æ´åº¦è¼ƒä½ï¼Œå»ºè­°åŠ ä¸Šåˆ¤æ–· Navigator.share æ˜¯å¦å­˜åœ¨ï¼Œé¿å…ç›´æ¥å ±éŒ¯ const btn = document.querySelector('#share-btn');btn.addEventListener('click', async () =&gt; { try { if (!navigator.share) { return; } await navigator.share({ title: 'Title', text: 'Share Content', url: 'https://xxx.com' }) } catch (err) { console.log(err.message); }}); æª”æ¡ˆåˆ†äº«&lt;input type=\"file\" id=\"file-input\" accept=\"image/*\" /&gt;&lt;button type=\"button\" id=\"share-btn\"&gt;åˆ†äº«&lt;/button&gt; å…ˆåˆ¤æ–·æª”æ¡ˆæ˜¯å¦èƒ½å…±äº«ï¼Œä½¿ç”¨ Navigator.canShareï¼Œå¦‚æœå›å‚³ trueï¼Œè¡¨ç¤º Navigator.share å¯ä»¥æˆåŠŸå‘¼å« const btn = document.querySelector('#share-btn');const input = document.querySelector('#file-input');btn.addEventListener('click', async () =&gt; { try { const files = input.files; if (!files.length || !navigator.canShare || !navigator.canShare({ files })) { return; } await navigator.share({ files, title: 'Image', text: 'Share Content' }) } catch (err) { console.log(err.message); }}); ç¯„ä¾‹ç•«é¢ See the Pen Web Share APIï¼šNavigator.share by Claire Chang (@claire-chang-the-bashful) on CodePen. åƒè€ƒæ–‡ç« ï¼š https://developer.mozilla.org/en-US/docs/Web/API/Navigator/sharehttps://web.dev/web-share/","link":"/2023/02/22/javascript/js-web-share-api/"},{"title":"CSS è£½ä½œå›ºå®šæ¯”ä¾‹å¯¬é«˜å€å¡Šï¼ˆAspect Ratio / Height Based on Widthï¼‰","text":"åœ¨é–‹ç™¼éŸ¿æ‡‰å¼ç¶²ç«™ï¼ˆResponsive Web Designï¼‰å¸¸æœƒéœ€è¦è£½ä½œç­‰æ¯”ä¾‹å¯¬é«˜åœ–ç‰‡ï¼Œä¸ç®¡è¢å¹•å°ºå¯¸å¦‚ä½•ç¸®æ”¾ï¼Œåœ–ç‰‡éƒ½èƒ½ä¿æŒåœ¨å›ºå®šæ¯”ä¾‹ï¼Œåšæ³•è »å¤šï¼Œä»¥ä¸‹åˆ—å‡ºå…¶ä¸­å…©ç¨®åšæ³•ï¼š aspect-ratioChrome 88ï¼ˆ2021ï¼‰ é–‹å§‹æ”¯æ´çš„å±¬æ€§ï¼Œè¨­ç½®æ–¹å¼ä¹Ÿå¾ˆç°¡å–®ï¼Œç›´æ¥è¼¸å…¥å¯¬é«˜æ¯”å°±å¯ä»¥äº† aspect-ratio: width / height; ç¼ºé»ï¼šaspect-ratio å±¬æ€§ç€è¦½å™¨æ”¯æ´åº¦è¼ƒä½ï¼Œå¯ä»¥åƒè€ƒ can I use padding-bottomå¦‚æœåœ¨æ„ç€è¦½å™¨æ”¯æ´åº¦ï¼Œå¯ä»¥ä½¿ç”¨ padding-bottom å»ºç«‹å¤–å±¤å®¹å™¨ å¯¬é«˜æ¯” padding-bottom ä»£å…¥å€¼ 16:9 56.25% 4:3 75% 5:4 80% padding-bottom: 56.25%; é€šå¸¸æœƒæ­é… position å®šä½ä½¿ç”¨ï¼Œå¦‚ä¸‹ï¼š &lt;div class=\"image-wrap\"&gt; &lt;p&gt;some description&lt;/p&gt;&lt;/div&gt; .image-wrap { position: relative; width: 100%; padding-bottom: 56.25%;}p { position: absolute; width: 100%;} ç¯„ä¾‹ç¨‹å¼ç¢¼ï¼š See the Pen CSS Aspect Ratio / Height Based on Width by Claire Chang (@claire-chang-the-bashful) on CodePen. åƒè€ƒæ–‡ç« ï¼š https://stackoverflow.com/questions/1495407/maintain-the-aspect-ratio-of-a-div-with-csshttps://developer.mozilla.org/en-US/docs/Web/CSS/aspect-ratio","link":"/2023/02/03/css/css-aspect-ratio/"},{"title":"CSS Grid Layout Module æ ¼ç·šä½ˆå±€ (1) å®Œæ•´ä»‹ç´¹èˆ‡ç¯„ä¾‹","text":"CSS Grid ä½ˆå±€ç³»çµ±èƒ½å¤ å¹«åŠ©æˆ‘å€‘è¼•é¬†æ§åˆ¶ç¶²æ ¼ä¸­å…ƒç´ ä½ç½®å’Œå¤§å°ï¼Œè·Ÿ Flex æ¯”è¼ƒï¼š Flexï¼šä¸€ç¶­ä½ˆå±€ç³»çµ±ï¼Œä¸»è¦ç”¨æ–¼å–®è¡Œæˆ–æ˜¯å–®åˆ—çš„å°é½Šè·Ÿæ’åˆ— Gridï¼šäºŒç¶­ç¶²æ ¼ç³»çµ±ï¼Œæä¾›æ›´è±å¯Œéˆæ´»çš„ä½ˆå±€æ§åˆ¶ï¼ŒåŒæ™‚æ“æ§ã€Œæ¬„ï¼ˆcolumnï¼‰ã€è·Ÿã€Œåˆ—ï¼ˆrowï¼‰ã€ï¼Œé©åˆç”¨æ–¼è¤‡é›œåº¦é«˜çš„ç¶²é ç‰ˆå‹ å¸¸ç”¨å±¬æ€§å¤–å±¤å®¹å™¨ displayï¼šå®šç¾©å®¹å™¨é¡å‹ï¼ˆgrid / inline-grid / subgridï¼‰ grid-template-columnsï¼šå®šç¾©ç¶²æ ¼æ¬„çš„å¤§å°å’Œæ•¸é‡ grid-template-rowsï¼šå®šç¾©ç¶²æ ¼åˆ—çš„å¤§å°å’Œæ•¸é‡ grid-gap / grid-column-gap / grid-row-gapï¼šè¨­å®šç¶²æ ¼é–“çš„é–“è· grid-template-areasï¼šå®šç¾©ç¶²æ ¼ç©ºé–“ä½ç½®ï¼Œç”±å–®å€‹æˆ–æ•¸å€‹å­—ä¸²çµ„æˆï¼Œæ­é… grid-area ä½¿ç”¨ justify-items / align-items / place-itemsï¼šå®šç¾©æ‰€æœ‰å…ƒç´ çš„å°é½Šæ–¹å¼ï¼ŒåŒ flex ç”¨æ³• å…§å±¤å…ƒç´  grid-column / grid-column-start / grid-column-endï¼šæ§åˆ¶å…ƒç´ åœ¨ç¶²æ ¼ä¸­æ‰€ä½”æ¬„ç©ºé–“ä½ç½® grid-row / grid-row-start / grid-row-endï¼šæ§åˆ¶å…ƒç´ åœ¨ç¶²æ ¼ä¸­æ‰€ä½”åˆ—ç©ºé–“ä½ç½® grid-areaï¼šå®šç¾©å…ƒç´ ç©ºé–“åç¨±ï¼Œæ­é… grid-template-areas ä½¿ç”¨ justify-self / align-self / place-selfï¼šå®šç¾©å–®ä¸€å…ƒç´ çš„å°é½Šæ–¹å¼ï¼ŒåŒ flex ç”¨æ³• å…ƒç´ è‡ªå‹•ä½ˆå±€ grid-auto-columnsï¼šå®šç¾©é è¨­æ¬„çš„å¤§å° grid-auto-rowsï¼šå®šç¾©é è¨­åˆ—çš„å¤§å° grid-auto-flowï¼šæ§åˆ¶è‡ªå‹•ä½ˆå±€çš„æ–¹å‘å’Œé †åº grid-template-columns / grid-template-rows / grid-column / grid-rowå¤–å±¤å®¹å™¨ &lt;div class=\"container\"&gt; ... &lt;/div&gt; grid-template-columns èˆ‡ grid-template-rows å¯ä»¥æŒ‡å®šç·šæ®µåç¨±ï¼ˆç”¨ [] è¡¨ç¤ºï¼‰ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œé è¨­æœƒå¾ 1 é–‹å§‹ç·¨è™Ÿï¼Œå¦‚æœè¼¸å…¥ -1ï¼Œå‰‡æœƒå¾æœ€å¾Œä¸€æ¢ç·šé–‹å§‹ç®—èµ· .container { display: grid; grid-template-columns: 100px 150px 150px auto; grid-template-rows: [start] 75px [line-2] 150px [line-3] 25% [end]; grid-gap: 5px;} ä¸€æ¢ç·šæ®µå¯ä»¥çµ¦å®šå¤šå€‹åç¨± .container { grid-template-rows: [start line-1] 75px [line-2] 150px [line-3] 25% [end line-4];} å¦‚æœæœ‰é€£çºŒé‡è¤‡å¯¬ / é«˜ï¼Œå¯ä»¥ä½¿ç”¨ repeat(count, value) ç°¡åŒ– .container { grid-template-columns: 100px repeat(2, 150px) auto;} æ­é… minmax(min-value, max-value) å‡½å¼ï¼Œè¨­å®šç¯„åœæœ€å¤§èˆ‡æœ€å°å€¼ï¼Œé”æˆè‡ªé©æ‡‰ç©ºé–“æ•ˆæœ .container { grid-template-columns: repeat(2, minnax(300px, 50%));} é™¤äº†ä¸Šè¿°ç¯„ä¾‹çš„å–®ä½ï¼Œä¹Ÿèƒ½é‹ç”¨ frï¼ˆfractionï¼‰å–®ä½ä¾†åˆ†é…ç©ºé–“ï¼Œfr å–®ä½ç”¨æ–¼å°‡å¯ç”¨ç©ºé–“åˆ†ç‚ºç›¸å°æ¯”ä¾‹ï¼Œèƒ½å¤ è‡ªé©æ‡‰å®¹å™¨è®ŠåŒ–ã€‚ ä»¥ä¸‹ç‚ºä¾‹ï¼šå‡è¨­ç›®å‰å®¹å™¨å¯¬ 500pxï¼Œæ‰£æ‰ 100pxï¼Œå®¹å™¨å…§å¯ç”¨ç©ºé–“ç‚º 400pxï¼Œå…±é…ç½®äº† 4frï¼Œå› æ­¤ 1fr å¯ä»¥åˆ†åˆ° 100px .container { grid-template-columns: 1fr 2fr 100px 1fr;} å…§å±¤å…ƒç´  &lt;div class=\"container\"&gt; &lt;div class=\"item-a\"&gt;&lt;/div&gt; &lt;div class=\"item-b\"&gt;&lt;/div&gt; &lt;div class=\"item-c\"&gt;&lt;/div&gt; &lt;div class=\"item-d\"&gt;&lt;/div&gt;&lt;/div&gt; grid-column / grid-row å¯ä»¥å¸¶å…¥ä»¥ä¸‹å€¼ï¼š lineï¼šç·šæ®µç·¨è™Ÿ span ï¼šå…ƒç´ ä½”æ¬„ä½æ•¸ span ï¼šå…ƒç´ æ‰€åœ¨æ ¼ç·šåç¨± autoï¼šè‡ªå‹• .item-a { grid-column-start: 1; grid-column-end: 3; grid-row-start: start; grid-row-end: line-2;}.item-b { grid-column: 1 / 2; // åˆä½µ grid-column-start &amp; grid-column-end grid-row: line-2 / line-3; // åˆä½µ grid-row-start &amp; grid-row-end}.item-c { grid-column: 2 / span 3; grid-row: line-2 / span 1;}.item-d { grid-column: 1 / -1; grid-row: line-3;} grid-template-areas / grid-areaså¤–å±¤å®¹å™¨ï¼‹å…§å±¤å…ƒç´  .container { display: grid; grid-template-columns: 100px 150px 150px auto; grid-template-rows: [start] 75px [line-2] 150px [line-3] 25% [end]; grid-gap: 5px; grid-template-area: \"header header . .\" \"sidebar content content content\" \"footer footer footer footer\";}.item-a { grid-area: header;}.item-b { grid-area: sidebar;}.item-c { grid-area: content;}.item-d { grid-area: footer;} justify-items / align-items / justify-self / align-selfç”¨æ–¼æ§åˆ¶å…§å±¤å…ƒç´ åœ¨å®¹å™¨ä¸­çš„å°é½Šæ–¹å¼ï¼Œèˆ‡ flex ç”¨æ³•ç›¸åŒï¼Œæ²’æœ‰å®šç¾©æ™‚é è¨­ç‚º stretch ï¼ˆå¡«æ»¿å®¹å™¨ï¼‰ å…ƒç´ è‹¥æœªå®šç¾©ä½ç½®ï¼Œé è¨­æœƒæ˜¯ç”±å·¦è‡³å³ï¼Œç”±ä¸Šè‡³ä¸‹é †æ’ï¼Œä¸€å€‹å…ƒç´ ä½”ä¸€å€‹ç¶²æ ¼ä½ç½® å¤–å±¤å®¹å™¨çµ±ä¸€å®šç¾© align-items justify-items place-itemsï¼šåˆä½µ align-items èˆ‡ justify-items .container { justify-items: start; align-items: stretch;} ç­‰åŒæ–¼ .container { place-items: stretch start;} å…§å±¤å…ƒç´ å€‹åˆ¥å®šç¾© align-self justify-self place-selfï¼šåˆä½µ align-self èˆ‡ justify-self .item-a { justify-self: start; align-self: start;}.item-b { justify-self: center; align-self: stretch;}.item-c { justify-self: stretch; align-self: center;}.item-d { place-self: end stretch; // åˆä½µå¯«æ³•} grid-auto-columns / grid-auto-rows / grid-auto-flowsç•¶é€éå…§å±¤å…ƒç´ æ•¸é‡è¶…éé å…ˆå®šç¾©çš„ç¶²æ ¼æ•¸é‡ï¼Œæˆ–æ˜¯å…ƒç´ è¶…å‡ºç¶²æ ¼å¤–ï¼Œgrid-auto-columns / grid-auto-rows å¯ä»¥å”åŠ©æˆ‘å€‘è‡ªå‹•å®šç¾©æ¬„æˆ–åˆ—çš„å°ºå¯¸ï¼Œç¯„ä¾‹èªªæ˜ï¼š &lt;div class=\"container\"&gt; &lt;div class=\"item\"&gt;1&lt;/div&gt; &lt;div class=\"item\"&gt;2&lt;/div&gt; ... &lt;div class=\"item\"&gt;16&lt;/div&gt;&lt;/div&gt; .container { grid-template-columns: repeat(4, 100px); grid-template-rows: repeat(2, 50px);} æœªå®šç¾©å‰ï¼Œç•«é¢å‘ˆç¾å¦‚ä¸‹ï¼š åŠ å…¥ grid-auto-columns èˆ‡ grid-auto-rows .container { grid-template-columns: repeat(4, 100px); grid-template-rows: repeat(2, 50px); grid-auto-columns: 100px; grid-auto-rows: 50px;} ç•«é¢å‘ˆç¾å¦‚ä¸‹ï¼š grid-auto-flow ç”¨ä¾†è‡ªå‹•å®šç¾©ç¶²æ ¼å…§å…ƒç´ çš„æ’åˆ—æ–¹å¼ï¼Œé è¨­å€¼ç‚º rowï¼Œä»¥ä¸Šé¢ç¯„ä¾‹ä½œç‚ºå»¶ä¼¸ .container { grid-auto-flow: column;} ç•«é¢å‘ˆç¾å¦‚ä¸‹ï¼š å®Œæ•´ç¯„ä¾‹ç¨‹å¼ç¢¼ See the Pen CSS Grid Layout Guide by Claire Chang (@claire-chang-the-bashful) on CodePen. åƒè€ƒæ–‡ç« ï¼š https://css-tricks.com/snippets/css/complete-guide-grid/https://www.casper.tw/css/2017/03/22/css-grid-layout/https://ithelp.ithome.com.tw/articles/10268087","link":"/2023/05/19/css/css-grid-layout/"},{"title":"CSS Grid Layout Module æ ¼ç·šä½ˆå±€ (2) Masonry ç€‘å¸ƒæµæ‡‰ç”¨","text":"ä¸Šä¸€ç¯‡æ–‡ç«  ä»‹ç´¹äº† CSS Gridï¼Œæ¥ä¸‹ä¾†é‹ç”¨ç¶²æ ¼ç³»çµ±ä¾†å¯¦ä½œç€‘å¸ƒæµç‰ˆé¢ã€‚ ç€‘å¸ƒæµï¼ˆWaterfall Flowï¼‰æ˜¯ä¸€ç¨®ç¶²é ä½ˆå±€çš„è¨­è¨ˆæ–¹å¼ã€‚ç€‘å¸ƒæµçš„ç‰¹é»æ˜¯å°‡å…§å®¹é …ç›®å‚ç›´æ’åˆ—ï¼Œä¸¦æ ¹æ“šå¯ç”¨çš„ç©ºé–“é€²è¡Œè‡ªé©æ‡‰èª¿æ•´ï¼Œå½¢æˆåƒç€‘å¸ƒä¸€æ¨£çš„æµå‹•æ•ˆæœ ã€‚ ç€‘å¸ƒæµä½ˆå±€ä¸­ï¼Œæ¯å€‹å…ƒç´ çš„å¯¬åº¦é€šå¸¸æ˜¯å›ºå®šçš„ï¼Œä½†é«˜åº¦æœƒæ ¹æ“šå…§å®¹çš„å¤§å°è®ŠåŒ–ã€‚é€™æ¨£å¯ä»¥ä½¿å…ƒç´ åœ¨å‚ç›´æ–¹å‘ä¸Šç·Šå¯†å †ç–Šï¼Œå¡«æ»¿å¯ç”¨ç©ºé–“ã€‚ç•¶ä¸€åˆ—çš„ç©ºé–“è¢«å¡«æ»¿å¾Œï¼Œä¸‹ä¸€å€‹å…ƒç´ æœƒè‡ªå‹•æ’åˆ—åˆ°ç©ºé–“è¼ƒå°‘çš„åˆ—ä¸­ï¼Œé”åˆ°å‡è¡¡çš„æ’ç‰ˆã€‚ é€é CSS Grid æˆ– Flexbox å¯ä»¥é”æˆç€‘å¸ƒæµä½ˆå±€çš„æ•ˆæœï¼Œæœ¬ç¯‡æœƒä½¿ç”¨ CSS Grid æ­é… JavaScript ä¾†å®Œæˆå¯¦ä½œã€‚ æœ¬ç¯‡ä½œæ³•ç„¡æ³•é”æˆè½‰å ´æ•ˆæœï¼Œå¦‚æœæƒ³è®“ç•«é¢è½‰æ›æ›´åŠ æµæš¢ï¼Œå¯ä»¥åƒè€ƒ é€™ç¯‡æ–‡ç« ï¼ˆmasonry-layout å¥—ä»¶é‹ç”¨ï¼‰ æ¦‚å¿µè§£æåˆ©ç”¨ CSS Grid æ ¼ç·šç³»çµ±ä¾†é”æˆç€‘å¸ƒæµçš„æ•ˆæœï¼š grid-auto-rows è¨­å®šåˆ—é«˜ grid-gap å»ºç«‹ç¶²æ ¼é–“è· åˆ©ç”¨ Javascript å–å¾—å…ƒç´ çš„é«˜åº¦ï¼Œä¸¦è¨ˆç®— grid-row-end å±¬æ€§ åˆ©ç”¨ç¶²æ ¼ç³»çµ±ï¼Œæ¯å€‹å…ƒç´ æœƒå»æ‰¾åˆ°ç©ºé–“ä½¿ç”¨æœ€å°‘çš„åˆ—ï¼Œä¸¦æ’åˆ—åœ¨å…¶å¾Œ æ ¼ç·šçš„çµæ§‹å¦‚ä¸‹åœ–ï¼š HTML å¤–å±¤å®¹å™¨ .container å…§å±¤å…ƒç´  .item &lt;ul class=\"container\"&gt; &lt;li class=\"item\"&gt; &lt;div class=\"content\"&gt; &lt;h3&gt;1.&lt;/h3&gt; Lorem ipsum dolor sit amet consectetur adipisicing elit. Ipsam voluptatibus hic laborum ea maiores, harum nobis. Placeat numquam ad laboriosam esse est porro, cum deserunt velit libero beatae quam necessitatibus. Iste sapiente commodi est labore amet quae rerum magni! Alias eum molestias sint nostrum optio ipsam quia delectus sunt. Rerum &lt;/div&gt; &lt;/li&gt; &lt;li class=\"item\"&gt; &lt;div class=\"content\"&gt; &lt;h3&gt;2.&lt;/h3&gt; Lorem ipsum dolor sit amet consectetur, adipisicing elit. Voluptatibus dolore natus ea &lt;/div&gt; &lt;/li&gt; ... &lt;li class=\"item\"&gt; &lt;div class=\"content\"&gt; &lt;h3&gt;16.&lt;/h3&gt; Lorem ipsum dolor sit amet consectetur, adipisicing elit. Sequi itaque veniam at labore consequuntur dicta adipisci ut laudantium deserunt &lt;/div&gt; &lt;/li&gt;&lt;/ul&gt; CSSå¤–å±¤å®¹å™¨ auto-fillï¼šæ­é… repeat(count, value) å‡½å¼ä½¿ç”¨ï¼Œæ ¹æ“šå¯ç”¨ç©ºé–“å¡«æ»¿æ¬„æˆ–åˆ— minmax(min-value, max-value)ï¼šæŒ‡å®šç¯„åœæœ€å°èˆ‡æœ€å¤§å€¼ï¼Œè‡ªå‹•èª¿æ•´æ¬„æˆ–åˆ—çš„å°ºå¯¸ .container { display: grid; grid-gap: 1rem; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); grid-auto-rows: 1rem;} å…§å±¤å…ƒç´  grid-row-endï¼šé€é Javascript å‹•æ…‹è¨ˆç®— Javascript rowHeightï¼šå–å¾— grid-auto-rows å€¼ rowGapï¼šå–å¾— grid-row-gap å€¼ é€é getBoundingClientRect().height å–å¾—å…ƒç´ çš„é«˜åº¦ åˆ©ç”¨ä»¥ä¸Šå€¼è¨ˆç®—å…ƒç´  grid-row-end: span &lt;number&gt;ï¼š è¡¨ç¤ºæ‰€ä½”åˆ—æ•¸ï¼Œæ ¹æ“šèµ·å§‹ä½ç½®å¾€å¾Œæ¨ç®— ç›£è½è¢å¹• resize äº‹ä»¶ï¼Œé‡æ–°è¨ˆç®—å…ƒç´ é«˜åº¦ getBoundingClientRect().height vs offsetHeightï¼šgetBoundingClientRect().height å–å¾—çš„æ˜¯ç›¸å°æ–¼è¢å¹•è¦–çª—çš„å¯è¦–é«˜ï¼ˆæ¸²æŸ“å¾Œçš„çµæœï¼‰ï¼Œè€Œ ****offsetHeight å–å¾—çš„æ˜¯å…ƒç´ å®Œæ•´é«˜ï¼ŒgetBoundingClientRect().height æœƒå—åˆ° transform å½±éŸ¿ï¼Œä¾‹å¦‚å…ƒç´ è¨­å®šé«˜åº¦ 100px ä»¥åŠ transform: scale(0.5);ï¼ŒgetBoundingClientRect().height å¾—åˆ° 50ï¼Œè€Œ offsetHeight å¾—åˆ°çš„æ˜¯ 100 const grid = document.querySelector(\".container\");const style = window.getComputedStyle(grid);const allItems = document.querySelectorAll(\".item\");const resizeGridItem = (item) =&gt; { rowHeight = parseInt(style.getPropertyValue(\"grid-auto-rows\")); rowGap = parseInt(style.getPropertyValue(\"grid-row-gap\")); rowSpan = Math.ceil((item.querySelector(\".content\").getBoundingClientRect().height + rowGap) / (rowHeight + rowGap)); item.style.gridRowEnd = `span ${rowSpan}`;}const resizeAllGridItems = () =&gt; { allItems.forEach(ele =&gt; { resizeGridItem(ele); });}window.onload = resizeAllGridItems();window.addEventListener(\"resize\", resizeAllGridItems); ç¯„ä¾‹ç¨‹å¼ç¢¼ See the Pen CSS Grid Layout Masonry by Claire Chang (@claire-chang-the-bashful) on CodePen. åƒè€ƒæ–‡ç« ï¼š https://css-tricks.com/piecing-together-approaches-for-a-css-masonry-layout/https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Grid_Layout/Masonry_Layouthttps://medium.com/@andybarefoot/a-masonry-style-layout-using-css-grid-8c663d355ebb","link":"/2023/05/23/css/css-grid-masonry/"},{"title":"CSS Grid Layout Module æ ¼ç·šä½ˆå±€ (3) Responsive Table éŸ¿æ‡‰å¼è¡¨æ ¼æ‡‰ç”¨","text":"åœ¨éŸ¿æ‡‰å¼ç¶²é è¨­è¨ˆä¸­ï¼Œå¸¸éœ€è¦è™•ç†ä¸åŒè£ç½®é–“ç‰ˆé¢çš„åˆ‡æ›ï¼Œä»¥è¡¨æ ¼ç‚ºä¾‹ï¼šåœ¨æ¡Œæ©Ÿä¸Šç”¨è¡¨æ ¼å‘ˆç¾å…§å®¹ï¼Œè€Œåœ¨è¡Œå‹•è£ç½®ä¸Šä½¿ç”¨å¡ç‰‡å¼ç‰ˆé¢ï¼Œé€™æ¨£çš„è¨­è¨ˆå„ªåŒ–èƒ½å¤ æå‡ä½¿ç”¨è€…åœ¨ä¸åŒè£ç½®ä¸Šçš„ç€è¦½é«”é©—ã€‚ ç‚ºäº†é”æˆé€™ç¨®å„ªåŒ–ï¼Œæœ‰ä»¥ä¸‹å¹¾ç¨®åšæ³•ï¼š è£½ä½œå…©å€‹ç‰ˆé¢ï¼Œåˆ©ç”¨æ–·é»ä¾†é€²è¡Œç‰ˆé¢åˆ‡æ› è£½ä½œä¸€å€‹å…±ç”¨ç‰ˆé¢ï¼Œæ­é… CSS Grid Layout é€²è¡Œè¨­è¨ˆï¼Œåœ¨æ‰‹æ©Ÿç‰ˆæ™‚èª¿æ•´ &lt;table&gt; çš„å±¬æ€§ï¼Œé”æˆå¡ç‰‡çš„è¦–è¦ºæ•ˆæœ æœ¬ç¯‡ä»‹ç´¹ç¬¬äºŒå€‹åšæ³•ï¼Œé€™éº¼åšå¯ä»¥é™ä½ç¨‹å¼ç¢¼çš„è¤‡é›œåº¦ï¼Œæå‡ç¨‹å¼ç¢¼å¯é‡ç”¨æ€§ï¼Œå°ˆæ¡ˆç¶­è­·æ€§ä¹Ÿè¼ƒé«˜ã€‚ CSS Grid ç›¸é—œçŸ¥è­˜ï¼Œå¯ä»¥åƒè€ƒ é€™ç¯‡æ–‡ç«  æ¦‚å¿µè§£æä½¿ç”¨ &lt;table&gt; å»ºç«‹è¡¨æ ¼ï¼Œåœ¨è¡Œå‹•è£ç½®æ–·é»ï¼Œå°‡ &lt;tr&gt; è¨­å®šç‚º display: gridï¼Œåˆ©ç”¨æ ¼ç·šç³»çµ±é”æˆå¡ç‰‡å¼ç‰ˆé¢ HTML&lt;table&gt; &lt;thead&gt; &lt;tr&gt; &lt;th scope=\"col\"&gt;#&lt;/th&gt; &lt;th scope=\"col\"&gt;Product&lt;/th&gt; &lt;th scope=\"col\"&gt;Ingredient&lt;/th&gt; &lt;th scope=\"col\"&gt;Price&lt;/th&gt; &lt;th scope=\"col\"&gt;&lt;/th&gt; &lt;/tr&gt; &lt;/thead&gt; &lt;tbody&gt; &lt;tr&gt; &lt;td class=\"index\"&gt;1&lt;/td&gt; &lt;td class=\"product\"&gt;Apple Juice&lt;/td&gt; &lt;td class=\"ingredient\"&gt;Apple, Sugar, Water&lt;/td&gt; &lt;td class=\"price\"&gt;$ 100&lt;/td&gt; &lt;td class=\"add-btn\"&gt; &lt;button type=\"button\"&gt;Add&lt;/button&gt; &lt;/td&gt; &lt;/tr&gt; ... &lt;/tbody&gt;&lt;/table&gt; CSS è¨­å®šæ–·é»ç‚º W768ï¼ˆIpadï¼‰ ç•¶è¢å¹•è¦–çª—å°æ–¼ 768pxï¼Œtbody &gt; tr è¨­å®šç‚º display: gridï¼Œtd æ¬„ä½åˆ©ç”¨æ ¼ç·šç³»çµ±æ’ç‰ˆ table { width: 1000px; max-width: 100%; margin: 0 auto; white-space: nowrap; border-spacing: 5px;}@media screen and (max-width: 768px) { thead { display: none; } tbody &gt; tr { display: grid; grid-gap: 0.5rem; grid-template-columns: repeat(2, 1fr); grid-template-rows: repeat(3, auto); } .index { display: none; } .product { justify-self: start; margin-bottom: 0.5rem; } .ingredient { grid-column: 1; grid-row: 2; justify-self: start; } .price { grid-column: 1; grid-row: 3; justify-self: start; align-self: center; } .add-btn { grid-column: 2; grid-row: 3; justify-self: end; align-self: center; }} ç¯„ä¾‹ç¨‹å¼ç¢¼ See the Pen CSS Grid Responsive Table by Claire Chang (@claire-chang-the-bashful) on CodePen. åƒè€ƒè³‡æºï¼š https://adamlynch.com/flexible-data-tables-with-css-grid/https://codepen.io/gilli/pen/QVaWGR","link":"/2023/05/24/css/css-grid-responsive-table/"},{"title":"CSS åœ–ç‰‡è‡ªé©æ‡‰å®¹å™¨ï¼ˆobject-fit / background-imageï¼‰","text":"ç¶²é åˆ‡ç‰ˆä¸­å¾ˆå¸¸é‡åˆ°ä¸€å€‹å•é¡Œï¼šç•¶åœ–ç‰‡å¤§å°ä¸ä¸€è‡´æ™‚ï¼Œå¦‚ä½•è®“åœ–ç‰‡åœ¨ä¸è®Šå½¢çš„æƒ…æ³ä¸‹è‡ªé©æ‡‰å®¹å™¨å¤§å°ï¼Ÿåœ–ç‰‡è®Šå½¢ä¸åƒ…æœƒå½±éŸ¿ç¶²é çš„ç¾æ„Ÿå’Œè¦–è¦ºæ•ˆæœï¼Œç”šè‡³å½±éŸ¿ä½¿ç”¨è€…é–±è®€ã€‚æœ¬ç¯‡ä»‹ç´¹å…©å€‹æ–¹æ³•ä¾†è§£æ±ºé€™å€‹å•é¡Œ background-imageèƒŒæ™¯åœ–ç‰‡æ˜¯å¾ˆç°¡å–®æ”¯æ´åº¦é«˜çš„å¯«æ³•ï¼Œä½¿ç”¨ background-image å–ä»£ &lt;img&gt; åœ–ç‰‡æ¨™ç±¤ï¼Œä¸¦ä½¿ç”¨ background ç›¸é—œå±¬æ€§ä¾†èª¿æ•´åœ–ç‰‡ &lt;div class=\"background-image-container\"&gt;&lt;/div&gt; .background-image-container { width: 300px; height: 300px; background-image: url(\"https://i.imgur.com/W7xqcWS.jpg\"); background-size: cover; background-position: center;} ä½¿ç”¨ background-size: cover è®“åœ–ç‰‡è¦†è“‹æ•´å€‹å®¹å™¨ï¼Œä¸¦ä¿ç•™åœ–ç‰‡æ¯”ä¾‹ï¼Œä¸¦æ­é… background-position: center ç¢ºä¿åœ–ç‰‡ç½®ä¸­ï¼Œåœ–ç‰‡å‘ˆç¾èˆ‡è£åˆ‡å¦‚ä¸‹ï¼š object-fitæŸäº›æƒ…å¢ƒæˆ‘å€‘æœƒéœ€è¦ä½¿ç”¨ &lt;img&gt; åœ–ç‰‡æ¨™ç±¤ï¼Œåƒæ˜¯åœ–ç‰‡éœ€èƒ½è¢«æœå°‹å¼•æ“çˆ¬èŸ²è®€å–ï¼ˆéœ€è¦æœ‰ alt å±¬æ€§ï¼‰ï¼Œé€™æ™‚å°±å¯ä»¥é€é object-fit ä¾†é”æˆ object-fit é¸é … fillï¼šé è¨­æ•ˆæœï¼Œå…ƒç´ æœƒè¢«æ‹‰ä¼¸å¡«æ»¿å¤–å±¤å®¹å™¨ï¼Œé•·å¯¬æ¯”æœƒè¢«æ‰­æ›² containï¼šå…ƒç´ çš„é•·å¯¬æ¯”ä¸è®Šï¼Œæœ€å¤§é‚Šæœƒå¡«æ»¿å®¹å™¨ coverï¼šå…ƒç´ çš„é•·å¯¬æ¯”ä¸è®Šï¼Œæœ€å°é‚Šæœƒå¡«æ»¿å®¹å™¨ï¼Œä¹Ÿå°±æ˜¯å…ƒç´ å¯èƒ½æœƒè¢«è£åˆ‡ noneï¼šå…ƒç´ ç¶­æŒæœ¬èº«çš„å¤§å°å’Œé•·å¯¬æ¯”ï¼Œä¸æœƒè¢«èª¿æ•´ scale-downï¼šå…ƒç´ ç¶­æŒæœ¬èº«çš„å¤§å°å’Œé•·å¯¬æ¯”ï¼Œä½†å¦‚æœå¤§æ–¼å®¹å™¨ï¼Œæœƒè¢«ç¸®å°é©æ‡‰å®¹å™¨ &lt;div class=\"object-fit-container\"&gt; &lt;img src=\"https://i.imgur.com/W7xqcWS.jpg\" alt=\"landscape\" /&gt;&lt;/div&gt; .object-fit-container { width: 300px; height: 300px; img { object-fit: cover; width: 100%; height: 100%; }} width è·Ÿ height ç”¨ä¾†è¨­å®šåœ–ç‰‡éœ€è¦è¢«å¡«æ»¿çš„ç¯„åœï¼Œå¦å¤–ä¹Ÿå¯ä»¥é€é object-position ä¾†èª¿æ•´åœ–ç‰‡çš„ä½ç½®ï¼ˆé è¨­æ˜¯ç½®ä¸­ï¼‰ ç¯„ä¾‹ç¨‹å¼ç¢¼ See the Pen css image fit container by Claire Chang (@claire-chang-the-bashful) on CodePen. åƒè€ƒæ–‡ç« ï¼š https://ithelp.ithome.com.tw/articles/10250499https://www.casper.tw/development/2020/10/11/img-cover/","link":"/2023/05/10/css/css-object-fit/"},{"title":"TypeScript å­¸ç¿’ç­†è¨˜ï¼šåŸºæœ¬ä»‹ç´¹èˆ‡å‹åˆ¥","text":"çœ¾æ‰€çš†çŸ¥ JavaScript æ˜¯å¼±å‹åˆ¥ï¼ˆWeak Typingï¼‰çš„èªè¨€ï¼Œå› æ­¤å¸¸æœƒç™¼ç”Ÿè³¦å€¼éŒ¯èª¤å°è‡´ç·¨è­¯å‡ºéŒ¯ï¼ŒTypeScript å¯è¦–ç‚ºé€²éšç‰ˆ JavaScriptï¼Œæä¾›éœæ…‹å‹åˆ¥å®šç¾©å’Œæª¢æŸ¥ï¼Œç›®æ¨™æ˜¯è®“é–‹ç™¼è€…åœ¨ç·¨å¯« JavaScript æ™‚æ“æœ‰æ›´å¥½çš„é–‹ç™¼é«”é©—å’Œæ›´é«˜çš„ç¨‹å¼ç¢¼å¯è®€æ€§ï¼Œæå‡å°ˆæ¡ˆç©©å®šåº¦ã€‚ åŸºæœ¬èªªæ˜ TypeScript æ˜¯åŸºæ–¼ JavaScript çš„è¶…é›†åˆï¼ˆSuperSetï¼‰ï¼Œæä¾›å‹åˆ¥ç³»çµ±ï¼ˆType Systemï¼‰ï¼Œèƒ½å¤ åœ¨é–‹ç™¼æ™‚å®£å‘Šå‹åˆ¥ å¿…é ˆç·¨è­¯æˆ JavaScript æª”æ¡ˆï¼Œç€è¦½å™¨ã€å¾Œç«¯æ¡†æ¶ã€Node.js ç’°å¢ƒâ€¦æ‰èƒ½é–±è®€ é¡å‹çš„å®šç¾©å¯ä»¥æ¸›å°‘ bugï¼Œèƒ½åœ¨ç·¨è­¯å‰é å…ˆæª¢æŸ¥ï¼Œé¿å…è¨±å¤šé‹ç®—éŒ¯èª¤ TypeScript åªæœƒé€²è¡Œéœæ…‹æª¢æŸ¥ï¼Œç·¨è­¯æ™‚å³ä½¿å ±éŒ¯ï¼Œé‚„æ˜¯æœƒç”¢ç”Ÿç·¨è­¯çµæœï¼Œä»ç„¶å¯ä»¥ä½¿ç”¨ç·¨è­¯å¾Œçš„ JavaScript æª” ç’°å¢ƒå»ºç½®èˆ‡ç›¸é—œæŒ‡ä»¤ å®‰è£ TypeScriptï¼šnpm install -g typescript é€²å…¥å°ˆæ¡ˆè³‡æ–™å¤¾ï¼Œè¼¸å…¥ tsc â€”-init å»ºç«‹ tsconfig.json è¨­å®š rootDir ï¼†outDir è·¯å¾‘ é–‹å•Ÿ inlineSourceMap: true tscï¼šå°‡æŒ‡ä»¤è·¯å¾‘ rootDir å…§æ‰€æœ‰ .ts æª”ç·¨è­¯ç‚º .js æª”å­˜æ”¾æ–¼ outDir tsc fileName.ts ï¼šå°‡æŒ‡å®šè·¯å¾‘ rootDir å…§ fileName.ts æª”ç·¨è­¯ç‚º fileName.js tsc â€”-watchï¼šé€²è¡Œå‹•æ…‹ç›£è½ åŸå§‹è³‡æ–™å‹åˆ¥ï¼ˆPrimitive Data Typesï¼‰ String å­—ä¸²å‹åˆ¥ï¼šconst str: string = 'hello' Number æ•¸å­—å‹åˆ¥ï¼ŒåŒ…æ‹¬æ•´æ•¸å’Œæµ®é»æ•¸ï¼šconst num: number = 1000 Boolean å¸ƒæ—å‹åˆ¥ï¼šconst boo: boolean = true Nullï¼šconst n: null = null Undefinedï¼šconst un: undefined = undefined Symbolï¼šES6 æ–°å‹åˆ¥ï¼Œæ˜¯ä¸€å€‹å”¯ä¸€ä¸”ä¸å¯è®Šçš„å€¼ï¼Œä½¿ç”¨ Symbol() å‡½æ•¸ä¾†å»ºç«‹ä¸€å€‹ Symbol å€¼ï¼Œå¯ä»¥åƒè€ƒ é€™ç¯‡æ–‡ç«  ç‰©ä»¶å‹åˆ¥ï¼ˆObject Typesï¼‰ Object ç‰©ä»¶å‹åˆ¥ const obj: Object = { name: 'Claire', age: 18 }const obj2: { name: string, age: number } = { name: 'Claire', age: 18 } Array é™£åˆ—å‹åˆ¥ ä½¿ç”¨å‹åˆ¥æ­é…ä¸­æ‹¬è™Ÿ [] è¡¨ç¤ºæ³• const arr: number[] = [ 111, 222 ];const arr2: string[][] = [ [ 'a' ], [ 'b' ] ]; æˆ–æ˜¯é™£åˆ—æ³›å‹ï¼ˆArray Genericï¼‰Array&lt;type&gt; è¡¨ç¤ºæ³• const arr3: Array&lt;boolean&gt; = [ true, false ]; Function å‡½å¼å‹åˆ¥ function hello(a: string, b: string) { return a + b;}function hello2(a: number, b: number): number { return a + b;}// hoveræç¤ºï¼šfunction hello3(a: number, b: boolean, c: string): numberfunction hello3(a: number, b: boolean, c: string) { return 10000000;}// hoveræç¤ºï¼šfunction hello4(name: string, age?: number): number | undefinedfunction hello4(name: string, age?: number) { return age;} ã€é¸å¡«ã€çš„åƒæ•¸å¦‚æœæ²’åŠ ä¸Šåˆ¤æ–·æœƒæ‹‹éŒ¯ï¼Œå› åƒæ•¸æœ‰å¯èƒ½ç‚º undefined ï¼Œè¦‹ä»¥ä¸‹ç¯„ä¾‹ function hello4(name: string, age?: number) { return age + 1; // 'age' is possibly 'undefined'.} é ˆåŠ ä¸Šåˆ¤æ–·æ¢ä»¶ï¼Œæ”¹å¯«å¦‚ä¸‹ function hello4(name: string, age?: number) { if (age === undefined) { return 1; } return age + 1;} TypeScript ç‰¹æœ‰å‹åˆ¥ Any ä»»æ„å‹åˆ¥ï¼Œç­‰åŒæ–¼ä¸å®šç¾©å‹åˆ¥ï¼Œå¯ä»¥è³¦å€¼çµ¦ä»»ä½•å‹åˆ¥ let anyVar: any = true;anyVar = 18;anyVar = 'hello';let str: string;str = anyVar; Unknownï¼šé¡ä¼¼ any å‹åˆ¥ï¼Œä½† any å¯ä»¥è³¦å€¼çµ¦ä»»ä½•å‹åˆ¥ï¼Œunknown åªèƒ½è³¦å€¼çµ¦ any å’Œè‡ªå·± let unknownVar: unknown = true;unknownVar = 18;unknownVar = 'hello';let str: string;str = unknownVar; // Type 'unknown' is not assignable to type 'string'let anyVar: any;anyVar = unknownVar; Neverï¼šå‡½å¼ç™¼ç”Ÿç„¡çª®è¿´åœˆï¼Œæˆ–æ˜¯å‡ºç¾ä¾‹å¤–ç‹€æ³æ‹‹éŒ¯èª¤ function throwError(): never { throw new Error('error');} Void ç©ºå€¼ï¼šé€šå¸¸ç”¨æ–¼è¡¨ç¤ºå‡½å¼æ²’æœ‰å›å‚³å€¼ function hello(a: string, b: string): void { alert(a + b);}// hoveræç¤ºï¼šfunction hello2(a: number, b: number): voidfunction hello2(a: number, b: number) { console.log(a + b);} ç€è¦½å™¨ DOM èˆ‡ BOM å‹åˆ¥ HTMLElementï¼šæ‰€æœ‰ HTML å…ƒç´ çš„åŸºæœ¬å‹åˆ¥ï¼ŒåŒ…å« &lt;div&gt;ã€&lt;p&gt;ã€&lt;span&gt; â€¦ HTMLInputElementï¼šä»£è¡¨ &lt;input&gt; å…ƒç´  HTMLTextAreaElementï¼šä»£è¡¨ &lt;textarea&gt; å…ƒç´  HTMLAnchorElementï¼šä»£è¡¨ &lt;a&gt; å…ƒç´  HTMLFormElementï¼šä»£è¡¨ &lt;form&gt; å…ƒç´  HTMLSelectElementï¼šä»£è¡¨ &lt;select&gt; å…ƒç´  HTMLFormElementï¼šä»£è¡¨ &lt;form&gt; å…ƒç´  HTMLTableElementï¼šä»£è¡¨ &lt;table&gt; å…ƒç´  MouseEventï¼šä»£è¡¨æ»‘é¼ äº‹ä»¶ KeyboardEventï¼šä»£è¡¨éµç›¤äº‹ä»¶ inputEventï¼šä»£è¡¨è¼¸å…¥äº‹ä»¶ FocusEventï¼šä»£è¡¨ç„¦é»äº‹ä»¶ åƒè€ƒè³‡æºï¼š https://willh.gitbook.io/typescript-tutorial/basics/primitive-data-types https://www.youtube.com/watch?v=GinkGJZBHIY","link":"/2023/03/21/typescript/ts-about-types/"},{"title":"TypeScript å­¸ç¿’ç­†è¨˜ï¼šé€²éšæ‡‰ç”¨","text":"Type Inference å‹åˆ¥æ¨è«–å¦‚æœæ²’æœ‰æ˜ç¢ºçš„æŒ‡å®šå‹åˆ¥ï¼ŒTypeScript æœƒä¾ç…§ã€å‹åˆ¥æ¨è«–ã€çš„è¦å‰‡æ¨æ–·å‡ºå‹åˆ¥ // è‡ªå‹•åˆ¤å®š string å‹åˆ¥let num = 'hello';num = 777;// Type 'number' is not assignable to type 'string'. å¦‚æœå®šç¾©çš„æ™‚å€™æ²’æœ‰è³¦å€¼ï¼Œæœƒè¢«æ¨æ–·ç‚º any å‹åˆ¥ // è‡ªå‹•åˆ¤å®š any å‹åˆ¥let something;something = 777;something = '777'; Union Types è¯åˆå‹åˆ¥ä½¿ç”¨ | ç¬¦è™Ÿä¾†è¡¨ç¤ºå¤šç¨®å¯èƒ½çš„å‹åˆ¥ let price: number | string;price = 1000;price = '1000';price = true; // Type 'boolean' is not assignable to type 'string | number' Type å‹åˆ¥åˆ¥åtype A = number | string;type B = (param: string) =&gt; string;let a1: A;a1 = 999;a1 = '999';a1 = false; // Type 'boolean' is not assignable to type 'A' Interface ä»‹é¢å®šç¾©ç‰©ä»¶æˆ–é™£åˆ—çš„å‹åˆ¥ï¼Œè·Ÿä¸Šé¢ type åŠŸèƒ½é¡ä¼¼ï¼Œå·®åˆ¥åœ¨ interface å¯ä»¥ã€æ“´å……ã€ å±¬æ€§ä»‹ç´¹ å¯é¸å±¬æ€§ï¼šç¯„ä¾‹ isMale?: boolean ä»»æ„å±¬æ€§ï¼šç¯„ä¾‹ [ propName: string ]: any å”¯è®€å±¬æ€§ï¼šä½¿ç”¨ readonly å®šç¾©å”¯è®€å±¬æ€§ï¼Œè‹¥åˆå§‹åŒ–å¾Œå†æ¬¡è³¦å€¼æœƒå ±éŒ¯ interface User { readonly id: number; name: string; isMale?: boolean; [ propName: string ]: any;}// æ“´å……interface User { age: number}const obj: User = { id: 1, name: 'Claire', age: 18, isMale: false}obj.id = 2; // Cannot assign to 'id' because it is a read-only property ä¹Ÿå¯ä»¥ç”¨ä¾†è¡¨ç¤ºé™£åˆ— interface Users { [ index: number ]: string}const users: Users = [ 'Daniel', 'Claire', 'Andy', 'Avery' ]; æˆ–æ˜¯å®šç¾©å‡½å¼ interface SearchUser { (arr: string[], name: string): boolean}const searchName: SearchUser = function(arr: string[], name: string) { return arr.includes(name);}console.log(searchName([ 'Daniel', 'Claire' ], 'Daniel')); // output: true Tuple å…ƒçµ„å‹åˆ¥å®šç¾©é™£åˆ—å…ƒç´ æ•¸é‡ã€å‹åˆ¥ let tuple: [ number, string, boolean ] = [ 1, 'a', true ];let tuple2: [ string, string ][] = [ [ 'a', 'b' ] ]; Enum åˆ—èˆ‰å‹åˆ¥ç”¨æ–¼å®šç¾©ä¸€çµ„å‘½åå¸¸æ•¸çš„æ–¹æ³• enum Alert { success, warning, danger } åˆ—èˆ‰é …ç›®é è¨­æœƒå¾ 0 é–‹å§‹éå¢è³¦å€¼ï¼Œåˆ—èˆ‰ key è·Ÿå€¼æœƒåå‘å°æ˜  console.log(Alert.success); // output: 0console.log(Alert[1]); // output: warning ä¹Ÿå¯ä»¥æ‰‹å‹•è³¦å€¼ enum Alert { success = 1, warning = 0, danger = -1}console.log(Alert.success); // output: 1console.log(Alert[1]); // output: successconsole.log(Alert);// output:// {// 1: 'success',// 0: 'warning',// -1: 'danger',// success: 1,// warning: 0,// danger: -1// } æˆ–ä½¿ç”¨éæ•¸å­—ï¼Œå¿…é ˆä½¿ç”¨æ–·è¨€ä¾†ç•¥éå‹åˆ¥æª¢æŸ¥ enum Alert { success = 'green' as any, warning = 'yellow' as any, danger = 'red' as any}console.log(Alert.green); // output: success Generics æ³›å‹åœ¨å‡½å¼æˆ–æ˜¯ class å¾Œé¢åŠ ä¸Š &lt;T&gt; æˆ–æ˜¯ &lt;Type&gt; è¡¨ç¤ºå‹•æ…‹å‹åˆ¥ï¼ˆåç¨±è‡ªè¨‚ï¼‰ï¼Œæ–¼èª¿ç”¨æ™‚å°‡å‹åˆ¥å‚³å…¥ï¼Œè®“å‹åˆ¥æ›´åŠ éˆæ´» function print&lt;T&gt;(data: T) { console.log(data);}print&lt;number&gt;(999); // output: 999print&lt;string&gt;('1000'); // output: '1000'class Print&lt;T&gt; { data: T constructor(d: T) { this.data = d; }}const p = new Print&lt;number&gt;(1000);const p2 = new Print&lt;boolean&gt;(true);console.log('p', p); // output: Print { data: 1000 }console.log('p2', p2); // output: Print { data: true } Type Assertion å‹åˆ¥æ–·è¨€æ‰‹å‹•æŒ‡å®šå‹åˆ¥ï¼Œä¸¦ä¸æœƒå½±éŸ¿å‹åˆ¥è½‰æ› ç¯„ä¾‹ä¸€ï¼š const user = { name: 'Claire', age: 20, gender: 'female'}function userInfo(param: string) { return user[param]; // Element implicitly has an 'any' type because expression of type 'string' can't be used to index type '{ name: string; age: number; gender: string; }'.} å›  param æœ‰å¯èƒ½ä¸å­˜åœ¨ user key å€¼ï¼Œå› æ­¤æ‹‹éŒ¯ï¼Œå¯ä»¥åŠ ä¸Šæ–·è¨€å¦‚ä¸‹ function userInfo(param: string) { return user[param as keyof typeof user];} ç¯„ä¾‹äºŒï¼š function toBoolean(something: string | number): boolean { return something; // Type 'string | number' is not assignable to type 'boolean'.} ç›´æ¥èª¿æ•´æˆ as boolean ä¾èˆŠæœƒæ‹‹éŒ¯ function toBoolean(something: string | number): boolean { return something as boolean; // Conversion of type 'string | number' to type 'boolean' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.} å› ç‚º something é å…ˆè¢«å®šç¾©ç‚º string | numberï¼Œè·Ÿ boolean æ²’æœ‰é—œè¯ï¼Œå¿…é ˆå…ˆæ–·è¨€æˆ unknown function toBoolean(something: string | number): boolean { return something as unknown as boolean;}console.log(toBoolean(123)); // output: 123 å‰é¢æåˆ°æ–·è¨€ä¸æœƒé€²è¡Œå‹åˆ¥è½‰å‹ï¼Œå› æ­¤çµæœä¸¦ä¸æœƒè®Šæˆ boolean ES6 Class èˆ‡å»ºæ§‹å‡½å¼å¦‚æœå° ES6 Class å°šä¸ç†Ÿæ‚‰ï¼Œå¯ä»¥åƒè€ƒ é€™ç¯‡æ–‡ç«  TypeScript Class ä¿®é£¾ç¬¦ publicï¼šå…¬æœ‰çš„ï¼Œå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨ï¼Œé è¨­å±¬æ€§è·Ÿæ–¹æ³•çš†ç‚º public privateï¼šç§æœ‰çš„ï¼Œä¸èƒ½åœ¨é¡åˆ¥çš„å¤–éƒ¨èª¿ç”¨ï¼ˆex: new å¯¦é«”æˆ–æ˜¯ extends ç¹¼æ‰¿ï¼‰ protectedï¼šå—ä¿è­·çš„ï¼Œextends ç¹¼æ‰¿å¯ä»¥èª¿ç”¨ï¼Œä½† new å¯¦é«”ä¸èƒ½èª¿ç”¨ public &amp; protected åªå­˜åœ¨æ–¼ typescriptï¼Œé€šå¸¸ä½¿ç”¨æ–¼é–‹æ³•éšæ®µï¼ˆé¿å…å…±åŒé–‹ç™¼æ™‚ç•°å‹•åˆ°ç¨‹å¼ç¢¼ï¼‰ï¼Œç·¨è­¯æˆ javascript å¾Œæ²’ä»€éº¼ä½œç”¨ï¼Œå›  js ä¸å­˜åœ¨é€™å…©å€‹é¡å‹ class Live { public roomName: string private id: string protected name: string constructor(roomName1: string, id1: string, name1: string) { console.log('å»ºç«‹ç›´æ’­ä¸­...'); this.roomName = roomName1; this.id = id1; this.name = name1; }}const live = new Live('no.1', '00001', 'Daniel');console.log(live); // output: Live { roomName: 'no.1', id: '00001', name: 'Daniel' } å¦‚æœéœ€è¦ä½¿ç”¨ç§æœ‰è®Šæ•¸ï¼Œå¯ä»¥æ”¹ç”¨ javascript çš„è®Šæ•¸å‰ç¶´ # class Live2 { // js ç§æœ‰è®Šæ•¸ #name constructor(name: string) { this.#name = name; }}const live2 = new Live2('Daniel');console.log(live2); // output: Live2 {} Class &amp; Interface å› é¡åˆ¥å¯ä»¥ç¹¼æ‰¿å…¶ä»–é¡åˆ¥ï¼Œæœ‰æ™‚é¡åˆ¥é–“æœ‰å…±åŒçš„ç‰¹æ€§ï¼Œå¯ä»¥æå–å‡ºä¾†ä½œç‚ºä»‹é¢å…±ç”¨ï¼ˆå°é¡åˆ¥çš„ä¸€éƒ¨åˆ†è¡Œç‚ºé€²è¡ŒæŠ½è±¡ï¼‰ï¼Œä¸¦ç”¨ implements ä¾†å¯¦ç¾ interface Eat { eat(): string;}class Animal { name: string; constructor(name: string) { this.name = name; }}class Person extends Animal implements Eat { constructor(name: string) { super(name); this.name = name; } eat() { return `${this.name} is eating food`; }}const daniel = new Person('Daniel');console.log(daniel.eat()); // output: Daniel is eating food å¯ä»¥ä¸€æ¬¡å¯¦ç¾å¤šå€‹ä»‹é¢ class Person implements Eat, Sleep { ...} ä¹Ÿå¯ä»¥ä»‹é¢ç¹¼æ‰¿ä»‹é¢ interface Animal { eat(): string;}interface Dog extends Animal { bark(): string;}const Coco: Dog = { eat() { return 'eating'; } bark() { return 'barking'; }} åƒè€ƒè³‡æºï¼š https://medium.com/enjoy-life-enjoy-coding/javascript-es6-ä¸­æœ€å®¹æ˜“èª¤æœƒçš„èªæ³•ç³–-class-åŸºæœ¬ç”¨æ³•-23e4a4a5e8ed https://www.youtube.com/watch?v=GinkGJZBHIY","link":"/2023/03/22/typescript/ts-advance/"},{"title":"TypeScript å­¸ç¿’ç­†è¨˜ï¼štsconfig.json ç·¨è­¯è¨­å®š","text":"tsconfig.json ç‚º TypeScript ç·¨è­¯å™¨çš„è¨­å®šæª”ï¼Œç”¨ä¾†é…ç½® TypeScript ç·¨è­¯å™¨çš„è¡Œç‚ºï¼Œç°¡å–®èªªæ˜è¨­å®šæª”å…§å®¹ ç’°å¢ƒå®‰è£ç”¢ç”Ÿ tsconfig.json æª”æ¡ˆ tsc --init è¨­å®šèªªæ˜compilerOptionsç‰©ä»¶ï¼Œå®šç¾©ç·¨è­¯å™¨çš„è¡Œç‚º å±¬æ€§ ä»‹ç´¹ é è¨­å€¼ å¯å¸¶å…¥å€¼ target æ¬²ç·¨è­¯çš„ JavaScript ç‰ˆæœ¬ es2016 ES3ã€ES5ã€ES6/ES2015ã€ES2016ã€ES2017ã€ES2018ã€ES2019ã€ES2020ã€ES2021 æˆ– ESNext lib ç·¨è­¯å™¨å¯ä»¥ä½¿ç”¨çš„æ¨™æº–åº« ç©ºå€¼ ES5ã€ES6ã€ES2015ã€ES2016ã€ES2017ã€ES2018ã€ES2019ã€ES2020ã€ES2021ã€ESNextã€DOMã€DOM.Iterableã€WebWorkerã€ScriptHostâ€¦ jsx æ”¯æ´ä½¿ç”¨ JSX èªæ³• preserve preserveã€reactã€react-jsx module ç”Ÿæˆçš„æ¨¡çµ„æ ¼å¼ commonjs monJSã€AMDã€SystemJSã€UMDã€ES6ã€ES2015 æˆ– ESNext rootDir ç·¨è­¯æ™‚çš„æ ¹ç›®éŒ„ ç©ºå€¼ çµ•å°è·¯å¾‘ã€ç›¸å°è·¯å¾‘ outDir ç·¨è­¯å¾Œæª”æ¡ˆå­˜æ”¾ä½ç½® ç©ºå€¼ çµ•å°è·¯å¾‘ã€ç›¸å°è·¯å¾‘ baseUrl æ¨¡çµ„è§£æçš„æ ¹ç›®éŒ„ . çµ•å°è·¯å¾‘ã€ç›¸å°è·¯å¾‘ paths å®šç¾©æ¨¡çµ„çš„è·¯å¾‘åˆ¥å ç©ºç‰©ä»¶ ç‰©ä»¶ allowJs æ˜¯å¦å…è¨±ç·¨è­¯ JavaScript æ–‡ä»¶ false boolean checkJs æ˜¯å¦æª¢æŸ¥ JavaScript æ–‡ä»¶å‹åˆ¥ false boolean declaration æ˜¯å¦ç”Ÿæˆç›¸å°æ‡‰çš„è£é£¾ï¼ˆ.d.tsï¼‰æ–‡ä»¶ false boolean sourceMap æ˜¯å¦ç”Ÿæˆç›¸å°æ‡‰çš„ .map æ–‡ä»¶ false boolean outFile ç·¨è­¯ç”Ÿæˆçš„ JavaScript ä»£ç¢¼åˆä½µåˆ°ä¸€å€‹æ–‡ä»¶ä¸­ ç©ºå€¼ çµ•å°è·¯å¾‘ã€ç›¸å°è·¯å¾‘ removeComments æ˜¯å¦ç§»é™¤è¨»è§£ false boolean noEmit æ˜¯å¦ä¸ç”Ÿæˆç·¨è­¯å¾Œçš„ JavaScript æ–‡ä»¶ false boolean strict æ˜¯å¦å•Ÿç”¨æ‰€æœ‰åš´æ ¼é¡å‹æª¢æŸ¥æ¨¡å¼ï¼Œç­‰æ–¼noImplicitAnyã€noImplicitThisã€alwaysStrictã€strictBindCallApplyã€strictNullChecksã€strictFunctionTypes å’Œ strictPropertyInitializationçš„è¨­å®šç‚ºtrue false boolean noImplicitAny æ˜¯å¦ç¦æ­¢ any å‹åˆ¥ false boolean noImplicitThis æ˜¯å¦ç¦æ­¢ this é—œéµå­—éš±å¼å‹åˆ¥ç‚º any false boolean alwaysStrict æ˜¯å¦åœ¨è¼¸å‡ºæ–‡ä»¶ä¸­åŒ…å« â€˜use strictâ€™ false boolean strictBindCallApply æ˜¯å¦åœ¨å‡½æ•¸ bindã€callã€apply çš„èª¿ç”¨ä¸­æª¢æŸ¥åƒæ•¸çš„é¡å‹ç¬¦åˆå‡½æ•¸çš„æœŸæœ›é¡å‹ false boolean strictNullChecks æ˜¯å¦é–‹å•Ÿåš´æ ¼çš„ç©ºå€¼æª¢æŸ¥ï¼ˆnull å’Œ undefinedï¼‰ false boolean strictFunctionTypes å‡½æ•¸é¡å‹åƒæ•¸çš„åƒæ•¸å’Œè¿”å›å€¼æ˜¯å¦ç²¾ç¢ºåŒ¹é… false boolean strictPropertyInitialization é¡æˆå“¡æ˜¯å¦é€²è¡Œåˆå§‹åŒ– false boolean experimentalDecorators æ˜¯å¦ä½¿ç”¨å¯¦é©—æ€§è£é£¾å™¨èªæ³• false boolean emitDecoratorMetadata å¦‚æœæœ‰ä½¿ç”¨è£é£¾å™¨ï¼Œæ˜¯å¦è¦ç”Ÿæˆè£é£¾å™¨æ•¸æ“š false boolean jsxFactory æŒ‡å®šä½¿ç”¨çš„ JSX å·¥å» å‡½æ•¸ï¼ˆTS 4.1+ï¼‰ ç©ºå€¼ è‡ªè¨‚ noLib ç·¨è­¯å¾Œçš„ä»£ç¢¼æ˜¯å¦æ’é™¤ TypeScript æ¨™æº–åº«çš„æ‰€æœ‰å®£å‘Šæ–‡ä»¶ false boolean esModuleInterop æ˜¯å¦å…¼å®¹ CommonJS module false boolean preserveSymlinks æ˜¯å¦ä¿ç•™ç¬¦è™Ÿé€£æ¥ false boolean skipLibCheck æ˜¯å¦è·³éæ¨™æº–åº«æª¢æŸ¥ false boolean noEmitOnError ç·¨è­¯å‡ºéŒ¯æ˜¯å¦åœæ­¢ç·¨è­¯æª”æ¡ˆ false boolean filesæŒ‡å®šæ¬²ç·¨è­¯ TypeScript æª”æ¡ˆï¼Œé™£åˆ—ï¼Œæ²’æœ‰å®šç¾©æ­¤å±¬æ€§é è¨­ç‚ºæ ¹ç›®éŒ„ä¸‹æ‰€æœ‰ .ts åŠ .tsx æª”æ¡ˆï¼Œå¯ä»¥ä½¿ç”¨çµ•å°è·¯å¾‘ã€ç›¸å°è·¯å¾‘ { \"files\": [ \"./src/index.ts\" ]} include &amp; excludeé™£åˆ—ï¼Œinclude æŒ‡å®šæ¬²ç·¨è­¯ TypeScript æª”æ¡ˆï¼Œexclude æŒ‡å®šä¸è¦è¢«ç·¨è­¯ TypeScript æª”æ¡ˆ å¯ä»¥è¼¸å…¥ç·¨è­¯çš„æª”æ¡ˆã€è³‡æ–™å¤¾æˆ–è€…é€šé…ç¬¦æ¨¡å¼ï¼ˆwildcard characterï¼‰ { \"include\": [ \"./src/test\" ], \"exclude\": [ \"./src/test/about.ts\" ]} filesã€includeã€exclude å„ªå…ˆæ¬Šï¼šfiles &gt; include &gt; exclude files å„ªå…ˆåº¦æœ€é«˜ï¼Œfiles æŒ‡å®šçš„æª”æ¡ˆä¸æœƒè¢« exclude æ’é™¤ include åŒ…å«çš„æª”æ¡ˆï¼Œå¯ä»¥é€é exclude é€²è¡Œéæ¿¾ åŒæ™‚å¯« files è·Ÿ includeï¼Œç›¸ç¬¦çš„æª”æ¡ˆèˆ‡è³‡æ–™å¤¾éƒ½æœƒè¢«ç·¨è­¯ extendså­—ä¸²ï¼Œä½¿ç”¨å…¶ä»– tsconfig.json æª”æ¡ˆä½œç‚ºåŸºç¤ï¼Œä¸¦è¦†å¯«æˆ–æ˜¯æ“´å……è¨­å®šï¼Œå¯ä»¥ä½¿ç”¨çµ•å°è·¯å¾‘ã€ç›¸å°è·¯å¾‘ { \"extends\": \"./base.json\"} åƒè€ƒè³‡æºï¼š https://ithelp.ithome.com.tw/articles/10216636","link":"/2023/03/25/typescript/ts-tsconfig-json/"},{"title":"TypeScript å­¸ç¿’ç­†è¨˜ï¼šå¸¸ç”¨ Utility Types","text":"TypeScript Utility Types æ˜¯ä¸€çµ„å…§å»ºçš„å‹åˆ¥å·¥å…·ï¼Œç”¨æ–¼æ“ä½œå’Œçµ„åˆç¾æœ‰å‹åˆ¥ï¼Œä»¥ç”¢ç”Ÿæ–°çš„å‹åˆ¥ã€‚é€™äº›å·¥å…·å¯ä»¥è®“é–‹ç™¼è€…æ›´å®¹æ˜“åœ°è™•ç†å’Œæ“ä½œ TypeScript å‹åˆ¥ï¼Œæé«˜ç¨‹å¼ç¢¼çš„å¯è®€æ€§å’Œå¯ç¶­è­·æ€§ã€‚ ä»¥ä¸‹ä»‹ç´¹å¹¾å€‹å¸¸ç”¨çš„ Utility Typesï¼š Record&lt;Keys, Type&gt;interface CatInfo { age: number; breed: string;}type CatName = 'miffy' | 'boris' | 'mordred';const cats: Record&lt;CatName, CatInfo&gt; = { miffy: { age: 10, breed: 'Persian' }, boris: { age: 5, breed: 'Maine Coon' }, mordred: { age: 16, breed: 'British Shorthair' }} Pick&lt;Type, Keys&gt;åƒæ•¸é¸æ“‡ interface Todo { title: string; description: string; isCompleted: boolean;}type TodoPreview = Pick&lt;Todo, 'title' | 'isCompleted'&gt;const todo: TodoPreview = { title: 'title', isCompleted: true} Omit&lt;Type, Keys&gt;åƒæ•¸æ’é™¤ interface Todo { title: string; description: string; isCompleted: boolean; createdAt: number;}type TodoPreview = Omit&lt;Todo, 'description'&gt;const todo: TodoPreview = { title: 'title', isCompleted: true, createdAt: 20230301} åƒè€ƒè³‡æºï¼š https://www.typescriptlang.org/docs/handbook/utility-types.html https://www.youtube.com/watch?v=GinkGJZBHIY","link":"/2023/03/23/typescript/ts-utility-types/"},{"title":"WebRTC å­¸ç¿’ç­†è¨˜ (3) éŒ„è£½ï¼ä¸‹è¼‰å½±éŸ³ä¸²æµ","text":"æœ¬ç¯‡é›–æœªæ¶‰åŠ WebRTC API çš„æ‡‰ç”¨ï¼Œä½† WebRTC å¯¦ä½œä¸Šå¸¸æœƒæ­é…å½±éŸ³éŒ„è£½èˆ‡ä¸‹è¼‰åŠŸèƒ½ï¼Œå› æ­¤å°‡æ­¤ç¯‡æ–‡ç« æ­¸é¡ç‚ºç³»åˆ—æ–‡ä¹‹ä¸€ éŒ„è£½å½±éŸ³ä¸²æµMediaStream Recording API MediaRecorder(stream) å¯ç”¨æ–¼åœ¨ç€è¦½å™¨ä¸­æ•æ‰åª’é«”ä¸²æµä¸¦å°‡å…¶éŒ„è£½ç‚ºå½±éŸ³æª”ï¼Œé€šå¸¸æœƒæ­é… MediaDevices API getUserMedia() Promise å‡½å¼å–å¾—åª’é«”ä¸²æµ const createStream = async () =&gt; { const constraints = { audio: true, video: true }; // å–å¾—è£ç½®çš„å½±éŸ³ä¸²æµ const stream = await navigator.mediaDevices.getUserMedia(constraints); return stream;};const startRecord = async () =&gt; { const stream = await createStream(); const options = { audioBitsPerSecond: 128000, videoBitsPerSecond: 2500000, mimeType: 'video/webm' }; // å»ºç«‹ MediaRecorder ç‰©ä»¶ const recorder = new MediaRecorder(stream, options); // é–‹å§‹éŒ„è£½ recorder.start();};startRecord(); å‘¼å« MediaRecorder.start() æ™‚ï¼Œå¦‚æœæ²’æœ‰å‚³å…¥åƒæ•¸ï¼Œæœƒåœ¨åœæ­¢éŒ„è£½æ™‚æ‰å›å‚³ä¸€å€‹ Blob æª”ï¼Œå¦‚æœå¸Œæœ›èƒ½æ‹†åˆ† chuck æª”æ¡ˆï¼Œå¯ä»¥åœ¨ start(timeslice) ä»£å…¥æ™‚é–“åƒæ•¸ï¼š // æ¯ç§’å›å‚³ä¸€æ¬¡éŒ„è£½çš„ä¸²æµMediaRecorder.start(1000); MediaRecorder API ç›¸é—œæ–¹æ³•å’Œäº‹ä»¶ï¼š MediaRecorder.start() é–‹å§‹éŒ„è£½åª’é«” MediaRecorder.stop() åœæ­¢éŒ„è£½åª’é«” MediaRecorder.pause() æš«åœéŒ„è£½åª’é«” MediaRecorder.resume() é‡æ–°é–‹å§‹éŒ„è£½åª’é«” MediaRecorder.ondataavailable éŒ„è£½æœŸé–“ç”¢ç”Ÿæ–°çš„åª’é«”è³‡æ–™ï¼ˆBlob æª”ï¼‰æ™‚è§¸ç™¼ MediaRecorder.onstop åª’é«”éŒ„è£½å®Œæˆä¸¦åœæ­¢æ™‚è§¸ç™¼ ä¸‹è¼‰å½±éŸ³ä¸²æµæ­é… ondataavailable ä»¥åŠ onstop é€²è¡Œç›£è½ å‰é¢æåˆ°çš„ MediaRecorder.start(timeslice) æ–¹æ³•å‚³å…¥çš„æ™‚é–“åƒæ•¸ï¼Œæœƒå½±éŸ¿ ondataavailable è§¸ç™¼æ™‚æ©Ÿï¼Œå‡è¨­ timeslice = 1000ï¼Œæ¯ç§’é˜æœƒè§¸ç™¼ä¸€æ¬¡ ondataavailableï¼Œä¸¦å›å‚³é€™æ®µæ™‚é–“ï¼ˆæ¯ç§’ï¼‰éŒ„è£½çš„å…§å®¹ï¼Œè‹¥æ²’æœ‰å‚³å…¥åƒæ•¸ï¼Œæœƒåœ¨åœæ­¢éŒ„è£½æ™‚æ‰è§¸ç™¼ï¼Œä¸¦å›å‚³æœŸé–“éŒ„è£½çš„æ‰€æœ‰å…§å®¹ æ­¥é©Ÿæ‹†è§£ï¼š é€é ondataavailable å–å¾—éŒ„è£½çš„ Blob chuckï¼Œä¸¦å„²å­˜è®Šæ•¸å…§ é€é onstop ç›£è½éŒ„è£½åœæ­¢ åŸ·è¡Œæª”æ¡ˆä¸‹è¼‰ const recordedChunks = [];recorder.start(1000);setTimeout(() =&gt; { recorder.stop();}, 5000);// 1. å–å¾—éŒ„è£½çš„ Blob chuckï¼Œä¸¦å„²å­˜è®Šæ•¸å…§recorder.ondataavailable = (event) =&gt; { if (event.data.size &gt; 0) { recordedChunks.push(event.data); }};// 2. ç›£è½éŒ„è£½åœæ­¢recorder.onstop = () =&gt; { download();};// 3. åŸ·è¡Œæª”æ¡ˆä¸‹è¼‰const download = () =&gt; { const blob = new Blob(recordedChunks, { type: 'video/webm' }); const url = URL.createObjectURL(blob); const a = document.createElement('a'); document.body.appendChild(a); a.style = 'display: none'; a.href = url; a.download = 'test.webm'; a.click(); window.URL.revokeObjectURL(url);}; URL.createObjectURL() ç”¨ä¾†å°‡ File æˆ–æ˜¯ Blob ç‰©ä»¶è½‰æˆä¸€å€‹ urlï¼Œåˆ©ç”¨é€™å€‹ url ä¾†è™•ç†æª”æ¡ˆä¸‹è¼‰ï¼Œä¸‹è¼‰å®Œç•¢å¾Œå†ä½¿ç”¨ URL.revokeObjectURL() é‡‹æ”¾ url éŒ„è£½èˆ‡ä¸‹è¼‰å®Œæ•´ç¯„ä¾‹ See the Pen Download and Record Videos by Claire Chang (@claire-chang-the-bashful) on CodePen. åƒè€ƒè³‡æºï¼š https://developer.mozilla.org/en-US/docs/Web/API/MediaStream_Recording_API https://medium.com/@kf99916/html5-ç¥å¥‡çš„-object-url-ä¸ç”¨å¾Œç«¯-å‰ç«¯ä¾¿èƒ½ç”¢ç”Ÿç²å–æŒ‡å®šç‰©ä»¶çš„ç¶²å€-6df283d58505","link":"/2023/05/03/webrtc/media-stream-record-and-download/"},{"title":"WebRTC å­¸ç¿’ç­†è¨˜ (4) å¯¦ä½œå¤šæ–¹è¦–è¨ŠèŠå¤©å®¤","text":"æœ¬ç¯‡æ˜¯è¦–è¨ŠèŠå¤©å®¤çš„é€²éšç‰ˆæœ¬ï¼Œå¿…é ˆå…ˆæŒæ¡ ä¸€å°ä¸€è¦–è¨ŠèŠå¤©å®¤ ä»‹ç´¹çš„ç›¸é—œçŸ¥è­˜ï¼Œæ‰èƒ½æ›´å¿«ç†è§£æœ¬ç¯‡çš„å¯¦ä½œå…§å®¹ï½ è¦–è¨Šæƒ…å¢ƒå¤šå€‹è£ç½® Aã€Bã€C â€¦â€¦ æƒ³è¦é€²è¡Œå¤šæ–¹è¦–è¨ŠèŠå¤©ï¼Œå¯ä»¥éš¨æ™‚é€²å…¥èŠå¤©å®¤ï¼Œä¸éœ€è¦ç‰¹å®šçš„é †åº æµç¨‹è§£æå¤šæ–¹è¦–è¨Šå¯ä»¥é€é RTCPeerConnection() å»ºç«‹å¤šå€‹é€£ç·šä¾†é”æˆã€‚è·Ÿä¸€å°ä¸€çš„é€£ç·šé¡ä¼¼ï¼Œå¤šæ–¹è¦–è¨Šä¸­çš„æ¯å€‹ P2P é€£ç·š ç™¼é€ç«¯ï¼ˆOfferï¼‰èˆ‡ æ¥æ”¶ç«¯ï¼ˆAnswerï¼‰éƒ½éœ€è¦åˆ†åˆ¥å»ºç«‹ä¸€å€‹ RTCPeerConnection() ç‰©ä»¶ï¼Œæ¯å€‹ç‰©ä»¶åˆ†åˆ¥ç®¡ç†ä¸€å€‹é€£ç·šï¼Œä¸¦é€é Signaling Server äº¤æ› ICE å’Œ SDP ä»¥å»ºç«‹é€£ç·šã€‚ é€£ç·šå»ºç«‹å¾Œï¼Œæ¯å€‹è£ç½®å¯ä»¥å°‡è‡ªå·±çš„å½±åƒå’Œè²éŸ³å‚³é€åˆ°å…¶ä»–è£ç½®çš„ RTCPeerConnection() ä¸­ï¼Œä»¥é”æˆå¤šæ–¹è¦–è¨Šçš„æ•ˆæœã€‚æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥é€éä½¿ç”¨åª’é«”ä¼ºæœå™¨ï¼ˆå¦‚ SFU æˆ– MCUï¼‰ä¾†é€²ä¸€æ­¥å„ªåŒ–å¤šæ–¹è¦–è¨Šçš„æ•ˆèƒ½å’Œå“è³ªã€‚ åœ¨ä¸€å°ä¸€è¦–è¨Šæƒ…å¢ƒï¼Œæœ‰æ˜ç¢ºçš„ç™¼é€ç«¯èˆ‡æ¥æ”¶ç«¯ï¼Œä»¥ Aã€B ç‚ºä¾‹ï¼š è£ç½® A ç™¼é€ Offer SDPï¼Œä¸¦è¨­å®šç‚ºæœ¬åœ° SDPï¼ˆsetLocalDescriptionï¼‰ è£ç½® B æ”¶åˆ° Offer SDPï¼Œä¸¦è¨­å®šç‚ºé ç«¯ SDPï¼ˆsetRemoteDescriptionï¼‰ è£ç½® B ç™¼é€ Answer SDPï¼Œä¸¦è¨­å®šç‚ºæœ¬åœ° SDPï¼ˆsetLocalDescriptionï¼‰ è£ç½® A æ”¶åˆ° Answer SDPï¼Œä¸¦è¨­å®šç‚ºé ç«¯ SDPï¼ˆsetRemoteDescriptionï¼‰ é‚£éº½åœ¨å¤šæ–¹è¦–è¨Šæƒ…æ³ï¼Œè©²æ€éº¼å®šç¾©ç™¼é€ç«¯èˆ‡æ¥æ”¶ç«¯å‘¢ï¼Ÿ æ¯å€‹æ–°åŠ å…¥èŠå¤©å®¤çš„è£ç½®ï¼Œå‘å·²åŠ å…¥èŠå¤©å®¤çš„æ‰€æœ‰è£ç½®ç™¼é€ Offer SDPï¼Œè€Œå…¶ä»–è£ç½®æ”¶åˆ° Offer SDP å¾Œï¼Œå†å‘è©²è£ç½®ç™¼é€ Answer SDPï¼Œå®Œæˆåª’é«”å”å•†ä¸¦å»ºç«‹ P2P é€£æ¥ã€‚ ä»¥ Aã€Bã€C ç‚ºä¾‹ï¼š è£ç½® A åŠ å…¥èŠå¤©å®¤ è£ç½® B åŠ å…¥èŠå¤©å®¤ï¼Œå‘ A ç™¼é€ Offer SDP è£ç½® A æ”¶åˆ° B çš„ Offer SDPï¼Œå‘ B ç™¼é€ Answer SDP è£ç½® B æ”¶åˆ° A çš„ Answer SDP è£ç½® C åŠ å…¥èŠå¤©å®¤ï¼Œå‘ Aã€B ç™¼é€ Offer SDP è£ç½® Aã€B æ”¶åˆ° C çš„ Offer SDPï¼Œå‘ C ç™¼é€ Answer SDP è£ç½® C æ”¶åˆ° Aã€B çš„ Answer SDP è©¦è‘—æ€è€ƒçœ‹çœ‹ï¼šç•¶æœ‰ä¸‰å°è£ç½®é€²è¡Œè¦–è¨Šé€£ç·šï¼Œç¸½å…±æœƒç”¢ç”Ÿå¹¾å€‹ RTCPeerConnection() ç‰©ä»¶å‘¢ï¼Ÿ è¦–è¨Šå¯¦ä½œç¯„ä¾‹é é¢ï¼šhttps://webrtc-socket.herokuapp.com/chat åˆ†ç‚º Serverï¼ˆSignaling Serverï¼‰ä»¥åŠ Clientï¼ˆè¦–è¨ŠèŠå¤©å®¤ï¼‰é€²è¡Œ æª”æ¡ˆçµæ§‹å¦‚ä¸‹ï¼š server.jschat.htmlchat.js é‡é»èªªæ˜ï¼šç”±æ–¼æ¯å€‹ P2P é€£ç·šçš„ç™¼é€ç«¯èˆ‡æ¥æ”¶ç«¯éƒ½éœ€è¦å„åˆ¥å»ºç«‹ RTCPeerConnection()ï¼Œå› æ­¤æœƒä½¿ç”¨ Socket.IO ç‚ºæ¯å€‹é€£ç·šç”¢ç”Ÿçš„å”¯ä¸€è­˜åˆ¥ç¢¼ socket.id ä½œç‚ºèº«ä»½è­˜åˆ¥ Serverï¼ˆserver.jsï¼‰å¥—ä»¶å®‰è£ï¼ˆNPMï¼‰ Node.js æ¡†æ¶ Express Websocket å¥—ä»¶ Socket.io å¥—ä»¶å¼•å…¥ï¼å•Ÿå‹•ä¼ºæœå™¨const express = require('express');const app = express();const http = require('http');const socket = require('socket.io');const server = http.createServer(app).listen('3000'); é€£æ¥ Client é é¢ï¼ˆè½‰æ›ç‚ºçµ•å°è·¯å¾‘ __dirnameï¼‰// html è·¯å¾‘è½‰æ›app.get('/chat', function(req, res) { res.sendfile(`${__dirname}/chat.html`);});// js è·¯å¾‘è½‰æ›app.get(/(.*)\\.(jpg|gif|png|ico|css|js|txt)/i, function(req, res) { res.sendfile(`${__dirname}/${req.params[0]}.${req.params[1]}`);}); åŠ å…¥ Socket.ioSocket.io API èªªæ˜ï¼šio.in(room).emit('joined')ï¼šå‘æ‰€æœ‰è£ç½®ç™¼é€è¨Šæ¯ï¼ˆåŒ…å«è‡ªå·±ï¼‰socket.to(room).emit('joined')ï¼šå‘æ‰€æœ‰è£ç½®ç™¼é€è¨Šæ¯ï¼ˆä¸åŒ…å«è‡ªå·±ï¼‰socket.to(id).emit('joined')ï¼šå‘ç‰¹å®šè£ç½®ç™¼é€è¨Šæ¯ const io = socket(server);io.on('connection', (socket) =&gt; { console.log('connection'); // è£ç½®åŠ å…¥èŠå¤©å®¤ socket.on('join', (room) =&gt; { console.log('join'); socket.join(room); // å–å¾—åŠ å…¥èŠå¤©å®¤è£ç½®çš„ socket.id const members = Array.from(socket.adapter.rooms.get(room)); // å‘æ‰€æœ‰è£ç½®å‘ŠçŸ¥æœ‰æ–°è£ç½®åŠ å…¥ï¼ˆåŒ…å«è‡ªå·±ï¼‰ io.in(room).emit('joined', socket.id, members); }); // è½‰å‚³ Offer socket.on('offer', (room, desc, remoteId, localId) =&gt; { socket.to(localId).emit('offer', desc, remoteId); }); // è½‰å‚³ Answer socket.on('answer', (room, desc, remoteId, localId) =&gt; { socket.to(localId).emit('answer', desc, remoteId); }); // äº¤æ› ice candidate socket.on('ice_candidate', (room, data, remoteId, localId) =&gt; { socket.to(localId).emit('ice_candidate', data, remoteId); }); // è£ç½®é›¢é–‹èŠå¤©å®¤ socket.on('disconnect_socket', () =&gt; { console.log('disconnect'); socket.disconnect(); });}); Clientï¼ˆè¦–è¨ŠèŠå¤©å®¤ï¼‰å¥—ä»¶å®‰è£ï¼ˆCDNï¼‰ WebRTC Adapterï¼ˆè§£æ±ºç›¸å®¹æ€§å•é¡Œï¼‰ Socket.io-client HTMLï¼ˆchat.htmlï¼‰ åŠ å…¥ Video Dom #localVideo æ¥æ”¶æœ¬åœ°åª’é«”ä¸²æµ #remoteVideos æ¥æ”¶å¤šå€‹é ç«¯åª’é«”ä¸²æµ CDN WebRTC Adapter ä»¥åŠ Socket.io-client å¼•å…¥ chat.js &lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset=\"utf-8\"&gt; &lt;link rel=\"icon\" type=\"image/x-icon\" href=\"./favicon.ico\"&gt; &lt;meta name=\"viewport\" content=\"width=device-width, user-scalable=yes, initial-scale=1, maximum-scale=1\"&gt; &lt;title&gt;chat&lt;/title&gt; &lt;style lang=\"scss\"&gt; .local-video { transform: scaleX(-1); } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class=\"container\"&gt; &lt;video muted=\"true\" autoplay=\"true\" playsinline=\"true\" id=\"localVideo\" class=\"local-video\"&gt;&lt;/video&gt; &lt;div id=\"remoteVideos\"&gt;&lt;/div&gt; &lt;div class=\"btn-group\"&gt; &lt;button type=\"button\" id=\"enter\"&gt;enter&lt;/button&gt; &lt;button type=\"button\" id=\"leave\"&gt;leave&lt;/button&gt; &lt;/div&gt; &lt;/div&gt; &lt;script src=\"https://webrtc.github.io/adapter/adapter-latest.js\"&gt;&lt;/script&gt; &lt;script src=\"https://cdn.jsdelivr.net/npm/socket.io-client@3.0.4/dist/socket.io.js\"&gt;&lt;/script&gt; &lt;script src=\"chat.js\" type=\"module\" async&gt;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt; Javascriptï¼ˆchat.jsï¼‰æ­¥é©Ÿæ‹†åˆ† é–‹å•Ÿè¦–çª—æ™‚ï¼Œå…ˆé€é getUserMedia() å–å¾—æœ¬åœ°åª’é«”ä¸²æµ é»æ“Šé€²å…¥èŠå¤©å®¤æŒ‰éˆ•ï¼šé€£æ¥ Socket Serverï¼ˆSignaling Serverï¼‰ï¼Œé€é Offerï¼Answer SDP å’Œé ç«¯è£ç½®äº¤æ› ICE å€™é¸ä½å€èˆ‡ SDP è³‡è¨Šï¼Œå»ºç«‹é»å°é»é€£ç·š é»æ“Šé›¢é–‹èŠå¤©å®¤æŒ‰éˆ•ï¼šç§»é™¤äº‹ä»¶ç›£è½ã€é—œé–‰ RTCPeerConnection é€£ç·šã€é‡‹æ”¾è¨˜æ†¶é«”ï¼Œä¸¦å‚³é€é›¢é–‹äº‹ä»¶çµ¦ Socket Server å®šç¾©å¸¸æ•¸èˆ‡è®Šæ•¸const localVideo = document.querySelector('#localVideo')const remoteVideos = document.querySelector('#remoteVideos')const enterBtn = document.querySelector('#enter');const leaveBtn = document.querySelector('#leave'); let peerConnectionList = {};let socket;let localStream;const room = 'room1'; // æˆ¿é–“å…ˆé è¨­ç‚º room1 é–‹å•Ÿè¦–çª—æ™‚ï¼Œå…ˆé€é getUserMedia å–å¾—æœ¬åœ°åª’é«”ä¸²æµ å–å¾—æœ¬åœ°å½±éŸ³ä¸²æµ Dom è¨­ç½®æœ¬åœ°ä¸²æµ å‚³å‡ºåª’é«”ä¸²æµ const createStream = async () =&gt; { const constraints = { audio: true, video: true }; // 1. å–å¾—æœ¬åœ°å½±éŸ³ä¸²æµ const stream = await navigator.mediaDevices.getUserMedia(constraints); // 2. Dom è¨­ç½®æœ¬åœ°åª’é«”ä¸²æµ localVideo.srcObject = stream; // 3. å‚³å‡ºåª’é«”ä¸²æµ localStream = stream;}createStream(); // ç•«é¢ä¸€é–‹å•Ÿå³å‘¼å« é»æ“Šé€²å…¥èŠå¤©å®¤æŒ‰éˆ•äº‹ä»¶è§¸ç™¼enterBtn.addEventListener('click', socketConnect); é€£æ¥ Socket Serverï¼ˆSignaling Serverï¼‰ï¼Œé€é Offerï¼Answer SDP å’Œé ç«¯è£ç½®äº¤æ› ICE å€™é¸ä½å€èˆ‡ SDP è³‡è¨Šï¼Œå»ºç«‹é»å°é»é€£ç·š Socket Server é€£ç·š åŠ å…¥æˆ¿é–“ ç›£è½æœ‰è£ç½®åŠ å…¥æˆ¿é–“ï¼šå¦‚æœæ˜¯è‡ªå·±ï¼Œå»ºç«‹ RTCPeerConnectionï¼Œè¨­å®šæœ¬åœ° SDPï¼ˆsetLocalDescriptionï¼‰ï¼Œä¸¦ç™¼é€ Offer SDP ç›£è½æ”¶åˆ° Offer SDPï¼šå»ºç«‹ RTCPeerConnectionï¼Œï¼Œè¨­å®šé ç«¯ SDPï¼ˆsetRemoteDescriptionï¼‰èˆ‡æœ¬åœ° SDPï¼ˆsetLocalDescriptionï¼‰ï¼Œä¸¦ç™¼é€ Answer SDP ç›£è½æ”¶åˆ° Answer SDPï¼šè¨­å®šé ç«¯ SDPï¼ˆsetRemoteDescriptionï¼‰ ç›£è½æ”¶åˆ° ICE å€™é¸ä½å€ï¼šä½¿ç”¨ RTCIceCandidate å®šç¾© ICE å€™é¸ä½å€ const socketConnect = () =&gt; { // 1. Socket Server é€£ç·š socket = io('ws://localhost:3000'); // 2. åŠ å…¥æˆ¿é–“ socket.emit('join', room); // 3. ç›£è½æœ‰è£ç½®åŠ å…¥æˆ¿é–“ socket.on('joined', (id, roomMembers) =&gt; { // æª¢æŸ¥ server å‚³ä¾†çš„ socket.id æ˜¯å¦ç­‰æ–¼è‡ªå·±çš„ socket.id // ä¸”èŠå¤©å®¤è£ç½®å¤§æ–¼ä¸€ï¼Œä¾åºç™¼é€ Offer SDP if (id === socket.id &amp;&amp; roomMembers.length &gt; 1) { console.log('ç™¼é€ offer'); // 3-1. ç™¼é€ Offer SDP roomMembers.forEach(remoteId =&gt; { if (remoteId !== socket.id) { setOfferSDP(remoteId); } }); } }); // 4. ç›£è½æ”¶åˆ° Offer SDP socket.on('offer', async (desc, remoteId) =&gt; { console.log('æ”¶åˆ° offer'); // 4-1. ç™¼é€ Answer SDP console.log('ç™¼é€ answer'); await sendAnswerSDP(remoteId, desc); }) // 5. ç›£è½æ”¶åˆ° Answer SDP socket.on('answer', (desc, remoteId) =&gt; { console.log('æ”¶åˆ° answer'); // è¨­å®šé ç«¯åª’é«”ä¸²æµ peerConnectionList[remoteId].setRemoteDescription(desc); }) // 6. ç›£è½æ”¶åˆ° ICE å€™é¸ä½å€ socket.on('ice_candidate', (data, remoteId) =&gt; { console.log('æ”¶åˆ° ice_candidate'); // RTCIceCandidate å®šç¾© ICE å€™é¸ä½å€ const candidate = new RTCIceCandidate({ sdpMLineIndex: data.label, candidate: data.candidate, }); // åŠ å…¥å€™é¸ä½å€ peerConnectionList[remoteId].addIceCandidate(candidate); })} 3-1. ç™¼é€ Offer SDP å»ºç«‹ RTCPeerConnection å»ºç«‹æœ¬åœ° SDP è¨­å®šæœ¬åœ° SDP ç™¼é€ Offer SDP const setOfferSDP = async (remoteId) =&gt; { // 1. å»ºç«‹ RTCPeerConnection const peerConnection = await createPeerConnection(remoteId); const offerOptions = { offerToReceiveAudio: true, // æ˜¯å¦å‚³é€è²éŸ³æµçµ¦å°æ–¹ offerToReceiveVideo: true // æ˜¯å¦å‚³é€å½±åƒæµçµ¦å°æ–¹ }; // 2. å»ºç«‹æœ¬åœ° SDP const localSDP = await peerConnection.createOffer(offerOptions); // 3. è¨­å®šæœ¬åœ° SDP await peerConnection.setLocalDescription(localSDP); // 4. ç™¼é€ Offer SDP socket.emit('offer', room, peerConnection.localDescription, socket.id, remoteId);} 4-1. ç™¼é€ Answer SDP å»ºç«‹ RTCPeerConnection è¨­å®šé ç«¯ SDP å»ºç«‹æœ¬åœ° SDP è¨­å®šæœ¬åœ° SDP ç™¼é€ Answer SDP const sendAnswerSDP = async (remoteId, desc) =&gt; { // 1. å»ºç«‹ RTCPeerConnection const peerConnection = await createPeerConnection(remoteId); // 2. è¨­å®šé ç«¯ SDP await peerConnection.setRemoteDescription(desc); const answerOptions = { offerToReceiveAudio: true, // æ˜¯å¦å‚³é€è²éŸ³æµçµ¦å°æ–¹ offerToReceiveVideo: true // æ˜¯å¦å‚³é€å½±åƒæµçµ¦å°æ–¹ }; // 3. å»ºç«‹æœ¬åœ° SDP const localSDP = await peerConnection.createAnswer(answerOptions); // 4. è¨­å®šæœ¬åœ° SDP await peerConnection.setLocalDescription(localSDP); // 5. ç™¼é€ Answer SDP socket.emit('answer', room, peerConnection.localDescription, socket.id, remoteId);} 3-1. 4-1. å»ºç«‹ RTCPeerConnection è¨­å®š iceServer å»ºç«‹ RTCPeerConnection å¢åŠ æœ¬åœ°åª’é«”ä¸²æµ ç›£è½æ‰¾åˆ°æœ¬åœ°çš„ ICE å€™é¸ä½å€ ç›£è½ ICE é€£æ¥ç‹€æ…‹ ç›£è½é ç«¯è£ç½®çš„ä¸²æµå‚³å…¥ video æ¨™ç±¤å±¬æ€§ï¼šplaysinlineï¼šæ§åˆ¶å½±ç‰‡åœ¨è¡Œå‹•è£ç½®çš„æ’­æ”¾è¡Œç‚ºï¼Œé¿å…æŸäº›è£ç½®ï¼ˆå¦‚ IOSï¼‰å½ˆå‡ºè¦–çª—æ’­æ”¾å™¨controlsï¼šæ˜¯å¦é¡¯ç¤ºæ’­æ”¾æ§åˆ¶å™¨ï¼Œåœ¨æŸäº›è£ç½®ï¼ˆå¦‚ IOS Safariï¼‰è¨­å®šç‚º false ç•«é¢å¯èƒ½æœƒè¢«éš±è—ï¼Œå¯ä»¥å…ˆå°‡å±¬æ€§è¨­ç‚º trueï¼Œæ¥è‘—ç§»é™¤è©²å±¬æ€§ï¼švideo.setAttribute('controls', true)video.removeAttribute('controls') å°‡ P2P é€£ç·šå­˜å…¥ peerConnectionList const createPeerConnection = async (remoteId) =&gt; { // 1. è¨­å®š iceServer const configuration = { iceServers: [{ urls: 'stun:stun.l.google.com:19302' // google æä¾›å…è²»çš„ STUN server }] }; // 2. å»ºç«‹ RTCPeerConnection const peerConnection = new RTCPeerConnection(configuration); // 3. å¢åŠ æœ¬åœ°åª’é«”ä¸²æµ localStream.getTracks().forEach((track) =&gt; { peerConnection.addTrack(track, localStream); }); // 4. ç›£è½æ‰¾åˆ°æœ¬åœ°çš„ ICE å€™é¸ä½å€ peerConnection.onicecandidate = (e) =&gt; { console.log('æ‰¾å°‹åˆ° ICE å€™é¸ä½å€'); if (e.candidate) { console.log('ç™¼é€ ICE å€™é¸ä½å€'); // å‚³é€ ICE å€™é¸ä½å€çµ¦é ç«¯ socket.emit('ice_candidate', room, { label: e.candidate.sdpMLineIndex, id: e.candidate.sdpMid, candidate: e.candidate.candidate, }, socket.id, remoteId); } }; // 5. ç›£è½ ICE é€£æ¥ç‹€æ…‹ peerConnection.oniceconnectionstatechange = (e) =&gt; { if (e.target.iceConnectionState === 'disconnected') { console.log('æœ‰è£ç½®æ–·ç·š'); // ç§»é™¤äº‹ä»¶ç›£è½ peerConnectionList[remoteId].onicecandidate = null; peerConnectionList[remoteId].onnegotiationneeded = null; peerConnectionList[remoteId].oniceconnectionstatechange = null; // é—œé–‰ RTCPeerConnection é€£ç·šä¸¦é‡‹æ”¾è¨˜æ†¶é«” peerConnectionList[remoteId].close(); delete peerConnectionList[remoteId]; // ç§»é™¤é ç«¯ video document.getElementById(remoteId).remove(); } }; // 6. ç›£è½é ç«¯è£ç½®çš„ä¸²æµå‚³å…¥ peerConnection.onaddstream = ({ stream }) =&gt; { console.log('ç›£è½åˆ°ä¸²æµ'); const video = document.createElement('video'); video.srcObject = stream; video.setAttribute('controls', true); video.setAttribute('playsinline', true); video.setAttribute('autoplay', true); video.setAttribute('muted', true); video.setAttribute('volume', 0); video.removeAttribute('controls'); video.classList.add('remote-video'); video.id = remoteId; remoteVideos.append(video); }; // 7. å°‡ P2P é€£ç·šå­˜å…¥ peerConnectionList peerConnectionList[remoteId] = peerConnection; return peerConnection;} é»æ“Šé›¢é–‹èŠå¤©å®¤æŒ‰éˆ•äº‹ä»¶è§¸ç™¼leaveBtn.addEventListener('click', leave); é›¢é–‹èŠå¤©å®¤ ç§»é™¤äº‹ä»¶ç›£è½ é—œé–‰ RTCPeerConnection é€£ç·š é‡‹æ”¾è¨˜æ†¶é«” ç§»é™¤é ç«¯ video å‚³éé›¢é–‹èŠå¤©å®¤äº‹ä»¶çµ¦ Socket Server const leave = () =&gt; { console.log('é›¢é–‹èŠå¤©å®¤'); // æª¢æŸ¥æ˜¯å¦æœ‰é€£ç·š if (Object.keys(peerConnectionList).length) { Object.keys(peerConnectionList).forEach(key =&gt; { // 1. ç§»é™¤äº‹ä»¶ç›£è½ peerConnectionList[key].onicecandidate = null; peerConnectionList[key].onnegotiationneeded = null; peerConnectionList[key].oniceconnectionstatechange = null; // 2. é—œé–‰ RTCPeerConnection é€£ç·š peerConnectionList[key].close(); }) // 3. é‡‹æ”¾è¨˜æ†¶é«” peerConnectionList = {}; // 4. ç§»é™¤é ç«¯ video remoteVideos.innerHTML = null; } // 5. å‚³éé›¢é–‹èŠå¤©å®¤äº‹ä»¶ socket.emit('disconnect_socket'); socket = null;} é€™æ¨£å°±å¤§åŠŸå‘Šæˆå›‰ï¼Œä¸Šè¿°èªªæ˜æœ‰è©¦è‘—ç°¡åŒ–ç¨‹å¼ç¢¼ï¼Œé¿å…ç´°ç¯€ç¹ç‘£é›£ä»¥ç†è§£ è©¦è‘—å„ªåŒ–çœ‹çœ‹ï¼š 1. enter button è·Ÿ leave button åŠ å…¥ disabled å±¬æ€§ï¼Œé¿å…é‡è¤‡æ“ä½œ 2. å°‡ socket.id åšç‚ºè­˜åˆ¥ç¢¼ï¼ŒåŠ å…¥èŠå¤©è¦–çª—ï¼ˆä¹Ÿæ›´å®¹æ˜“é™¤éŒ¯ï¼ï¼‰ 3. ä¸åŒè£ç½®çš„è¢å¹•å¯¬é«˜æ¯”ä¸åŒï¼Œåˆ©ç”¨ css å„ªåŒ–ï¼Œé¿å…ç•«é¢ç ´ç‰ˆ 4. async function åŠ å…¥ try / catch æ•æ‰éŒ¯èª¤æƒ…å¢ƒ ç¯„ä¾‹é é¢ï¼šhttps://webrtc-socket.herokuapp.com/chat åƒè€ƒè³‡æºï¼š https://github.com/muaz-khan/RTCMultiConnection/blob/master/dist/RTCMultiConnection.js https://iter01.com/489722.html https://socket.io/docs/v3/rooms/","link":"/2023/05/10/webrtc/webrtc-group-chat/"},{"title":"WebRTC å­¸ç¿’ç­†è¨˜ (1) åŸºæœ¬è§€å¿µèˆ‡æµç¨‹","text":"WebRTCï¼ˆWeb Real-Time Communicationï¼‰æ˜¯ä¸€ç¨®ç”¨æ–¼ç€è¦½å™¨ä¹‹é–“é€²è¡Œå³æ™‚é€šè¨Šçš„æŠ€è¡“ã€‚è®“ç”¨æˆ¶å¯ä»¥é€éç€è¦½å™¨å»ºç«‹è¦–è¨Šã€éŸ³è¨Šå’Œè³‡æ–™å‚³è¼¸çš„é€£ç·šï¼Œä¸¦å¯¦ç¾ P2P é»å°é»é€šè¨Šï¼Œè€Œç„¡é ˆé€éä¸­ä»‹æœå‹™ã€‚ WebRTC å¦‚ä½•é”æˆé€£ç·šï¼ŸWebRTC å³æ™‚é€šè¨Šæ˜¯é€é P2Pï¼ˆPeer-to-Peerï¼‰é€£ç·šä¾†é”æˆï¼Œä¸é P2P é€£ç·šä¸¦æ²’æœ‰é€™éº¼ç°¡å–®ï¼Œå› å¤§éƒ¨åˆ†è£ç½®è™•æ–¼å€åŸŸç¶²è·¯ä¸­ï¼Œé€šå¸¸æ˜¯é€é NATï¼ˆNetwork Address Translationï¼‰å°‡å…§éƒ¨ç¶²è·¯ IP è½‰æ›æˆå¤–éƒ¨ç¶²è·¯ IP ä¾†é”æˆé€£ç·šï¼Œä¹Ÿå°±æ˜¯èªªä¸¦æ²’æœ‰ç›´æ¥é–‹æ”¾çš„é€šè¨Šè·¯å¾‘ï¼ˆç„¡æ³•ç›´æ¥é€£åˆ°å…§ç¶² IPï¼‰ï¼Œå› æ­¤éœ€è¦ï¼š å…ˆé€é ICE æ¡†æ¶ä¾†æ‰¾åˆ°å…±åŒçš„é€£ç·šè·¯å¾‘ï¼Œä¸¦ç”¨ Signaling Server äº¤æ›è³‡è¨Šï¼ˆä¸Šåœ–æ­¥é©Ÿ â‘ â‘¡â‘¢â‘£ï¼‰ é€é P2P é”æˆå³æ™‚é€šè¨Šï¼ˆä¸Šåœ–æ­¥é©Ÿ â‘¤ï¼‰ ç‚ºä»€éº¼è¦ä½¿ç”¨ P2P é€£ç·šï¼ŸICE æ¡†æ¶æ˜¯ä»€éº¼ï¼ŸSignaling Serveråˆæ˜¯ä»€éº¼ï¼ŸP2P é€£ç·šå¦‚ä½•é€²è¡Œè¦–è¨Šé€šè©±ï¼Ÿ çœ‹å®Œäº† WebRTC çš„æ¦‚å¿µé‚„æ˜¯å……æ»¿å•è™Ÿï¼Ÿï¼Ÿï¼Ÿæ¥ä¸‹ä¾†ä¾åºèªªæ˜ï½ P2Pï¼ˆPeer-to-Peerï¼‰Connection é»å°é»é€£ç·šP2P æŒ‡çš„æ˜¯å…©å€‹ç€è¦½å™¨ç›´æ¥å»ºç«‹é»å°é»é€£æ¥ï¼Œä¸éœ€é€éä¼ºæœå™¨ä¸­è½‰ï¼Œå¯ä»¥é”åˆ°å³æ™‚å½±éŸ³ä¸²æµã€‚WebRTC å…§çš„ P2P é€£ç·šç”± WebRTC API é”æˆï¼Œå…ˆé€é RTCPeerConnection() å»ºç«‹å¯¦é«”ï¼Œä¾†é€²è¡Œæœ¬åœ°è·Ÿé ç«¯çš„æºé€šã€‚ WebRTC APIConstructor å»ºæ§‹å¼ï¼šâ€¢ RTCPeerConnection()ï¼šå»ºç«‹ç‰©ä»¶å¯¦é«”ï¼Œç”¨ä¾†è™•ç†æœ¬åœ°è·Ÿé ç«¯é»å°é»é€£ç·šEvent Handler äº‹ä»¶è™•ç†å™¨ï¼šâ€¢ icecandidateï¼šæ‰¾å°‹åˆ° ICE å€™é¸ä½ç½®â€¢ iceconnectionstatechangeï¼šICE é€£ç·šç‹€æ…‹æ”¹è®Šâ€¢ addstreamï¼šæ–°å¢ä¸²æµMethodsï¼šâ€¢ addTrackï¼šå¢åŠ è¦–è¨Šã€éŸ³è¨Šï¼Œä»¥å‚³è¼¸åˆ°å¦ä¸€ç«¯â€¢ createOfferï¼šå»ºç«‹ Offer SDPâ€¢ createAnswerï¼šå»ºç«‹ Answer SDPâ€¢ setLocalDescriptionï¼šè¨­å®šæœ¬åœ° SDP è³‡è¨Šâ€¢ setRemoteDescriptionï¼šè¨­å®šé ç«¯ï¼ˆå°æ–¹ï¼‰SDP è³‡è¨Šâ€¢ addIceCandidateï¼šæ–°å¢ ICE å€™é¸ä½å€ ICE æ¡†æ¶ï¼ˆInteractive Connectivity Establishmentï¼‰ç”¨æ–¼åœ¨ç¶²è·¯ä¸­ç©¿é€ NAT çš„æŠ€è¡“æ¡†æ¶ï¼ŒICE æ•´åˆäº† STUN èˆ‡ TURN å”å®šï¼Œç”¨æ–¼ç¢ºå®šå…©å€‹è¨­å‚™ä¹‹é–“æœ€ä½³çš„é€šè¨Šè·¯å¾‘ï¼Œé€²è€Œé”æˆç«¯é»é–“é€£ç·šã€‚ NATï¼ˆNetwork Address Translationï¼‰ç¶²è·¯ä½ç½®è½‰è­¯ç”¨ä¾†å°‡ç§æœ‰ IP è½‰æ›ï¼ˆæ˜ å°„ï¼‰ç‚ºå…¬æœ‰ IPï¼Œç”±æ–¼ NAT ä¸å…è¨±å¤–ç¶²ä¸»æ©Ÿç›´æ¥è¨ªå•å…§ç¶²ï¼Œå› æ­¤æœƒé€ æˆ P2P ç›´æ¥é€£ç·šçš„å›°é›£ï¼ŒNAT è·Ÿé˜²ç«ç‰†è©³ç´°èªªæ˜å¯ä»¥åƒè€ƒ é€™ç¯‡æ–‡ç«  STUNï¼ˆSession Traversal Utilities for NATï¼‰å”å®šç”¨ä¾†ç©¿è¶Š NAT çš„ä¸€ç¨®å”è­°ï¼Œå”åŠ©åœ¨ NAT å…§çš„ä½¿ç”¨è€…æ‰¾åˆ°è‡ªå·±çš„å…¬ç¶² IPå’Œ Portï¼Œä¸¦å°‡è³‡è¨Šå‚³çµ¦å…¶ä»–ä½¿ç”¨è€…ï¼Œè®“é›™æ–¹ç­è§£å½¼æ­¤çš„è³‡è¨Šï¼Œç¹é NAT é™åˆ¶ï¼Œé”æˆ P2P é€£ç·šï¼Œä¸éåœ¨ Symmetric NAT ä¸å¯ç©¿é€çš„æƒ…æ³ä¸‹å‰‡ä¸é©ç”¨ TURNï¼ˆTraversal Using Relay NATï¼‰å”å®šç©¿è¶Š NAT çš„å¦ä¸€ç¨®å”è­°ï¼Œä½¿ç”¨ã€Œä¸­ç¹¼ã€çš„æ–¹å¼ä¾†é€²è¡Œï¼Œç•¶ STUN çš„å€™é¸ä½å€éƒ½ç„¡æ³•é€£ç·šæ™‚ï¼Œå°‡è³‡æ–™é€éä¸­é–“ä¼ºæœå™¨å‚³è¼¸ ICE å»ºç«‹é€£ç·šæµç¨‹ å…ˆå˜—è©¦ç”¨æœ¬åœ°ç¶²è·¯ IP ç›´æ¥é€£ç·š å¦‚æœå¤±æ•—ï¼Œå†ä½¿ç”¨ STUN å”å®šç©¿é€ NAT å»ºç«‹é€£ç·š å¦‚æœå¤±æ•—ï¼Œæœ€å¾Œæ‰ä½¿ç”¨ TURN å”å®šå°‡è³‡æ–™é€éä¸­ç¹¼ä¼ºæœå™¨å‚³è¼¸ Signaling Server ä¿¡è™Ÿä¼ºæœå™¨WebRTC é€šè¨Šæ™‚é›–ç„¶ä¸éœ€é€éä¼ºæœå™¨ä¸­è½‰ï¼Œä½¿ç”¨ P2P é”åˆ°å³æ™‚å½±éŸ³ä¸²æµï¼Œä½†åœ¨æ­¤ä¹‹å‰é‚„æ˜¯éœ€è¦å…ˆé€éä¼ºæœå™¨ä¾†é€²è¡Œåª’é«”ä¸²æµå’Œ ICE å€™é¸ä½å€å”èª¿ï¼Œä»¥ç¢ºå®šé€šè¨Šçš„å°æ–¹å’Œæ–¹å¼ï¼Œé€™å€‹ä¼ºæœå™¨å°±ç¨±ç‚º Signaling Serverã€‚ WebRTC æ²’æœ‰ç‰¹åˆ¥è¦ç¯„ Signaling Serverï¼Œå¸¸ç”¨çš„æœå‹™ç‚º WebSocket æˆ–æ˜¯ HTTP ä¼ºæœå™¨ã€‚ Signaling Server å»ºç«‹æµç¨‹ é€é WebSocket æˆ–æ˜¯ HTTP ä¼ºæœå™¨å»ºç«‹é€£ç·š ç™¼é€ç«¯èˆ‡æ¥æ”¶ç«¯åˆ†åˆ¥ä½¿ç”¨ SDPï¼ˆSession Description Protocolï¼‰offer-answer æ¨¡å‹æè¿°åª’é«”ä¸²æµè¨Šæ¯ï¼Œå‚³éçµ¦ Signaling Serverï¼ŒSignaling Server å†å‚³éçµ¦å°æ–¹ ç™¼é€ç«¯èˆ‡æ¥æ”¶ç«¯åˆ†åˆ¥å°‡å…¶æ”¶é›†åˆ°çš„æœ¬åœ°ç¶²è·¯ä½å€å’Œ ICE å€™é¸ä½å€é€šçŸ¥ Signaling Serverï¼ŒSignaling Server å†å°‡è¨Šæ¯å‚³éçµ¦å°æ–¹ æ§åˆ¶è¨Šæ¯ï¼ˆé€šè©±é–‹å§‹ã€æš«åœã€çµæŸç­‰ï¼‰èˆ‡æ•¸æ“šå‚³è¼¸ï¼ˆèŠå¤©è¨Šæ¯ã€æª”æ¡ˆï¼‰ SDPï¼ˆSession Description Protocolï¼‰å”å®šç”¨æ–¼æè¿°å¤šåª’é«”æœƒè©±çš„æ ¼å¼åŒ–æ–‡å­—å”å®šï¼Œåƒæ˜¯æœƒè­°çš„åƒèˆ‡è€…ã€åª’é«”é¡å‹ã€åª’é«”æµçš„å‚³è¼¸å”å®šã€ç·¨ç¢¼æ–¹å¼ã€è§£ç¢¼æ–¹å¼ã€å°åŒ…å¤§å°ç­‰è¨Šæ¯ã€‚ä¹Ÿå¯ä»¥åŒ…å«å…¶ä»–ç›¸é—œè¨Šæ¯ï¼Œä¾‹å¦‚æ™‚å€ã€åª’é«”ä¸²æµçš„ port è™Ÿã€æœƒè©±æŒçºŒæ™‚é–“ç­‰ã€‚SDP offer-answer æ¨¡å‹ä¸­ï¼Œç™¼é€ç«¯æœƒå»ºç«‹ä¸€å€‹ SDP offerï¼Œä¸¦å‘æ¥æ”¶ç«¯å‚³é€è©² SDP offerã€‚æ¥æ”¶ç«¯æ”¶åˆ° SDP offer å¾Œï¼Œæœƒå»ºç«‹ SDP answer ä¸¦å›å‚³çµ¦ç™¼é€ç«¯ï¼Œäº¤æ› SDP çš„éç¨‹ï¼Œè¢«ç¨±ç‚ºåª’é«”å”å•† P2P é€£ç·šå¦‚ä½•é€²è¡Œè¦–è¨Šé€šè©±ï¼ŸP2P é€£ç·šæˆåŠŸå¾Œï¼Œéœ€é€é MediaDevice API è£¡çš„ getUserMedia() å–å¾—æœ¬åœ°åª’é«”ä¸²æµï¼Œåª’é«”ä¸²æµç‚ºåŒ…å«è¦–è¨Šã€éŸ³è¨Šå’Œè³‡æ–™çš„æ•¸æ“šä¸²æµï¼ŒWebRTC ä½¿ç”¨å¤šç¨®æŠ€è¡“ä¾†é”æˆåª’é«”ä¸²æµå‚³è¼¸ï¼ŒåŒ…æ‹¬å³æ™‚å‚³è¼¸å”å®šï¼ˆRTPï¼‰å’Œå³æ™‚å‚³è¼¸æ§åˆ¶å”å®šï¼ˆRTCPï¼‰ç­‰ï¼Œä¸¦ä½¿ç”¨å‰é¢æåˆ°çš„ WebRTC API ä¾†é”æˆ P2P é€£ç·šèˆ‡è³‡æ–™å‚³éã€‚ è©¦è‘—ä½¿ç”¨ getUserMedia åœ¨ç€è¦½å™¨è¼¸å‡ºå½±éŸ³å‘¼å« getUserMedia() å–å¾—ä½¿ç”¨è€…çš„éŸ³è¨Šå’Œè¦–è¨Šï¼Œæœƒå›å‚³ä¸€å€‹ Promise ç‰©ä»¶ï¼Œconstraints ç”¨ä¾†è¨­å®šæ“·å–æ¢ä»¶ï¼ˆå½±åƒæˆ–è²éŸ³ï¼Œè‡³å°‘è¦æœ‰ä¸€é …ç‚º trueï¼‰ï¼Œä»¥ä¸‹ç¯„ä¾‹æœƒåœ¨ç€è¦½å™¨ä¸Šè¼¸å‡ºæœ¬åœ°ç«¯å½±éŸ³ï¼š &lt;video id=\"video\" autoplay&gt;&lt;/video&gt; const constraints = { audio: true, video: true};const video = document.querySelector(\"#video\");const createStream = async () =&gt; { try { const stream = await navigator.mediaDevices.getUserMedia(constraints); video.srcObject = stream; } catch (err) { throw err; }} è¦–è¨Šå½±åƒæ˜¯é¡›å€’çš„ï¼Œæˆ‘å€‘å¯ä»¥é€é CSS è¨­å®šåè½‰ #video { transform: scaleX(-1);} WebRTC ä¸€å°ä¸€è¦–è¨Šæµç¨‹è§£æè¦–è¨Šæƒ…å¢ƒè£ç½® A é–‹å•Ÿäº†ä¸€å€‹èŠå¤©å®¤ï¼Œæ¥è‘—è£ç½® B é€£æ¥è©²èŠå¤©å®¤é€²è¡Œè¦–è¨ŠèŠå¤© åœ–ç‰‡åƒè€ƒï¼šMDN æµç¨‹è§£æï¼ˆæ­é… STUN å”å®šï¼‰ è£ç½® A é€é STUN server å–å¾—æœ¬åœ°ç§æœ‰ IP ä»¥åŠå…¬æœ‰ IP è£ç½® B é€é STUN server å–å¾—æœ¬åœ°ç§æœ‰ IP ä»¥åŠå…¬æœ‰ IP è£ç½® A ç™¼é€ offer SDPï¼Œä¸¦è¨­å®šç‚ºæœ¬åœ° SDP è£ç½® B æ”¶åˆ° offer SDPï¼Œä¸¦è¨­å®šç‚ºé ç«¯ SDP è£ç½® B ç™¼é€ answer SDPï¼Œä¸¦è¨­å®šç‚ºæœ¬åœ° SDP è£ç½® A æ”¶åˆ° answer SDPï¼Œä¸¦è¨­å®šç‚ºé ç«¯ SDP è£ç½® A å‚³é€ ICE å€™é¸ä½å€ è£ç½® B å¯«å…¥è£ç½® A ICE å€™é¸ä½å€ è£ç½® B å‚³é€ ICE å€™é¸ä½å€ è£ç½® A å¯«å…¥è£ç½® B ICE å€™é¸ä½å€ P2P é€£ç·šå»ºç«‹ï¼Œé€²è¡Œå³æ™‚åª’é«”ä¸²æµï¼ˆéŸ³è¨Šã€è¦–è¨Šï¼‰ WebRTC åŸºæœ¬è§€å¿µèªªæ˜å°±åˆ°é€™ï¼Œä¸‹ä¸€ç¯‡å°‡æœƒé€²è¡Œå¯¦ä½œï¼Œä¸€èµ·å®Œæˆä¸€å°ä¸€è¦–è¨ŠèŠå¤©å®¤å§ï¼ åƒè€ƒæ–‡ç« ï¼š https://www.wowza.com/blog/webrtc-signaling-servers https://ithelp.ithome.com.tw/articles/10209725 https://ithelp.ithome.com.tw/articles/10284640 https://ithelp.ithome.com.tw/articles/10266739","link":"/2023/04/25/webrtc/webrtc-intro/"},{"title":"WebRTC å­¸ç¿’ç­†è¨˜ (2) å¯¦ä½œä¸€å°ä¸€è¦–è¨ŠèŠå¤©å®¤","text":"ä¸Šä¸€ç¯‡ èªªæ˜äº†å®ŒæˆèŠå¤©å®¤å¿…å‚™çš„åŸºç¤è§€å¿µï¼Œæ¥è‘—å°±ä¾†é€²è¡Œå¯¦ä½œå§ï¼ è¦–è¨Šæƒ…å¢ƒè£ç½® A é–‹å•Ÿäº†ä¸€å€‹èŠå¤©å®¤ï¼Œæ¥è‘—è£ç½® B é€£æ¥è©²èŠå¤©å®¤é€²è¡Œè¦–è¨ŠèŠå¤© åœ–ç‰‡åƒè€ƒï¼šMDN æµç¨‹è§£æï¼ˆæ­é… STUN å”å®šï¼‰ è£ç½® A é€é STUN server å–å¾—æœ¬åœ°ç§æœ‰ IP ä»¥åŠå…¬æœ‰ IP è£ç½® B é€é STUN server å–å¾—æœ¬åœ°ç§æœ‰ IP ä»¥åŠå…¬æœ‰ IP è£ç½® A ç™¼é€ offer SDPï¼Œä¸¦è¨­å®šç‚ºæœ¬åœ° SDP è£ç½® B æ”¶åˆ° offer SDPï¼Œä¸¦è¨­å®šç‚ºé ç«¯ SDP è£ç½® B ç™¼é€ answer SDPï¼Œä¸¦è¨­å®šç‚ºæœ¬åœ° SDP è£ç½® A æ”¶åˆ° answer SDPï¼Œä¸¦è¨­å®šç‚ºé ç«¯ SDP è£ç½® A å‚³é€ ICE å€™é¸ä½å€ è£ç½® B å¯«å…¥è£ç½® A ICE å€™é¸ä½å€ è£ç½® B å‚³é€ ICE å€™é¸ä½å€ è£ç½® A å¯«å…¥è£ç½® B ICE å€™é¸ä½å€ P2P é€£ç·šå»ºç«‹ï¼Œé€²è¡Œå³æ™‚åª’é«”ä¸²æµï¼ˆéŸ³è¨Šã€è¦–è¨Šï¼‰ è¦–è¨Šå¯¦ä½œ å¯¦ä½œåˆ†ç‚º Serverï¼ˆSignaling Serverï¼‰ä»¥åŠ Clientï¼ˆè¦–è¨ŠèŠå¤©å®¤ï¼‰é€²è¡Œ æª”æ¡ˆçµæ§‹å¦‚ä¸‹ï¼š server.jschat.htmlchat.js Serverï¼ˆserver.jsï¼‰å¥—ä»¶å®‰è£ï¼ˆNPMï¼‰ Node.js æ¡†æ¶ Express Websocket å¥—ä»¶ Socket.io å¥—ä»¶å¼•å…¥const express = require('express');const app = express();const http = require('http');const socket = require('socket.io'); å•Ÿå‹•ä¼ºæœå™¨port è¨­å®š 3000ï¼Œå› æ­¤ä¼ºæœå™¨é€£ç·šç¶²å€ç‚º http://localhost:3000 const server = http.createServer(app).listen('3000'); é€£æ¥ Client é é¢ï¼ˆè½‰æ›ç‚ºçµ•å°è·¯å¾‘ __dirnameï¼‰// html è·¯å¾‘è½‰æ›app.get('/chat', function(req, res) { es.sendfile(`${__dirname}/chat.html`);});// js è·¯å¾‘è½‰æ›app.get(/(.*)\\.(jpg|gif|png|ico|css|js|txt)/i, function(req, res) { console.log(__dirname); res.sendfile(`${__dirname}/${req.params[0]}.${req.params[1]}`);}); åŠ å…¥ Socket.io socket.on() ç›£è½ join, offer, answer, ice_candidate, hangup ç­‰ Client è‡ªè¨‚äº‹ä»¶ socket.emit() å‚³éäº‹ä»¶çµ¦ Client const io = socket(server);io.on('connection', (socket) =&gt; { console.log('connection'); // åŠ å…¥æˆ¿é–“ socket.on('join', (room) =&gt; { console.log('join'); socket.join(room); socket.to(room).emit('ready', 'æº–å‚™é€šè©±'); }); // è½‰å‚³ Offer socket.on('offer', (room, description) =&gt; { socket.to(room).emit('offer', description); }); // è½‰å‚³ Answer socket.on('answer', (room, desc) =&gt; { socket.to(room).emit('answer', description); }); // äº¤æ› ice candidate socket.on('ice_candidate', (room, data) =&gt; { socket.to(room).emit('ice_candidate', data); }); // é—œé–‰é€šè©± socket.on('hangup', (room) =&gt; { console.log('hangup'); socket.leave(room); });}); Clientï¼ˆè¦–è¨ŠèŠå¤©å®¤ï¼‰å¥—ä»¶å®‰è£ï¼ˆCDNï¼‰ WebRTC Adapterï¼ˆè§£æ±ºç›¸å®¹æ€§å•é¡Œï¼‰ Socket.io-client HTMLï¼ˆchat.htmlï¼‰ åŠ å…¥ Video Dom #localVideo æ¥æ”¶æœ¬åœ°åª’é«”ä¸²æµ #remoteVideo æ¥æ”¶é ç«¯åª’é«”ä¸²æµ CDN WebRTC Adapter ä»¥åŠ Socket.io-client å¼•å…¥ chat.js &lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset=\"utf-8\"&gt; &lt;meta name=\"viewport\" content=\"width=device-width, user-scalable=yes, initial-scale=1, maximum-scale=1\"&gt; &lt;title&gt;chat&lt;/title&gt; &lt;style lang=\"scss\"&gt; video { transform: scaleX(-1); } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div&gt; &lt;video muted=\"false\" width=\"320\" autoplay playsinline id=\"localVideo\"&gt;&lt;/video&gt; &lt;video width=\"320\" autoplay playsinline id=\"remoteVideo\"&gt;&lt;/video&gt; &lt;button type=\"button\" id=\"call\"&gt;call&lt;/button&gt; &lt;button type=\"button\" id=\"hangup\"&gt;hangup&lt;/button&gt; &lt;/div&gt; &lt;script src=\"https://webrtc.github.io/adapter/adapter-latest.js\"&gt;&lt;/script&gt; &lt;script src=\"https://cdn.jsdelivr.net/npm/socket.io-client@3.0.4/dist/socket.io.js\"&gt;&lt;/script&gt; &lt;script src=\"chat.js\" type=\"module\" async&gt;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt; Javascriptï¼ˆchat.jsï¼‰ä»»å‹™æ­¥é©Ÿæ‹†åˆ† é€£æ¥ Socket Serverï¼ˆSignaling Serverï¼‰é€é Socket ç›£è½ Offer SDPã€Answer SDPã€ICE Candidate getUserMedia å–å¾—æœ¬åœ°åª’é«”ä¸²æµ RTCPeerConnection å»ºç«‹ P2P é€£ç·šï¼Œèˆ‡ RTCPeerConnection äº‹ä»¶ç›£è½ å®šç¾©å¸¸æ•¸èˆ‡è®Šæ•¸const localVideo = document.querySelector('#localVideo');const remoteVideo = document.querySelector('#remoteVideo');const callBtn = document.querySelector('#call');const hangupBtn = document.querySelector('#hangup');let peerConnection;let socket;let localStream;const room = 'room1'; // æˆ¿é–“å…ˆé è¨­ç‚º room1 é€£æ¥ Socket Serverï¼ˆSignaling Serverï¼‰é€é Socket ç›£è½ Offer SDPã€Answer SDPã€ICE Candidate socket.emit() ä»¥åŠ socket.on() å‚³éèˆ‡æ¥æ”¶è³‡æ–™çµ¦ Server const socketConnect = () =&gt; { // ä¼ºæœå™¨é€£ç·šç¶²å€ï¼šhttp://localhost:3000 socket = io('ws://localhost:3000'); // ç™¼é€æˆ¿é–“è³‡è¨Š socket.emit('join', room); // ç›£è½åŠ å…¥æˆ¿é–“ socket.on('ready', (msg) =&gt; { // ç™¼é€ Offer SDP sendSDP('offer'); }); // ç›£è½æ”¶åˆ° Offer socket.on('offer', async (desc) =&gt; { // è¨­å®šå°æ–¹çš„åª’é«”ä¸²æµ await peerConnection.setRemoteDescription(desc); // ç™¼é€ Answer SDP await sendSDP('answer'); }); // ç›£è½æ”¶åˆ° Answer socket.on('answer', (desc) =&gt; { // è¨­å®šå°æ–¹çš„åª’é«”ä¸²æµ peerConnection.setRemoteDescription(desc) }); // ç›£è½æ”¶åˆ° ICE å€™é¸ä½å€ socket.on('ice_candidate', (data) =&gt; { // RTCIceCandidate ç”¨ä»¥å®šç¾© ICE å€™é¸ä½å€ const candidate = new RTCIceCandidate({ sdpMLineIndex: data.label, candidate: data.candidate }); // åŠ å…¥ ICE å€™é¸ä½å€ peerConnection.addIceCandidate(candidate); });}; è™•ç† Offer SDP / Answer SDP /** * @param {String} type offer/answer */const sendSDP = async (type) =&gt; { try { if (!peerConnection) { console.log('å°šæœªé–‹å•Ÿè¦–è¨Š'); return; } const method = type === 'offer' ? 'createOffer' : 'createAnswer'; const offerOptions = { offerToReceiveAudio: true, // æ˜¯å¦å‚³é€è²éŸ³æµçµ¦å°æ–¹ offerToReceiveVideo: true // æ˜¯å¦å‚³é€å½±åƒæµçµ¦å°æ–¹ }; // å»ºç«‹ SDP const localSDP = await peerConnection[method](offerOptions); // è¨­å®šæœ¬åœ° SDP await peerConnection.setLocalDescription(localSDP); // ç™¼é€ SDP socket.emit(type, room, peerConnection.localDescription); } catch (err) { console.log('error: ', err); }}; getUserMedia å–å¾—æœ¬åœ°åª’é«”ä¸²æµconst createStream = async () =&gt; { try { const constraints = { audio: true, video: true }; // getUserMedia å–å¾—æœ¬åœ°å½±éŸ³ä¸²æµ const stream = await navigator.mediaDevices.getUserMedia(constraints); // Dom è¨­ç½®æœ¬åœ°åª’é«”ä¸²æµ localVideo.srcObject = stream; // å‚³å‡ºåª’é«”ä¸²æµ localStream = stream; } catch (err) { console.log('getUserMedia error: ', err.message, err.name); }}; RTCPeerConnection å»ºç«‹ P2P é€£ç·šï¼Œèˆ‡ RTCPeerConnection äº‹ä»¶ç›£è½ RTCPeerConnection å…§çš„ iceServers ç”¨ä¾†å»ºç«‹å…©å°è£ç½®é»å°é»é€£ç·šçš„ä¼ºæœå™¨ getTracks()ï¼šå–å¾—åª’é«”ä¸²æµï¼ˆMediaStreamï¼‰ä¸­åª’é«”è»Œé“ï¼ˆMediaStreamTrackï¼‰é™£åˆ— addTrack(MediaStreamTrack, MediaStream)ï¼šå¢åŠ åª’é«”è»Œé“ï¼ˆMediaStreamTrackï¼‰åˆ° RTCPeerConnection ä¸­æŒ‡å®šçš„åª’é«”ä¸²æµï¼ˆMediaStreamï¼‰ const createPeerConnection = () =&gt; { // è¨­å®š iceServer const configuration = { iceServers: [{ urls: 'stun:stun.l.google.com:19302' // google æä¾›å…è²»çš„ STUN server }] }; // å»ºç«‹ RTCPeerConnection peerConnection = new RTCPeerConnection(configuration); // å¢åŠ æœ¬åœ°ä¸²æµ localStream.getTracks().forEach((track) =&gt; { peerConnection.addTrack(track, localStream); }); // æ‰¾å°‹åˆ° ICE å€™é¸ä½å€å¾Œï¼Œé€å» Server èˆ‡å¦ä¸€ä½é…å° peerConnection.onicecandidate = (e) =&gt; { if (e.candidate) { // ç™¼é€ ICE socket.emit('ice_candidate', room, { label: e.candidate.sdpMLineIndex, id: e.candidate.sdpMid, candidate: e.candidate.candidate, }); } }; // ç›£è½ ICE é€£æ¥ç‹€æ…‹ peerConnection.oniceconnectionstatechange = (e) =&gt; { // è‹¥é€£æ¥å·²æ–·ï¼ŒåŸ·è¡Œæ›æ–·ç›¸é—œå‹•ä½œ if (e.target.iceConnectionState === 'disconnected') { hangup(); } }; // ç›£è½æ˜¯å¦æœ‰åª’é«”ä¸²æµå‚³å…¥ peerConnection.onaddstream = ({ stream }) =&gt; { // Dom åŠ å…¥é ç«¯ä¸²æµ remoteVideo.srcObject = stream; };}; é»æ“ŠæŒ‰éˆ•é–‹å§‹é€£ç·šï¼é—œé–‰é€£ç·š// å»ºç«‹æœ¬åœ°åª’é«”ä¸²æµcreateStream();// é–‹å§‹é€£ç·šconst call = () =&gt; { socketConnect(); // socket é€£ç·š createPeerConnection(); // å»ºç«‹ P2P é€£ç·š};// é—œé–‰é€£ç·šconst hangup = () =&gt; { // ç§»é™¤äº‹ä»¶ç›£è½ peerConnection.onicecandidate = null; peerConnection.onnegotiationneeded = null; // é—œé–‰ RTCPeerConnection é€£ç·šä¸¦é‡‹æ”¾è¨˜æ†¶é«” peerConnection.close(); peerConnection = null; // å‚³éæ›æ–·äº‹ä»¶çµ¦ Server socket.emit('hangup', room); socket = null; // ç§»é™¤é ç«¯ video src remoteVideo.srcObject = null; // ç§»é™¤é ç«¯åª’é«”ä¸²æµ};callBtn.addEventListener('click', call);hangupBtn.addEventListener('click', hangup); é€™æ¨£ä¸€å°ä¸€èŠå¤©å®¤å°±å®Œæˆå›‰ï¼Œå¾ŒçºŒæœƒèªªæ˜å¦‚ä½•é”æˆå¤šæ–¹è¦–è¨ŠåŠŸèƒ½ åƒè€ƒæ–‡ç« ï¼š https://ithelp.ithome.com.tw/articles/10251454 https://ithelp.ithome.com.tw/articles/10209193 https://ithelp.ithome.com.tw/articles/10278727 https://medium.com/@jedy05097952/åˆæ¢-webrtc-æ‰‹æŠŠæ‰‹å»ºç«‹ç·šä¸Šè¦–è¨Š-1-5e9d4702e8e8","link":"/2023/05/02/webrtc/webrtc-video-chat/"}],"tags":[{"name":"node","slug":"node","link":"/tags/node/"},{"name":"nuxt2","slug":"nuxt2","link":"/tags/nuxt2/"},{"name":"axios","slug":"axios","link":"/tags/axios/"},{"name":"bootstrap","slug":"bootstrap","link":"/tags/bootstrap/"},{"name":"ckeditor","slug":"ckeditor","link":"/tags/ckeditor/"},{"name":"seo","slug":"seo","link":"/tags/seo/"},{"name":"gtag","slug":"gtag","link":"/tags/gtag/"},{"name":"masonry","slug":"masonry","link":"/tags/masonry/"},{"name":"sitemap","slug":"sitemap","link":"/tags/sitemap/"},{"name":"swiper","slug":"swiper","link":"/tags/swiper/"},{"name":"vee-validate","slug":"vee-validate","link":"/tags/vee-validate/"},{"name":"nuxt3","slug":"nuxt3","link":"/tags/nuxt3/"},{"name":"firebase","slug":"firebase","link":"/tags/firebase/"},{"name":"node.js","slug":"node-js","link":"/tags/node-js/"},{"name":"mongodb","slug":"mongodb","link":"/tags/mongodb/"},{"name":"nuxt","slug":"nuxt","link":"/tags/nuxt/"},{"name":"vue3","slug":"vue3","link":"/tags/vue3/"},{"name":"dns","slug":"dns","link":"/tags/dns/"},{"name":"github","slug":"github","link":"/tags/github/"},{"name":"javascript","slug":"javascript","link":"/tags/javascript/"},{"name":"three.js","slug":"three-js","link":"/tags/three-js/"},{"name":"css","slug":"css","link":"/tags/css/"},{"name":"typescript","slug":"typescript","link":"/tags/typescript/"},{"name":"webrtc","slug":"webrtc","link":"/tags/webrtc/"}],"categories":[{"name":"Node","slug":"Node","link":"/categories/Node/"},{"name":"Nuxt","slug":"Nuxt","link":"/categories/Nuxt/"},{"name":"Nuxt3","slug":"Nuxt3","link":"/categories/Nuxt3/"},{"name":"Vue","slug":"Vue","link":"/categories/Vue/"},{"name":"Web","slug":"Web","link":"/categories/Web/"},{"name":"Javascript","slug":"Javascript","link":"/categories/Javascript/"},{"name":"CSS","slug":"CSS","link":"/categories/CSS/"},{"name":"Typescript","slug":"Typescript","link":"/categories/Typescript/"},{"name":"WebRTC","slug":"WebRTC","link":"/categories/WebRTC/"}]}